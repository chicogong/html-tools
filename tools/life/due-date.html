<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>é¢„äº§æœŸè®¡ç®—å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="é¢„äº§æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta name="keywords" content="due-date,life,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/life/due-date.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="é¢„äº§æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta property="og:description" content="é¢„äº§æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/life/due-date.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="é¢„äº§æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta name="twitter:description" content="é¢„äº§æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <meta
      name="description"
      content="åœ¨çº¿é¢„äº§æœŸè®¡ç®—å™¨ï¼Œæ ¹æ®æœ«æ¬¡æœˆç»æˆ–Bè¶…æ•°æ®è®¡ç®—é¢„äº§æœŸï¼Œæ˜¾ç¤ºå½“å‰å­•å‘¨ã€èƒå„¿å‘è‚²æƒ…å†µã€é‡è¦äº§æ£€æ—¶é—´èŠ‚ç‚¹"
    />
    <meta name="keywords" content="é¢„äº§æœŸè®¡ç®—,å­•å‘¨è®¡ç®—,æ€€å­•å‘¨æ•°,èƒå„¿å‘è‚²,äº§æ£€æ—¶é—´,é¢„äº§æœŸ" />
    <style>
      :root {
        --color-bg-deep: #0a0a0f;
        --color-bg-surface: #12121a;
        --color-bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --color-text-primary: #e8e8ed;
        --color-text-secondary: #8888a0;
        --color-text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --color-accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --color-accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      
  /* å­—ä½“å˜é‡ */
  --font-sans: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-mono: 'JetBrains Mono', 'Courier New', monospace;
}

      [data-theme="light"] {
        --color-bg-deep: #fafafa;
        --color-bg-surface: #fff;
        --color-bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --color-text-primary: #1a1a1a;
        --color-text-secondary: #666;
        --color-text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border-subtle);
        background: var(--color-bg-card);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      :root {
        --bg-color: #fdf2f8;
        --card-bg: #fff;
        --color-text-primary: #4a4a4a;
        --color-text-secondary: #7f8c8d;
        --border-color: #f3e8ef;
        --primary-color: #ec4899;
        --primary-hover: #db2777;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --info-color: #8b5cf6;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --bg-color: #1a1a2e;
          --card-bg: #16213e;
          --color-text-primary: #eaf0f6;
          --color-text-secondary: #a0aab4;
          --border-color: #2d3748;
          --primary-color: var(--color-accent-pink);
          --primary-hover: #ec4899;
        }
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-sans);
        font-size: 16px;
        line-height: 1.6;
        background: var(--bg-color);
        color: var(--color-text-primary);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
      }

      h1 {
        text-align: center;
        margin-bottom: 8px;
        font-size: 1.8rem;
      }

      .subtitle {
        text-align: center;
        color: var(--color-text-secondary);
        margin-bottom: 24px;
        font-size: 0.95rem;
      }

      .card {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: 0 4px 12px rgba(236, 72, 153, 0.08);
      }

      .card-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 16px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .form-group label {
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--color-text-secondary);
      }

      .form-group input,
      .form-group select {
        padding: 12px;
        border: 2px solid var(--border-color);
        border-radius: 10px;
        font-size: 1rem;
        background: var(--bg-color);
        color: var(--color-text-primary);
        transition: border-color 0.2s;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: var(--primary-color);
      }

      .method-tabs {
        display: flex;
        gap: 12px;
        margin-bottom: 20px;
      }

      .method-tab {
        flex: 1;
        padding: 14px;
        border: 2px solid var(--border-color);
        border-radius: 12px;
        background: var(--bg-color);
        color: var(--color-text-primary);
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
        font-size: 0.95rem;
      }

      .method-tab:hover {
        border-color: var(--primary-color);
      }

      .method-tab.active {
        background: var(--primary-color);
        border-color: var(--primary-color);
        color: white;
      }

      .method-section {
        display: none;
      }

      .method-section.show {
        display: block;
      }

      .btn {
        padding: 14px 28px;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        width: 100%;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(236, 72, 153, 0.3);
      }

      /* ç»“æœåŒºåŸŸ */
      .result-section {
        display: none;
      }

      .result-section.show {
        display: block;
      }

      .result-main {
        background: linear-gradient(135deg, var(--primary-color), var(--info-color));
        border-radius: 20px;
        padding: 30px;
        color: white;
        text-align: center;
        margin-bottom: 20px;
      }

      .due-date {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 8px;
      }

      .due-date-label {
        font-size: 1rem;
        opacity: 0.9;
      }

      .pregnancy-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
        margin-top: 24px;
      }

      .stat-box {
        background: rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        padding: 16px;
      }

      .stat-value {
        font-size: 1.8rem;
        font-weight: 700;
      }

      .stat-label {
        font-size: 0.85rem;
        opacity: 0.9;
      }

      /* å­•å‘¨è¿›åº¦ */
      .progress-section {
        margin-bottom: 20px;
      }

      .progress-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
      }

      .progress-bar {
        height: 12px;
        background: var(--border-color);
        border-radius: 6px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary-color), var(--info-color));
        border-radius: 6px;
        transition: width 0.5s ease;
      }

      .trimester-markers {
        display: flex;
        justify-content: space-between;
        margin-top: 8px;
        font-size: 0.8rem;
        color: var(--color-text-secondary);
      }

      /* èƒå„¿å‘è‚²ä¿¡æ¯ */
      .fetal-info {
        display: grid;
        grid-template-columns: 120px 1fr;
        gap: 20px;
        align-items: center;
      }

      .fetal-icon {
        width: 100px;
        height: 100px;
        background: var(--bg-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
      }

      .fetal-details h3 {
        margin-bottom: 8px;
        color: var(--primary-color);
      }

      .fetal-details p {
        color: var(--color-text-secondary);
        line-height: 1.6;
        font-size: 0.95rem;
      }

      .fetal-size {
        display: flex;
        gap: 20px;
        margin-top: 12px;
      }

      .size-item {
        display: flex;
        align-items: center;
        gap: 8px;
        background: var(--bg-color);
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
      }

      /* é‡è¦æ—¥æœŸæ—¶é—´çº¿ */
      .timeline {
        position: relative;
        padding-left: 30px;
      }

      .timeline::before {
        content: "";
        position: absolute;
        left: 8px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--border-color);
      }

      .timeline-item {
        position: relative;
        padding-bottom: 20px;
      }

      .timeline-item:last-child {
        padding-bottom: 0;
      }

      .timeline-dot {
        position: absolute;
        left: -26px;
        top: 4px;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background: var(--border-color);
      }

      .timeline-dot.passed {
        background: var(--success-color);
      }

      .timeline-dot.current {
        background: var(--primary-color);
        box-shadow: 0 0 0 4px rgba(236, 72, 153, 0.2);
      }

      .timeline-dot.future {
        background: var(--border-color);
      }

      .timeline-date {
        font-size: 0.85rem;
        color: var(--color-text-secondary);
        margin-bottom: 4px;
      }

      .timeline-title {
        font-weight: 600;
        margin-bottom: 4px;
      }

      .timeline-desc {
        font-size: 0.9rem;
        color: var(--color-text-secondary);
      }

      /* å­•æœŸé˜¶æ®µæ ‡ç­¾ */
      .trimester-badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.85rem;
        font-weight: 500;
      }

      .trimester-1 {
        background: rgba(16, 185, 129, 0.15);
        color: var(--success-color);
      }
      .trimester-2 {
        background: rgba(245, 158, 11, 0.15);
        color: var(--warning-color);
      }
      .trimester-3 {
        background: rgba(236, 72, 153, 0.15);
        color: var(--primary-color);
      }

      /* æç¤ºæ¡† */
      .tip-box {
        background: rgba(139, 92, 246, 0.1);
        border-left: 4px solid var(--info-color);
        padding: 16px;
        border-radius: 0 12px 12px 0;
        margin-top: 20px;
      }

      .tip-box strong {
        color: var(--info-color);
      }

      @media (max-width: 600px) {
        .method-tabs {
          flex-direction: column;
        }
        .pregnancy-stats {
          grid-template-columns: 1fr;
        }
        .fetal-info {
          grid-template-columns: 1fr;
          text-align: center;
        }
        .fetal-icon {
          margin: 0 auto;
        }
        .due-date {
          font-size: 2rem;
        }
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
      .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        margin: -1px;
        padding: 0;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
    <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
  <body>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">
      <span id="theme-icon">ğŸŒ™</span>
    </button>

    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      é¢„äº§æœŸè®¡ç®—å™¨
    </nav>
    <div class="container">
      <h1>ğŸ¤° é¢„äº§æœŸè®¡ç®—å™¨</h1>
      <p class="subtitle">è®¡ç®—é¢„äº§æœŸï¼Œäº†è§£å­•å‘¨å’Œèƒå„¿å‘è‚²æƒ…å†µ</p>

      <!-- è®¡ç®—æ–¹å¼é€‰æ‹© -->
      <div class="card">
        <div class="card-title">
          <span>ğŸ“…</span>
          é€‰æ‹©è®¡ç®—æ–¹å¼
        </div>
        <div class="method-tabs">
          <button class="method-tab active" data-method="lmp" onclick="switchMethod('lmp')">
            ğŸ©¸ æœ«æ¬¡æœˆç»æ—¥æœŸ
          </button>
          <button class="method-tab" data-method="ultrasound" onclick="switchMethod('ultrasound')">
            ğŸ”¬ Bè¶…å­•å‘¨æ¨ç®—
          </button>
          <button class="method-tab" data-method="ivf" onclick="switchMethod('ivf')">
            ğŸ§¬ è¯•ç®¡å©´å„¿
          </button>
        </div>

        <!-- æœ«æ¬¡æœˆç» -->
        <div class="method-section show" id="lmpSection">
          <div class="form-row">
            <div class="form-group">
              <label for="input--------">æœ«æ¬¡æœˆç»ç¬¬ä¸€å¤©</label>
              <input  type="date" id="lmpDate" aria-label="æ—¥æœŸé€‰æ‹©å™¨" />
            </div>
            <div class="form-group">
              <label>æœˆç»å‘¨æœŸï¼ˆå¤©ï¼‰</label>
              <select id="cycleLength">
                <option value="25">25å¤©</option>
                <option value="26">26å¤©</option>
                <option value="27">27å¤©</option>
                <option value="28" selected>28å¤©ï¼ˆæ ‡å‡†å‘¨æœŸï¼‰</option>
                <option value="29">29å¤©</option>
                <option value="30">30å¤©</option>
                <option value="31">31å¤©</option>
                <option value="32">32å¤©</option>
                <option value="35">35å¤©</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Bè¶…æ¨ç®— -->
        <div class="method-section" id="ultrasoundSection">
          <div class="form-row">
            <div class="form-group">
              <label for="input-b-----">Bè¶…æ£€æŸ¥æ—¥æœŸ</label>
              <input  type="date" id="ultrasoundDate" aria-label="æ—¥æœŸé€‰æ‹©å™¨" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="input-b-----">Bè¶…æ˜¾ç¤ºå­•å‘¨</label>
              <input
                
                type="number"
                id="ultrasoundWeeks"
                placeholder="å‘¨"
                min="4"
                max="40"
                aria-label="æ•°å­—è¾“å…¥æ¡†"
              />
            </div>
            <div class="form-group">
              <label for="input-b-----">Bè¶…æ˜¾ç¤ºå¤©æ•°</label>
              <input
                
                type="number"
                id="ultrasoundDays"
                placeholder="å¤©"
                min="0"
                max="6"
                aria-label="æ•°å­—è¾“å…¥æ¡†"
              />
            </div>
          </div>
        </div>

        <!-- è¯•ç®¡å©´å„¿ -->
        <div class="method-section" id="ivfSection">
          <div class="form-row">
            <div class="form-group">
              <label for="input-----">ç§»æ¤æ—¥æœŸ</label>
              <input  type="date" id="ivfDate" aria-label="æ—¥æœŸé€‰æ‹©å™¨" />
            </div>
            <div class="form-group">
              <label>èƒšèƒç±»å‹</label>
              <select id="embryoType">
                <option value="3">D3é²œèƒšï¼ˆ3å¤©ï¼‰</option>
                <option value="5" selected>å›Šèƒšï¼ˆ5å¤©ï¼‰</option>
                <option value="6">å›Šèƒšï¼ˆ6å¤©ï¼‰</option>
              </select>
            </div>
          </div>
        </div>

        <button class="btn btn-primary" onclick="calculate()" aria-label="âœ¨ è®¡ç®—é¢„äº§æœŸ">
          âœ¨ è®¡ç®—é¢„äº§æœŸ
        </button>
      </div>

      <!-- è®¡ç®—ç»“æœ -->
      <div class="result-section" id="resultSection">
        <!-- ä¸»è¦ç»“æœ -->
        <div class="card">
          <div class="result-main">
            <div class="due-date-label">é¢„äº§æœŸ</div>
            <div class="due-date" id="dueDateResult">2025å¹´8æœˆ15æ—¥</div>
            <div id="trimesterBadge" class="trimester-badge trimester-1">å­•æ—©æœŸ</div>

            <div class="pregnancy-stats">
              <div class="stat-box">
                <div class="stat-value" id="weeksResult">0</div>
                <div class="stat-label">å½“å‰å­•å‘¨</div>
              </div>
              <div class="stat-box">
                <div class="stat-value" id="daysLeftResult">0</div>
                <div class="stat-label">è·ç¦»é¢„äº§æœŸ</div>
              </div>
              <div class="stat-box">
                <div class="stat-value" id="progressResult">0%</div>
                <div class="stat-label">å­•ç¨‹è¿›åº¦</div>
              </div>
            </div>
          </div>

          <!-- è¿›åº¦æ¡ -->
          <div class="progress-section">
            <div class="progress-header">
              <span>å­•æœŸè¿›åº¦</span>
              <span id="progressText">0/40å‘¨</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="trimester-markers">
              <span>å­•æ—©æœŸ (1-12å‘¨)</span>
              <span>å­•ä¸­æœŸ (13-27å‘¨)</span>
              <span>å­•æ™šæœŸ (28-40å‘¨)</span>
            </div>
          </div>
        </div>

        <!-- èƒå„¿å‘è‚² -->
        <div class="card">
          <div class="card-title">
            <span>ğŸ‘¶</span>
            èƒå„¿å‘è‚²æƒ…å†µ
          </div>
          <div class="fetal-info">
            <div class="fetal-icon" id="fetalIcon">ğŸ«›</div>
            <div class="fetal-details">
              <h3 id="fetalTitle">ç¬¬8å‘¨</h3>
              <p id="fetalDesc">èƒå„¿æ­£åœ¨å¿«é€Ÿå‘è‚²ä¸­...</p>
              <div class="fetal-size" id="fetalSize">
                <div class="size-item">ğŸ“ çº¦ 1.6 cm</div>
                <div class="size-item">âš–ï¸ çº¦ 1 g</div>
              </div>
            </div>
          </div>
        </div>

        <!-- é‡è¦æ—¥æœŸ -->
        <div class="card">
          <div class="card-title">
            <span>ğŸ“‹</span>
            é‡è¦äº§æ£€æ—¶é—´
          </div>
          <div class="timeline" id="timeline">
            <!-- åŠ¨æ€ç”Ÿæˆ -->
          </div>

          <div class="tip-box">
            <strong>ğŸ’¡ æ¸©é¦¨æç¤ºï¼š</strong>
            <br />
            é¢„äº§æœŸåªæ˜¯ä¸€ä¸ªä¼°è®¡å€¼ï¼Œå®é™…åˆ†å¨©æ—¥æœŸå¯èƒ½æå‰æˆ–æ¨å1-2å‘¨éƒ½å±äºæ­£å¸¸èŒƒå›´ã€‚åªæœ‰çº¦5%çš„å®å®ä¼šåœ¨é¢„äº§æœŸå½“å¤©å‡ºç”Ÿã€‚å¦‚æœ‰ä»»ä½•ä¸é€‚ï¼Œè¯·åŠæ—¶å°±åŒ»ã€‚
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentMethod = "lmp";

      // èƒå„¿å‘è‚²æ•°æ®
      const fetalDevelopment = {
        4: { icon: "ğŸ”µ", size: "0.1cm", weight: "<1g", desc: "å—ç²¾åµç€åºŠï¼Œå¼€å§‹å½¢æˆèƒšèƒ" },
        5: { icon: "ğŸ«˜", size: "0.2cm", weight: "<1g", desc: "å¿ƒè„å¼€å§‹è·³åŠ¨ï¼Œç¥ç»ç®¡å½¢æˆ" },
        6: { icon: "ğŸ«›", size: "0.5cm", weight: "<1g", desc: "é¢éƒ¨å™¨å®˜å¼€å§‹å‘è‚²ï¼Œå››è‚¢èŠ½å‡ºç°" },
        7: { icon: "ğŸ«›", size: "1cm", weight: "<1g", desc: "æ‰‹æŒ‡è„šè¶¾å¼€å§‹åˆ†åŒ–" },
        8: { icon: "ğŸ«›", size: "1.6cm", weight: "1g", desc: "èƒšèƒæœŸç»“æŸï¼Œæ­£å¼ç§°ä¸ºèƒå„¿" },
        9: { icon: "ğŸ¥œ", size: "2.3cm", weight: "2g", desc: "çœ¼ç‘å¼€å§‹å½¢æˆï¼Œå››è‚¢å¯ä»¥æ´»åŠ¨" },
        10: { icon: "ğŸ¥œ", size: "3cm", weight: "4g", desc: "æ‰‹æŒ‡è„šè¶¾å®Œå…¨åˆ†å¼€ï¼ŒæŒ‡ç”²å¼€å§‹ç”Ÿé•¿" },
        11: { icon: "ğŸ‡", size: "4cm", weight: "7g", desc: "å¤–ç”Ÿæ®–å™¨å¼€å§‹å‘è‚²" },
        12: { icon: "ğŸ‹", size: "5.4cm", weight: "14g", desc: "æ‰€æœ‰å™¨å®˜å·²å½¢æˆï¼Œè¿›å…¥æˆç†ŸæœŸ" },
        13: { icon: "ğŸ‹", size: "7cm", weight: "25g", desc: "å£°å¸¦å½¢æˆï¼Œå¯ä»¥æ‰“å—" },
        14: { icon: "ğŸ‹", size: "8.7cm", weight: "43g", desc: "å¼€å§‹é•¿å‡ºèƒæ¯›" },
        15: { icon: "ğŸ", size: "10cm", weight: "70g", desc: "å¯ä»¥æ„Ÿå—åˆ°å…‰çº¿" },
        16: { icon: "ğŸ", size: "11.6cm", weight: "100g", desc: "å¯èƒ½å¼€å§‹æ„Ÿå—åˆ°èƒåŠ¨" },
        17: { icon: "ğŸ¥‘", size: "13cm", weight: "140g", desc: "è„‚è‚ªå¼€å§‹ç§¯ç´¯" },
        18: { icon: "ğŸ¥‘", size: "14cm", weight: "190g", desc: "å¯ä»¥å¬åˆ°å£°éŸ³" },
        19: { icon: "ğŸ¥­", size: "15cm", weight: "240g", desc: "æ„Ÿè§‰å™¨å®˜å¿«é€Ÿå‘è‚²" },
        20: { icon: "ğŸ¥­", size: "16cm", weight: "300g", desc: "å¯é€šè¿‡Bè¶…ç¡®å®šæ€§åˆ«ï¼Œå­•æœŸè¿‡åŠ" },
        21: { icon: "ğŸŒ", size: "27cm", weight: "360g", desc: "çœ‰æ¯›å’Œçœ¼ç‘å‘è‚²å®Œå–„" },
        22: { icon: "ğŸŒ", size: "28cm", weight: "430g", desc: "å˜´å”‡å’Œçœ‰æ¯›æ›´åŠ æ¸…æ™°" },
        23: { icon: "ğŸ¥’", size: "29cm", weight: "500g", desc: "çš®è‚¤å¼€å§‹å˜å¾—ä¸é€æ˜" },
        24: { icon: "ğŸ¥’", size: "30cm", weight: "600g", desc: "è‚ºéƒ¨å¼€å§‹äº§ç”Ÿè¡¨é¢æ´»æ€§ç‰©è´¨" },
        25: { icon: "ğŸŒ½", size: "35cm", weight: "660g", desc: "å¼€å§‹æœ‰è§„å¾‹çš„ç¡çœ å‘¨æœŸ" },
        26: { icon: "ğŸŒ½", size: "36cm", weight: "760g", desc: "çœ¼ç›å¯ä»¥çå¼€" },
        27: { icon: "ğŸ¥¬", size: "37cm", weight: "875g", desc: "å¤§è„‘å¿«é€Ÿå‘è‚²" },
        28: { icon: "ğŸ¥¬", size: "38cm", weight: "1kg", desc: "å¯ä»¥åšæ¢¦äº†" },
        29: { icon: "ğŸ†", size: "39cm", weight: "1.2kg", desc: "éª¨éª¼å˜å¾—æ›´åšç¡¬" },
        30: { icon: "ğŸ†", size: "40cm", weight: "1.3kg", desc: "å¼€å§‹å‚¨å­˜é“ã€é’™ç­‰çŸ¿ç‰©è´¨" },
        31: { icon: "ğŸ¥¥", size: "41cm", weight: "1.5kg", desc: "è„‘éƒ¨å‘è‚²è¿›å…¥é«˜å³°æœŸ" },
        32: { icon: "ğŸ¥¥", size: "42cm", weight: "1.7kg", desc: "æŒ‡ç”²é•¿åˆ°æŒ‡å°–" },
        33: { icon: "ğŸ", size: "43cm", weight: "1.9kg", desc: "å…ç–«ç³»ç»Ÿå‘è‚²" },
        34: { icon: "ğŸ", size: "45cm", weight: "2.1kg", desc: "è‚ºéƒ¨æ¥è¿‘æˆç†Ÿ" },
        35: { icon: "ğŸˆ", size: "46cm", weight: "2.4kg", desc: "å¤§éƒ¨åˆ†å™¨å®˜å·²ç»æˆç†Ÿ" },
        36: { icon: "ğŸˆ", size: "47cm", weight: "2.6kg", desc: "èƒä½å¤§å¤šå·²å›ºå®š" },
        37: { icon: "ğŸƒ", size: "48cm", weight: "2.9kg", desc: "è¶³æœˆï¼éšæ—¶å¯èƒ½å‡ºç”Ÿ" },
        38: { icon: "ğŸƒ", size: "49cm", weight: "3.1kg", desc: "å„å™¨å®˜å·²å®Œå…¨æˆç†Ÿ" },
        39: { icon: "ğŸ‰", size: "50cm", weight: "3.3kg", desc: "ç­‰å¾…åˆ†å¨©ä¿¡å·" },
        40: { icon: "ğŸ‰", size: "51cm", weight: "3.5kg", desc: "é¢„äº§æœŸåˆ°æ¥ï¼Œå‡†å¤‡è¿æ¥å®å®ï¼" }
      };

      // äº§æ£€æ—¶é—´è¡¨
      const checkupSchedule = [
        { week: 6, title: "é¦–æ¬¡äº§æ£€", desc: "ç¡®è®¤å¦Šå¨ ï¼ŒBè¶…æ£€æŸ¥èƒå¿ƒ" },
        { week: 12, title: "NTæ£€æŸ¥", desc: "æµ‹é‡èƒå„¿é¢ˆéƒ¨é€æ˜å±‚åšåº¦" },
        { week: 16, title: "å”æ°ç­›æŸ¥", desc: "æŠ½è¡€æ£€æŸ¥æŸ“è‰²ä½“å¼‚å¸¸é£é™©" },
        { week: 20, title: "å¤§æ’ç•¸Bè¶…", desc: "å…¨é¢æ£€æŸ¥èƒå„¿ç»“æ„å‘è‚²" },
        { week: 24, title: "ç³–è€é‡æµ‹è¯•", desc: "ç­›æŸ¥å¦Šå¨ æœŸç³–å°¿ç—…" },
        { week: 28, title: "å¸¸è§„äº§æ£€", desc: "å¼€å§‹æ¯ä¸¤å‘¨äº§æ£€ä¸€æ¬¡" },
        { week: 32, title: "Bè¶…æ£€æŸ¥", desc: "è¯„ä¼°èƒå„¿å¤§å°å’Œç¾Šæ°´é‡" },
        { week: 36, title: "è¶³æœˆæ£€æŸ¥", desc: "å¼€å§‹æ¯å‘¨äº§æ£€ï¼Œè¯„ä¼°åˆ†å¨©æ¡ä»¶" },
        { week: 37, title: "å…¥é™¢å‡†å¤‡", desc: "å‡†å¤‡å¾…äº§åŒ…ï¼Œäº†è§£åˆ†å¨©å¾å…†" },
        { week: 40, title: "é¢„äº§æœŸ", desc: "ç­‰å¾…åˆ†å¨©ï¼Œè¶…è¿‡41å‘¨éœ€è¯„ä¼°" }
      ];

      document.addEventListener("DOMContentLoaded", () => {
        // è®¾ç½®é»˜è®¤æ—¥æœŸ
        const today = new Date();
        document.getElementById("lmpDate").value = getDateWeeksAgo(today, 8);
        document.getElementById("ultrasoundDate").value = today.toISOString().split("T")[0];
        document.getElementById("ivfDate").value = getDateWeeksAgo(today, 6);
      });

      function getDateWeeksAgo(date, weeks) {
        const result = new Date(date);
        result.setDate(result.getDate() - weeks * 7);
        return result.toISOString().split("T")[0];
      }

      function switchMethod(method) {
        currentMethod = method;

        document.querySelectorAll(".method-tab").forEach((tab) => {
          tab.classList.toggle("active", tab.dataset.method === method);
        });

        document.querySelectorAll(".method-section").forEach((section) => {
          section.classList.remove("show");
        });
        document.getElementById(method + "Section").classList.add("show");
      }

      function calculate() {
        let lmpDate; // æœ«æ¬¡æœˆç»æ—¥æœŸ

        switch (currentMethod) {
          case "lmp": {
            const inputDate = document.getElementById("lmpDate").value;
            if (!inputDate) {
              alert("è¯·é€‰æ‹©æœ«æ¬¡æœˆç»æ—¥æœŸ");
              return;
            }
            lmpDate = new Date(inputDate);

            // æ ¹æ®æœˆç»å‘¨æœŸè°ƒæ•´
            const cycleLength = parseInt(document.getElementById("cycleLength").value);
            const cycleDiff = cycleLength - 28;
            lmpDate.setDate(lmpDate.getDate() + cycleDiff);
            break;
          }

          case "ultrasound": {
            const ultrasoundDate = document.getElementById("ultrasoundDate").value;
            const weeks = parseInt(document.getElementById("ultrasoundWeeks").value) || 0;
            const days = parseInt(document.getElementById("ultrasoundDays").value) || 0;

            if (!ultrasoundDate || weeks < 4) {
              alert("è¯·å¡«å†™Bè¶…æ£€æŸ¥æ—¥æœŸå’Œå­•å‘¨");
              return;
            }

            const totalDays = weeks * 7 + days;
            lmpDate = new Date(ultrasoundDate);
            lmpDate.setDate(lmpDate.getDate() - totalDays);
            break;
          }

          case "ivf": {
            const ivfDate = document.getElementById("ivfDate").value;
            const embryoType = parseInt(document.getElementById("embryoType").value);

            if (!ivfDate) {
              alert("è¯·é€‰æ‹©ç§»æ¤æ—¥æœŸ");
              return;
            }

            // è¯•ç®¡å©´å„¿LMPè®¡ç®—ï¼šç§»æ¤æ—¥æœŸ - (14 + èƒšèƒå¤©æ•°) å¤©
            lmpDate = new Date(ivfDate);
            lmpDate.setDate(lmpDate.getDate() - 14 - embryoType);
            break;
          }
        }

        // è®¡ç®—é¢„äº§æœŸï¼ˆLMP + 280å¤©ï¼‰
        const dueDate = new Date(lmpDate);
        dueDate.setDate(dueDate.getDate() + 280);

        // è®¡ç®—å½“å‰å­•å‘¨
        const today = new Date();
        const daysSinceLMP = Math.floor((today - lmpDate) / (1000 * 60 * 60 * 24));
        const currentWeeks = Math.floor(daysSinceLMP / 7);
        const currentDays = daysSinceLMP % 7;

        // è®¡ç®—è·ç¦»é¢„äº§æœŸå¤©æ•°
        const daysUntilDue = Math.floor((dueDate - today) / (1000 * 60 * 60 * 24));

        // è®¡ç®—è¿›åº¦
        const progress = Math.min(100, Math.max(0, (daysSinceLMP / 280) * 100));

        // æ˜¾ç¤ºç»“æœ
        document.getElementById("resultSection").classList.add("show");

        // ä¸»è¦æ•°æ®
        document.getElementById("dueDateResult").textContent = formatDate(dueDate);
        document.getElementById("weeksResult").textContent = `${currentWeeks}å‘¨${currentDays}å¤©`;
        document.getElementById("daysLeftResult").textContent =
          daysUntilDue > 0 ? `${daysUntilDue}å¤©` : "å·²åˆ°æœŸ";
        document.getElementById("progressResult").textContent = progress.toFixed(1) + "%";

        // è¿›åº¦æ¡
        document.getElementById("progressBar").style.width = progress + "%";
        document.getElementById("progressText").textContent = `${currentWeeks}/40å‘¨`;

        // å­•æœŸé˜¶æ®µ
        let trimester, trimesterClass;
        if (currentWeeks < 13) {
          trimester = "å­•æ—©æœŸ";
          trimesterClass = "trimester-1";
        } else if (currentWeeks < 28) {
          trimester = "å­•ä¸­æœŸ";
          trimesterClass = "trimester-2";
        } else {
          trimester = "å­•æ™šæœŸ";
          trimesterClass = "trimester-3";
        }
        const badge = document.getElementById("trimesterBadge");
        badge.textContent = trimester;
        badge.className = `trimester-badge ${trimesterClass}`;

        // èƒå„¿å‘è‚²
        const weekData =
          fetalDevelopment[Math.min(40, Math.max(4, currentWeeks))] || fetalDevelopment[40];
        document.getElementById("fetalIcon").textContent = weekData.icon;
        document.getElementById("fetalTitle").textContent = `ç¬¬${currentWeeks}å‘¨`;
        document.getElementById("fetalDesc").textContent = weekData.desc;
        document.getElementById("fetalSize").innerHTML = `
                <div class="size-item">ğŸ“ çº¦ ${weekData.size}</div>
                <div class="size-item">âš–ï¸ çº¦ ${weekData.weight}</div>
            `;

        // æ—¶é—´çº¿
        renderTimeline(lmpDate, currentWeeks);

        // æ»šåŠ¨åˆ°ç»“æœ
        document.getElementById("resultSection").scrollIntoView({ behavior: "smooth" });
      }

      function renderTimeline(lmpDate, currentWeeks) {
        const timeline = document.getElementById("timeline");

        timeline.innerHTML = checkupSchedule
          .map((item) => {
            const checkupDate = new Date(lmpDate);
            checkupDate.setDate(checkupDate.getDate() + item.week * 7);

            let dotClass = "future";
            if (item.week < currentWeeks) {
              dotClass = "passed";
            } else if (item.week <= currentWeeks + 1) {
              dotClass = "current";
            }

            return `
                    <div class="timeline-item">
                        <div class="timeline-dot ${dotClass}"></div>
                        <div class="timeline-date">${formatDate(checkupDate)} Â· å­•${item.week}å‘¨</div>
                        <div class="timeline-title">${item.title}</div>
                        <div class="timeline-desc">${item.desc}</div>
                    </div>
                `;
          })
          .join("");
      }

      function formatDate(date) {
        return date.toLocaleDateString("zh-CN", {
          year: "numeric",
          month: "long",
          day: "numeric"
        });
      }

      // Theme toggle
      function toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        document.getElementById("theme-icon").textContent = newTheme === "light" ? "â˜€ï¸" : "ğŸŒ™";
        localStorage.setItem("theme", newTheme);
      }

      // Load saved theme
      const savedTheme = localStorage.getItem("theme") || "dark";
      if (savedTheme === "light") {
        document.documentElement.setAttribute("data-theme", "light");
        document.getElementById("theme-icon").textContent = "â˜€ï¸";
      }
    </script>
  </body>
</html>
