<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Schema 生成器 - WebUtils</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="JSON Schema 生成器 - WebUtils" />
  <meta name="keywords" content="json-schema-generator,dev,tools,webutils" />
  <meta name="author" content="WebUtils" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tools.realtime-ai.chat/tools/dev/json-schema-generator.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="JSON Schema 生成器 - WebUtils" />
  <meta property="og:description" content="JSON Schema 生成器 - WebUtils" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tools.realtime-ai.chat/tools/dev/json-schema-generator.html" />
  <meta property="og:site_name" content="WebUtils" />
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="640" />
  <meta property="og:image:type" content="image/png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="JSON Schema 生成器 - WebUtils" />
  <meta name="twitter:description" content="JSON Schema 生成器 - WebUtils" />
  <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-input: #0e0e14;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --border-strong: #3a3a4a;
      --accent-cyan: #00f5d4;
      --accent-green: #10b981;
      --accent-red: #f43f5e;
      --accent-yellow: #fbbf24;
      --accent-purple: #a855f7;
      --glow-cyan: rgb(0, 245, 212, 0.15);
      --glow-green: rgb(16, 185, 129, 0.15);
      --glow-red: rgb(244, 63, 94, 0.15);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    [data-theme="light"] {
      --bg-deep: #fafafa;
      --bg-surface: #fff;
      --bg-card: #fff;
      --bg-input: #f5f5f5;
      --bg-hover: #f5f5f5;
      --text-primary: #1a1a1a;
      --text-secondary: #666;
      --text-muted: #999;
      --border-subtle: #e5e5e5;
      --border-strong: #d5d5d5;
    }

        :root {
            --primary-color: #0ea5e9;
            --preview-bg: #f8fafc;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        [data-theme="dark"] {
            --preview-bg: #1e293b;
        }
        
        body {
            min-height: 100vh;
            padding: 2rem;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .header h1 {
            margin: 0;
            background: linear-gradient(135deg, #0ea5e9, #6366f1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .theme-toggle {
            cursor: pointer;
            background: none;
            border: 2px solid var(--pico-primary);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: transform 0.3s ease;
        }
        
        .theme-toggle:hover {
            transform: rotate(180deg);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: var(--pico-card-background-color);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .panel-header h3 {
            margin: 0;
        }
        
        .code-area {
            font-family: monospace;
            font-size: 0.875rem;
            min-height: 500px;
            resize: vertical;
        }
        
        .btn-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .btn-small {
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
        }
        
        .copy-btn.copied {
            background: #10b981;
            border-color: #10b981;
        }
        
        .error-message {
            color: #ef4444;
            padding: 0.75rem;
            background: #fef2f2;
            border-radius: 6px;
            margin-top: 0.5rem;
            font-size: 0.875rem;
        }
        
        [data-theme="dark"] .error-message {
            background: #450a0a;
        }
        
        .options-section {
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--preview-bg);
            border-radius: 8px;
        }
        
        .options-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        
        .option-item input[type="checkbox"] {
            margin: 0;
        }
        
        .preset-btns {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .preset-btn {
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        
        .stats {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            font-size: 0.8rem;
            color: var(--pico-muted-color);
        }
        
        .stat-item {
            background: var(--pico-secondary-background);
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
        }
        
        .stat-value {
            font-weight: 600;
            color: var(--pico-primary);
        }
    
        .breadcrumb {     background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">首页</a><span>›</span>JSON Schema 生成器</nav>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">← 返回首页</a>
        <header class="header">
            <h1>JSON Schema 生成器</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="切换主题">
                <span id="theme-icon"></span>
            </button>
        </header>
        
        <div class="options-section">
            <div class="options-title">生成选项</div>
            <div class="options-grid">
                <label class="option-item">
                    <input type="checkbox" id="opt-required" checked onchange="generateSchema()">
                    生成 required 字段
                </label>
                <label class="option-item">
                    <input type="checkbox" id="opt-additional" onchange="generateSchema()">
                    允许额外属性
                </label>
                <label class="option-item">
                    <input type="checkbox" id="opt-examples" checked onchange="generateSchema()">
                    包含示例值
                </label>
                <label class="option-item">
                    <input type="checkbox" id="opt-description" onchange="generateSchema()">
                    生成描述字段
                </label>
                <label class="option-item">
                    <input type="checkbox" id="opt-nullable" onchange="generateSchema()">
                    允许 null 值
                </label>
                <label class="option-item">
                    <input type="checkbox" id="opt-minmax" onchange="generateSchema()">
                    推断数值范围
                </label>
            </div>
        </div>
        
        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <h3>JSON 输入</h3>
                    <div class="btn-group">
                        <button class="btn-small" onclick="formatJson()">格式化</button>
                        <button class="btn-small" onclick="clearInput()">清空</button>
                    </div>
                </div>
                
                <div class="preset-btns">
                    <button class="preset-btn" onclick="loadExample('user')">用户对象</button>
                    <button class="preset-btn" onclick="loadExample('product')">商品</button>
                    <button class="preset-btn" onclick="loadExample('order')">订单</button>
                    <button class="preset-btn" onclick="loadExample('api')">API响应</button>
                </div>
                
                <textarea class="code-area" id="json-input" placeholder="输入 JSON 数据..." oninput="generateSchema()">{
  "id": 1,
  "name": "张三",
  "email": "zhangsan@example.com",
  "age": 28,
  "active": true,
  "roles": ["admin", "user"],
  "profile": {
    "avatar": "https://example.com/avatar.jpg",
    "bio": "软件工程师"
  },
  "createdAt": "2024-01-15T10:30:00Z"
}</textarea>
                
                <div id="input-error"></div>
                
                <div class="stats">
                    <span class="stat-item">字段数: <span class="stat-value" id="field-count">0</span></span>
                    <span class="stat-item">嵌套深度: <span class="stat-value" id="depth-count">0</span></span>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <h3>JSON Schema</h3>
                    <div class="btn-group">
                        <button class="btn-small copy-btn" onclick="copySchema()">复制</button>
                        <button class="btn-small" onclick="downloadSchema()">下载</button>
                    </div>
                </div>
                
                <textarea class="code-area" id="schema-output" readonly placeholder="生成的 JSON Schema 将显示在这里..."></textarea>
            </div>
        </div>
    </main>
    
    <script>
        // Theme management
        function initTheme() {
            var savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }
        
        window.toggleTheme = function() {
            var currentTheme = document.documentElement.getAttribute('data-theme');
            var newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        };
        
        function updateThemeIcon(theme) {
            document.getElementById('theme-icon').textContent = theme === 'light' ? '\u{1F319}' : '\u2600';
        }
        
        window.loadExample = function(type) {
            var examples = {
                'user': {
                    'id': 1,
                    'name': '张三',
                    'email': 'zhangsan@example.com',
                    'age': 28,
                    'active': true,
                    'roles': ['admin', 'user'],
                    'profile': {
                        'avatar': 'https://example.com/avatar.jpg',
                        'bio': '软件工程师'
                    },
                    'createdAt': '2024-01-15T10:30:00Z'
                },
                'product': {
                    'productId': 'P001',
                    'name': '智能手机',
                    'price': 2999.00,
                    'stock': 100,
                    'category': '电子产品',
                    'tags': ['手机', '智能', '热销'],
                    'specs': {
                        'screen': '6.5英寸',
                        'memory': '8GB',
                        'storage': '128GB'
                    },
                    'inStock': true
                },
                'order': {
                    'orderId': 'ORD20240115001',
                    'userId': 1001,
                    'items': [
                        {
                            'productId': 'P001',
                            'quantity': 2,
                            'price': 2999.00
                        }
                    ],
                    'total': 5998.00,
                    'status': 'pending',
                    'shippingAddress': {
                        'province': '广东省',
                        'city': '深圳市',
                        'detail': '南山区科技园'
                    },
                    'createdAt': '2024-01-15T10:30:00Z'
                },
                'api': {
                    'code': 200,
                    'message': 'success',
                    'data': {
                        'list': [
                            {'id': 1, 'title': '文章1'},
                            {'id': 2, 'title': '文章2'}
                        ],
                        'pagination': {
                            'page': 1,
                            'pageSize': 10,
                            'total': 100
                        }
                    },
                    'timestamp': 1705304400000
                }
            };
            
            if (examples[type]) {
                document.getElementById('json-input').value = JSON.stringify(examples[type], null, 2);
                generateSchema();
            }
        };
        
        window.formatJson = function() {
            var input = document.getElementById('json-input');
            var errorDiv = document.getElementById('input-error');
            
            try {
                var json = JSON.parse(input.value);
                input.value = JSON.stringify(json, null, 2);
                errorDiv.textContent = '';
            } catch (e) {
                errorDiv.innerHTML = '<div class="error-message">JSON 格式错误: ' + e.message + '</div>';
            }
        };
        
        window.clearInput = function() {
            document.getElementById('json-input').value = '';
            document.getElementById('schema-output').value = '';
            document.getElementById('input-error').textContent = '';
            document.getElementById('field-count').textContent = '0';
            document.getElementById('depth-count').textContent = '0';
        };
        
        window.generateSchema = function() {
            var input = document.getElementById('json-input').value;
            var output = document.getElementById('schema-output');
            var errorDiv = document.getElementById('input-error');
            
            if (!input.trim()) {
                output.value = '';
                errorDiv.textContent = '';
                return;
            }
            
            try {
                var json = JSON.parse(input);
                errorDiv.textContent = '';
                
                var options = {
                    required: document.getElementById('opt-required').checked,
                    additionalProperties: document.getElementById('opt-additional').checked,
                    examples: document.getElementById('opt-examples').checked,
                    description: document.getElementById('opt-description').checked,
                    nullable: document.getElementById('opt-nullable').checked,
                    minmax: document.getElementById('opt-minmax').checked
                };
                
                var stats = { fieldCount: 0, maxDepth: 0 };
                var schema = jsonToSchema(json, options, 0, stats);
                
                // Add schema metadata
                schema['$schema'] = 'https://json-schema.org/draft/2020-12/schema';
                schema['$id'] = 'https://example.com/schema.json';
                
                output.value = JSON.stringify(schema, null, 2);
                
                document.getElementById('field-count').textContent = stats.fieldCount;
                document.getElementById('depth-count').textContent = stats.maxDepth;
                
            } catch (e) {
                errorDiv.innerHTML = '<div class="error-message">JSON 格式错误: ' + e.message + '</div>';
                output.value = '';
            }
        };
        
        function jsonToSchema(value, options, depth, stats) {
            stats.maxDepth = Math.max(stats.maxDepth, depth);
            
            var type = getType(value);
            var schema = {};
            
            if (type === 'null') {
                schema.type = 'null';
            } else if (type === 'boolean') {
                schema.type = 'boolean';
                if (options.examples) schema.examples = [value];
            } else if (type === 'integer') {
                schema.type = 'integer';
                if (options.examples) schema.examples = [value];
                if (options.minmax) {
                    schema.minimum = 0;
                }
            } else if (type === 'number') {
                schema.type = 'number';
                if (options.examples) schema.examples = [value];
            } else if (type === 'string') {
                schema.type = 'string';
                if (options.examples) schema.examples = [value];
                
                // Detect string formats
                if (isDateTimeString(value)) {
                    schema.format = 'date-time';
                } else if (isDateString(value)) {
                    schema.format = 'date';
                } else if (isEmailString(value)) {
                    schema.format = 'email';
                } else if (isUriString(value)) {
                    schema.format = 'uri';
                }
            } else if (type === 'array') {
                schema.type = 'array';
                if (value.length > 0) {
                    // Analyze array items
                    var itemSchemas = value.map(function(item) {
                        return jsonToSchema(item, options, depth + 1, stats);
                    });
                    
                    // Check if all items have the same schema
                    if (areSchemasSimilar(itemSchemas)) {
                        schema.items = itemSchemas[0];
                    } else {
                        schema.items = { anyOf: uniqueSchemas(itemSchemas) };
                    }
                } else {
                    schema.items = {};
                }
                if (options.examples && value.length > 0) {
                    schema.examples = [value];
                }
            } else if (type === 'object') {
                schema.type = 'object';
                schema.properties = {};
                
                var keys = Object.keys(value);
                stats.fieldCount += keys.length;
                
                keys.forEach(function(key) {
                    schema.properties[key] = jsonToSchema(value[key], options, depth + 1, stats);
                    if (options.description) {
                        schema.properties[key].description = key + ' 字段';
                    }
                });
                
                if (options.required && keys.length > 0) {
                    schema.required = keys;
                }
                
                if (!options.additionalProperties) {
                    schema.additionalProperties = false;
                }
            }
            
            if (options.nullable && type !== 'null') {
                if (Array.isArray(schema.type)) {
                    schema.type.push('null');
                } else {
                    schema.type = [schema.type, 'null'];
                }
            }
            
            return schema;
        }
        
        function getType(value) {
            if (value === null) return 'null';
            if (Array.isArray(value)) return 'array';
            if (typeof value === 'boolean') return 'boolean';
            if (typeof value === 'number') {
                return Number.isInteger(value) ? 'integer' : 'number';
            }
            if (typeof value === 'string') return 'string';
            if (typeof value === 'object') return 'object';
            return 'unknown';
        }
        
        function isDateTimeString(str) {
            return /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(str);
        }
        
        function isDateString(str) {
            return /^\d{4}-\d{2}-\d{2}$/.test(str);
        }
        
        function isEmailString(str) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(str);
        }
        
        function isUriString(str) {
            return /^https?:\/\//.test(str);
        }
        
        function areSchemasSimilar(schemas) {
            if (schemas.length <= 1) return true;
            var first = JSON.stringify(schemas[0]);
            return schemas.every(function(s) {
                return JSON.stringify(s) === first;
            });
        }
        
        function uniqueSchemas(schemas) {
            var seen = {};
            return schemas.filter(function(s) {
                var key = JSON.stringify(s);
                if (seen[key]) return false;
                seen[key] = true;
                return true;
            });
        }
        
        window.copySchema = function() {
            var output = document.getElementById('schema-output');
            
            navigator.clipboard.writeText(output.value).then(function() {
                var btn = document.querySelector('.copy-btn');
                btn.textContent = '已复制!';
                btn.classList.add('copied');
                setTimeout(function() {
                    btn.textContent = '复制';
                    btn.classList.remove('copied');
                }, 2000);
            });
        };
        
        window.downloadSchema = function() {
            var output = document.getElementById('schema-output').value;
            if (!output) return;
            
            var blob = new Blob([output], { type: 'application/json' });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'schema.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        };
        
        // Initialize
        initTheme();
        generateSchema();
    </script>
</body>
</html>
