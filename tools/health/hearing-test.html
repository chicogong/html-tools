<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>å¬åŠ›æµ‹è¯• - WebUtils</title>

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="åœ¨çº¿å¬åŠ›æµ‹è¯•å·¥å…· - ä½¿ç”¨Web Audio APIç”Ÿæˆæµ‹è¯•éŸ³é¢‘ï¼Œæ”¯æŒå·¦è€³/å³è€³/åŒè€³æµ‹è¯•"
    />
    <meta name="keywords" content="å¬åŠ›æµ‹è¯• hearing test å¬åŠ›æ£€æŸ¥ audiogram é¢‘ç‡" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/health/hearing-test.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="å¬åŠ›æµ‹è¯• - WebUtils" />
    <meta
      property="og:description"
      content="åœ¨çº¿å¬åŠ›æµ‹è¯•å·¥å…· - ä½¿ç”¨Web Audio APIç”Ÿæˆæµ‹è¯•éŸ³é¢‘ï¼Œæ”¯æŒå·¦è€³/å³è€³/åŒè€³æµ‹è¯•"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/health/hearing-test.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="å¬åŠ›æµ‹è¯• - WebUtils" />
    <meta
      name="twitter:description"
      content="åœ¨çº¿å¬åŠ›æµ‹è¯•å·¥å…· - ä½¿ç”¨Web Audio APIç”Ÿæˆæµ‹è¯•éŸ³é¢‘ï¼Œæ”¯æŒå·¦è€³/å³è€³/åŒè€³æµ‹è¯•"
    />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <!-- JSON-LD BreadcrumbList Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "é¦–é¡µ",
            "item": "https://tools.realtime-ai.chat/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "å¥åº·å·¥å…·",
            "item": "https://tools.realtime-ai.chat/#health"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "å¬åŠ›æµ‹è¯•",
            "item": "https://tools.realtime-ai.chat/tools/health/hearing-test.html"
          }
        ]
      }
    </script>

    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ============================================
         Design System - CSS Variables
         ============================================ */
      :root {
        /* Dark Theme (Default) */
        --color-bg-base: #0a0a0f;
        --color-bg-elevated: #121218;
        --color-bg-surface: #1a1a22;
        --color-bg-subtle: #242430;
        --color-bg-input: #0e0e14;
        --color-text-primary: #f5f5f7;
        --color-text-secondary: #a1a1aa;
        --color-text-muted: #71717a;
        --color-border-default: rgba(255, 255, 255, 0.08);
        --color-border-subtle: rgba(255, 255, 255, 0.04);
        --color-border-strong: rgba(255, 255, 255, 0.12);
        --color-accent-primary: #00d4aa;
        --color-accent-secondary: #8b5cf6;
        --color-accent-tertiary: #3b82f6;
        --color-success: #22c55e;
        --color-warning: #f59e0b;
        --color-error: #ef4444;

        /* Glassmorphism */
        --glass-bg: rgba(26, 26, 34, 0.72);
        --glass-border: rgba(255, 255, 255, 0.08);
        --glass-blur: 24px;
        --glass-saturate: 180%;

        /* Shadows */
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.4);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
        --shadow-glow: 0 0 20px rgba(0, 212, 170, 0.15);

        /* Spacing */
        --space-1: 4px;
        --space-2: 8px;
        --space-3: 12px;
        --space-4: 16px;
        --space-5: 20px;
        --space-6: 24px;
        --space-8: 32px;

        /* Border Radius */
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 16px;
        --radius-xl: 24px;
        --radius-full: 9999px;

        /* Typography */
        --font-sans: "Inter", -apple-system, blinkmacsystemfont, "Segoe UI", sans-serif;
        --font-mono: "JetBrains Mono", "SF Mono", "Fira Code", monospace;

        /* Transitions */
        --transition-fast: 150ms ease;
        --transition-normal: 250ms ease;

        /* Layout */
        --nav-height: 56px;
        --container-max: 900px;
        --safe-area-top: env(safe-area-inset-top, 0px);
        --safe-area-bottom: env(safe-area-inset-bottom, 0px);
      }

      /* Light Theme */
      [data-theme="light"] {
        --color-bg-base: #f8fafc;
        --color-bg-elevated: #fff;
        --color-bg-surface: #fff;
        --color-bg-subtle: #f1f5f9;
        --color-bg-input: #f8fafc;
        --color-text-primary: #0f172a;
        --color-text-secondary: #475569;
        --color-text-muted: #94a3b8;
        --color-border-default: rgba(0, 0, 0, 0.08);
        --color-border-subtle: rgba(0, 0, 0, 0.04);
        --color-border-strong: rgba(0, 0, 0, 0.12);
        --color-accent-primary: #00b894;
        --glass-bg: rgba(255, 255, 255, 0.78);
        --glass-border: rgba(0, 0, 0, 0.06);
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);
        --shadow-glow: 0 0 20px rgba(0, 184, 148, 0.12);
      }

      /* ============================================
         Base Styles
         ============================================ */
      *,
      *::before,
      *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        font-size: 16px;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      body {
        font-family: var(--font-sans);
        background: var(--color-bg-base);
        color: var(--color-text-primary);
        min-height: 100vh;
        min-height: 100dvh;
        line-height: 1.5;
        transition:
          background-color var(--transition-normal),
          color var(--transition-normal);
      }

      /* Subtle background gradient */
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        background:
          radial-gradient(circle at 20% 20%, rgba(0, 212, 170, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.03) 0%, transparent 50%);
      }

      [data-theme="light"] body::before {
        background:
          radial-gradient(circle at 20% 20%, rgba(0, 184, 148, 0.05) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(124, 58, 237, 0.05) 0%, transparent 50%);
      }

      /* ============================================
         Navigation Bar
         ============================================ */
      .nav-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        height: calc(var(--nav-height) + var(--safe-area-top));
        padding-top: var(--safe-area-top);
        background: var(--glass-bg);
        backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur));
        -webkit-backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur));
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background var(--transition-normal);
      }

      .nav-content {
        width: 100%;
        max-width: var(--container-max);
        height: var(--nav-height);
        padding: 0 var(--space-6);
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        gap: var(--space-4);
      }

      /* Back Button */
      .nav-back {
        display: flex;
        align-items: center;
        gap: var(--space-1);
        color: var(--color-accent-primary);
        text-decoration: none;
        font-size: 0.9375rem;
        font-weight: 500;
        padding: var(--space-2) var(--space-1);
        margin-left: calc(var(--space-2) * -1);
        border-radius: var(--radius-sm);
        transition: all var(--transition-fast);
        justify-self: start;
      }

      .nav-back:hover {
        background: var(--color-border-subtle);
      }

      .nav-back-icon {
        width: 20px;
        height: 20px;
        stroke-width: 2.5;
      }

      .nav-back-text {
        display: inline;
      }

      /* Nav Title */
      .nav-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--color-text-primary);
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      /* Nav Actions */
      .nav-actions {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        justify-self: end;
      }

      /* Theme Toggle */
      .theme-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        border: none;
        border-radius: var(--radius-full);
        background: var(--color-bg-subtle);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--transition-fast);
      }

      .theme-toggle:hover {
        background: var(--color-border-strong);
        color: var(--color-text-primary);
        transform: scale(1.05);
      }

      .theme-toggle svg {
        width: 18px;
        height: 18px;
      }

      .theme-icon-dark,
      .theme-icon-light {
        display: none;
      }

      [data-theme="dark"] .theme-icon-light,
      :root:not([data-theme]) .theme-icon-light {
        display: block;
      }

      [data-theme="light"] .theme-icon-dark {
        display: block;
      }

      /* ============================================
         Main Content
         ============================================ */
      .main-content {
        position: relative;
        z-index: 1;
        min-height: 100vh;
        min-height: 100dvh;
        padding-top: calc(var(--nav-height) + var(--safe-area-top) + var(--space-6));
        padding-bottom: calc(var(--space-8) + var(--safe-area-bottom));
        padding-left: var(--space-6);
        padding-right: var(--space-6);
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .container {
        width: 100%;
        max-width: var(--container-max);
      }

      /* Breadcrumb Navigation */
      .breadcrumb {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        font-family: var(--font-mono);
        font-size: 0.875rem;
        padding: var(--space-3) var(--space-4);
        background: var(--glass-bg);
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-md);
        flex-wrap: wrap;
        margin-bottom: var(--space-5);
      }

      .breadcrumb a {
        color: var(--color-text-secondary);
        text-decoration: none;
        transition: color var(--transition-fast);
      }

      .breadcrumb a:hover {
        color: var(--color-accent-primary);
      }

      .breadcrumb-separator {
        color: var(--color-text-muted);
        user-select: none;
      }

      .breadcrumb-current {
        color: var(--color-text-primary);
        font-weight: 500;
      }

      /* Page Title */
      .page-title {
        font-size: 1.75rem;
        font-weight: 700;
        margin-bottom: var(--space-2);
        color: var(--color-text-primary);
      }

      .page-subtitle {
        font-size: 0.9375rem;
        color: var(--color-text-secondary);
        margin-bottom: var(--space-6);
      }

      /* ============================================
         Card Styles
         ============================================ */
      .card {
        background: var(--glass-bg);
        backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur));
        -webkit-backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur));
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        margin-bottom: var(--space-5);
        box-shadow: var(--shadow-md);
      }

      .card-title {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: var(--space-5);
        color: var(--color-text-primary);
      }

      /* ============================================
         Warning Box
         ============================================ */
      .warning {
        background: rgba(239, 68, 68, 0.08);
        border: 1px solid var(--color-error);
        border-radius: var(--radius-lg);
        padding: var(--space-5);
        margin-bottom: var(--space-5);
      }

      .warning-title {
        color: var(--color-error);
        font-weight: 600;
        margin-bottom: var(--space-2);
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }

      .warning-content {
        font-size: 0.9375rem;
        color: var(--color-text-secondary);
        line-height: 1.6;
      }

      .warning-content p {
        margin-bottom: var(--space-2);
      }

      .warning-content p:last-child {
        margin-bottom: 0;
      }

      /* ============================================
         Test Area Styles
         ============================================ */
      .test-area {
        min-height: 300px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--space-8);
      }

      .frequency-display {
        font-size: 3rem;
        font-weight: 700;
        color: var(--color-accent-primary);
        margin-bottom: var(--space-2);
        font-family: var(--font-mono);
      }

      .volume-display {
        font-size: 1.0625rem;
        color: var(--color-text-secondary);
        margin-bottom: var(--space-6);
        font-family: var(--font-mono);
      }

      .play-btn {
        width: 120px;
        height: 120px;
        border-radius: var(--radius-full);
        font-size: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: var(--space-6);
        border: 2px solid var(--color-accent-primary);
        background: transparent;
        cursor: pointer;
        transition: all var(--transition-normal);
        color: var(--color-accent-primary);
      }

      .play-btn:hover {
        background: var(--color-accent-primary);
        color: #fff;
        transform: scale(1.05);
      }

      .play-btn.playing {
        animation: pulse 0.6s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      .status-text {
        color: var(--color-text-secondary);
        margin-bottom: var(--space-4);
        font-size: 1rem;
      }

      /* ============================================
         Response Buttons
         ============================================ */
      .response-btns {
        display: flex;
        gap: var(--space-4);
        flex-wrap: wrap;
        justify-content: center;
      }

      .response-btns button {
        min-width: 120px;
        padding: var(--space-3) var(--space-6);
      }

      /* ============================================
         Progress Bar
         ============================================ */
      .progress {
        display: flex;
        gap: var(--space-1);
        margin-bottom: var(--space-5);
      }

      .progress-dot {
        flex: 1;
        height: 8px;
        background: var(--color-border-default);
        border-radius: var(--radius-full);
        transition: all var(--transition-fast);
      }

      .progress-dot.done {
        background: var(--color-success);
      }

      .progress-dot.failed {
        background: var(--color-error);
      }

      .progress-dot.current {
        background: var(--color-accent-primary);
        animation: blink 1s infinite;
      }

      @keyframes blink {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* ============================================
         Ear Selection
         ============================================ */
      .ear-select {
        display: flex;
        gap: var(--space-3);
        justify-content: center;
        margin-bottom: var(--space-5);
        flex-wrap: wrap;
      }

      .ear-btn {
        padding: var(--space-3) var(--space-6);
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-md);
        background: var(--color-bg-subtle);
        color: var(--color-text-primary);
        cursor: pointer;
        transition: all var(--transition-fast);
        font-weight: 500;
        font-family: var(--font-sans);
      }

      .ear-btn:hover {
        border-color: var(--color-accent-primary);
      }

      .ear-btn.active {
        border-color: var(--color-accent-primary);
        background: var(--color-accent-primary);
        color: #fff;
        box-shadow: var(--shadow-glow);
      }

      /* ============================================
         Instructions
         ============================================ */
      .instructions {
        padding: var(--space-5);
        background: var(--color-bg-subtle);
        border-radius: var(--radius-lg);
        margin-bottom: var(--space-5);
      }

      .instructions h3 {
        margin-bottom: var(--space-3);
        color: var(--color-text-primary);
        font-weight: 600;
      }

      .instructions ol {
        padding-left: var(--space-6);
      }

      .instructions li {
        margin-bottom: var(--space-2);
        color: var(--color-text-secondary);
        line-height: 1.6;
      }

      /* ============================================
         Results Styles
         ============================================ */
      .audiogram {
        width: 100%;
        max-width: 600px;
        margin: var(--space-5) auto;
      }

      .audiogram canvas {
        width: 100%;
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-lg);
        background: var(--color-bg-subtle);
      }

      .freq-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: var(--space-3);
        margin-top: var(--space-5);
      }

      .freq-item {
        padding: var(--space-4);
        background: var(--color-bg-subtle);
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-md);
        text-align: center;
      }

      .freq-item .hz {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--color-text-primary);
      }

      .freq-item .db {
        font-size: 0.875rem;
        color: var(--color-text-secondary);
        margin-top: var(--space-1);
        font-family: var(--font-mono);
      }

      .freq-item .status {
        margin-top: var(--space-2);
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius-sm);
        font-size: 0.75rem;
        font-weight: 500;
      }

      .freq-item .status.good {
        background: var(--color-success);
        color: white;
      }

      .freq-item .status.mild {
        background: var(--color-warning);
        color: white;
      }

      .freq-item .status.moderate {
        background: #f97316;
        color: white;
      }

      .freq-item .status.severe {
        background: var(--color-error);
        color: white;
      }

      /* ============================================
         Reference Chart
         ============================================ */
      .reference-chart {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: var(--space-3);
        margin-top: var(--space-4);
      }

      /* ============================================
         Note Box
         ============================================ */
      .note {
        margin-top: var(--space-5);
        padding: var(--space-4);
        background: var(--color-bg-subtle);
        border-left: 3px solid var(--color-accent-primary);
        border-radius: var(--radius-md);
        font-size: 0.875rem;
        color: var(--color-text-secondary);
        line-height: 1.6;
      }

      /* ============================================
         Buttons
         ============================================ */
      button {
        padding: var(--space-3) var(--space-4);
        font-size: 0.9375rem;
        font-weight: 500;
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-md);
        background: var(--color-bg-subtle);
        color: var(--color-text-primary);
        cursor: pointer;
        transition: all var(--transition-fast);
        font-family: var(--font-sans);
      }

      button:hover {
        border-color: var(--color-accent-primary);
        background: var(--color-bg-surface);
        transform: translateY(-1px);
      }

      button:active {
        transform: translateY(0);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      button.primary {
        background: var(--color-accent-primary);
        border-color: var(--color-accent-primary);
        color: #fff;
        font-weight: 600;
      }

      button.primary:hover {
        background: #00c299;
        border-color: #00c299;
        box-shadow: var(--shadow-glow);
      }

      button.success {
        background: var(--color-success);
        border-color: var(--color-success);
        color: #fff;
      }

      button.success:hover {
        background: #16a34a;
        border-color: #16a34a;
      }

      button.danger {
        background: var(--color-error);
        border-color: var(--color-error);
        color: #fff;
      }

      button.danger:hover {
        background: #dc2626;
        border-color: #dc2626;
      }

      /* ============================================
         Mobile Responsive
         ============================================ */
      @media (max-width: 480px) {
        :root {
          --nav-height: 52px;
        }

        .nav-content {
          padding: 0 var(--space-4);
        }

        .nav-back-text {
          display: none;
        }

        .main-content {
          padding-top: calc(var(--nav-height) + var(--safe-area-top) + var(--space-4));
          padding-left: var(--space-4);
          padding-right: var(--space-4);
        }

        .page-title {
          font-size: 1.375rem;
        }

        .frequency-display {
          font-size: 2rem;
        }

        .play-btn {
          width: 100px;
          height: 100px;
          font-size: 1.5rem;
        }

        .card {
          padding: var(--space-4);
        }

        .test-area {
          padding: var(--space-5);
        }

        .freq-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .ear-select {
          gap: var(--space-2);
        }

        .ear-btn {
          flex: 1;
          min-width: 0;
        }

        .response-btns {
          gap: var(--space-2);
        }

        .response-btns button {
          min-width: 100px;
          padding: var(--space-2) var(--space-4);
          font-size: 0.875rem;
        }

        .breadcrumb {
          font-size: 0.8125rem;
          padding: var(--space-2) var(--space-3);
        }

        .reference-chart {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      /* Tablet */
      @media (min-width: 768px) {
        .nav-back-text {
          display: inline;
        }
      }

      /* Desktop */
      @media (min-width: 1024px) {
        .main-content {
          padding-top: calc(var(--nav-height) + var(--safe-area-top) + var(--space-8));
        }
      }

      /* ============================================
         Accessibility
         ============================================ */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      :focus-visible {
        outline: 2px solid var(--color-accent-primary);
        outline-offset: 2px;
      }

      button:focus:not(:focus-visible),
      a:focus:not(:focus-visible) {
        outline: none;
      }
    </style>
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="nav-bar">
      <div class="nav-content">
        <a href="../../index.html" class="nav-back" aria-label="è¿”å›é¦–é¡µ">
          <svg
            class="nav-back-icon"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
          <span class="nav-back-text">é¦–é¡µ</span>
        </a>

        <h1 class="nav-title">å¬åŠ›æµ‹è¯•</h1>

        <div class="nav-actions">
          <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">
            <svg
              class="theme-icon-light"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
            <svg
              class="theme-icon-dark"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
          </button>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <!-- Breadcrumb Navigation -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
          <a href="../../index.html">é¦–é¡µ</a>
          <span class="breadcrumb-separator">/</span>
          <a href="../../index.html#health">å¥åº·å·¥å…·</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">å¬åŠ›æµ‹è¯•</span>
        </nav>

        <!-- Page Title -->
        <h2 class="page-title">å¬åŠ›æµ‹è¯•</h2>
        <p class="page-subtitle">åœ¨çº¿å¬åŠ›è‡ªæµ‹ï¼ˆè¯·ä½¿ç”¨è€³æœºä»¥è·å¾—å‡†ç¡®ç»“æœï¼‰</p>

        <!-- Warning Box -->
        <div class="warning">
          <div class="warning-title">ä½¿ç”¨æç¤º</div>
          <div class="warning-content">
            <p>1. è¯·åœ¨å®‰é™ç¯å¢ƒä¸­ä½¿ç”¨è€³æœºè¿›è¡Œæµ‹è¯•</p>
            <p>2. å°†è®¾å¤‡éŸ³é‡è°ƒè‡³ä¸­ç­‰æ°´å¹³ï¼ˆçº¦50%ï¼‰</p>
            <p>3. æœ¬æµ‹è¯•ä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šå¬åŠ›æ£€æŸ¥</p>
          </div>
        </div>

        <!-- Test Controls Card -->
        <div class="card">
          <h3 class="card-title">é€‰æ‹©æµ‹è¯•è€³æœµ</h3>
          <div class="ear-select">
            <button class="ear-btn active" data-ear="left" onclick="selectEar('left')">å·¦è€³</button>
            <button class="ear-btn" data-ear="right" onclick="selectEar('right')">å³è€³</button>
            <button class="ear-btn" data-ear="both" onclick="selectEar('both')">åŒè€³</button>
          </div>

          <div class="progress" id="progress"></div>

          <div class="test-area" id="testArea"></div>
        </div>

        <!-- Results Card -->
        <div class="card" id="resultsCard" style="display: none">
          <h3 class="card-title">æµ‹è¯•ç»“æœ</h3>
          <div class="audiogram">
            <canvas id="audiogramCanvas" width="600" height="300"></canvas>
          </div>
          <div class="freq-grid" id="freqResults"></div>
        </div>

        <!-- Reference Chart Card -->
        <div class="card">
          <h3 class="card-title">å¬åŠ›åˆ†çº§å‚è€ƒ</h3>
          <div class="reference-chart">
            <div class="freq-item">
              <div class="hz">æ­£å¸¸</div>
              <div class="db">0-25 dB</div>
              <div class="status good">è‰¯å¥½</div>
            </div>
            <div class="freq-item">
              <div class="hz">è½»åº¦æŸå¤±</div>
              <div class="db">26-40 dB</div>
              <div class="status mild">è½»åº¦</div>
            </div>
            <div class="freq-item">
              <div class="hz">ä¸­åº¦æŸå¤±</div>
              <div class="db">41-55 dB</div>
              <div class="status moderate">ä¸­åº¦</div>
            </div>
            <div class="freq-item">
              <div class="hz">é‡åº¦æŸå¤±</div>
              <div class="db">&gt;55 dB</div>
              <div class="status severe">é‡åº¦</div>
            </div>
          </div>
        </div>

        <!-- Note Box -->
        <div class="note">
          æœ¬å·¥å…·ä½¿ç”¨Web Audio
          APIç”Ÿæˆæµ‹è¯•éŸ³é¢‘ï¼Œç»“æœå—è®¾å¤‡ã€è€³æœºè´¨é‡å’Œç¯å¢ƒå™ªéŸ³å½±å“ã€‚å¦‚æœ‰å¬åŠ›é—®é¢˜ï¼Œè¯·åˆ°åŒ»é™¢è¿›è¡Œä¸“ä¸šçš„çº¯éŸ³å¬åŠ›æµ‹è¯•ã€‚
        </div>
      </div>
    </main>

    <script>
      // ============================================
      // Audio Context and State
      // ============================================
      var audioContext = null;
      var currentEar = "left";
      var testState = {
        running: false,
        currentFreqIndex: 0,
        currentVolume: 0,
        results: {}
      };

      var frequencies = [250, 500, 1000, 2000, 4000, 8000];
      var volumeLevels = [0.5, 0.3, 0.2, 0.1, 0.05, 0.02, 0.01, 0.005];
      var dbLevels = [10, 20, 30, 40, 50, 60, 70, 80];

      // ============================================
      // Ear Selection
      // ============================================
      function selectEar(ear) {
        currentEar = ear;
        document.querySelectorAll(".ear-btn").forEach(function (btn) {
          btn.classList.toggle("active", btn.dataset.ear === ear);
        });
      }

      // ============================================
      // Audio Initialization and Tone Generation
      // ============================================
      function initAudio() {
        if (!audioContext) {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }
        if (audioContext.state === "suspended") {
          audioContext.resume();
        }
      }

      function playTone(frequency, volume, duration) {
        duration = duration || 1;
        return new Promise(function (resolve) {
          initAudio();

          var oscillator = audioContext.createOscillator();
          var gainNode = audioContext.createGain();
          var panNode = audioContext.createStereoPanner();

          oscillator.type = "sine";
          oscillator.frequency.value = frequency;

          if (currentEar === "left") {
            panNode.pan.value = -1;
          } else if (currentEar === "right") {
            panNode.pan.value = 1;
          } else {
            panNode.pan.value = 0;
          }

          gainNode.gain.setValueAtTime(0, audioContext.currentTime);
          gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.1);
          gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + duration - 0.1);
          gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + duration);

          oscillator.connect(gainNode);
          gainNode.connect(panNode);
          panNode.connect(audioContext.destination);

          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + duration);

          setTimeout(resolve, duration * 1000);
        });
      }

      // ============================================
      // Test Flow
      // ============================================
      function startTest() {
        testState = {
          running: true,
          currentFreqIndex: 0,
          currentVolume: 0,
          results: {}
        };

        frequencies.forEach(function (f) {
          testState.results[f] = null;
        });

        renderProgress();
        runTest();
      }

      async function runTest() {
        var testArea = document.getElementById("testArea");

        while (testState.currentFreqIndex < frequencies.length && testState.running) {
          var freq = frequencies[testState.currentFreqIndex];
          testState.currentVolume = 0;

          var lastHeardVolume = -1;

          for (var volIndex = 0; volIndex < volumeLevels.length && testState.running; volIndex++) {
            testState.currentVolume = volIndex;
            renderProgress();

            renderPlayingState(testArea, freq, volIndex);

            await playTone(freq, volumeLevels[volIndex], 1);

            renderResponseState(testArea, freq, volIndex);

            var response = await waitForResponse();

            if (response) {
              lastHeardVolume = volIndex;
            } else {
              break;
            }
          }

          if (lastHeardVolume >= 0) {
            testState.results[freq] = dbLevels[lastHeardVolume];
          } else {
            testState.results[freq] = dbLevels[dbLevels.length - 1];
          }

          testState.currentFreqIndex++;
        }

        if (testState.running) {
          showResults();
        }
      }

      // ============================================
      // UI Rendering
      // ============================================
      function renderPlayingState(container, freq, volIndex) {
        container.textContent = "";

        var freqDiv = document.createElement("div");
        freqDiv.className = "frequency-display";
        freqDiv.textContent = freq + " Hz";

        var volDiv = document.createElement("div");
        volDiv.className = "volume-display";
        volDiv.textContent = "éŸ³é‡ç­‰çº§: " + (volIndex + 1) + "/" + volumeLevels.length;

        var playBtn = document.createElement("button");
        playBtn.className = "play-btn playing";
        playBtn.disabled = true;
        playBtn.textContent = "ğŸ”Š";

        var statusText = document.createElement("p");
        statusText.className = "status-text";
        statusText.textContent = "æ­£åœ¨æ’­æ”¾...";

        container.appendChild(freqDiv);
        container.appendChild(volDiv);
        container.appendChild(playBtn);
        container.appendChild(statusText);
      }

      function renderResponseState(container, freq, volIndex) {
        container.textContent = "";

        var freqDiv = document.createElement("div");
        freqDiv.className = "frequency-display";
        freqDiv.textContent = freq + " Hz";

        var volDiv = document.createElement("div");
        volDiv.className = "volume-display";
        volDiv.textContent = "éŸ³é‡ç­‰çº§: " + (volIndex + 1) + "/" + volumeLevels.length;

        var playBtn = document.createElement("button");
        playBtn.className = "play-btn";
        playBtn.textContent = "ğŸ”Š";
        playBtn.onclick = function () {
          playTone(freq, volumeLevels[volIndex], 1);
        };

        var statusText = document.createElement("p");
        statusText.className = "status-text";
        statusText.textContent = "æ‚¨èƒ½å¬åˆ°å£°éŸ³å—ï¼Ÿ";

        var btnContainer = document.createElement("div");
        btnContainer.className = "response-btns";

        var yesBtn = document.createElement("button");
        yesBtn.className = "success";
        yesBtn.textContent = "èƒ½å¬åˆ°";
        yesBtn.onclick = function () {
          respond(true);
        };

        var noBtn = document.createElement("button");
        noBtn.className = "danger";
        noBtn.textContent = "å¬ä¸åˆ°";
        noBtn.onclick = function () {
          respond(false);
        };

        btnContainer.appendChild(yesBtn);
        btnContainer.appendChild(noBtn);

        container.appendChild(freqDiv);
        container.appendChild(volDiv);
        container.appendChild(playBtn);
        container.appendChild(statusText);
        container.appendChild(btnContainer);
      }

      function renderProgress() {
        var container = document.getElementById("progress");
        container.textContent = "";

        frequencies.forEach(function (freq, index) {
          var dot = document.createElement("div");
          dot.className = "progress-dot";

          if (testState.results[freq] !== null && testState.results[freq] !== undefined) {
            dot.classList.add(testState.results[freq] <= 25 ? "done" : "failed");
          } else if (index === testState.currentFreqIndex) {
            dot.classList.add("current");
          }

          container.appendChild(dot);
        });
      }

      function showResults() {
        testState.running = false;

        var testArea = document.getElementById("testArea");
        testArea.textContent = "";

        var resultDiv = document.createElement("div");
        resultDiv.style.textAlign = "center";

        var title = document.createElement("h2");
        title.style.cssText = "margin-bottom: var(--space-4); color: var(--color-text-primary);";
        title.textContent = "æµ‹è¯•å®Œæˆï¼";

        var desc = document.createElement("p");
        desc.style.cssText = "color: var(--color-text-secondary); margin-bottom: var(--space-5);";
        desc.textContent = "æŸ¥çœ‹ä¸‹æ–¹çš„è¯¦ç»†ç»“æœ";

        var restartBtn = document.createElement("button");
        restartBtn.className = "primary";
        restartBtn.style.cssText =
          "margin-top: var(--space-5); padding: var(--space-4) var(--space-8);";
        restartBtn.textContent = "é‡æ–°æµ‹è¯•";
        restartBtn.onclick = startTest;

        resultDiv.appendChild(title);
        resultDiv.appendChild(desc);
        resultDiv.appendChild(restartBtn);
        testArea.appendChild(resultDiv);

        document.getElementById("resultsCard").style.display = "block";

        drawAudiogram();
        renderFreqResults();

        document.getElementById("resultsCard").scrollIntoView({ behavior: "smooth" });
      }

      // ============================================
      // Response Handling
      // ============================================
      var responseResolver = null;

      function waitForResponse() {
        return new Promise(function (resolve) {
          responseResolver = resolve;
          setTimeout(function () {
            if (responseResolver) {
              responseResolver(false);
              responseResolver = null;
            }
          }, 10000);
        });
      }

      function respond(heard) {
        if (responseResolver) {
          responseResolver(heard);
          responseResolver = null;
        }
      }

      // ============================================
      // Results Visualization
      // ============================================
      function drawAudiogram() {
        var canvas = document.getElementById("audiogramCanvas");
        var ctx = canvas.getContext("2d");
        var width = canvas.width;
        var height = canvas.height;

        ctx.clearRect(0, 0, width, height);

        var bgColor =
          getComputedStyle(document.documentElement).getPropertyValue("--color-bg-subtle").trim() ||
          "#f5f5f5";
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, width, height);

        var padding = 60;
        var graphWidth = width - padding * 2;
        var graphHeight = height - padding * 2;

        var borderColor =
          getComputedStyle(document.documentElement)
            .getPropertyValue("--color-border-default")
            .trim() || "#e0e0e0";
        ctx.strokeStyle = borderColor;
        ctx.lineWidth = 1;

        for (var db = 0; db <= 80; db += 20) {
          var y = padding + (db / 80) * graphHeight;
          ctx.beginPath();
          ctx.moveTo(padding, y);
          ctx.lineTo(width - padding, y);
          ctx.stroke();

          var textColor =
            getComputedStyle(document.documentElement)
              .getPropertyValue("--color-text-secondary")
              .trim() || "#666";
          ctx.fillStyle = textColor;
          ctx.font =
            "12px " + getComputedStyle(document.documentElement).getPropertyValue("--font-sans");
          ctx.textAlign = "right";
          ctx.fillText(db + " dB", padding - 10, y + 4);
        }

        frequencies.forEach(function (freq, index) {
          var x = padding + (index / (frequencies.length - 1)) * graphWidth;
          ctx.beginPath();
          ctx.moveTo(x, padding);
          ctx.lineTo(x, height - padding);
          ctx.stroke();

          var textColor =
            getComputedStyle(document.documentElement)
              .getPropertyValue("--color-text-secondary")
              .trim() || "#666";
          ctx.fillStyle = textColor;
          ctx.textAlign = "center";
          ctx.fillText(freq >= 1000 ? freq / 1000 + "k" : freq, x, height - padding + 20);
        });

        ctx.fillStyle = "rgba(34, 197, 94, 0.2)";
        ctx.fillRect(padding, padding, graphWidth, (25 / 80) * graphHeight);

        var accentColor =
          getComputedStyle(document.documentElement)
            .getPropertyValue("--color-accent-primary")
            .trim() || "#8b5cf6";
        ctx.strokeStyle = accentColor;
        ctx.lineWidth = 3;
        ctx.beginPath();

        frequencies.forEach(function (freq, index) {
          var x = padding + (index / (frequencies.length - 1)) * graphWidth;
          var dbVal = testState.results[freq] || 0;
          var y = padding + (dbVal / 80) * graphHeight;

          if (index === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        });
        ctx.stroke();

        frequencies.forEach(function (freq, index) {
          var x = padding + (index / (frequencies.length - 1)) * graphWidth;
          var dbVal = testState.results[freq] || 0;
          var y = padding + (dbVal / 80) * graphHeight;

          ctx.beginPath();
          ctx.arc(x, y, 6, 0, Math.PI * 2);
          ctx.fillStyle = dbVal <= 25 ? "#22c55e" : dbVal <= 40 ? "#f59e0b" : "#ef4444";
          ctx.fill();
        });

        var textColor =
          getComputedStyle(document.documentElement)
            .getPropertyValue("--color-text-primary")
            .trim() || "#333";
        ctx.fillStyle = textColor;
        ctx.font =
          "14px " + getComputedStyle(document.documentElement).getPropertyValue("--font-sans");
        ctx.textAlign = "center";
        ctx.fillText("é¢‘ç‡ (Hz)", width / 2, height - 10);
      }

      function renderFreqResults() {
        var container = document.getElementById("freqResults");
        container.textContent = "";

        frequencies.forEach(function (freq) {
          var db = testState.results[freq] || 0;
          var status, statusClass;

          if (db <= 25) {
            status = "æ­£å¸¸";
            statusClass = "good";
          } else if (db <= 40) {
            status = "è½»åº¦æŸå¤±";
            statusClass = "mild";
          } else if (db <= 55) {
            status = "ä¸­åº¦æŸå¤±";
            statusClass = "moderate";
          } else {
            status = "é‡åº¦æŸå¤±";
            statusClass = "severe";
          }

          var item = document.createElement("div");
          item.className = "freq-item";

          var hzDiv = document.createElement("div");
          hzDiv.className = "hz";
          hzDiv.textContent = freq >= 1000 ? freq / 1000 + " kHz" : freq + " Hz";

          var dbDiv = document.createElement("div");
          dbDiv.className = "db";
          dbDiv.textContent = db + " dB";

          var statusDiv = document.createElement("div");
          statusDiv.className = "status " + statusClass;
          statusDiv.textContent = status;

          item.appendChild(hzDiv);
          item.appendChild(dbDiv);
          item.appendChild(statusDiv);
          container.appendChild(item);
        });
      }

      function renderInitialTestArea() {
        var testArea = document.getElementById("testArea");
        testArea.textContent = "";

        var instructions = document.createElement("div");
        instructions.className = "instructions";

        var h3 = document.createElement("h3");
        h3.textContent = "æµ‹è¯•è¯´æ˜";
        instructions.appendChild(h3);

        var ol = document.createElement("ol");
        [
          "ç¡®ä¿æ‚¨åœ¨å®‰é™çš„ç¯å¢ƒä¸­",
          "æˆ´ä¸Šè€³æœºå¹¶å°†éŸ³é‡è°ƒè‡³èˆ’é€‚æ°´å¹³",
          'ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŒ‰é’®',
          'æ¯æ¬¡æ’­æ”¾å£°éŸ³åï¼Œå¦‚æœèƒ½å¬åˆ°è¯·ç‚¹å‡»"èƒ½å¬åˆ°"',
          'å¦‚æœå¬ä¸åˆ°ï¼Œç‚¹å‡»"å¬ä¸åˆ°"æˆ–ç­‰å¾…è‡ªåŠ¨è·³è¿‡'
        ].forEach(function (text) {
          var li = document.createElement("li");
          li.textContent = text;
          ol.appendChild(li);
        });
        instructions.appendChild(ol);
        testArea.appendChild(instructions);

        var startBtn = document.createElement("button");
        startBtn.className = "primary";
        startBtn.style.cssText =
          "margin-top: var(--space-5); padding: var(--space-4) var(--space-8); font-size: 1.0625rem;";
        startBtn.textContent = "å¼€å§‹æµ‹è¯•";
        startBtn.onclick = startTest;
        testArea.appendChild(startBtn);
      }

      // ============================================
      // Theme Management
      // ============================================
      function toggleTheme() {
        var html = document.documentElement;
        var currentTheme = html.getAttribute("data-theme") || "dark";
        var newTheme = currentTheme === "light" ? "dark" : "light";

        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      }

      function initTheme() {
        var savedTheme = localStorage.getItem("theme");
        var prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        var theme = savedTheme || (prefersDark ? "dark" : "light");

        document.documentElement.setAttribute("data-theme", theme);
      }

      // ============================================
      // Initialize
      // ============================================
      initTheme();
      renderProgress();
      renderInitialTestArea();
    </script>
  </body>
</html>
