<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ç„å‡†è®­ç»ƒ - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a24;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --accent: #ef4444;
            --border: #2a2a3a;
            --target-color: #ef4444;
        }
        [data-theme="light"] {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e5e5e5;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --border: #ddd;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #ef4444, #f87171, #fca5a5);
            padding: 12px 20px;
            text-align: center;
            position: relative;
        }
        .header h1 { font-size: 22px; color: #7f1d1d; margin-bottom: 2px; }
        .header p { font-size: 11px; opacity: 0.8; color: #7f1d1d; }
        .theme-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.3);
            border: none;
            padding: 5px 8px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }
        .stats-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        .stat-box {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            border: 1px solid var(--border);
        }
        .stat-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 3px;
        }
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--accent);
        }
        .stat-value.best { color: #fbbf24; }
        .game-settings {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        .setting-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .setting-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        .setting-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 11px;
            cursor: pointer;
        }
        .setting-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        .game-area {
            position: relative;
            width: 100%;
            height: 400px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 2px solid var(--border);
            overflow: hidden;
            cursor: crosshair;
            margin-bottom: 15px;
        }
        .game-area.playing {
            border-color: var(--accent);
        }
        .target {
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .target::before {
            content: '';
            position: absolute;
            width: 30%;
            height: 30%;
            background: white;
            border-radius: 50%;
        }
        .target::after {
            content: '';
            position: absolute;
            width: 10%;
            height: 10%;
            background: var(--target-color);
            border-radius: 50%;
        }
        .target:hover {
            transform: scale(1.05);
        }
        .target.hit {
            animation: hitEffect 0.2s;
        }
        @keyframes hitEffect {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }
        .start-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.7);
            z-index: 10;
        }
        .start-overlay.hidden { display: none; }
        .start-title {
            font-size: 24px;
            margin-bottom: 10px;
        }
        .start-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        .start-btn {
            padding: 15px 40px;
            border-radius: 10px;
            border: none;
            background: var(--accent);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .start-btn:hover {
            transform: scale(1.05);
        }
        .result-panel {
            text-align: center;
        }
        .result-score {
            font-size: 48px;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
        }
        .result-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            font-size: 14px;
        }
        .result-stat {
            text-align: center;
        }
        .result-stat .value {
            font-size: 20px;
            font-weight: bold;
            color: var(--text-primary);
        }
        .result-stat .label {
            color: var(--text-secondary);
            font-size: 12px;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        .progress-fill {
            height: 100%;
            background: var(--accent);
            transition: width 0.1s;
        }
        .info-box {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--border);
        }
        .info-box h3 {
            font-size: 14px;
            margin-bottom: 10px;
            color: var(--accent);
        }
        .info-box p {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .miss-indicator {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid #666;
            border-radius: 50%;
            pointer-events: none;
            animation: missEffect 0.5s forwards;
        }
        @keyframes missEffect {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        @media (max-width: 500px) {
            .stats-row { grid-template-columns: repeat(2, 1fr); }
            .game-area { height: 300px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¯ ç„å‡†è®­ç»ƒ</h1>
        <p>æå‡ä½ çš„ç„å‡†é€Ÿåº¦å’Œç²¾å‡†åº¦</p>
        <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
    </div>

    <div class="container">
        <div class="stats-row">
            <div class="stat-box">
                <div class="stat-label">å¾—åˆ†</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">å‘½ä¸­ç‡</div>
                <div class="stat-value" id="accuracy">100%</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">å¹³å‡ååº”</div>
                <div class="stat-value" id="avgTime">-- ms</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">æœ€ä½³çºªå½•</div>
                <div class="stat-value best" id="bestScore">0</div>
            </div>
        </div>

        <div class="game-settings">
            <div class="setting-group">
                <span class="setting-label">ç›®æ ‡æ•°é‡:</span>
                <button class="setting-btn active" data-targets="30">30</button>
                <button class="setting-btn" data-targets="50">50</button>
                <button class="setting-btn" data-targets="100">100</button>
            </div>
            <div class="setting-group">
                <span class="setting-label">ç›®æ ‡å¤§å°:</span>
                <button class="setting-btn" data-size="large">å¤§</button>
                <button class="setting-btn active" data-size="medium">ä¸­</button>
                <button class="setting-btn" data-size="small">å°</button>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="start-overlay" id="startOverlay">
                <div class="start-title">ğŸ¯ ç„å‡†è®­ç»ƒ</div>
                <div class="start-subtitle">å¿«é€Ÿç‚¹å‡»çº¢è‰²ç›®æ ‡</div>
                <button class="start-btn" onclick="startGame()">å¼€å§‹è®­ç»ƒ</button>
            </div>
        </div>

        <div class="info-box">
            <h3>è®­ç»ƒè¯´æ˜</h3>
            <p>
                å°½å¯èƒ½å¿«é€Ÿä¸”å‡†ç¡®åœ°ç‚¹å‡»å‡ºç°çš„çº¢è‰²ç›®æ ‡ã€‚<br>
                â€¢ ç‚¹å‡»ç›®æ ‡å¾—åˆ†ï¼Œç‚¹å‡»ç©ºç™½å¤„ä¼šé™ä½å‘½ä¸­ç‡<br>
                â€¢ ç›®æ ‡è¶Šå°ã€æ•°é‡è¶Šå¤šï¼ŒæŒ‘æˆ˜è¶Šå¤§<br>
                â€¢ è®­ç»ƒä½ çš„æ‰‹çœ¼åè°ƒèƒ½åŠ›å’Œååº”é€Ÿåº¦
            </p>
        </div>
    </div>

    <script>
        // æ¸¸æˆé…ç½®
        const SIZE_CONFIG = {
            large: { min: 60, max: 80 },
            medium: { min: 40, max: 60 },
            small: { min: 25, max: 40 }
        };

        // æ¸¸æˆçŠ¶æ€
        let isPlaying = false;
        let score = 0;
        let hits = 0;
        let misses = 0;
        let totalTargets = 30;
        let targetSize = 'medium';
        let targetsRemaining = 0;
        let reactionTimes = [];
        let targetSpawnTime = 0;
        let bestScore = 0;

        // DOM å…ƒç´ 
        const gameArea = document.getElementById('gameArea');
        const startOverlay = document.getElementById('startOverlay');
        const scoreEl = document.getElementById('score');
        const accuracyEl = document.getElementById('accuracy');
        const avgTimeEl = document.getElementById('avgTime');
        const bestScoreEl = document.getElementById('bestScore');
        const progressFill = document.getElementById('progressFill');

        // åˆå§‹åŒ–
        function init() {
            loadBestScore();
            initSettings();
            gameArea.addEventListener('click', handleMiss);
        }

        function initSettings() {
            document.querySelectorAll('.setting-btn[data-targets]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.setting-btn[data-targets]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    totalTargets = parseInt(btn.dataset.targets);
                });
            });

            document.querySelectorAll('.setting-btn[data-size]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.setting-btn[data-size]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    targetSize = btn.dataset.size;
                });
            });
        }

        function loadBestScore() {
            const saved = localStorage.getItem('aimTrainerBest');
            if (saved) {
                bestScore = parseInt(saved);
                bestScoreEl.textContent = bestScore;
            }
        }

        function saveBestScore() {
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('aimTrainerBest', bestScore);
                bestScoreEl.textContent = bestScore;
            }
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            isPlaying = true;
            score = 0;
            hits = 0;
            misses = 0;
            reactionTimes = [];
            targetsRemaining = totalTargets;
            
            startOverlay.classList.add('hidden');
            gameArea.classList.add('playing');
            updateDisplay();
            spawnTarget();
        }

        // ç”Ÿæˆç›®æ ‡
        function spawnTarget() {
            if (targetsRemaining <= 0) {
                endGame();
                return;
            }

            const config = SIZE_CONFIG[targetSize];
            const size = config.min + Math.random() * (config.max - config.min);
            
            const maxX = gameArea.clientWidth - size;
            const maxY = gameArea.clientHeight - size;
            const x = Math.random() * maxX;
            const y = Math.random() * maxY;

            const target = document.createElement('div');
            target.className = 'target';
            target.style.width = size + 'px';
            target.style.height = size + 'px';
            target.style.left = x + 'px';
            target.style.top = y + 'px';
            target.style.background = `radial-gradient(circle, var(--target-color) 0%, #b91c1c 100%)`;
            
            target.addEventListener('click', (e) => {
                e.stopPropagation();
                handleHit(target);
            });

            gameArea.appendChild(target);
            targetSpawnTime = performance.now();
        }

        // å‘½ä¸­ç›®æ ‡
        function handleHit(target) {
            if (!isPlaying) return;

            const reactionTime = Math.round(performance.now() - targetSpawnTime);
            reactionTimes.push(reactionTime);
            
            hits++;
            targetsRemaining--;
            
            // è®¡ç®—åˆ†æ•°ï¼ˆåŸºäºååº”æ—¶é—´å’Œç›®æ ‡å¤§å°ï¼‰
            const sizeBonus = targetSize === 'small' ? 3 : targetSize === 'medium' ? 2 : 1;
            const timeBonus = Math.max(0, 500 - reactionTime) / 10;
            score += Math.round(100 * sizeBonus + timeBonus);
            
            target.classList.add('hit');
            playSound(800 + Math.random() * 400, 0.1);
            
            setTimeout(() => {
                target.remove();
                if (isPlaying) spawnTarget();
            }, 200);
            
            updateDisplay();
        }

        // æœªå‘½ä¸­
        function handleMiss(e) {
            if (!isPlaying) return;
            if (e.target.classList.contains('target')) return;
            
            misses++;
            
            // æ˜¾ç¤ºæœªå‘½ä¸­æŒ‡ç¤º
            const rect = gameArea.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            const indicator = document.createElement('div');
            indicator.className = 'miss-indicator';
            indicator.style.left = (x - 10) + 'px';
            indicator.style.top = (y - 10) + 'px';
            gameArea.appendChild(indicator);
            
            setTimeout(() => indicator.remove(), 500);
            
            playSound(200, 0.1);
            updateDisplay();
        }

        // ç»“æŸæ¸¸æˆ
        function endGame() {
            isPlaying = false;
            gameArea.classList.remove('playing');
            
            saveBestScore();
            
            const accuracy = hits + misses > 0 ? Math.round(hits / (hits + misses) * 100) : 100;
            const avgTime = reactionTimes.length > 0 
                ? Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length)
                : 0;
            
            startOverlay.innerHTML = `
                <div class="result-panel">
                    <div class="start-title">è®­ç»ƒå®Œæˆ!</div>
                    <div class="result-score">${score}</div>
                    <div class="result-stats">
                        <div class="result-stat">
                            <div class="value">${accuracy}%</div>
                            <div class="label">å‘½ä¸­ç‡</div>
                        </div>
                        <div class="result-stat">
                            <div class="value">${avgTime}ms</div>
                            <div class="label">å¹³å‡ååº”</div>
                        </div>
                        <div class="result-stat">
                            <div class="value">${hits}/${totalTargets}</div>
                            <div class="label">å‘½ä¸­æ•°</div>
                        </div>
                    </div>
                    <button class="start-btn" onclick="resetGame()">å†æ¥ä¸€æ¬¡</button>
                </div>
            `;
            startOverlay.classList.remove('hidden');
            
            playSound(600, 0.1);
            setTimeout(() => playSound(800, 0.1), 100);
            setTimeout(() => playSound(1000, 0.1), 200);
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            startOverlay.innerHTML = `
                <div class="start-title">ğŸ¯ ç„å‡†è®­ç»ƒ</div>
                <div class="start-subtitle">å¿«é€Ÿç‚¹å‡»çº¢è‰²ç›®æ ‡</div>
                <button class="start-btn" onclick="startGame()">å¼€å§‹è®­ç»ƒ</button>
            `;
            startOverlay.classList.remove('hidden');
            
            // æ¸…é™¤æ®‹ç•™ç›®æ ‡
            document.querySelectorAll('.target').forEach(t => t.remove());
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            scoreEl.textContent = score;
            
            const accuracy = hits + misses > 0 ? Math.round(hits / (hits + misses) * 100) : 100;
            accuracyEl.textContent = accuracy + '%';
            
            if (reactionTimes.length > 0) {
                const avg = Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length);
                avgTimeEl.textContent = avg + 'ms';
            }
            
            const progress = ((totalTargets - targetsRemaining) / totalTargets) * 100;
            progressFill.style.width = progress + '%';
        }

        // æ’­æ”¾éŸ³æ•ˆ
        function playSound(freq, duration) {
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.frequency.value = freq;
                osc.type = 'sine';
                gain.gain.setValueAtTime(0.2, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + duration);
                osc.start();
                osc.stop(ctx.currentTime + duration);
            } catch (e) {}
        }

        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            const body = document.body;
            const btn = document.querySelector('.theme-toggle');
            if (body.getAttribute('data-theme') === 'light') {
                body.removeAttribute('data-theme');
                btn.textContent = 'ğŸŒ™';
                localStorage.setItem('theme', 'dark');
            } else {
                body.setAttribute('data-theme', 'light');
                btn.textContent = 'â˜€ï¸';
                localStorage.setItem('theme', 'light');
            }
        }

        // åˆå§‹åŒ–
        (function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.setAttribute('data-theme', 'light');
                document.querySelector('.theme-toggle').textContent = 'â˜€ï¸';
            }
            init();
        })();
    </script>
</body>
</html>
