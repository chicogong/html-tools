<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ„äº§æŠ˜æ—§è®¡ç®—å™¨ - WebUtils</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #14b8a6; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input, select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus, select:focus { outline: none; border-color: var(--accent); }
        .result-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .result-item { background: var(--bg); padding: 16px; border-radius: 8px; text-align: center; }
        .result-item .value { font-size: 1.4rem; font-weight: 700; color: var(--accent); }
        .result-item .label { font-size: 0.8rem; color: var(--text2); margin-top: 4px; }
        .table-container { max-height: 350px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th, td { padding: 10px; text-align: right; border-bottom: 1px solid var(--border); }
        th { background: var(--bg); position: sticky; top: 0; color: var(--text2); font-weight: 500; }
        td:first-child, th:first-child { text-align: left; }
        .method-info { background: var(--bg); padding: 12px; border-radius: 8px; margin-top: 16px; font-size: 0.85rem; color: var(--text2); }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">â† è¿”å›</a>
        <h1>ğŸ“‰ èµ„äº§æŠ˜æ—§è®¡ç®—å™¨</h1>
        <p class="subtitle">è®¡ç®—å›ºå®šèµ„äº§æŠ˜æ—§ï¼ˆç›´çº¿æ³•ã€åŒå€ä½™é¢é€’å‡æ³•ã€å¹´æ•°æ€»å’Œæ³•ï¼‰</p>
        
        <div class="grid">
            <div class="card">
                <div class="card-title">èµ„äº§ä¿¡æ¯</div>
                <div class="form-group">
                    <label>èµ„äº§åŸå€¼ (å…ƒ)</label>
                    <input type="number" id="assetCost" value="100000" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>æ®‹å€¼ (å…ƒ)</label>
                    <input type="number" id="salvageValue" value="5000" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>ä½¿ç”¨å¹´é™ (å¹´)</label>
                    <input type="number" id="usefulLife" value="5" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>æŠ˜æ—§æ–¹æ³•</label>
                    <select id="method" onchange="calculate()">
                        <option value="straight">ç›´çº¿æ³• (å¹³å‡å¹´é™æ³•)</option>
                        <option value="double">åŒå€ä½™é¢é€’å‡æ³•</option>
                        <option value="sum">å¹´æ•°æ€»å’Œæ³•</option>
                    </select>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">è®¡ç®—ç»“æœ</div>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="value" id="annualDepreciation">Â¥0</div>
                        <div class="label">å¹´æŠ˜æ—§é¢</div>
                    </div>
                    <div class="result-item">
                        <div class="value" id="monthlyDepreciation">Â¥0</div>
                        <div class="label">æœˆæŠ˜æ—§é¢</div>
                    </div>
                    <div class="result-item">
                        <div class="value" id="depreciationRate">0%</div>
                        <div class="label">æŠ˜æ—§ç‡</div>
                    </div>
                    <div class="result-item">
                        <div class="value" id="totalDepreciation">Â¥0</div>
                        <div class="label">ç´¯è®¡æŠ˜æ—§</div>
                    </div>
                </div>
                
                <div class="method-info" id="methodInfo"></div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">æŠ˜æ—§æ˜ç»†è¡¨</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>å¹´ä»½</th>
                            <th>å¹´åˆè´¦é¢ä»·å€¼</th>
                            <th>å¹´æŠ˜æ—§é¢</th>
                            <th>ç´¯è®¡æŠ˜æ—§</th>
                            <th>å¹´æœ«è´¦é¢ä»·å€¼</th>
                        </tr>
                    </thead>
                    <tbody id="depreciationTable"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        function calculate() {
            const cost = parseFloat(document.getElementById('assetCost').value) || 0;
            const salvage = parseFloat(document.getElementById('salvageValue').value) || 0;
            const life = parseInt(document.getElementById('usefulLife').value) || 1;
            const method = document.getElementById('method').value;
            
            const depreciableBase = cost - salvage;
            let schedule = [];
            let firstYearDepreciation = 0;
            let methodDescription = '';
            
            if (method === 'straight') {
                // ç›´çº¿æ³•
                const annualDep = depreciableBase / life;
                firstYearDepreciation = annualDep;
                methodDescription = 'ç›´çº¿æ³•ï¼šæ¯å¹´æŠ˜æ—§é¢ç›¸åŒï¼ŒæŠ˜æ—§é¢ = (åŸå€¼ - æ®‹å€¼) / ä½¿ç”¨å¹´é™';
                
                let bookValue = cost;
                let accumulated = 0;
                for (let year = 1; year <= life; year++) {
                    accumulated += annualDep;
                    schedule.push({
                        year,
                        beginValue: bookValue,
                        depreciation: annualDep,
                        accumulated,
                        endValue: bookValue - annualDep
                    });
                    bookValue -= annualDep;
                }
            } else if (method === 'double') {
                // åŒå€ä½™é¢é€’å‡æ³•
                const rate = 2 / life;
                methodDescription = 'åŒå€ä½™é¢é€’å‡æ³•ï¼šæŠ˜æ—§ç‡ = 2/ä½¿ç”¨å¹´é™ï¼Œæœ€åä¸¤å¹´æ”¹ç”¨ç›´çº¿æ³•ä½¿è´¦é¢ä»·å€¼ç­‰äºæ®‹å€¼';
                
                let bookValue = cost;
                let accumulated = 0;
                
                for (let year = 1; year <= life; year++) {
                    let depreciation;
                    
                    if (year <= life - 2) {
                        depreciation = bookValue * rate;
                    } else {
                        // æœ€åä¸¤å¹´ç”¨ç›´çº¿æ³•
                        depreciation = (bookValue - salvage) / (life - year + 1);
                    }
                    
                    depreciation = Math.max(0, Math.min(depreciation, bookValue - salvage));
                    
                    if (year === 1) firstYearDepreciation = depreciation;
                    
                    accumulated += depreciation;
                    schedule.push({
                        year,
                        beginValue: bookValue,
                        depreciation,
                        accumulated,
                        endValue: bookValue - depreciation
                    });
                    bookValue -= depreciation;
                }
            } else if (method === 'sum') {
                // å¹´æ•°æ€»å’Œæ³•
                const sumOfYears = (life * (life + 1)) / 2;
                methodDescription = 'å¹´æ•°æ€»å’Œæ³•ï¼šæŠ˜æ—§ç‡ = å‰©ä½™å¹´é™ / å¹´æ•°æ€»å’Œï¼Œå¹´æ•°æ€»å’Œ = n(n+1)/2 = ' + sumOfYears;
                
                let bookValue = cost;
                let accumulated = 0;
                
                for (let year = 1; year <= life; year++) {
                    const remainingYears = life - year + 1;
                    const depreciation = depreciableBase * (remainingYears / sumOfYears);
                    
                    if (year === 1) firstYearDepreciation = depreciation;
                    
                    accumulated += depreciation;
                    schedule.push({
                        year,
                        beginValue: bookValue,
                        depreciation,
                        accumulated,
                        endValue: bookValue - depreciation
                    });
                    bookValue -= depreciation;
                }
            }
            
            const fmt = (n) => 'Â¥' + n.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            
            document.getElementById('annualDepreciation').textContent = fmt(firstYearDepreciation) + (method !== 'straight' ? ' (é¦–å¹´)' : '');
            document.getElementById('monthlyDepreciation').textContent = fmt(firstYearDepreciation / 12);
            document.getElementById('depreciationRate').textContent = ((firstYearDepreciation / cost) * 100).toFixed(2) + '%';
            document.getElementById('totalDepreciation').textContent = fmt(depreciableBase);
            document.getElementById('methodInfo').textContent = methodDescription;
            
            // æ¸²æŸ“è¡¨æ ¼
            const tbody = document.getElementById('depreciationTable');
            tbody.textContent = '';
            
            schedule.forEach(row => {
                const tr = document.createElement('tr');
                [
                    'ç¬¬' + row.year + 'å¹´',
                    fmt(row.beginValue),
                    fmt(row.depreciation),
                    fmt(row.accumulated),
                    fmt(row.endValue)
                ].forEach(text => {
                    const td = document.createElement('td');
                    td.textContent = text;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
        }
        
        calculate();
    </script>
</body>
</html>
