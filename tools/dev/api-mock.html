<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API MockæœåŠ¡ - WebUtils</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg-primary: #0a0a0f; --bg-secondary: #12121a; --bg-tertiary: #1a1a25; --text-primary: #fff; --text-secondary: #88a; --accent: #6366f1; --border: #2a2a3a; --success: #22c55e; --warning: #f59e0b; --danger: #ef4444; }
        [data-theme="light"] { --bg-primary: #f8fafc; --bg-secondary: #fff; --bg-tertiary: #f1f5f9; --text-primary: #1e293b; --text-secondary: #64748b; --border: #e2e8f0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }
        .header { background: linear-gradient(135deg, #f59e0b, #d97706); padding: 2rem; text-align: center; }
        .header h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .nav { display: flex; justify-content: space-between; max-width: 1200px; margin: 0 auto 1rem; }
        .back-link { color: rgba(255,255,255,0.9); text-decoration: none; }
        .theme-toggle { background: rgba(255,255,255,0.2); border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; color: white; cursor: pointer; }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; }
        .form-row { display: grid; grid-template-columns: 120px 1fr 100px; gap: 1rem; align-items: center; margin-bottom: 1rem; }
        @media (max-width: 768px) { .form-row { grid-template-columns: 1fr; } }
        select, input, textarea { width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); font-family: inherit; }
        textarea { min-height: 200px; font-family: Monaco, Menlo, monospace; font-size: 0.9rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; cursor: pointer; font-size: 1rem; transition: all 0.2s; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .method-select { width: 120px; }
        .method-GET { background: #22c55e20; color: #22c55e; }
        .method-POST { background: #3b82f620; color: #3b82f6; }
        .method-PUT { background: #f59e0b20; color: #f59e0b; }
        .method-DELETE { background: #ef444420; color: #ef4444; }
        .status-input { width: 100px; }
        .mock-list { margin-top: 1rem; }
        .mock-item { display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem; }
        .mock-item .method { padding: 0.25rem 0.75rem; border-radius: 0.25rem; font-size: 0.85rem; font-weight: 600; }
        .mock-item .path { flex: 1; font-family: monospace; }
        .mock-item .status { color: var(--text-secondary); font-size: 0.85rem; }
        .tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
        .tab { padding: 0.5rem 1rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--bg-tertiary); color: var(--text-secondary); cursor: pointer; }
        .tab.active { background: var(--accent); color: white; border-color: var(--accent); }
        .response-preview { background: var(--bg-tertiary); border-radius: 0.5rem; padding: 1rem; font-family: monospace; font-size: 0.9rem; max-height: 300px; overflow: auto; }
        .template-btns { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem; }
        .template-btn { padding: 0.5rem 0.75rem; border: 1px solid var(--border); border-radius: 0.25rem; background: var(--bg-tertiary); color: var(--text-primary); cursor: pointer; font-size: 0.85rem; }
        .template-btn:hover { border-color: var(--accent); }
        .toast { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%); background: var(--success); color: white; padding: 0.75rem 1.5rem; border-radius: 0.5rem; opacity: 0; transition: opacity 0.3s; }
        .toast.show { opacity: 1; }
        .help-text { font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.5rem; }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#dev">å¼€å‘å·¥å…·</a><span>â€º</span>API å“åº”æ¨¡æ‹Ÿå™¨</nav>
    <div class="header">
        <div class="nav">
            <a href="../../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
        </div>
        <h1>ğŸ­ API MockæœåŠ¡</h1>
        <p>å¿«é€Ÿç”Ÿæˆæ¨¡æ‹ŸAPIå“åº”æ•°æ®</p>
    </div>
    <div class="container">
        <div class="card">
            <h3 style="margin-bottom: 1rem;">åˆ›å»ºMockæ¥å£</h3>
            
            <div class="form-row">
                <select id="method" class="method-select">
                    <option value="GET">GET</option>
                    <option value="POST">POST</option>
                    <option value="PUT">PUT</option>
                    <option value="DELETE">DELETE</option>
                    <option value="PATCH">PATCH</option>
                </select>
                <input type="text" id="path" placeholder="/api/users">
                <input type="number" id="status" class="status-input" value="200" placeholder="çŠ¶æ€ç ">
            </div>
            
            <div class="tabs">
                <button class="tab active" data-tab="body" onclick="switchTab('body')">å“åº”ä½“</button>
                <button class="tab" data-tab="headers" onclick="switchTab('headers')">å“åº”å¤´</button>
            </div>
            
            <div id="bodyTab">
                <div class="template-btns">
                    <span style="color: var(--text-secondary); margin-right: 0.5rem;">æ¨¡æ¿:</span>
                    <button class="template-btn" onclick="useTemplate('user')">ç”¨æˆ·æ•°æ®</button>
                    <button class="template-btn" onclick="useTemplate('list')">åˆ—è¡¨æ•°æ®</button>
                    <button class="template-btn" onclick="useTemplate('pagination')">åˆ†é¡µæ•°æ®</button>
                    <button class="template-btn" onclick="useTemplate('error')">é”™è¯¯å“åº”</button>
                    <button class="template-btn" onclick="useTemplate('success')">æˆåŠŸå“åº”</button>
                </div>
                <textarea id="responseBody" placeholder="è¾“å…¥JSONå“åº”ä½“...">{
  "id": 1,
  "name": "å¼ ä¸‰",
  "email": "zhangsan@example.com",
  "avatar": "https://api.dicebear.com/7.x/avataaars/svg?seed=1",
  "createdAt": "2024-01-01T00:00:00Z"
}</textarea>
            </div>
            
            <div id="headersTab" style="display: none;">
                <textarea id="responseHeaders" placeholder="è¾“å…¥å“åº”å¤´ (æ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: Header-Name: value)">Content-Type: application/json
X-Request-Id: {{uuid}}
X-Response-Time: {{random:10-100}}ms</textarea>
                <p class="help-text">æ”¯æŒå˜é‡: {{uuid}}, {{timestamp}}, {{random:min-max}}, {{date}}</p>
            </div>
            
            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                <button class="btn btn-primary" onclick="addMock()">â• æ·»åŠ Mock</button>
                <button class="btn btn-secondary" onclick="formatJson()">æ ¼å¼åŒ–JSON</button>
            </div>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 1rem;">Mockæ¥å£åˆ—è¡¨</h3>
            <div class="mock-list" id="mockList">
                <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">æš‚æ— Mockæ¥å£ï¼Œè¯·æ·»åŠ </p>
            </div>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 1rem;">å¯¼å‡ºé…ç½®</h3>
            <div class="template-btns">
                <button class="btn btn-secondary" onclick="exportConfig('json')">å¯¼å‡ºJSON</button>
                <button class="btn btn-secondary" onclick="exportConfig('postman')">å¯¼å‡ºPostmané›†åˆ</button>
                <button class="btn btn-secondary" onclick="importConfig()">å¯¼å…¥é…ç½®</button>
            </div>
            <input type="file" id="importFile" style="display: none;" accept=".json" onchange="handleImport(this.files[0])">
        </div>
    </div>
    
    <div class="toast" id="toast">æ“ä½œæˆåŠŸ</div>
    
    <script>
        let mocks = [];
        
        const templates = {
            user: {
                id: 1,
                name: 'å¼ ä¸‰',
                email: 'zhangsan@example.com',
                avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=1',
                role: 'user',
                createdAt: '{{date}}'
            },
            list: {
                data: [
                    { id: 1, name: 'é¡¹ç›®A', status: 'active' },
                    { id: 2, name: 'é¡¹ç›®B', status: 'pending' },
                    { id: 3, name: 'é¡¹ç›®C', status: 'completed' }
                ],
                total: 3
            },
            pagination: {
                data: [],
                pagination: {
                    page: 1,
                    pageSize: 10,
                    total: 100,
                    totalPages: 10
                }
            },
            error: {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'è¯·æ±‚å‚æ•°é”™è¯¯',
                    details: []
                }
            },
            success: {
                success: true,
                message: 'æ“ä½œæˆåŠŸ',
                data: null
            }
        };
        
        window.switchTab = function(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            document.getElementById('bodyTab').style.display = tab === 'body' ? 'block' : 'none';
            document.getElementById('headersTab').style.display = tab === 'headers' ? 'block' : 'none';
        };
        
        window.useTemplate = function(name) {
            const template = templates[name];
            document.getElementById('responseBody').value = JSON.stringify(template, null, 2);
        };
        
        window.formatJson = function() {
            try {
                const body = document.getElementById('responseBody').value;
                const parsed = JSON.parse(body);
                document.getElementById('responseBody').value = JSON.stringify(parsed, null, 2);
            } catch (e) {
                alert('JSONæ ¼å¼é”™è¯¯: ' + e.message);
            }
        };
        
        window.addMock = function() {
            const method = document.getElementById('method').value;
            const path = document.getElementById('path').value.trim();
            const status = parseInt(document.getElementById('status').value) || 200;
            const body = document.getElementById('responseBody').value;
            const headers = document.getElementById('responseHeaders').value;
            
            if (!path) {
                alert('è¯·è¾“å…¥æ¥å£è·¯å¾„');
                return;
            }
            
            try {
                JSON.parse(body);
            } catch (e) {
                alert('å“åº”ä½“ä¸æ˜¯æœ‰æ•ˆçš„JSON: ' + e.message);
                return;
            }
            
            mocks.push({ method, path, status, body, headers, id: Date.now() });
            renderMockList();
            showToast('Mockæ¥å£å·²æ·»åŠ ');
        };
        
        function renderMockList() {
            const list = document.getElementById('mockList');
            
            if (mocks.length === 0) {
                list.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 2rem;">æš‚æ— Mockæ¥å£ï¼Œè¯·æ·»åŠ </p>';
                return;
            }
            
            list.innerHTML = mocks.map(mock => `
                <div class="mock-item">
                    <span class="method method-${mock.method}">${mock.method}</span>
                    <span class="path">${mock.path}</span>
                    <span class="status">${mock.status}</span>
                    <button class="btn btn-secondary" style="padding: 0.25rem 0.5rem;" onclick="editMock(${mock.id})">ç¼–è¾‘</button>
                    <button class="btn btn-danger" style="padding: 0.25rem 0.5rem;" onclick="deleteMock(${mock.id})">åˆ é™¤</button>
                </div>
            `).join('');
        }
        
        window.editMock = function(id) {
            const mock = mocks.find(m => m.id === id);
            if (!mock) return;
            
            document.getElementById('method').value = mock.method;
            document.getElementById('path').value = mock.path;
            document.getElementById('status').value = mock.status;
            document.getElementById('responseBody').value = mock.body;
            document.getElementById('responseHeaders').value = mock.headers;
            
            deleteMock(id);
        };
        
        function deleteMock(id) {
            mocks = mocks.filter(m => m.id !== id);
            renderMockList();
        }
        
        window.exportConfig = function(format) {
            if (mocks.length === 0) {
                alert('æ²¡æœ‰å¯å¯¼å‡ºçš„Mockæ¥å£');
                return;
            }
            
            let content, filename;
            
            if (format === 'json') {
                content = JSON.stringify(mocks, null, 2);
                filename = 'mock-config.json';
            } else if (format === 'postman') {
                const collection = {
                    info: {
                        name: 'Mock API Collection',
                        schema: 'https://schema.getpostman.com/json/collection/v2.1.0/collection.json'
                    },
                    item: mocks.map(mock => ({
                        name: `${mock.method} ${mock.path}`,
                        request: {
                            method: mock.method,
                            url: { raw: '{{baseUrl}}' + mock.path },
                            header: []
                        },
                        response: [{
                            name: 'Mock Response',
                            status: mock.status === 200 ? 'OK' : 'Error',
                            code: mock.status,
                            body: mock.body
                        }]
                    }))
                };
                content = JSON.stringify(collection, null, 2);
                filename = 'postman-collection.json';
            }
            
            const blob = new Blob([content], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
        };
        
        window.importConfig = function() {
            document.getElementById('importFile').click();
        };
        
        window.handleImport = function(file) {
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (Array.isArray(imported)) {
                        mocks = [...mocks, ...imported.map(m => ({ ...m, id: Date.now() + Math.random() }))];
                        renderMockList();
                        showToast('å¯¼å…¥æˆåŠŸ');
                    } else {
                        alert('æ— æ•ˆçš„é…ç½®æ–‡ä»¶æ ¼å¼');
                    }
                } catch (e) {
                    alert('è§£ææ–‡ä»¶å¤±è´¥: ' + e.message);
                }
            };
            reader.readAsText(file);
        };
        
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }
        
        window.toggleTheme = function() {
            const t = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', t);
            localStorage.setItem('theme', t);
        };
        document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'dark');
    </script>
</body>
</html>
