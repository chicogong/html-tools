<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>工时计算器 - WebUtils</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-input: #0e0e14;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --accent-cyan: #00f5d4;
      --accent-blue: #4cc9f0;
      --accent-green: #10b981;
      --accent-red: #f43f5e;
      --accent-yellow: #fbbf24;
      --glow-cyan: rgb(0, 245, 212, 0.15);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Space Grotesk', system-ui, sans-serif;
      background: var(--bg-deep);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
    }

    .bg-grid {
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgb(0, 245, 212, 0.02) 1px, transparent 1px),
        linear-gradient(90deg, rgb(0, 245, 212, 0.02) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 900px;
      margin: 0 auto;
      padding: 24px;
      min-height: 100vh;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-secondary);
      text-decoration: none;
      padding: 8px 14px;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      transition: all 0.2s ease;
      margin-bottom: 24px;
    }

    .back-link:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    h1 {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 24px;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 20px;
    }

    .card-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }

    .time-entry {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .time-entry label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
      min-width: 60px;
    }

    input[type="time"],
    input[type="number"] {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.95rem;
      padding: 10px 14px;
      background: var(--bg-input);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
    }

    input[type="number"] {
      width: 100px;
    }

    input:focus {
      outline: none;
      border-color: var(--accent-cyan);
    }

    .result-display {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 20px;
      margin-top: 20px;
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid var(--border-subtle);
    }

    .result-row:last-child {
      border-bottom: none;
    }

    .result-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .result-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      font-weight: 600;
      color: var(--accent-cyan);
    }

    .result-value.warning {
      color: var(--accent-yellow);
    }

    .result-value.danger {
      color: var(--accent-red);
    }

    .result-value.success {
      color: var(--accent-green);
    }

    .summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
      margin-top: 20px;
    }

    .summary-card {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 16px;
      text-align: center;
    }

    .summary-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--accent-cyan);
    }

    .summary-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .presets {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }

    .preset-btn {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      padding: 8px 14px;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    .preset-btn:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    .preset-btn.active {
      background: var(--accent-cyan);
      border-color: var(--accent-cyan);
      color: var(--bg-deep);
    }

    .actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    button {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      padding: 10px 20px;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    button.primary {
      background: var(--accent-cyan);
      border-color: var(--accent-cyan);
      color: var(--bg-deep);
      font-weight: 600;
    }

    button.primary:hover {
      background: var(--accent-blue);
      border-color: var(--accent-blue);
    }

    .overtime-warning {
      background: rgba(251, 191, 36, 0.1);
      border: 1px solid var(--accent-yellow);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      margin-top: 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--accent-yellow);
    }

    footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 16px;
      border-top: 1px solid var(--border-subtle);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    footer a {
      color: var(--accent-cyan);
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>

  <div class="container">
    <a href="../../index.html" class="back-link">← 返回</a>

    <h1>工时计算器</h1>
    <p class="desc">计算每日工作时长、加班时间和薪资估算</p>

    <div class="card">
      <div class="card-title">工作时间预设</div>
      <div class="presets">
        <button class="preset-btn" data-start="09:00" data-end="18:00" data-break="60">标准 9-18</button>
        <button class="preset-btn" data-start="09:00" data-end="21:00" data-break="60">996 9-21</button>
        <button class="preset-btn" data-start="10:00" data-end="19:00" data-break="60">弹性 10-19</button>
        <button class="preset-btn" data-start="08:30" data-end="17:30" data-break="60">朝九晚五半</button>
      </div>

      <div class="time-entry">
        <label>上班时间</label>
        <input type="time" id="startTime" value="09:00">
      </div>

      <div class="time-entry">
        <label>下班时间</label>
        <input type="time" id="endTime" value="18:00">
      </div>

      <div class="time-entry">
        <label>午休时长</label>
        <input type="number" id="breakTime" value="60" min="0" max="180" step="15">
        <span style="color: var(--text-muted); font-size: 0.85rem;">分钟</span>
      </div>

      <div class="result-display">
        <div class="result-row">
          <span class="result-label">总工作时长</span>
          <span class="result-value" id="totalHours">8 小时 0 分钟</span>
        </div>
        <div class="result-row">
          <span class="result-label">净工作时长（扣除午休）</span>
          <span class="result-value" id="netHours">7 小时 0 分钟</span>
        </div>
        <div class="result-row">
          <span class="result-label">加班时长（超过 8 小时）</span>
          <span class="result-value" id="overtimeHours">0 小时 0 分钟</span>
        </div>
      </div>

      <div id="overtimeWarning" class="overtime-warning" style="display: none;"></div>
    </div>

    <div class="card">
      <div class="card-title">薪资估算（可选）</div>
      
      <div class="time-entry">
        <label>月薪</label>
        <input type="number" id="monthlySalary" value="10000" min="0" step="100">
        <span style="color: var(--text-muted); font-size: 0.85rem;">元</span>
      </div>

      <div class="time-entry">
        <label>每月工作日</label>
        <input type="number" id="workDays" value="22" min="1" max="31">
        <span style="color: var(--text-muted); font-size: 0.85rem;">天</span>
      </div>

      <div class="time-entry">
        <label>加班工资倍率</label>
        <input type="number" id="overtimeRate" value="1.5" min="1" max="3" step="0.5">
        <span style="color: var(--text-muted); font-size: 0.85rem;">倍</span>
      </div>

      <div class="summary">
        <div class="summary-card">
          <div class="summary-value" id="dailySalary">¥454.55</div>
          <div class="summary-label">日薪</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="hourlySalary">¥56.82</div>
          <div class="summary-label">时薪</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="overtimePay">¥0</div>
          <div class="summary-label">加班费（当日）</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="totalDailyPay">¥454.55</div>
          <div class="summary-label">当日总收入</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">每周/每月统计</div>
      
      <div class="time-entry">
        <label>每周工作天数</label>
        <input type="number" id="weekDays" value="5" min="1" max="7">
        <span style="color: var(--text-muted); font-size: 0.85rem;">天</span>
      </div>

      <div class="summary">
        <div class="summary-card">
          <div class="summary-value" id="weeklyHours">35 h</div>
          <div class="summary-label">每周工时</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="monthlyHours">154 h</div>
          <div class="summary-label">每月工时</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="weeklyOvertime">0 h</div>
          <div class="summary-label">每周加班</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="monthlyOvertime">0 h</div>
          <div class="summary-label">每月加班</div>
        </div>
      </div>
    </div>

    <footer>
      <a href="https://github.com/chicogong/html-tools" target="_blank">GitHub</a> ·
      纯前端 · 无服务器 ·
      <a href="../../index.html">WebUtils</a>
    </footer>
  </div>

  <script>
    var startTimeEl = document.getElementById('startTime');
    var endTimeEl = document.getElementById('endTime');
    var breakTimeEl = document.getElementById('breakTime');
    var monthlySalaryEl = document.getElementById('monthlySalary');
    var workDaysEl = document.getElementById('workDays');
    var overtimeRateEl = document.getElementById('overtimeRate');
    var weekDaysEl = document.getElementById('weekDays');
    var LS_KEY = 'work_hours_v1';

    var STANDARD_HOURS = 8;

    function timeToMinutes(timeStr) {
      var parts = timeStr.split(':');
      return parseInt(parts[0]) * 60 + parseInt(parts[1]);
    }

    function formatDuration(minutes) {
      var h = Math.floor(Math.abs(minutes) / 60);
      var m = Math.abs(minutes) % 60;
      return h + ' 小时 ' + m + ' 分钟';
    }

    function formatHours(minutes) {
      return (minutes / 60).toFixed(1) + ' h';
    }

    function calculate() {
      var startMinutes = timeToMinutes(startTimeEl.value);
      var endMinutes = timeToMinutes(endTimeEl.value);
      var breakMinutes = parseInt(breakTimeEl.value) || 0;

      // Handle overnight shifts
      if (endMinutes < startMinutes) {
        endMinutes += 24 * 60;
      }

      var totalMinutes = endMinutes - startMinutes;
      var netMinutes = totalMinutes - breakMinutes;
      var overtimeMinutes = Math.max(0, netMinutes - STANDARD_HOURS * 60);

      // Display results
      document.getElementById('totalHours').textContent = formatDuration(totalMinutes);
      document.getElementById('netHours').textContent = formatDuration(netMinutes);
      
      var overtimeEl = document.getElementById('overtimeHours');
      overtimeEl.textContent = formatDuration(overtimeMinutes);
      overtimeEl.className = 'result-value' + (overtimeMinutes > 0 ? ' warning' : '');

      // Overtime warning
      var warningEl = document.getElementById('overtimeWarning');
      if (overtimeMinutes > 180) {
        warningEl.style.display = 'block';
        warningEl.textContent = '注意：今日加班超过 3 小时，请注意休息！';
      } else if (netMinutes > 12 * 60) {
        warningEl.style.display = 'block';
        warningEl.textContent = '警告：工作时间超过 12 小时，严重影响健康！';
      } else {
        warningEl.style.display = 'none';
      }

      // Salary calculation
      var monthlySalary = parseFloat(monthlySalaryEl.value) || 0;
      var workDays = parseInt(workDaysEl.value) || 22;
      var overtimeRate = parseFloat(overtimeRateEl.value) || 1.5;

      var dailySalary = monthlySalary / workDays;
      var hourlySalary = dailySalary / STANDARD_HOURS;
      var overtimePay = (overtimeMinutes / 60) * hourlySalary * overtimeRate;
      var totalDailyPay = dailySalary + overtimePay;

      document.getElementById('dailySalary').textContent = '¥' + dailySalary.toFixed(2);
      document.getElementById('hourlySalary').textContent = '¥' + hourlySalary.toFixed(2);
      document.getElementById('overtimePay').textContent = '¥' + overtimePay.toFixed(2);
      document.getElementById('totalDailyPay').textContent = '¥' + totalDailyPay.toFixed(2);

      // Weekly/Monthly stats
      var weekDays = parseInt(weekDaysEl.value) || 5;
      var weeklyNetMinutes = netMinutes * weekDays;
      var monthlyNetMinutes = netMinutes * workDays;
      var weeklyOvertimeMinutes = overtimeMinutes * weekDays;
      var monthlyOvertimeMinutes = overtimeMinutes * workDays;

      document.getElementById('weeklyHours').textContent = formatHours(weeklyNetMinutes);
      document.getElementById('monthlyHours').textContent = formatHours(monthlyNetMinutes);
      document.getElementById('weeklyOvertime').textContent = formatHours(weeklyOvertimeMinutes);
      document.getElementById('monthlyOvertime').textContent = formatHours(monthlyOvertimeMinutes);

      // Save settings
      saveToStorage();
    }

    function saveToStorage() {
      var data = {
        startTime: startTimeEl.value,
        endTime: endTimeEl.value,
        breakTime: breakTimeEl.value,
        monthlySalary: monthlySalaryEl.value,
        workDays: workDaysEl.value,
        overtimeRate: overtimeRateEl.value,
        weekDays: weekDaysEl.value
      };
      localStorage.setItem(LS_KEY, JSON.stringify(data));
    }

    function loadFromStorage() {
      try {
        var saved = localStorage.getItem(LS_KEY);
        if (saved) {
          var data = JSON.parse(saved);
          startTimeEl.value = data.startTime || '09:00';
          endTimeEl.value = data.endTime || '18:00';
          breakTimeEl.value = data.breakTime || '60';
          monthlySalaryEl.value = data.monthlySalary || '10000';
          workDaysEl.value = data.workDays || '22';
          overtimeRateEl.value = data.overtimeRate || '1.5';
          weekDaysEl.value = data.weekDays || '5';
        }
      } catch (e) {
        // Ignore parse errors
      }
    }

    // Preset buttons
    document.querySelectorAll('.preset-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.preset-btn').forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        
        startTimeEl.value = btn.getAttribute('data-start');
        endTimeEl.value = btn.getAttribute('data-end');
        breakTimeEl.value = btn.getAttribute('data-break');
        calculate();
      });
    });

    // Event listeners
    [startTimeEl, endTimeEl, breakTimeEl, monthlySalaryEl, workDaysEl, overtimeRateEl, weekDaysEl].forEach(function(el) {
      el.addEventListener('input', calculate);
      el.addEventListener('change', calculate);
    });

    // Initialize
    loadFromStorage();
    calculate();
  </script>
</body>
</html>
