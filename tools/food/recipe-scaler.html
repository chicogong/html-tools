<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>配方缩放工具 - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #22c55e; --accent2: #4ade80; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 700px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text2); }
        input, select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus, select:focus { outline: none; border-color: var(--accent); }
        .scale-controls { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
        .scale-btn { padding: 10px 20px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); cursor: pointer; font-size: 0.9rem; }
        .scale-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
        .scale-btn:hover { border-color: var(--accent); }
        .custom-scale { display: flex; gap: 8px; align-items: center; }
        .custom-scale input { width: 80px; text-align: center; }
        .ingredient-list { margin-top: 16px; }
        .ingredient-item { display: flex; gap: 12px; margin-bottom: 12px; align-items: center; }
        .ingredient-item input { flex: 1; }
        .ingredient-item input:first-child { max-width: 100px; }
        .remove-btn { width: 36px; height: 36px; border-radius: 8px; border: 1px solid #ef4444; background: transparent; color: #ef4444; cursor: pointer; font-size: 1.2rem; }
        .remove-btn:hover { background: #ef4444; color: white; }
        .add-btn { width: 100%; padding: 12px; border: 1px dashed var(--border); border-radius: 8px; background: transparent; color: var(--text2); cursor: pointer; }
        .add-btn:hover { border-color: var(--accent); color: var(--accent); }
        .result-card { background: linear-gradient(135deg, var(--accent), var(--accent2)); border-radius: 12px; padding: 20px; color: white; }
        .result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .result-header h3 { font-size: 1.1rem; }
        .result-header .scale-factor { font-size: 1.5rem; font-weight: 700; }
        .scaled-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.2); }
        .scaled-item:last-child { border-bottom: none; }
        .scaled-amount { font-weight: 600; }
        .action-btns { display: flex; gap: 12px; margin-top: 16px; }
        .action-btn { flex: 1; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); cursor: pointer; }
        .action-btn:hover { border-color: var(--accent); }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">← 返回</a>
        <h1>配方缩放工具</h1>
        <p class="subtitle">轻松调整食谱份量</p>
        
        <div class="card">
            <div class="form-group">
                <label>原始份量</label>
                <div style="display: flex; gap: 12px;">
                    <input type="number" id="originalServings" value="4" min="1" oninput="updateScale()">
                    <span style="line-height: 46px; color: var(--text2);">人份</span>
                </div>
            </div>
            
            <div class="form-group">
                <label>目标份量</label>
                <div class="scale-controls">
                    <button class="scale-btn" data-scale="0.5" onclick="setScale(0.5)">1/2x</button>
                    <button class="scale-btn active" data-scale="1" onclick="setScale(1)">1x</button>
                    <button class="scale-btn" data-scale="2" onclick="setScale(2)">2x</button>
                    <button class="scale-btn" data-scale="3" onclick="setScale(3)">3x</button>
                    <div class="custom-scale">
                        <input type="number" id="targetServings" value="4" min="1" oninput="updateFromTarget()">
                        <span style="color: var(--text2);">人份</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 16px;">原始配料</h3>
            <div class="ingredient-list" id="ingredientList"></div>
            <button class="add-btn" onclick="addIngredient()">+ 添加配料</button>
        </div>
        
        <div class="card result-card">
            <div class="result-header">
                <h3>缩放后配料</h3>
                <div class="scale-factor" id="scaleFactor">1x</div>
            </div>
            <div id="scaledList"></div>
        </div>
        
        <div class="action-btns">
            <button class="action-btn" onclick="copyScaled()">复制结果</button>
            <button class="action-btn" onclick="clearAll()">清空</button>
        </div>
    </div>
    
    <script>
        let scale = 1;
        
        function createIngredientItem(amount, unit, name) {
            const item = document.createElement('div');
            item.className = 'ingredient-item';
            
            const amountInput = document.createElement('input');
            amountInput.type = 'text';
            amountInput.placeholder = '数量';
            amountInput.className = 'amount';
            amountInput.value = amount || '';
            amountInput.addEventListener('input', updateScaledList);
            
            const unitInput = document.createElement('input');
            unitInput.type = 'text';
            unitInput.placeholder = '单位';
            unitInput.className = 'unit';
            unitInput.value = unit || '';
            unitInput.addEventListener('input', updateScaledList);
            
            const nameInput = document.createElement('input');
            nameInput.type = 'text';
            nameInput.placeholder = '配料名称';
            nameInput.className = 'name';
            nameInput.value = name || '';
            nameInput.addEventListener('input', updateScaledList);
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.textContent = '×';
            removeBtn.addEventListener('click', function() {
                item.remove();
                updateScaledList();
            });
            
            item.appendChild(amountInput);
            item.appendChild(unitInput);
            item.appendChild(nameInput);
            item.appendChild(removeBtn);
            
            return item;
        }
        
        function initIngredients() {
            const list = document.getElementById('ingredientList');
            list.appendChild(createIngredientItem('200', '克', '面粉'));
            list.appendChild(createIngredientItem('2', '个', '鸡蛋'));
            list.appendChild(createIngredientItem('50', '毫升', '牛奶'));
            updateScaledList();
        }
        
        function setScale(s) {
            scale = s;
            document.querySelectorAll('.scale-btn').forEach(function(btn) {
                btn.classList.toggle('active', parseFloat(btn.dataset.scale) === s);
            });
            const original = parseInt(document.getElementById('originalServings').value) || 4;
            document.getElementById('targetServings').value = Math.round(original * s);
            updateScaledList();
        }
        
        function updateScale() {
            const original = parseInt(document.getElementById('originalServings').value) || 4;
            document.getElementById('targetServings').value = Math.round(original * scale);
            updateScaledList();
        }
        
        function updateFromTarget() {
            const original = parseInt(document.getElementById('originalServings').value) || 4;
            const target = parseInt(document.getElementById('targetServings').value) || 4;
            scale = target / original;
            document.querySelectorAll('.scale-btn').forEach(function(btn) {
                btn.classList.toggle('active', parseFloat(btn.dataset.scale) === scale);
            });
            updateScaledList();
        }
        
        function addIngredient() {
            const list = document.getElementById('ingredientList');
            list.appendChild(createIngredientItem('', '', ''));
        }
        
        function updateScaledList() {
            const items = document.querySelectorAll('.ingredient-item');
            const scaledList = document.getElementById('scaledList');
            while (scaledList.firstChild) scaledList.removeChild(scaledList.firstChild);
            
            items.forEach(function(item) {
                const amount = parseFloat(item.querySelector('.amount').value) || 0;
                const unit = item.querySelector('.unit').value;
                const name = item.querySelector('.name').value;
                
                if (name) {
                    const scaledAmount = amount * scale;
                    const formatted = scaledAmount % 1 === 0 ? scaledAmount.toString() : scaledAmount.toFixed(2).replace(/\.?0+$/, '');
                    
                    const div = document.createElement('div');
                    div.className = 'scaled-item';
                    
                    const nameSpan = document.createElement('span');
                    nameSpan.textContent = name;
                    
                    const amountSpan = document.createElement('span');
                    amountSpan.className = 'scaled-amount';
                    amountSpan.textContent = formatted + ' ' + unit;
                    
                    div.appendChild(nameSpan);
                    div.appendChild(amountSpan);
                    scaledList.appendChild(div);
                }
            });
            
            document.getElementById('scaleFactor').textContent = scale % 1 === 0 ? scale + 'x' : scale.toFixed(2) + 'x';
        }
        
        function copyScaled() {
            const items = document.querySelectorAll('.scaled-item');
            let text = '配方 (' + document.getElementById('targetServings').value + '人份)\n';
            text += '--------------------\n';
            items.forEach(function(item) {
                const name = item.querySelector('span:first-child').textContent;
                const amount = item.querySelector('.scaled-amount').textContent;
                text += name + ': ' + amount + '\n';
            });
            navigator.clipboard.writeText(text).then(function() { alert('已复制到剪贴板'); });
        }
        
        function clearAll() {
            const list = document.getElementById('ingredientList');
            while (list.firstChild) list.removeChild(list.firstChild);
            list.appendChild(createIngredientItem('', '', ''));
            updateScaledList();
        }
        
        initIngredients();
    </script>
</body>
</html>
