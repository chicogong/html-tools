<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é˜¶æ¢¯ç”µè´¹è®¡ç®—å™¨ - WebUtils</title>
    <meta name="description" content="åœ¨çº¿é˜¶æ¢¯ç”µè´¹è®¡ç®—å™¨ï¼Œæ”¯æŒå…¨å›½å„çœå¸‚å±…æ°‘ç”¨ç”µé˜¶æ¢¯ç”µä»·è®¡ç®—ï¼Œä¸€æˆ·ä¸€è¡¨ã€åˆè¡¨ç”¨æˆ·ã€å³°è°·ç”µä»·è®¡ç®—">
    <meta name="keywords" content="é˜¶æ¢¯ç”µä»·,ç”µè´¹è®¡ç®—,å±…æ°‘ç”µè´¹,å³°è°·ç”µä»·,ç”µè´¹æŸ¥è¯¢,ç”¨ç”µè®¡ç®—">
    <style>
        :root {
            --bg-color: #f0f9ff;
            --card-bg: #fff;
            --text-primary: #1e3a5f;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --primary-color: #0ea5e9;
            --primary-hover: #0284c7;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --tier1-color: #10b981;
            --tier2-color: #f59e0b;
            --tier3-color: #ef4444;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #0f172a;
                --card-bg: #1e293b;
                --text-primary: #f1f5f9;
                --text-secondary: #94a3b8;
                --border-color: #334155;
                --primary-color: #38bdf8;
                --primary-hover: #0ea5e9;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 8px;
            font-size: 1.8rem;
        }

        .subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-size: 0.95rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.08);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            font-size: 1rem;
            background: var(--bg-color);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .input-with-unit {
            display: flex;
            align-items: center;
        }

        .input-with-unit input {
            flex: 1;
            border-radius: 10px 0 0 10px;
        }

        .input-with-unit .unit {
            padding: 12px 16px;
            background: var(--border-color);
            border: 2px solid var(--border-color);
            border-left: none;
            border-radius: 0 10px 10px 0;
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
        }

        /* ç”¨ç”µç±»å‹é€‰æ‹© */
        .type-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .type-btn {
            flex: 1;
            min-width: 140px;
            padding: 16px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-color);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .type-btn:hover {
            border-color: var(--primary-color);
        }

        .type-btn.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .type-btn .icon {
            font-size: 1.5rem;
            margin-bottom: 4px;
        }

        .type-btn .label {
            font-size: 0.9rem;
        }

        /* å³°è°·æ—¶æ®µè¾“å…¥ */
        .peak-valley-section {
            display: none;
            background: var(--bg-color);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .peak-valley-section.show {
            display: block;
        }

        .peak-valley-row {
            display: grid;
            grid-template-columns: 80px 1fr 1fr;
            gap: 12px;
            align-items: center;
            margin-bottom: 12px;
        }

        .peak-valley-row:last-child {
            margin-bottom: 0;
        }

        .period-label {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .period-label.peak { color: var(--danger-color); }
        .period-label.valley { color: var(--success-color); }
        .period-label.flat { color: var(--warning-color); }

        /* ç»“æœå±•ç¤º */
        .result-section {
            display: none;
        }

        .result-section.show {
            display: block;
        }

        .result-main {
            background: linear-gradient(135deg, var(--primary-color), #6366f1);
            border-radius: 20px;
            padding: 30px;
            color: white;
            text-align: center;
            margin-bottom: 20px;
        }

        .total-bill {
            font-size: 3.5rem;
            font-weight: 700;
        }

        .total-bill .currency {
            font-size: 1.5rem;
            vertical-align: top;
        }

        .total-label {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 8px;
        }

        .result-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 24px;
        }

        .summary-item {
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 16px;
        }

        .summary-value {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .summary-label {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        /* é˜¶æ¢¯æ˜ç»† */
        .tier-breakdown {
            display: grid;
            gap: 12px;
        }

        .tier-item {
            display: grid;
            grid-template-columns: 100px 1fr auto auto;
            gap: 16px;
            align-items: center;
            padding: 16px;
            background: var(--bg-color);
            border-radius: 12px;
            border-left: 4px solid;
        }

        .tier-item.tier-1 { border-color: var(--tier1-color); }
        .tier-item.tier-2 { border-color: var(--tier2-color); }
        .tier-item.tier-3 { border-color: var(--tier3-color); }

        .tier-name {
            font-weight: 600;
        }

        .tier-name.tier-1 { color: var(--tier1-color); }
        .tier-name.tier-2 { color: var(--tier2-color); }
        .tier-name.tier-3 { color: var(--tier3-color); }

        .tier-range {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .tier-usage {
            font-weight: 500;
        }

        .tier-cost {
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* ç”µä»·è¡¨ */
        .price-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .price-table th,
        .price-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .price-table th {
            color: var(--text-secondary);
            font-weight: 500;
            background: var(--bg-color);
        }

        .price-table tr:last-child td {
            border-bottom: none;
        }

        /* çœä»½é€‰æ‹©å™¨ç¾åŒ– */
        .province-grid {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            max-height: 300px;
            overflow-y: auto;
        }

        .province-grid.show {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
        }

        .province-item {
            padding: 8px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .province-item:hover {
            background: var(--primary-color);
            color: white;
        }

        .province-wrapper {
            position: relative;
        }

        /* æç¤ºä¿¡æ¯ */
        .info-box {
            background: rgba(14, 165, 233, 0.1);
            border-left: 4px solid var(--primary-color);
            padding: 16px;
            border-radius: 0 12px 12px 0;
            margin-top: 20px;
            font-size: 0.9rem;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            .type-selector {
                flex-direction: column;
            }
            .result-summary {
                grid-template-columns: 1fr;
            }
            .tier-item {
                grid-template-columns: 1fr 1fr;
            }
            .total-bill {
                font-size: 2.5rem;
            }
        }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#life">ç”Ÿæ´»å·¥å…·</a><span>â€º</span>é˜¶æ¢¯ç”µè´¹è®¡ç®—å™¨</nav>
    <div class="container">
        <h1>âš¡ é˜¶æ¢¯ç”µè´¹è®¡ç®—å™¨</h1>
        <p class="subtitle">æ ¹æ®å„åœ°é˜¶æ¢¯ç”µä»·æ”¿ç­–è®¡ç®—å±…æ°‘ç”¨ç”µè´¹ç”¨</p>

        <!-- åœ°åŒºå’Œç±»å‹é€‰æ‹© -->
        <div class="card">
            <div class="card-title">
                <span>ğŸ“</span> é€‰æ‹©åœ°åŒºå’Œç”¨ç”µç±»å‹
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>é€‰æ‹©çœä»½/åŸå¸‚</label>
                    <select id="province" onchange="updatePriceTable()">
                        <option value="beijing">åŒ—äº¬</option>
                        <option value="shanghai">ä¸Šæµ·</option>
                        <option value="guangdong">å¹¿ä¸œ</option>
                        <option value="jiangsu">æ±Ÿè‹</option>
                        <option value="zhejiang">æµ™æ±Ÿ</option>
                        <option value="shandong">å±±ä¸œ</option>
                        <option value="sichuan">å››å·</option>
                        <option value="hubei">æ¹–åŒ—</option>
                        <option value="hunan">æ¹–å—</option>
                        <option value="henan">æ²³å—</option>
                        <option value="hebei">æ²³åŒ—</option>
                        <option value="fujian">ç¦å»º</option>
                        <option value="anhui">å®‰å¾½</option>
                        <option value="liaoning">è¾½å®</option>
                        <option value="shaanxi">é™•è¥¿</option>
                        <option value="chongqing">é‡åº†</option>
                        <option value="tianjin">å¤©æ´¥</option>
                        <option value="default" selected>å…¨å›½é€šç”¨</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ç»“ç®—å‘¨æœŸ</label>
                    <select id="period" onchange="updatePriceTable()">
                        <option value="monthly">æŒ‰æœˆç»“ç®—</option>
                        <option value="yearly">æŒ‰å¹´ç»“ç®—</option>
                    </select>
                </div>
            </div>

            <div class="card-title" style="margin-top: 16px;">
                <span>ğŸ </span> ç”¨ç”µç±»å‹
            </div>
            <div class="type-selector">
                <button class="type-btn active" data-type="ladder" onclick="switchType('ladder')">
                    <div class="icon">ğŸ“Š</div>
                    <div class="label">é˜¶æ¢¯ç”µä»·</div>
                </button>
                <button class="type-btn" data-type="peakvalley" onclick="switchType('peakvalley')">
                    <div class="icon">ğŸŒ™</div>
                    <div class="label">å³°è°·ç”µä»·</div>
                </button>
                <button class="type-btn" data-type="fixed" onclick="switchType('fixed')">
                    <div class="icon">ğŸ“Œ</div>
                    <div class="label">å›ºå®šç”µä»·</div>
                </button>
            </div>
        </div>

        <!-- ç”¨ç”µé‡è¾“å…¥ -->
        <div class="card">
            <div class="card-title">
                <span>ğŸ”Œ</span> è¾“å…¥ç”¨ç”µé‡
            </div>

            <!-- æ™®é€šé˜¶æ¢¯ç”µä»·è¾“å…¥ -->
            <div id="ladderInput">
                <div class="form-row">
                    <div class="form-group">
                        <label>æœ¬æœŸç”¨ç”µé‡</label>
                        <div class="input-with-unit">
                            <input type="number" id="totalUsage" placeholder="è¾“å…¥ç”¨ç”µåº¦æ•°" min="0">
                            <span class="unit">åº¦(kWh)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³°è°·ç”µä»·è¾“å…¥ -->
            <div class="peak-valley-section" id="peakValleyInput">
                <div class="peak-valley-row">
                    <span class="period-label peak">âš¡ å³°æ—¶</span>
                    <div class="form-group">
                        <div class="input-with-unit">
                            <input type="number" id="peakUsage" placeholder="å³°æ—¶ç”¨ç”µ" min="0">
                            <span class="unit">åº¦</span>
                        </div>
                    </div>
                    <span style="color: var(--text-secondary); font-size: 0.85rem;">8:00-22:00</span>
                </div>
                <div class="peak-valley-row">
                    <span class="period-label valley">ğŸŒ™ è°·æ—¶</span>
                    <div class="form-group">
                        <div class="input-with-unit">
                            <input type="number" id="valleyUsage" placeholder="è°·æ—¶ç”¨ç”µ" min="0">
                            <span class="unit">åº¦</span>
                        </div>
                    </div>
                    <span style="color: var(--text-secondary); font-size: 0.85rem;">22:00-8:00</span>
                </div>
            </div>

            <!-- å›ºå®šç”µä»·è¾“å…¥ -->
            <div id="fixedInput" style="display: none;">
                <div class="form-row">
                    <div class="form-group">
                        <label>ç”¨ç”µé‡</label>
                        <div class="input-with-unit">
                            <input type="number" id="fixedUsage" placeholder="è¾“å…¥ç”¨ç”µåº¦æ•°" min="0">
                            <span class="unit">åº¦(kWh)</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>å•ä»·ï¼ˆå…ƒ/åº¦ï¼‰</label>
                        <input type="number" id="fixedPrice" placeholder="0.52" step="0.01" min="0">
                    </div>
                </div>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="includeBaseFee">
                <label for="includeBaseFee">åŒ…å«åŸºæœ¬ç”µè´¹ï¼ˆéƒ¨åˆ†åœ°åŒºæ”¶å–ï¼Œçº¦5-10å…ƒ/æœˆï¼‰</label>
            </div>

            <button class="btn btn-primary" onclick="calculate()" style="margin-top: 20px;">
                ğŸ§® è®¡ç®—ç”µè´¹
            </button>
        </div>

        <!-- è®¡ç®—ç»“æœ -->
        <div class="result-section" id="resultSection">
            <div class="card">
                <div class="result-main">
                    <div class="total-label">æœ¬æœŸç”µè´¹</div>
                    <div class="total-bill">
                        <span class="currency">Â¥</span>
                        <span id="totalBill">0.00</span>
                    </div>
                    
                    <div class="result-summary">
                        <div class="summary-item">
                            <div class="summary-value" id="totalKwh">0</div>
                            <div class="summary-label">æ€»ç”¨ç”µé‡(åº¦)</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="avgPrice">0.00</div>
                            <div class="summary-label">å¹³å‡ç”µä»·(å…ƒ/åº¦)</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="dailyAvg">0.0</div>
                            <div class="summary-label">æ—¥å‡ç”¨ç”µ(åº¦)</div>
                        </div>
                    </div>
                </div>

                <div class="card-title">
                    <span>ğŸ“‹</span> è´¹ç”¨æ˜ç»†
                </div>
                <div class="tier-breakdown" id="tierBreakdown">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- ç”µä»·æ ‡å‡† -->
        <div class="card">
            <div class="card-title">
                <span>ğŸ“œ</span> å½“å‰åœ°åŒºç”µä»·æ ‡å‡†
            </div>
            <table class="price-table" id="priceTable">
                <thead>
                    <tr>
                        <th>æ¡£ä½</th>
                        <th>ç”¨ç”µèŒƒå›´ï¼ˆæœˆï¼‰</th>
                        <th>ç”µä»·ï¼ˆå…ƒ/åº¦ï¼‰</th>
                    </tr>
                </thead>
                <tbody id="priceTableBody">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>

            <div class="info-box">
                <strong>ğŸ’¡ è¯´æ˜ï¼š</strong>
                <ul style="margin: 8px 0 0 16px; line-height: 1.8;">
                    <li>é˜¶æ¢¯ç”µä»·åˆ†ä¸ºä¸‰æ¡£ï¼Œç”¨ç”µé‡è¶Šå¤šå•ä»·è¶Šé«˜</li>
                    <li>éƒ¨åˆ†çœå¸‚æ”¯æŒæŒ‰å¹´ç´¯è®¡è®¡ç®—ï¼Œé˜¶æ¢¯æ ‡å‡†æŒ‰12ä¸ªæœˆæ±‡æ€»</li>
                    <li>å³°è°·ç”µä»·éœ€ç”³è¯·å®‰è£…å³°è°·åˆ†æ—¶ç”µè¡¨</li>
                    <li>ç”µä»·æ ‡å‡†å¯èƒ½ä¼šè°ƒæ•´ï¼Œè¯·ä»¥å½“åœ°ä¾›ç”µå…¬å¸å…¬å¸ƒä¸ºå‡†</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // å„åœ°ç”µä»·æ•°æ®ï¼ˆ2024å¹´æ ‡å‡†ï¼Œå®é™…åº”ä»¥å½“åœ°æœ€æ–°å…¬å‘Šä¸ºå‡†ï¼‰
        const electricityPrices = {
            default: {
                name: 'å…¨å›½é€šç”¨',
                monthly: {
                    tier1: { limit: 170, price: 0.52 },
                    tier2: { limit: 260, price: 0.57 },
                    tier3: { limit: Infinity, price: 0.82 }
                },
                peakValley: {
                    peak: 0.56,
                    valley: 0.36
                }
            },
            beijing: {
                name: 'åŒ—äº¬',
                monthly: {
                    tier1: { limit: 240, price: 0.4883 },
                    tier2: { limit: 400, price: 0.5383 },
                    tier3: { limit: Infinity, price: 0.7883 }
                },
                peakValley: {
                    peak: 0.5583,
                    valley: 0.3583
                }
            },
            shanghai: {
                name: 'ä¸Šæµ·',
                monthly: {
                    tier1: { limit: 260, price: 0.617 },
                    tier2: { limit: 400, price: 0.667 },
                    tier3: { limit: Infinity, price: 0.917 }
                },
                peakValley: {
                    peak: 0.617,
                    valley: 0.307
                }
            },
            guangdong: {
                name: 'å¹¿ä¸œ',
                monthly: {
                    tier1: { limit: 260, price: 0.59 },
                    tier2: { limit: 600, price: 0.64 },
                    tier3: { limit: Infinity, price: 0.89 }
                },
                peakValley: {
                    peak: 0.9966,
                    valley: 0.2966
                }
            },
            jiangsu: {
                name: 'æ±Ÿè‹',
                monthly: {
                    tier1: { limit: 230, price: 0.5283 },
                    tier2: { limit: 400, price: 0.5783 },
                    tier3: { limit: Infinity, price: 0.8283 }
                },
                peakValley: {
                    peak: 0.5583,
                    valley: 0.3583
                }
            },
            zhejiang: {
                name: 'æµ™æ±Ÿ',
                monthly: {
                    tier1: { limit: 276, price: 0.538 },
                    tier2: { limit: 476, price: 0.588 },
                    tier3: { limit: Infinity, price: 0.838 }
                },
                peakValley: {
                    peak: 0.568,
                    valley: 0.288
                }
            },
            shandong: {
                name: 'å±±ä¸œ',
                monthly: {
                    tier1: { limit: 210, price: 0.5469 },
                    tier2: { limit: 400, price: 0.5969 },
                    tier3: { limit: Infinity, price: 0.8469 }
                },
                peakValley: {
                    peak: 0.5769,
                    valley: 0.3069
                }
            },
            sichuan: {
                name: 'å››å·',
                monthly: {
                    tier1: { limit: 180, price: 0.5224 },
                    tier2: { limit: 280, price: 0.6224 },
                    tier3: { limit: Infinity, price: 0.8224 }
                },
                peakValley: {
                    peak: 0.5824,
                    valley: 0.3324
                }
            },
            hubei: {
                name: 'æ¹–åŒ—',
                monthly: {
                    tier1: { limit: 180, price: 0.558 },
                    tier2: { limit: 400, price: 0.608 },
                    tier3: { limit: Infinity, price: 0.858 }
                },
                peakValley: {
                    peak: 0.598,
                    valley: 0.298
                }
            },
            hunan: {
                name: 'æ¹–å—',
                monthly: {
                    tier1: { limit: 180, price: 0.588 },
                    tier2: { limit: 350, price: 0.638 },
                    tier3: { limit: Infinity, price: 0.888 }
                },
                peakValley: {
                    peak: 0.618,
                    valley: 0.338
                }
            },
            henan: {
                name: 'æ²³å—',
                monthly: {
                    tier1: { limit: 180, price: 0.56 },
                    tier2: { limit: 260, price: 0.61 },
                    tier3: { limit: Infinity, price: 0.86 }
                },
                peakValley: {
                    peak: 0.58,
                    valley: 0.30
                }
            },
            hebei: {
                name: 'æ²³åŒ—',
                monthly: {
                    tier1: { limit: 170, price: 0.52 },
                    tier2: { limit: 260, price: 0.57 },
                    tier3: { limit: Infinity, price: 0.82 }
                },
                peakValley: {
                    peak: 0.55,
                    valley: 0.30
                }
            },
            fujian: {
                name: 'ç¦å»º',
                monthly: {
                    tier1: { limit: 200, price: 0.4983 },
                    tier2: { limit: 400, price: 0.5483 },
                    tier3: { limit: Infinity, price: 0.7983 }
                },
                peakValley: {
                    peak: 0.5383,
                    valley: 0.2783
                }
            },
            anhui: {
                name: 'å®‰å¾½',
                monthly: {
                    tier1: { limit: 180, price: 0.5653 },
                    tier2: { limit: 350, price: 0.6153 },
                    tier3: { limit: Infinity, price: 0.8653 }
                },
                peakValley: {
                    peak: 0.5953,
                    valley: 0.3053
                }
            },
            liaoning: {
                name: 'è¾½å®',
                monthly: {
                    tier1: { limit: 180, price: 0.50 },
                    tier2: { limit: 280, price: 0.55 },
                    tier3: { limit: Infinity, price: 0.80 }
                },
                peakValley: {
                    peak: 0.54,
                    valley: 0.28
                }
            },
            shaanxi: {
                name: 'é™•è¥¿',
                monthly: {
                    tier1: { limit: 160, price: 0.4983 },
                    tier2: { limit: 240, price: 0.5483 },
                    tier3: { limit: Infinity, price: 0.7983 }
                },
                peakValley: {
                    peak: 0.5483,
                    valley: 0.2783
                }
            },
            chongqing: {
                name: 'é‡åº†',
                monthly: {
                    tier1: { limit: 200, price: 0.52 },
                    tier2: { limit: 400, price: 0.57 },
                    tier3: { limit: Infinity, price: 0.82 }
                },
                peakValley: {
                    peak: 0.57,
                    valley: 0.30
                }
            },
            tianjin: {
                name: 'å¤©æ´¥',
                monthly: {
                    tier1: { limit: 220, price: 0.4883 },
                    tier2: { limit: 400, price: 0.5383 },
                    tier3: { limit: Infinity, price: 0.7883 }
                },
                peakValley: {
                    peak: 0.5383,
                    valley: 0.3083
                }
            }
        };

        let currentType = 'ladder';

        document.addEventListener('DOMContentLoaded', () => {
            updatePriceTable();
        });

        function switchType(type) {
            currentType = type;
            
            document.querySelectorAll('.type-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });

            document.getElementById('ladderInput').style.display = type === 'ladder' ? 'block' : 'none';
            document.getElementById('peakValleyInput').classList.toggle('show', type === 'peakvalley');
            document.getElementById('fixedInput').style.display = type === 'fixed' ? 'block' : 'none';
        }

        function updatePriceTable() {
            const province = document.getElementById('province').value;
            const period = document.getElementById('period').value;
            const priceData = electricityPrices[province] || electricityPrices.default;
            
            const multiplier = period === 'yearly' ? 12 : 1;
            const tiers = priceData.monthly;

            const tableBody = document.getElementById('priceTableBody');
            tableBody.innerHTML = `
                <tr>
                    <td style="color: var(--tier1-color); font-weight: 600;">ç¬¬ä¸€æ¡£</td>
                    <td>0 - ${tiers.tier1.limit * multiplier} åº¦</td>
                    <td>${tiers.tier1.price.toFixed(4)} å…ƒ</td>
                </tr>
                <tr>
                    <td style="color: var(--tier2-color); font-weight: 600;">ç¬¬äºŒæ¡£</td>
                    <td>${tiers.tier1.limit * multiplier + 1} - ${tiers.tier2.limit * multiplier} åº¦</td>
                    <td>${tiers.tier2.price.toFixed(4)} å…ƒ</td>
                </tr>
                <tr>
                    <td style="color: var(--tier3-color); font-weight: 600;">ç¬¬ä¸‰æ¡£</td>
                    <td>${tiers.tier2.limit * multiplier + 1} åº¦ä»¥ä¸Š</td>
                    <td>${tiers.tier3.price.toFixed(4)} å…ƒ</td>
                </tr>
            `;

            if (priceData.peakValley) {
                tableBody.innerHTML += `
                    <tr>
                        <td colspan="3" style="background: var(--bg-color); font-weight: 600; color: var(--text-secondary);">
                            å³°è°·ç”µä»·ï¼ˆéœ€ç”³è¯·åˆ†æ—¶ç”µè¡¨ï¼‰
                        </td>
                    </tr>
                    <tr>
                        <td style="color: var(--danger-color);">å³°æ—¶ (8:00-22:00)</td>
                        <td>-</td>
                        <td>${priceData.peakValley.peak.toFixed(4)} å…ƒ</td>
                    </tr>
                    <tr>
                        <td style="color: var(--success-color);">è°·æ—¶ (22:00-8:00)</td>
                        <td>-</td>
                        <td>${priceData.peakValley.valley.toFixed(4)} å…ƒ</td>
                    </tr>
                `;
            }
        }

        function calculate() {
            const province = document.getElementById('province').value;
            const period = document.getElementById('period').value;
            const priceData = electricityPrices[province] || electricityPrices.default;
            const includeBaseFee = document.getElementById('includeBaseFee').checked;
            
            let totalUsage = 0;
            let totalBill = 0;
            let breakdownItems = [];
            const multiplier = period === 'yearly' ? 12 : 1;

            switch (currentType) {
                case 'ladder': {
                    totalUsage = parseFloat(document.getElementById('totalUsage').value) || 0;
                    if (totalUsage <= 0) {
                        alert('è¯·è¾“å…¥ç”¨ç”µé‡');
                        return;
                    }

                    const tiers = priceData.monthly;
                    const tier1Limit = tiers.tier1.limit * multiplier;
                    const tier2Limit = tiers.tier2.limit * multiplier;

                    // ç¬¬ä¸€æ¡£
                    const tier1Usage = Math.min(totalUsage, tier1Limit);
                    const tier1Cost = tier1Usage * tiers.tier1.price;
                    breakdownItems.push({
                        name: 'ç¬¬ä¸€æ¡£',
                        class: 'tier-1',
                        range: `0-${tier1Limit}åº¦`,
                        usage: tier1Usage,
                        price: tiers.tier1.price,
                        cost: tier1Cost
                    });

                    // ç¬¬äºŒæ¡£
                    if (totalUsage > tier1Limit) {
                        const tier2Usage = Math.min(totalUsage - tier1Limit, tier2Limit - tier1Limit);
                        const tier2Cost = tier2Usage * tiers.tier2.price;
                        breakdownItems.push({
                            name: 'ç¬¬äºŒæ¡£',
                            class: 'tier-2',
                            range: `${tier1Limit + 1}-${tier2Limit}åº¦`,
                            usage: tier2Usage,
                            price: tiers.tier2.price,
                            cost: tier2Cost
                        });
                    }

                    // ç¬¬ä¸‰æ¡£
                    if (totalUsage > tier2Limit) {
                        const tier3Usage = totalUsage - tier2Limit;
                        const tier3Cost = tier3Usage * tiers.tier3.price;
                        breakdownItems.push({
                            name: 'ç¬¬ä¸‰æ¡£',
                            class: 'tier-3',
                            range: `${tier2Limit + 1}åº¦ä»¥ä¸Š`,
                            usage: tier3Usage,
                            price: tiers.tier3.price,
                            cost: tier3Cost
                        });
                    }

                    totalBill = breakdownItems.reduce((sum, item) => sum + item.cost, 0);
                    break;
                }

                case 'peakvalley': {
                    const peakUsage = parseFloat(document.getElementById('peakUsage').value) || 0;
                    const valleyUsage = parseFloat(document.getElementById('valleyUsage').value) || 0;
                    totalUsage = peakUsage + valleyUsage;

                    if (totalUsage <= 0) {
                        alert('è¯·è¾“å…¥ç”¨ç”µé‡');
                        return;
                    }

                    const peakPrice = priceData.peakValley?.peak || 0.56;
                    const valleyPrice = priceData.peakValley?.valley || 0.36;

                    const peakCost = peakUsage * peakPrice;
                    const valleyCost = valleyUsage * valleyPrice;

                    breakdownItems.push({
                        name: 'å³°æ—¶ç”¨ç”µ',
                        class: 'tier-3',
                        range: '8:00-22:00',
                        usage: peakUsage,
                        price: peakPrice,
                        cost: peakCost
                    });

                    breakdownItems.push({
                        name: 'è°·æ—¶ç”¨ç”µ',
                        class: 'tier-1',
                        range: '22:00-8:00',
                        usage: valleyUsage,
                        price: valleyPrice,
                        cost: valleyCost
                    });

                    totalBill = peakCost + valleyCost;
                    break;
                }

                case 'fixed': {
                    totalUsage = parseFloat(document.getElementById('fixedUsage').value) || 0;
                    const fixedPrice = parseFloat(document.getElementById('fixedPrice').value) || 0.52;

                    if (totalUsage <= 0) {
                        alert('è¯·è¾“å…¥ç”¨ç”µé‡');
                        return;
                    }

                    totalBill = totalUsage * fixedPrice;
                    breakdownItems.push({
                        name: 'å›ºå®šç”µä»·',
                        class: 'tier-1',
                        range: 'ç»Ÿä¸€ä»·æ ¼',
                        usage: totalUsage,
                        price: fixedPrice,
                        cost: totalBill
                    });
                    break;
                }
            }

            // åŸºæœ¬ç”µè´¹
            if (includeBaseFee) {
                const baseFee = 5;
                breakdownItems.push({
                    name: 'åŸºæœ¬ç”µè´¹',
                    class: 'tier-2',
                    range: 'å›ºå®šæ”¶å–',
                    usage: '-',
                    price: '-',
                    cost: baseFee
                });
                totalBill += baseFee;
            }

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultSection').classList.add('show');
            document.getElementById('totalBill').textContent = totalBill.toFixed(2);
            document.getElementById('totalKwh').textContent = totalUsage.toFixed(0);
            document.getElementById('avgPrice').textContent = totalUsage > 0 ? (totalBill / totalUsage).toFixed(4) : '0.00';
            document.getElementById('dailyAvg').textContent = (totalUsage / (period === 'yearly' ? 365 : 30)).toFixed(1);

            // æ¸²æŸ“æ˜ç»†
            const breakdownHtml = breakdownItems.map(item => `
                <div class="tier-item ${item.class}">
                    <div class="tier-name ${item.class}">${item.name}</div>
                    <div class="tier-range">${item.range}</div>
                    <div class="tier-usage">${typeof item.usage === 'number' ? item.usage.toFixed(0) + ' åº¦' : item.usage}</div>
                    <div class="tier-cost">Â¥${item.cost.toFixed(2)}</div>
                </div>
            `).join('');
            document.getElementById('tierBreakdown').innerHTML = breakdownHtml;

            // æ»šåŠ¨åˆ°ç»“æœ
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
