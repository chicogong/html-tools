<!doctype html>
<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>转换器工具 - WebUtils</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ===== CSS 变量 ===== */
      :root {
        --bg-body: #0a0a0a;
        --bg-card: #111;
        --bg-input: #0d0d0d;
        --bg-hover: #1a1a1a;
        --text-primary: #e5e5e5;
        --text-secondary: #737373;
        --text-muted: #525252;
        --border-color: #252525;
        --border-focus: #404040;
        --accent: #00f5d4;
        --accent-hover: #00dfc4;
        --accent-glow: rgba(0, 245, 212, 0.15);
        --accent-secondary: #a855f7;
        --success: #10b981;
        --error: #ef4444;
        --warning: #f59e0b;
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 14px;
        --font-sans: 'Inter', system-ui, sans-serif;
        --font-mono: 'JetBrains Mono', monospace;
      }

      [data-theme='light'] {
        --bg-body: #fafafa;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f0f0f0;
        --text-primary: #171717;
        --text-secondary: #525252;
        --text-muted: #a3a3a3;
        --border-color: #e5e5e5;
        --border-focus: #d4d4d4;
        --accent: #10b981;
        --accent-hover: #059669;
        --accent-glow: rgba(16, 185, 129, 0.15);
        --accent-secondary: #9333ea;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: var(--font-sans);
        background: var(--bg-body);
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 32px 24px;
      }

      /* ===== 头部 ===== */
      .header {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 24px;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .back-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        background: transparent;
        border: none;
        border-radius: var(--radius-sm);
        color: var(--text-secondary);
        text-decoration: none;
        transition: all 0.2s;
      }

      .back-btn:hover {
        background: var(--bg-hover);
        color: var(--text-primary);
      }

      .back-btn:hover svg {
        transform: translateX(-2px);
      }

      .back-btn svg {
        transition: transform 0.2s;
      }

      .title-group h1 {
        font-size: 1.25rem;
        font-weight: 600;
        letter-spacing: -0.02em;
      }

      .title-group p {
        font-size: 0.8125rem;
        color: var(--text-secondary);
        margin-top: 2px;
      }

      /* ===== 图标 ===== */
      .icon {
        width: 16px;
        height: 16px;
        flex-shrink: 0;
      }

      .icon-sm {
        width: 14px;
        height: 14px;
      }

      .header-right {
        display: flex;
        gap: 8px;
      }

      .theme-toggle {
        display: flex;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        overflow: hidden;
      }

      .theme-btn {
        padding: 8px 12px;
        font-size: 0.75rem;
        font-family: var(--font-mono);
        background: transparent;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
      }

      .theme-btn:hover {
        color: var(--text-secondary);
      }
      .theme-btn.active {
        background: var(--accent);
        color: #000;
      }

      /* ===== 转换器布局 ===== */
      .converter {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 0;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        overflow: hidden;
      }

      .panel {
        display: flex;
        flex-direction: column;
      }

      .panel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 20px;
        border-bottom: 1px solid var(--border-color);
      }

      .panel-title {
        display: flex;
        align-items: center;
        gap: 8px;
        font-family: var(--font-mono);
        font-size: 0.8rem;
        font-weight: 500;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .panel-title .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--accent);
      }

      .panel:last-child .panel-title .dot {
        background: var(--accent-secondary);
      }

      .panel-actions {
        display: flex;
        gap: 6px;
      }

      .panel-body {
        flex: 1;
        padding: 20px;
      }

      .panel textarea,
      .panel .output-box {
        width: 100%;
        height: 100%;
        min-height: 320px;
        padding: 16px;
        font-family: var(--font-mono);
        font-size: 0.9rem;
        line-height: 1.7;
        background: var(--bg-input);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        color: var(--text-primary);
        resize: none;
        outline: none;
        transition: all 0.2s;
      }

      .panel textarea:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px var(--accent-glow);
      }

      .panel textarea::placeholder {
        color: var(--text-muted);
      }

      .panel .output-box {
        white-space: pre-wrap;
        word-break: break-all;
        overflow: auto;
      }

      .panel .output-box:empty::before {
        content: '转换结果将显示在这里...';
        color: var(--text-muted);
      }

      /* ===== 中间切换按钮 ===== */
      .swap-column {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px 0;
        background: var(--bg-card);
        border-left: 1px solid var(--border-color);
        border-right: 1px solid var(--border-color);
      }

      .swap-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        background: var(--bg-input);
        border: 1px solid var(--border-color);
        border-radius: 50%;
        color: var(--text-secondary);
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s;
      }

      .swap-btn:hover {
        background: var(--accent);
        border-color: var(--accent);
        color: #000;
        transform: rotate(180deg);
      }

      /* ===== 按钮 ===== */
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        font-family: var(--font-mono);
        font-size: 0.75rem;
        font-weight: 500;
        background: var(--bg-input);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
      }

      .btn:hover {
        background: var(--bg-hover);
        border-color: var(--border-focus);
        color: var(--text-primary);
      }

      .btn-primary {
        background: var(--accent);
        border-color: var(--accent);
        color: #000;
      }

      .btn-primary:hover {
        background: var(--accent-hover);
        border-color: var(--accent-hover);
      }

      /* ===== 底部状态栏 ===== */
      .status-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 20px;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        margin-top: 16px;
        font-family: var(--font-mono);
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .status-bar .stats {
        display: flex;
        gap: 20px;
      }

      .status-bar .stat {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .status-bar .stat-value {
        color: var(--text-secondary);
      }

      /* ===== Toast ===== */
      .toast {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        padding: 12px 20px;
        font-family: var(--font-mono);
        font-size: 0.85rem;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        color: var(--text-primary);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 1000;
      }

      .toast.show {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }

      .toast.success {
        border-color: var(--success);
        color: var(--success);
      }
      .toast.error {
        border-color: var(--error);
        color: var(--error);
      }

      /* ===== 响应式 ===== */
      @media (max-width: 768px) {
        .container {
          padding: 16px;
        }
        .header {
          flex-direction: column;
          align-items: stretch;
        }
        .header-right {
          justify-content: flex-end;
        }

        .converter {
          grid-template-columns: 1fr;
          grid-template-rows: auto auto auto;
        }

        .swap-column {
          border-left: none;
          border-right: none;
          border-top: 1px solid var(--border-color);
          border-bottom: 1px solid var(--border-color);
          padding: 12px;
        }

        .swap-btn {
          transform: rotate(90deg);
        }

        .swap-btn:hover {
          transform: rotate(270deg);
        }

        .panel textarea,
        .panel .output-box {
          min-height: 200px;
        }

        .status-bar {
          flex-direction: column;
          gap: 8px;
          text-align: center;
        }

        .btn span:not(:first-child) {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- 头部 -->
      <header class="header">
        <div class="header-left">
          <a href="../../index.html" class="back-btn" title="返回首页">
            <svg
              class="icon"
              viewBox="0 0 16 16"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M10 12L6 8L10 4" />
            </svg>
          </a>
          <div class="title-group">
            <h1>转换器工具</h1>
            <p>格式A 与 格式B 互转</p>
          </div>
        </div>
        <div class="header-right">
          <div class="theme-toggle">
            <button class="theme-btn active" data-theme="dark">暗色</button>
            <button class="theme-btn" data-theme="light">亮色</button>
          </div>
        </div>
      </header>

      <!-- 转换器主体 -->
      <main class="converter">
        <!-- 左侧输入 -->
        <div class="panel panel-input">
          <div class="panel-header">
            <div class="panel-title">
              <span class="dot"></span>
              <span>格式A</span>
            </div>
            <div class="panel-actions">
              <button class="btn" id="pasteBtn">
                <svg
                  class="icon"
                  viewBox="0 0 16 16"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="5" y="2" width="6" height="3" rx="0.5" />
                  <path
                    d="M5 3.5H3.5a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1H11"
                  />
                </svg>
                <span>粘贴</span>
              </button>
              <button class="btn" id="clearBtn">
                <svg
                  class="icon"
                  viewBox="0 0 16 16"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M2.5 4.5h11M6 4.5V3a1 1 0 011-1h2a1 1 0 011 1v1.5M12.5 4.5l-.5 9a1 1 0 01-1 1h-6a1 1 0 01-1-1l-.5-9"
                  />
                </svg>
                <span>清空</span>
              </button>
            </div>
          </div>
          <div class="panel-body">
            <textarea id="input" placeholder="在此输入格式A内容..." spellcheck="false"></textarea>
          </div>
        </div>

        <!-- 中间切换 -->
        <div class="swap-column">
          <button class="swap-btn" id="swapBtn" title="交换输入输出">
            <svg
              class="icon"
              viewBox="0 0 16 16"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M4 6l8 0M12 6l-2-2M12 6l-2 2" />
              <path d="M12 10l-8 0M4 10l2-2M4 10l2 2" />
            </svg>
          </button>
        </div>

        <!-- 右侧输出 -->
        <div class="panel panel-output">
          <div class="panel-header">
            <div class="panel-title">
              <span class="dot"></span>
              <span>格式B</span>
            </div>
            <div class="panel-actions">
              <button class="btn" id="shareBtn">
                <svg
                  class="icon"
                  viewBox="0 0 16 16"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <circle cx="4" cy="8" r="2" />
                  <circle cx="12" cy="4" r="2" />
                  <circle cx="12" cy="12" r="2" />
                  <path d="M6 7l4-2M6 9l4 2" />
                </svg>
                <span>分享</span>
              </button>
              <button class="btn btn-primary" id="copyBtn">
                <svg
                  class="icon"
                  viewBox="0 0 16 16"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="2" y="2" width="8" height="8" rx="1" />
                  <path d="M6 10v4a1 1 0 001 1h7a1 1 0 001-1V7a1 1 0 00-1-1h-4" />
                </svg>
                <span>复制</span>
              </button>
            </div>
          </div>
          <div class="panel-body">
            <div id="output" class="output-box"></div>
          </div>
        </div>
      </main>

      <!-- 状态栏 -->
      <div class="status-bar">
        <div class="stats">
          <div class="stat">
            输入:
            <span class="stat-value" id="inputChars">0</span>
            字符
          </div>
          <div class="stat">
            输出:
            <span class="stat-value" id="outputChars">0</span>
            字符
          </div>
        </div>
        <div class="shortcuts">
          <kbd>⌘V</kbd>
          粘贴 ·
          <kbd>⌘K</kbd>
          清空 ·
          <kbd>⌘⇧C</kbd>
          复制
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script>
      // ===== 状态 =====
      const state = { input: '', output: '', reversed: false };

      // ===== DOM =====
      const $ = (id) => document.getElementById(id);
      const inputEl = $('input');
      const outputEl = $('output');
      const toastEl = $('toast');
      const inputCharsEl = $('inputChars');
      const outputCharsEl = $('outputChars');

      // ===== 转换函数 =====
      function convert(text, reverse = false) {
        // TODO: 实现转换逻辑
        // reverse=false: A -> B
        // reverse=true: B -> A
        return text;
      }

      function processInput() {
        const input = inputEl.value;
        state.input = input;

        try {
          const result = convert(input, state.reversed);
          state.output = result;
          outputEl.textContent = result;
          updateStats();
          saveState();
        } catch (error) {
          showToast('转换失败: ' + error.message, 'error');
        }
      }

      function updateStats() {
        inputCharsEl.textContent = state.input.length;
        outputCharsEl.textContent = state.output.length;
      }

      // ===== 交换方向 =====
      window.swap = function () {
        state.reversed = !state.reversed;
        const temp = inputEl.value;
        inputEl.value = outputEl.textContent;
        processInput();

        // 更新标签
        const labels = document.querySelectorAll('.panel-title span:last-child');
        labels[0].textContent = state.reversed ? '格式B' : '格式A';
        labels[1].textContent = state.reversed ? '格式A' : '格式B';

        showToast('已切换转换方向', 'success');
      };

      // ===== URL 状态 =====
      function saveState() {
        try {
          const data = JSON.stringify({ input: state.input, reversed: state.reversed });
          history.replaceState(null, '', '#' + btoa(encodeURIComponent(data)));
        } catch (e) {}
      }

      function loadState() {
        try {
          const hash = location.hash.slice(1);
          if (!hash) return null;
          return JSON.parse(decodeURIComponent(atob(hash)));
        } catch (e) {
          return null;
        }
      }

      function restoreState() {
        const saved = loadState();
        if (saved) {
          state.reversed = saved.reversed || false;
          if (saved.input) {
            inputEl.value = saved.input;
            processInput();
          }
          if (state.reversed) {
            const labels = document.querySelectorAll('.panel-title span:last-child');
            labels[0].textContent = '格式B';
            labels[1].textContent = '格式A';
          }
        }
      }

      // ===== 操作函数 =====
      async function paste() {
        try {
          inputEl.value = await navigator.clipboard.readText();
          processInput();
          showToast('已粘贴', 'success');
        } catch (e) {
          showToast('粘贴失败', 'error');
        }
      }

      window.copy = async function () {
        try {
          await navigator.clipboard.writeText(state.output);
          showToast('已复制', 'success');
        } catch (e) {
          showToast('复制失败', 'error');
        }
      };

      function clear() {
        inputEl.value = '';
        outputEl.textContent = '';
        state.input = state.output = '';
        updateStats();
        history.replaceState(null, '', location.pathname);
        showToast('已清空', 'success');
      }

      function share() {
        navigator.clipboard
          .writeText(location.href)
          .then(() => showToast('链接已复制', 'success'))
          .catch(() => showToast('复制失败', 'error'));
      }

      function showToast(msg, type = 'info') {
        toastEl.textContent = msg;
        toastEl.className = 'toast ' + type + ' show';
        setTimeout(() => toastEl.classList.remove('show'), 2500);
      }

      // ===== 主题 =====
      document.querySelectorAll('.theme-btn').forEach((btn) => {
        btn.addEventListener('click', () => {
          const theme = btn.dataset.theme;
          document.body.dataset.theme = theme === 'light' ? 'light' : '';
          document.querySelectorAll('.theme-btn').forEach((b) => b.classList.remove('active'));
          btn.classList.add('active');
          localStorage.setItem('theme', theme);
        });
      });

      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'light') {
        document.body.dataset.theme = 'light';
        document.querySelector('[data-theme="light"]').classList.add('active');
        document.querySelector('[data-theme="dark"]').classList.remove('active');
      }

      // ===== 事件 =====
      inputEl.addEventListener('input', processInput);
      $('pasteBtn').addEventListener('click', paste);
      $('clearBtn').addEventListener('click', clear);
      $('copyBtn').addEventListener('click', copy);
      $('shareBtn').addEventListener('click', share);
      $('swapBtn').addEventListener('click', swap);

      document.addEventListener('keydown', (e) => {
        const mod = e.metaKey || e.ctrlKey;
        if (mod && e.key === 'v' && document.activeElement !== inputEl) {
          e.preventDefault();
          paste();
        }
        if (mod && e.key === 'k') {
          e.preventDefault();
          clear();
        }
        if (mod && e.shiftKey && e.key.toLowerCase() === 'c') {
          e.preventDefault();
          copy();
        }
      });

      // ===== 初始化 =====
      restoreState();
    </script>
  </body>
</html>
