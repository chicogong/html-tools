<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>演示计时器 - WebUtils</title>
    <meta property="og:title" content="演示计时器 - WebUtils" />
    <meta property="og:description" content="演示计时器：在线实用工具，免费在线使用，无需安装" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/office/presentation-timer.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/office/presentation-timer.html" />
    <meta name="description" content="演讲/演示专用计时器，大屏倒计时显示，支持预警提醒和全屏模式" />
    <meta name="keywords" content="timer 计时器 演讲 演示 倒计时 presentation fullscreen" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-magenta: #f72585;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-blue: #4cc9f0;
        --accent-purple: #7b2cbf;
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
        --font-sans: "Space Grotesk", -apple-system, blinkmacsystemfont, "Segoe UI", roboto, sans-serif;
        --font-mono: "JetBrains Mono", "Courier New", monospace;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
        --accent-cyan: #00d4b8;
        --accent-magenta: #e63975;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }
      
      *,
      *::before,
      *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      html {
        font-size: 16px;
        -webkit-font-smoothing: antialiased;
      }
      body {
        font-family: var(--font-sans);
        background: var(--color-bg-deep);
        color: var(--color-text-primary);
        min-height: 100vh;
        min-height: 100dvh;
        line-height: 1.5;
      }
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        background: radial-gradient(circle at 20% 20%, rgba(0, 212, 170, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.03) 0%, transparent 50%);
      }
      .nav-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        height: calc(var(--nav-height) + var(--safe-area-top));
        padding-top: var(--safe-area-top);
        background: var(--glass-bg);
        backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur));
        -webkit-backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur));
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .nav-content {
        width: 100%;
        max-width: var(--container-max);
        height: var(--nav-height);
        padding: 0 var(--space-6);
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        gap: var(--space-4);
      }
      .nav-back {
        display: flex;
        align-items: center;
        gap: var(--space-1);
        color: var(--color-accent-primary);
        text-decoration: none;
        font-size: 0.9375rem;
        font-weight: 500;
        padding: var(--space-2) var(--space-1);
        margin-left: calc(var(--space-2) * -1);
        border-radius: var(--radius-sm);
        transition: all var(--transition-fast);
        justify-self: start;
      }
      .nav-back:hover {
        background: var(--color-border-subtle);
      }
      .nav-back-icon {
        width: 20px;
        height: 20px;
        stroke-width: 2.5;
      }
      .nav-title {
        font-size: 1rem;
        font-weight: 600;
        text-align: center;
        white-space: nowrap;
      }
      .nav-actions {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        justify-self: end;
      }
      .theme-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        border: none;
        border-radius: var(--radius-full);
        background: var(--color-bg-subtle);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--transition-fast);
      }
      .theme-toggle:hover {
        background: var(--color-border-strong);
        color: var(--color-text-primary);
      }
      .theme-toggle svg {
        width: 18px;
        height: 18px;
      }
      .theme-icon-dark,
      .theme-icon-light {
        display: none;
      }
      [data-theme="dark"] .theme-icon-light,
      :root:not([data-theme]) .theme-icon-light {
        display: block;
      }
      [data-theme="light"] .theme-icon-dark {
        display: block;
      }
      .main-content {
        position: relative;
        z-index: 1;
        min-height: 100vh;
        padding-top: calc(var(--nav-height) + var(--safe-area-top) + var(--space-5));
        padding-bottom: calc(var(--space-6) + var(--safe-area-bottom));
        padding-left: var(--space-6);
        padding-right: var(--space-6);
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .tool-card {
        width: 100%;
        max-width: var(--container-max);
        background: var(--glass-bg);
        backdrop-filter: saturate(var(--glass-saturate)) blur(16px);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        box-shadow: var(--shadow-lg);
        animation: fade-in-up 0.4s ease-out;
      }
      @keyframes fade-in-up {
        from {
          opacity: 0;
          transform: translateY(16px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .tool-header {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        margin-bottom: var(--space-5);
        padding-bottom: var(--space-5);
        border-bottom: 1px solid var(--color-border-subtle);
      }
      .tool-icon {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--color-accent-primary), var(--color-accent-tertiary));
        border-radius: var(--radius-md);
        font-size: 1.25rem;
      }
      .tool-info h1 {
        font-size: 1.25rem;
        font-weight: 700;
      }
      .tool-info .desc {
        font-size: 0.875rem;
        color: var(--text-muted);
        margin-top: var(--space-1);
      }

      /* Progress Bar */
      .progress-container {
        width: 100%;
        margin-bottom: var(--space-4);
      }
      .progress-bar {
        width: 100%;
        height: 8px;
        background: var(--color-bg-subtle);
        border-radius: var(--radius-full);
        overflow: hidden;
      }
      .progress-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--color-accent-primary), var(--color-accent-tertiary));
        border-radius: var(--radius-full);
        transition: width 0.3s ease, background 0.3s ease;
      }
      .progress-fill.warning {
        background: linear-gradient(90deg, var(--color-warning), #fbbf24);
      }
      .progress-fill.danger {
        background: linear-gradient(90deg, var(--color-error), #f87171);
      }
      .progress-label {
        display: flex;
        justify-content: space-between;
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-top: var(--space-1);
        font-family: var(--font-mono);
      }

      .timer-display {
        text-align: center;
        padding: var(--space-6) 0;
        border-radius: var(--radius-lg);
        transition: background-color var(--transition-normal);
      }
      .timer-display.warning-bg {
        background: rgba(245, 158, 11, 0.15);
      }
      .timer-display.danger-bg {
        background: rgba(239, 68, 68, 0.15);
      }
      .timer-time {
        font-family: var(--font-mono);
        font-size: 6rem;
        font-weight: 700;
        line-height: 1;
        color: var(--color-accent-primary);
        transition: color var(--transition-normal);
      }
      .timer-time.warning {
        color: var(--color-warning);
      }
      .timer-time.danger {
        color: var(--color-error);
        animation: pulse 1s ease-in-out infinite;
      }
      .timer-time.finished {
        color: var(--color-error);
        animation: flash 0.5s ease-in-out infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }
      @keyframes flash {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.3;
        }
      }
      .timer-status {
        font-size: 1rem;
        color: var(--text-muted);
        margin-top: var(--space-3);
      }
      .settings-section {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-4);
        align-items: center;
        justify-content: center;
        margin-bottom: var(--space-5);
        padding: var(--space-4);
        background: var(--color-bg-subtle);
        border-radius: var(--radius-md);
      }
      .setting-item {
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }
      .setting-item label {
        font-size: 0.875rem;
        color: var(--color-text-secondary);
      }
      .setting-item input[type="number"] {
        width: 80px;
        padding: var(--space-2) var(--space-3);
        font-family: var(--font-mono);
        font-size: 0.9375rem;
        background: var(--color-bg-input);
        border: 2px solid var(--color-border-default);
        border-radius: var(--radius-sm);
        color: var(--color-text-primary);
        text-align: center;
      }
      .setting-item input[type="number"]:focus {
        outline: none;
        border-color: var(--color-accent-primary);
      }
      .setting-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: var(--color-accent-primary);
        cursor: pointer;
      }
      .controls {
        display: flex;
        gap: var(--space-3);
        justify-content: center;
        flex-wrap: wrap;
      }
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        height: 52px;
        padding: 0 var(--space-6);
        font-family: var(--font-mono);
        font-size: 1rem;
        font-weight: 600;
        color: var(--color-text-secondary);
        background: var(--color-bg-subtle);
        border: none;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all var(--transition-fast);
      }
      .btn:hover {
        background: var(--color-border-strong);
        color: var(--color-text-primary);
      }
      .btn-primary {
        background: var(--color-accent-primary);
        color: var(--color-bg-deep);
        min-width: 120px;
      }
      .btn-primary:hover {
        background: #00b894;
        box-shadow: var(--shadow-glow);
      }
      .btn-danger {
        background: var(--color-error);
        color: white;
      }
      .btn-danger:hover {
        background: #dc2626;
      }
      .btn-fullscreen {
        background: var(--color-accent-secondary);
        color: white;
      }
      .btn-fullscreen:hover {
        background: #7c3aed;
      }
      .btn svg {
        width: 18px;
        height: 18px;
      }
      .quick-times {
        display: flex;
        gap: var(--space-2);
        justify-content: center;
        margin-top: var(--space-5);
        padding-top: var(--space-5);
        border-top: 1px solid var(--color-border-subtle);
      }
      .quick-btn {
        padding: var(--space-2) var(--space-4);
        font-family: var(--font-mono);
        font-size: 0.875rem;
        background: var(--color-bg-subtle);
        border: 1px solid var(--color-border-default);
        border-radius: var(--radius-sm);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--transition-fast);
      }
      .quick-btn:hover {
        border-color: var(--color-accent-primary);
        color: var(--color-accent-primary);
      }
      .footer {
        text-align: center;
        margin-top: var(--space-5);
      }
      .footer p {
        font-family: var(--font-mono);
        font-size: 0.75rem;
        color: var(--text-muted);
      }
      .footer a {
        color: var(--color-accent-primary);
        text-decoration: none;
      }

      /* Fullscreen Mode */
      .fullscreen-mode .nav-bar,
      .fullscreen-mode .tool-header,
      .fullscreen-mode .settings-section,
      .fullscreen-mode .quick-times,
      .fullscreen-mode .footer {
        display: none !important;
      }
      .fullscreen-mode .main-content {
        padding: 0;
        justify-content: center;
      }
      .fullscreen-mode .tool-card {
        max-width: 100%;
        height: 100vh;
        height: 100dvh;
        border-radius: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: var(--space-8);
      }
      .fullscreen-mode .progress-container {
        max-width: 800px;
        margin-bottom: var(--space-8);
      }
      .fullscreen-mode .progress-bar {
        height: 12px;
      }
      .fullscreen-mode .timer-display {
        padding: var(--space-8) 0;
      }
      .fullscreen-mode .timer-time {
        font-size: 12rem;
      }
      .fullscreen-mode .timer-status {
        font-size: 1.5rem;
        margin-top: var(--space-5);
      }
      .fullscreen-mode .controls {
        margin-top: var(--space-8);
      }
      .fullscreen-mode .btn {
        height: 64px;
        padding: 0 var(--space-8);
        font-size: 1.25rem;
      }
      .fullscreen-icon-enter,
      .fullscreen-icon-exit {
        display: none;
      }
      .btn-fullscreen .fullscreen-icon-enter {
        display: block;
      }
      .fullscreen-mode .btn-fullscreen .fullscreen-icon-enter {
        display: none;
      }
      .fullscreen-mode .btn-fullscreen .fullscreen-icon-exit {
        display: block;
      }
      .fullscreen-text-enter {
        display: inline;
      }
      .fullscreen-text-exit {
        display: none;
      }
      .fullscreen-mode .fullscreen-text-enter {
        display: none;
      }
      .fullscreen-mode .fullscreen-text-exit {
        display: inline;
      }

      @media (max-width: 640px) {
        .nav-content {
          padding: 0 var(--space-4);
        }
        .main-content {
          padding: calc(var(--nav-height) + var(--safe-area-top) + var(--space-4)) var(--space-4)
            calc(var(--space-5) + var(--safe-area-bottom));
        }
        .tool-card {
          padding: var(--space-4);
        }
        .timer-time {
          font-size: 3.5rem;
        }
        .settings-section {
          flex-direction: column;
        }
        .controls {
          flex-direction: column;
        }
        .btn {
          width: 100%;
        }
        .fullscreen-mode .timer-time {
          font-size: 5rem;
        }
        .fullscreen-mode .timer-status {
          font-size: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <nav class="nav-bar">
      <div class="nav-content">
        <a href="../../index.html" class="nav-back" aria-label="返回首页">
          <svg class="nav-back-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
          <span>首页</span>
        </a>
        <h1 class="nav-title">演示计时器</h1>
        <div class="nav-actions">
          <button class="theme-toggle" onclick="toggleTheme()" aria-label="切换主题">
            <svg class="theme-icon-light" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <svg class="theme-icon-dark" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>
        </div>
      </div>
    </nav>

    <main class="main-content">
      <div class="tool-card">
        <div class="tool-header">
          <div class="tool-icon">⏱️</div>
          <div class="tool-info">
            <h1>演示计时器</h1>
            <p class="desc">演讲演示专用倒计时，支持预警提醒、进度条和全屏模式</p>
          </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
          </div>
          <div class="progress-label">
            <span id="elapsedLabel">已用 00:00</span>
            <span id="totalLabel">总计 00:00</span>
          </div>
        </div>

        <div id="timerDisplay" class="timer-display">
          <div id="timerTime" class="timer-time">00:00</div>
          <div id="timerStatus" class="timer-status">设置时间开始</div>
        </div>

        <div class="settings-section">
          <div class="setting-item">
            <label for="minutes">时长 (分钟)</label>
            <input type="number" id="minutes" value="10" min="1" max="180" />
          </div>
          <div class="setting-item">
            <input type="checkbox" id="soundAlert" checked />
            <label for="soundAlert">结束音效</label>
          </div>
        </div>

        <div class="controls">
          <button id="startBtn" class="btn btn-primary" onclick="startTimer()">开始</button>
          <button id="pauseBtn" class="btn" onclick="pauseTimer()" style="display: none">暂停</button>
          <button id="resumeBtn" class="btn btn-primary" onclick="resumeTimer()" style="display: none">继续</button>
          <button class="btn btn-danger" onclick="resetTimer()">重置</button>
          <button id="fullscreenBtn" class="btn btn-fullscreen" onclick="toggleFullscreen()">
            <svg class="fullscreen-icon-enter" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="15 3 21 3 21 9"></polyline>
              <polyline points="9 21 3 21 3 15"></polyline>
              <line x1="21" y1="3" x2="14" y2="10"></line>
              <line x1="3" y1="21" x2="10" y2="14"></line>
            </svg>
            <svg class="fullscreen-icon-exit" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="4 14 10 14 10 20"></polyline>
              <polyline points="20 10 14 10 14 4"></polyline>
              <line x1="14" y1="10" x2="21" y2="3"></line>
              <line x1="3" y1="21" x2="10" y2="14"></line>
            </svg>
            <span class="fullscreen-text-enter">全屏</span>
            <span class="fullscreen-text-exit">退出全屏</span>
          </button>
        </div>

        <div class="quick-times">
          <button class="quick-btn" onclick="setQuickTime(5)">5分钟</button>
          <button class="quick-btn" onclick="setQuickTime(10)">10分钟</button>
          <button class="quick-btn" onclick="setQuickTime(15)">15分钟</button>
          <button class="quick-btn" onclick="setQuickTime(20)">20分钟</button>
          <button class="quick-btn" onclick="setQuickTime(30)">30分钟</button>
        </div>
      </div>

      <footer class="footer">
        <p>
          <a href="https://github.com/chicogong/html-tools" target="_blank">GitHub</a>
          · 纯前端 · 无服务器 ·
          <a href="../../index.html">WebUtils</a>
        </p>
      </footer>
    </main>

    <script>
      var totalSeconds = 0;
      var remainingSeconds = 0;
      var timerInterval = null;
      var isRunning = false;
      var audioContext = null;
      var isFullscreen = false;

      var timerTimeEl = document.getElementById("timerTime");
      var timerStatusEl = document.getElementById("timerStatus");
      var timerDisplayEl = document.getElementById("timerDisplay");
      var minutesEl = document.getElementById("minutes");
      var startBtn = document.getElementById("startBtn");
      var pauseBtn = document.getElementById("pauseBtn");
      var resumeBtn = document.getElementById("resumeBtn");
      var soundAlertEl = document.getElementById("soundAlert");
      var progressFillEl = document.getElementById("progressFill");
      var elapsedLabelEl = document.getElementById("elapsedLabel");
      var totalLabelEl = document.getElementById("totalLabel");
      var fullscreenBtn = document.getElementById("fullscreenBtn");

      function formatTime(seconds) {
        var mins = Math.floor(seconds / 60);
        var secs = seconds % 60;
        return String(mins).padStart(2, "0") + ":" + String(secs).padStart(2, "0");
      }

      function updateDisplay() {
        timerTimeEl.textContent = formatTime(remainingSeconds);

        // Update progress bar
        var elapsed = totalSeconds - remainingSeconds;
        var progress = totalSeconds > 0 ? (elapsed / totalSeconds) * 100 : 0;
        progressFillEl.style.width = progress + "%";
        elapsedLabelEl.textContent = "已用 " + formatTime(elapsed);
        totalLabelEl.textContent = "总计 " + formatTime(totalSeconds);

        // Reset classes
        timerTimeEl.classList.remove("warning", "danger", "finished");
        timerDisplayEl.classList.remove("warning-bg", "danger-bg");
        progressFillEl.classList.remove("warning", "danger");

        if (remainingSeconds === 0 && totalSeconds > 0) {
          timerTimeEl.classList.add("finished");
          timerDisplayEl.classList.add("danger-bg");
          progressFillEl.classList.add("danger");
          timerStatusEl.textContent = "时间到！";
        } else if (remainingSeconds <= 60 && remainingSeconds > 0) {
          timerTimeEl.classList.add("danger");
          timerDisplayEl.classList.add("danger-bg");
          progressFillEl.classList.add("danger");
          timerStatusEl.textContent = "最后 1 分钟！";
        } else if (remainingSeconds <= 300 && remainingSeconds > 0) {
          timerTimeEl.classList.add("warning");
          timerDisplayEl.classList.add("warning-bg");
          progressFillEl.classList.add("warning");
          timerStatusEl.textContent = "剩余 5 分钟";
        } else if (isRunning) {
          timerStatusEl.textContent = "进行中...";
        }
      }

      function startTimer() {
        var minutes = parseInt(minutesEl.value) || 10;
        totalSeconds = minutes * 60;
        remainingSeconds = totalSeconds;

        isRunning = true;
        startBtn.style.display = "none";
        pauseBtn.style.display = "inline-flex";
        resumeBtn.style.display = "none";
        minutesEl.disabled = true;

        updateDisplay();
        timerInterval = setInterval(tick, 1000);
      }

      function tick() {
        if (remainingSeconds > 0) {
          remainingSeconds--;
          updateDisplay();
        } else {
          clearInterval(timerInterval);
          isRunning = false;
          if (soundAlertEl.checked) {
            playAlert();
          }
        }
      }

      function pauseTimer() {
        clearInterval(timerInterval);
        isRunning = false;
        pauseBtn.style.display = "none";
        resumeBtn.style.display = "inline-flex";
        timerStatusEl.textContent = "已暂停";
      }

      function resumeTimer() {
        isRunning = true;
        pauseBtn.style.display = "inline-flex";
        resumeBtn.style.display = "none";
        timerInterval = setInterval(tick, 1000);
        updateDisplay();
      }

      function resetTimer() {
        clearInterval(timerInterval);
        isRunning = false;
        remainingSeconds = 0;
        totalSeconds = 0;

        startBtn.style.display = "inline-flex";
        pauseBtn.style.display = "none";
        resumeBtn.style.display = "none";
        minutesEl.disabled = false;

        timerTimeEl.textContent = "00:00";
        timerTimeEl.classList.remove("warning", "danger", "finished");
        timerDisplayEl.classList.remove("warning-bg", "danger-bg");
        progressFillEl.classList.remove("warning", "danger");
        progressFillEl.style.width = "0%";
        elapsedLabelEl.textContent = "已用 00:00";
        totalLabelEl.textContent = "总计 00:00";
        timerStatusEl.textContent = "设置时间开始";
      }

      function setQuickTime(minutes) {
        minutesEl.value = minutes;
        if (!isRunning) {
          timerTimeEl.textContent = formatTime(minutes * 60);
          totalLabelEl.textContent = "总计 " + formatTime(minutes * 60);
        }
      }

      function toggleFullscreen() {
        isFullscreen = !isFullscreen;
        document.body.classList.toggle("fullscreen-mode", isFullscreen);

        if (isFullscreen) {
          // Request browser fullscreen
          if (document.documentElement.requestFullscreen) {
            document.documentElement.requestFullscreen();
          } else if (document.documentElement.webkitRequestFullscreen) {
            document.documentElement.webkitRequestFullscreen();
          }
        } else {
          // Exit browser fullscreen
          if (document.exitFullscreen) {
            document.exitFullscreen();
          } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
          }
        }
      }

      // Listen for fullscreen change events (e.g., pressing Escape)
      document.addEventListener("fullscreenchange", handleFullscreenChange);
      document.addEventListener("webkitfullscreenchange", handleFullscreenChange);

      function handleFullscreenChange() {
        var isNowFullscreen = document.fullscreenElement || document.webkitFullscreenElement;
        if (!isNowFullscreen && isFullscreen) {
          isFullscreen = false;
          document.body.classList.remove("fullscreen-mode");
        }
      }

      function playAlert() {
        try {
          if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
          }

          // Resume audio context if suspended (required by browsers)
          if (audioContext.state === "suspended") {
            audioContext.resume();
          }

          var oscillator = audioContext.createOscillator();
          var gainNode = audioContext.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);

          oscillator.frequency.value = 880;
          oscillator.type = "sine";

          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.5);

          setTimeout(function () {
            var osc2 = audioContext.createOscillator();
            var gain2 = audioContext.createGain();
            osc2.connect(gain2);
            gain2.connect(audioContext.destination);
            osc2.frequency.value = 880;
            osc2.type = "sine";
            gain2.gain.setValueAtTime(0.3, audioContext.currentTime);
            gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            osc2.start(audioContext.currentTime);
            osc2.stop(audioContext.currentTime + 0.5);
          }, 600);

          setTimeout(function () {
            var osc3 = audioContext.createOscillator();
            var gain3 = audioContext.createGain();
            osc3.connect(gain3);
            gain3.connect(audioContext.destination);
            osc3.frequency.value = 1100;
            osc3.type = "sine";
            gain3.gain.setValueAtTime(0.3, audioContext.currentTime);
            gain3.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
            osc3.start(audioContext.currentTime);
            osc3.stop(audioContext.currentTime + 0.8);
          }, 1200);
        } catch (e) {
          console.log("Audio not supported");
        }
      }

      window.toggleTheme = function () {
        var html = document.documentElement;
        var currentTheme = html.getAttribute("data-theme") || "dark";
        var newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      };

      function initTheme() {
        var savedTheme = localStorage.getItem("theme");
        var prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        var theme = savedTheme || (prefersDark ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", theme);
      }

      document.addEventListener("keydown", function (e) {
        if (e.code === "Space" && e.target.tagName !== "INPUT") {
          e.preventDefault();
          if (!isRunning && remainingSeconds === 0) {
            startTimer();
          } else if (isRunning) {
            pauseTimer();
          } else {
            resumeTimer();
          }
        } else if (e.code === "Escape") {
          if (isFullscreen) {
            toggleFullscreen();
          } else {
            resetTimer();
          }
        } else if (e.code === "KeyF") {
          toggleFullscreen();
        }
      });

      initTheme();
    </script>
  </body>
</html>
