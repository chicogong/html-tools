<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ—¥æœŸè®¡ç®—å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="è®¡ç®—æ—¥æœŸå·®å¼‚ã€æ—¥æœŸæ¨ç®—ã€å·¥ä½œæ—¥ç»Ÿè®¡" />
    <meta name="keywords" content="æ—¥æœŸ è®¡ç®— å·¥ä½œæ—¥ å¤©æ•°å·®" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/time/date-calculator.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="æ—¥æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta property="og:description" content="è®¡ç®—æ—¥æœŸå·®å¼‚ã€æ—¥æœŸæ¨ç®—ã€å·¥ä½œæ—¥ç»Ÿè®¡" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/time/date-calculator.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="æ—¥æœŸè®¡ç®—å™¨ - WebUtils" />
    <meta name="twitter:description" content="è®¡ç®—æ—¥æœŸå·®å¼‚ã€æ—¥æœŸæ¨ç®—ã€å·¥ä½œæ—¥ç»Ÿè®¡" />
    <!-- OG Image -->
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <style>
      :root {
        --bg-deep: #1a1a2e;
        --bg-surface: #16213e;
        --bg-card: rgb(255, 255, 255, 0.05);
        --text-primary: #e8e8e8;
        --text-secondary: #888;
        --text-muted: #666;
        --border-subtle: rgb(255, 255, 255, 0.1);
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border-subtle);
        background: var(--bg-card);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        min-height: 100vh;
        color: #e8e8e8;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 2rem;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        color: #888;
        font-size: 0.95rem;
      }

      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        justify-content: center;
      }

      .tab {
        padding: 12px 24px;
        background: rgb(255, 255, 255, 0.05);
        border: 1px solid rgb(255, 255, 255, 0.1);
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.95rem;
      }

      .tab:hover {
        background: rgb(255, 255, 255, 0.1);
      }

      .tab.active {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        border-color: transparent;
        color: white;
      }

      .panel {
        background: rgb(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 25px;
        border: 1px solid rgb(255, 255, 255, 0.1);
        display: none;
      }

      .panel.active {
        display: block;
      }

      .section-title {
        font-size: 1.1rem;
        color: #2ecc71;
        margin-bottom: 20px;
      }

      .input-row {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
        align-items: flex-end;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .input-group label {
        font-size: 0.85rem;
        color: #888;
      }

      input[type="date"],
      input[type="number"],
      select {
        background: rgb(0, 0, 0, 0.3);
        border: 1px solid rgb(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 12px 15px;
        color: #e8e8e8;
        font-size: 1rem;
        min-width: 150px;
      }

      input[type="date"]:focus,
      input[type="number"]:focus,
      select:focus {
        outline: none;
        border-color: #2ecc71;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgb(46, 204, 113, 0.4);
      }

      .btn-secondary {
        background: rgb(255, 255, 255, 0.1);
        color: #e8e8e8;
        border: 1px solid rgb(255, 255, 255, 0.2);
      }

      .result-section {
        margin-top: 25px;
        padding-top: 25px;
        border-top: 1px solid rgb(255, 255, 255, 0.1);
      }

      .result-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
      }

      .result-card {
        background: rgb(0, 0, 0, 0.2);
        border-radius: 10px;
        padding: 20px;
        text-align: center;
      }

      .result-value {
        font-size: 2rem;
        font-weight: 300;
        color: #2ecc71;
        margin-bottom: 5px;
      }

      .result-label {
        font-size: 0.85rem;
        color: #888;
      }

      .result-detail {
        background: rgb(46, 204, 113, 0.1);
        border: 1px solid rgb(46, 204, 113, 0.2);
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
      }

      .result-detail-title {
        font-size: 1rem;
        color: #2ecc71;
        margin-bottom: 10px;
      }

      .result-detail-text {
        font-size: 1.2rem;
        color: #e8e8e8;
      }

      .quick-dates {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-bottom: 20px;
      }

      .quick-date {
        padding: 6px 12px;
        background: rgb(46, 204, 113, 0.2);
        border: 1px solid rgb(46, 204, 113, 0.3);
        border-radius: 20px;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .quick-date:hover {
        background: rgb(46, 204, 113, 0.3);
      }

      .info-text {
        font-size: 0.85rem;
        color: #888;
        margin-top: 10px;
      }

      footer {
        text-align: center;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid rgb(255, 255, 255, 0.1);
        color: #666;
        font-size: 0.85rem;
      }

      footer a {
        color: #2ecc71;
        text-decoration: none;
      }

      footer a:hover {
        text-decoration: underline;
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      æ—¥æœŸè®¡ç®—å™¨
    </nav>
    <div class="container">
      <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
      <header>
        <h1>æ—¥æœŸè®¡ç®—å™¨</h1>
        <p class="subtitle">è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å·®å¼‚ï¼Œæˆ–æ¨ç®—æŒ‡å®šå¤©æ•°åçš„æ—¥æœŸ</p>
      </header>

      <div class="tabs">
        <div class="tab active" data-tab="diff" onclick="switchTab('diff')">æ—¥æœŸå·®è®¡ç®—</div>
        <div class="tab" data-tab="add" onclick="switchTab('add')">æ—¥æœŸæ¨ç®—</div>
        <div class="tab" data-tab="workdays" onclick="switchTab('workdays')">å·¥ä½œæ—¥è®¡ç®—</div>
      </div>

      <!-- æ—¥æœŸå·®è®¡ç®— -->
      <div class="panel active" id="panel-diff">
        <div class="section-title">è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å·®å¼‚</div>
        <div class="quick-dates">
          <span class="quick-date" onclick="setQuickDate('diff', 'today')">ä»Šå¤©</span>
          <span class="quick-date" onclick="setQuickDate('diff', 'year-start')">æœ¬å¹´åˆ</span>
          <span class="quick-date" onclick="setQuickDate('diff', 'year-end')">æœ¬å¹´æœ«</span>
          <span class="quick-date" onclick="setQuickDate('diff', 'birthday')">ç”Ÿæ—¥è®¡ç®—</span>
        </div>
        <div class="input-row">
          <div class="input-group">
            <label>å¼€å§‹æ—¥æœŸ</label>
            <input type="date" id="diffStart" />
          </div>
          <div class="input-group">
            <label>ç»“æŸæ—¥æœŸ</label>
            <input type="date" id="diffEnd" />
          </div>
          <button class="btn btn-primary" onclick="calculateDiff()">è®¡ç®—</button>
          <button class="btn btn-secondary" onclick="swapDates()">äº¤æ¢æ—¥æœŸ</button>
        </div>
        <div class="result-section" id="diffResult" style="display: none">
          <div class="result-grid">
            <div class="result-card">
              <div class="result-value" id="diffDays">0</div>
              <div class="result-label">å¤©</div>
            </div>
            <div class="result-card">
              <div class="result-value" id="diffWeeks">0</div>
              <div class="result-label">å‘¨</div>
            </div>
            <div class="result-card">
              <div class="result-value" id="diffMonths">0</div>
              <div class="result-label">æœˆ</div>
            </div>
            <div class="result-card">
              <div class="result-value" id="diffYears">0</div>
              <div class="result-label">å¹´</div>
            </div>
          </div>
          <div class="result-detail">
            <div class="result-detail-title">è¯¦ç»†ç»“æœ</div>
            <div class="result-detail-text" id="diffDetail"></div>
          </div>
        </div>
      </div>

      <!-- æ—¥æœŸæ¨ç®— -->
      <div class="panel" id="panel-add">
        <div class="section-title">ä»æŒ‡å®šæ—¥æœŸæ¨ç®—</div>
        <div class="quick-dates">
          <span class="quick-date" onclick="setAddDays(7)">+1å‘¨</span>
          <span class="quick-date" onclick="setAddDays(14)">+2å‘¨</span>
          <span class="quick-date" onclick="setAddDays(30)">+30å¤©</span>
          <span class="quick-date" onclick="setAddDays(90)">+90å¤©</span>
          <span class="quick-date" onclick="setAddDays(365)">+1å¹´</span>
          <span class="quick-date" onclick="setAddDays(-7)">-1å‘¨</span>
          <span class="quick-date" onclick="setAddDays(-30)">-30å¤©</span>
        </div>
        <div class="input-row">
          <div class="input-group">
            <label>èµ·å§‹æ—¥æœŸ</label>
            <input type="date" id="addStart" />
          </div>
          <div class="input-group">
            <label>å¤©æ•°</label>
            <input type="number" id="addDays" value="30" />
          </div>
          <button class="btn btn-primary" onclick="calculateAdd()">è®¡ç®—</button>
          <button class="btn btn-secondary" onclick="setToday('addStart')">ä½¿ç”¨ä»Šå¤©</button>
        </div>
        <div class="result-section" id="addResult" style="display: none">
          <div class="result-detail">
            <div class="result-detail-title">è®¡ç®—ç»“æœ</div>
            <div class="result-detail-text" id="addDetail"></div>
          </div>
        </div>
      </div>

      <!-- å·¥ä½œæ—¥è®¡ç®— -->
      <div class="panel" id="panel-workdays">
        <div class="section-title">è®¡ç®—å·¥ä½œæ—¥ï¼ˆæ’é™¤å‘¨æœ«ï¼‰</div>
        <div class="input-row">
          <div class="input-group">
            <label>å¼€å§‹æ—¥æœŸ</label>
            <input type="date" id="workStart" />
          </div>
          <div class="input-group">
            <label>ç»“æŸæ—¥æœŸ</label>
            <input type="date" id="workEnd" />
          </div>
          <button class="btn btn-primary" onclick="calculateWorkdays()">è®¡ç®—å·¥ä½œæ—¥</button>
        </div>
        <div class="info-text">æ³¨ï¼šä»…æ’é™¤å‘¨æœ«ï¼ˆå‘¨å…­ã€å‘¨æ—¥ï¼‰ï¼Œä¸è€ƒè™‘æ³•å®šèŠ‚å‡æ—¥</div>
        <div class="result-section" id="workResult" style="display: none">
          <div class="result-grid">
            <div class="result-card">
              <div class="result-value" id="workDays">0</div>
              <div class="result-label">å·¥ä½œæ—¥</div>
            </div>
            <div class="result-card">
              <div class="result-value" id="weekendDays">0</div>
              <div class="result-label">å‘¨æœ«å¤©æ•°</div>
            </div>
            <div class="result-card">
              <div class="result-value" id="totalDays">0</div>
              <div class="result-label">æ€»å¤©æ•°</div>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <a href="../../index.html">è¿”å›å·¥å…·åˆ—è¡¨</a>
        Â·
        <a
          href="https://github.com/chicogong/html-tools/blob/master/tools/date-calculator.html"
          target="_blank"
        >
          æŸ¥çœ‹æºä»£ç 
        </a>
      </footer>
    </div>

    <script>
      var diffStart = document.getElementById("diffStart");
      var diffEnd = document.getElementById("diffEnd");
      var addStart = document.getElementById("addStart");
      var addDays = document.getElementById("addDays");
      var workStart = document.getElementById("workStart");
      var workEnd = document.getElementById("workEnd");

      // åˆ‡æ¢æ ‡ç­¾
      window.switchTab = function (tabName) {
        document.querySelectorAll(".tab").forEach(function (tab) {
          tab.classList.remove("active");
        });
        document.querySelectorAll(".panel").forEach(function (panel) {
          panel.classList.remove("active");
        });

        document.querySelector('.tab[data-tab="' + tabName + '"]').classList.add("active");
        document.getElementById("panel-" + tabName).classList.add("active");
      };

      // æ ¼å¼åŒ–æ—¥æœŸä¸º YYYY-MM-DD
      function formatDate(date) {
        var year = date.getFullYear();
        var month = String(date.getMonth() + 1).padStart(2, "0");
        var day = String(date.getDate()).padStart(2, "0");
        return year + "-" + month + "-" + day;
      }

      // æ ¼å¼åŒ–æ—¥æœŸä¸ºä¸­æ–‡
      function formatDateCN(date) {
        return (
          date.getFullYear() +
          "å¹´" +
          (date.getMonth() + 1) +
          "æœˆ" +
          date.getDate() +
          "æ—¥ " +
          ["å‘¨æ—¥", "å‘¨ä¸€", "å‘¨äºŒ", "å‘¨ä¸‰", "å‘¨å››", "å‘¨äº”", "å‘¨å…­"][date.getDay()]
        );
      }

      // è®¾ç½®ä»Šå¤©
      window.setToday = function (inputId) {
        document.getElementById(inputId).value = formatDate(new Date());
      };

      // å¿«é€Ÿæ—¥æœŸè®¾ç½®
      window.setQuickDate = function (mode, type) {
        var today = new Date();
        var year = today.getFullYear();

        if (type === "today") {
          diffStart.value = formatDate(today);
          diffEnd.value = formatDate(today);
        } else if (type === "year-start") {
          diffStart.value = year + "-01-01";
          diffEnd.value = formatDate(today);
        } else if (type === "year-end") {
          diffStart.value = formatDate(today);
          diffEnd.value = year + "-12-31";
        } else if (type === "birthday") {
          diffEnd.value = formatDate(today);
        }

        calculateDiff();
      };

      // è®¾ç½®æ¨ç®—å¤©æ•°
      window.setAddDays = function (days) {
        addDays.value = days;
        if (!addStart.value) {
          addStart.value = formatDate(new Date());
        }
        calculateAdd();
      };

      // äº¤æ¢æ—¥æœŸ
      window.swapDates = function () {
        var temp = diffStart.value;
        diffStart.value = diffEnd.value;
        diffEnd.value = temp;
        calculateDiff();
      };

      // è®¡ç®—æ—¥æœŸå·®
      function calculateDiff() {
        var start = new Date(diffStart.value);
        var end = new Date(diffEnd.value);

        if (isNaN(start.getTime()) || isNaN(end.getTime())) {
          return;
        }

        var diffTime = Math.abs(end - start);
        var diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        var diffWeeks = Math.floor(diffDays / 7);

        // è®¡ç®—æœˆä»½å’Œå¹´ä»½å·®å¼‚
        var years = end.getFullYear() - start.getFullYear();
        var months = end.getMonth() - start.getMonth();
        var days = end.getDate() - start.getDate();

        if (days < 0) {
          months--;
          var prevMonth = new Date(end.getFullYear(), end.getMonth(), 0);
          days += prevMonth.getDate();
        }
        if (months < 0) {
          years--;
          months += 12;
        }

        document.getElementById("diffDays").textContent = diffDays;
        document.getElementById("diffWeeks").textContent = diffWeeks;
        document.getElementById("diffMonths").textContent = years * 12 + months;
        document.getElementById("diffYears").textContent = (diffDays / 365).toFixed(2);

        var detail = formatDateCN(start) + " åˆ° " + formatDateCN(end) + "ï¼š";
        if (years > 0) {
          detail += years + "å¹´";
        }
        if (months > 0) {
          detail += months + "ä¸ªæœˆ";
        }
        if (days > 0) {
          detail += days + "å¤©";
        }
        if (years === 0 && months === 0 && days === 0) {
          detail += "åŒä¸€å¤©";
        }

        document.getElementById("diffDetail").textContent = detail;
        document.getElementById("diffResult").style.display = "block";

        saveState();
      }

      // è®¡ç®—æ—¥æœŸæ¨ç®—
      function calculateAdd() {
        var start = new Date(addStart.value);
        var days = parseInt(addDays.value);

        if (isNaN(start.getTime()) || isNaN(days)) {
          return;
        }

        var result = new Date(start);
        result.setDate(result.getDate() + days);

        var direction = days >= 0 ? "å" : "å‰";
        var detail =
          formatDateCN(start) +
          " " +
          direction +
          " " +
          Math.abs(days) +
          " å¤©æ˜¯ï¼š" +
          formatDateCN(result);

        document.getElementById("addDetail").textContent = detail;
        document.getElementById("addResult").style.display = "block";

        saveState();
      }

      // è®¡ç®—å·¥ä½œæ—¥
      function calculateWorkdays() {
        var start = new Date(workStart.value);
        var end = new Date(workEnd.value);

        if (isNaN(start.getTime()) || isNaN(end.getTime())) {
          return;
        }

        // ç¡®ä¿ start <= end
        if (start > end) {
          var temp = start;
          start = end;
          end = temp;
        }

        var workdays = 0;
        var weekends = 0;
        var current = new Date(start);

        while (current <= end) {
          var dayOfWeek = current.getDay();
          if (dayOfWeek === 0 || dayOfWeek === 6) {
            weekends++;
          } else {
            workdays++;
          }
          current.setDate(current.getDate() + 1);
        }

        var total = workdays + weekends;

        document.getElementById("workDays").textContent = workdays;
        document.getElementById("weekendDays").textContent = weekends;
        document.getElementById("totalDays").textContent = total;
        document.getElementById("workResult").style.display = "block";

        saveState();
      }

      // URL çŠ¶æ€æŒä¹…åŒ–
      function saveState() {
        var state = {
          tab: document.querySelector(".tab.active").dataset.tab,
          diffStart: diffStart.value,
          diffEnd: diffEnd.value,
          addStart: addStart.value,
          addDays: addDays.value,
          workStart: workStart.value,
          workEnd: workEnd.value
        };
        try {
          var hash = btoa(encodeURIComponent(JSON.stringify(state)));
          history.replaceState(null, "", "#" + hash);
        } catch (e) {
          console.error("ä¿å­˜çŠ¶æ€å¤±è´¥:", e);
        }
      }

      function loadState() {
        var hash = window.location.hash.slice(1);
        if (hash) {
          try {
            var state = JSON.parse(decodeURIComponent(atob(hash)));
            if (state.tab) switchTab(state.tab);
            if (state.diffStart) diffStart.value = state.diffStart;
            if (state.diffEnd) diffEnd.value = state.diffEnd;
            if (state.addStart) addStart.value = state.addStart;
            if (state.addDays) addDays.value = state.addDays;
            if (state.workStart) workStart.value = state.workStart;
            if (state.workEnd) workEnd.value = state.workEnd;

            // é‡æ–°è®¡ç®—
            if (state.diffStart && state.diffEnd) calculateDiff();
            if (state.addStart && state.addDays) calculateAdd();
            if (state.workStart && state.workEnd) calculateWorkdays();
          } catch (e) {
            console.error("åŠ è½½çŠ¶æ€å¤±è´¥:", e);
            initDefaults();
          }
        } else {
          initDefaults();
        }
      }

      // åˆå§‹åŒ–é»˜è®¤å€¼
      function initDefaults() {
        var today = formatDate(new Date());
        diffStart.value = today;
        diffEnd.value = today;
        addStart.value = today;
        workStart.value = today;
        workEnd.value = today;
      }

      // åˆå§‹åŒ–
      loadState();

      window.toggleTheme = function () {
        const html = document.documentElement;
        const btn = document.querySelector(".theme-toggle");
        const next = html.getAttribute("data-theme") === "light" ? "dark" : "light";
        html.setAttribute("data-theme", next);
        btn.textContent = next === "light" ? "â˜€ï¸" : "ğŸŒ™";
        localStorage.setItem("theme", next);
      };

      (function () {
        const saved = localStorage.getItem("theme");
        if (saved) {
          document.documentElement.setAttribute("data-theme", saved);
          const btn = document.querySelector(".theme-toggle");
          if (btn) btn.textContent = saved === "light" ? "â˜€ï¸" : "ğŸŒ™";
        }
      })();
    </script>
  </body>
</html>
