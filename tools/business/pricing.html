<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®šä»·ç­–ç•¥è®¡ç®—å™¨ - WebUtils</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #6366f1; --accent2: #8b5cf6; --green: #10b981; --orange: #f59e0b; }
        @media (prefers-color-scheme: light) {
            :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #1a1a1a; --text2: #666; }
        }
        [data-theme="light"] { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #1a1a1a; --text2: #666; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 16px; }
        .card-title { font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input, select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus, select:focus { outline: none; border-color: var(--accent); }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.2s; }
        .btn-primary { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; width: 100%; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4); }
        .strategy-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; }
        .strategy-card { background: var(--bg); border: 2px solid var(--border); border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.2s; }
        .strategy-card.active { border-color: var(--accent); background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1)); }
        .strategy-card:hover { border-color: var(--accent); }
        .strategy-icon { font-size: 2rem; margin-bottom: 8px; }
        .strategy-name { font-weight: 600; margin-bottom: 8px; }
        .strategy-desc { font-size: 0.85rem; color: var(--text2); }
        .price-result { background: linear-gradient(135deg, var(--accent), var(--accent2)); border-radius: 12px; padding: 24px; color: white; text-align: center; margin-bottom: 16px; }
        .price-label { font-size: 0.9rem; opacity: 0.9; margin-bottom: 8px; }
        .price-value { font-size: 3rem; font-weight: 700; }
        .price-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
        .price-option { background: var(--bg); border-radius: 12px; padding: 20px; text-align: center; }
        .price-option-name { font-size: 0.9rem; color: var(--text2); margin-bottom: 8px; }
        .price-option-value { font-size: 1.5rem; font-weight: 700; color: var(--accent); }
        .price-option-margin { font-size: 0.85rem; color: var(--green); margin-top: 4px; }
        .analysis { margin-top: 16px; padding: 16px; background: var(--bg); border-radius: 8px; }
        .analysis-title { font-weight: 600; margin-bottom: 8px; color: var(--orange); }
        .analysis-text { font-size: 0.9rem; color: var(--text2); line-height: 1.8; }
        .hidden { display: none; }
        .theme-toggle { position: fixed; top: 16px; right: 16px; background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; cursor: pointer; font-size: 1.2rem; z-index: 100; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">â† è¿”å›</a>
        <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
        <h1>ğŸ’° å®šä»·ç­–ç•¥è®¡ç®—å™¨</h1>
        <p class="subtitle">æ ¹æ®ä¸åŒç­–ç•¥è®¡ç®—æœ€ä¼˜å®šä»·æ–¹æ¡ˆ</p>

        <div class="card">
            <div class="card-title">ğŸ“¦ äº§å“æˆæœ¬</div>
            <div class="grid">
                <div class="form-group">
                    <label>å•ä½æˆæœ¬ (å…ƒ)</label>
                    <input type="number" id="unitCost" value="80" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label>ç›®æ ‡åˆ©æ¶¦ç‡ (%)</label>
                    <input type="number" id="targetMargin" value="30" min="0" max="100">
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">ğŸ“Š å¸‚åœºä¿¡æ¯</div>
            <div class="grid">
                <div class="form-group">
                    <label>ç«å“æœ€ä½ä»· (å…ƒ)</label>
                    <input type="number" id="competitorLow" value="100" min="0">
                </div>
                <div class="form-group">
                    <label>ç«å“æœ€é«˜ä»· (å…ƒ)</label>
                    <input type="number" id="competitorHigh" value="150" min="0">
                </div>
                <div class="form-group">
                    <label>å¸‚åœºå‡ä»· (å…ƒ)</label>
                    <input type="number" id="marketAvg" value="120" min="0">
                </div>
                <div class="form-group">
                    <label>é¡¾å®¢å¿ƒç†ä»·ä½ (å…ƒ)</label>
                    <input type="number" id="customerExpect" value="99" min="0">
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">ğŸ¯ é€‰æ‹©å®šä»·ç­–ç•¥</div>
            <div class="strategy-cards">
                <div class="strategy-card active" data-strategy="cost" onclick="selectStrategy('cost')">
                    <div class="strategy-icon">ğŸ§®</div>
                    <div class="strategy-name">æˆæœ¬åŠ æˆå®šä»·</div>
                    <div class="strategy-desc">åŸºäºæˆæœ¬åŠ ä¸Šç›®æ ‡åˆ©æ¶¦ç‡</div>
                </div>
                <div class="strategy-card" data-strategy="competition" onclick="selectStrategy('competition')">
                    <div class="strategy-icon">âš”ï¸</div>
                    <div class="strategy-name">ç«äº‰å¯¼å‘å®šä»·</div>
                    <div class="strategy-desc">å‚è€ƒç«å“ä»·æ ¼åŒºé—´å®šä»·</div>
                </div>
                <div class="strategy-card" data-strategy="value" onclick="selectStrategy('value')">
                    <div class="strategy-icon">ğŸ’</div>
                    <div class="strategy-name">ä»·å€¼å¯¼å‘å®šä»·</div>
                    <div class="strategy-desc">åŸºäºé¡¾å®¢æ„ŸçŸ¥ä»·å€¼å®šä»·</div>
                </div>
                <div class="strategy-card" data-strategy="psychological" onclick="selectStrategy('psychological')">
                    <div class="strategy-icon">ğŸ§ </div>
                    <div class="strategy-name">å¿ƒç†å®šä»·</div>
                    <div class="strategy-desc">è¿ç”¨ä»·æ ¼å¿ƒç†å­¦æŠ€å·§</div>
                </div>
            </div>
            <button class="btn btn-primary" style="margin-top: 16px;" onclick="calculate()">è®¡ç®—å®šä»·</button>
        </div>

        <div id="resultSection" class="hidden">
            <div class="price-result">
                <div class="price-label">æ¨èå®šä»·</div>
                <div class="price-value" id="recommendedPrice"></div>
            </div>

            <div class="card">
                <div class="card-title">ğŸ“ˆ ä»·æ ¼æ–¹æ¡ˆå¯¹æ¯”</div>
                <div class="price-grid">
                    <div class="price-option">
                        <div class="price-option-name">ä½ä»·ç­–ç•¥</div>
                        <div class="price-option-value" id="lowPrice"></div>
                        <div class="price-option-margin" id="lowMargin"></div>
                    </div>
                    <div class="price-option">
                        <div class="price-option-name">ä¸­ä»·ç­–ç•¥</div>
                        <div class="price-option-value" id="midPrice"></div>
                        <div class="price-option-margin" id="midMargin"></div>
                    </div>
                    <div class="price-option">
                        <div class="price-option-name">é«˜ä»·ç­–ç•¥</div>
                        <div class="price-option-value" id="highPrice"></div>
                        <div class="price-option-margin" id="highMargin"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ğŸ“Š å®šä»·åˆ†æ</div>
                <div class="grid">
                    <div class="form-group">
                        <label style="color: var(--text);">å®é™…åˆ©æ¶¦ç‡</label>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--green);" id="actualMargin"></div>
                    </div>
                    <div class="form-group">
                        <label style="color: var(--text);">å•ä½åˆ©æ¶¦</label>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent);" id="unitProfit"></div>
                    </div>
                    <div class="form-group">
                        <label style="color: var(--text);">ç›¸å¯¹å¸‚åœºå‡ä»·</label>
                        <div style="font-size: 1.5rem; font-weight: 700;" id="vsMarket"></div>
                    </div>
                    <div class="form-group">
                        <label style="color: var(--text);">ä»·æ ¼ç«äº‰åŠ›</label>
                        <div style="font-size: 1.5rem; font-weight: 700;" id="competitiveness"></div>
                    </div>
                </div>

                <div class="analysis">
                    <div class="analysis-title">ğŸ’¡ å®šä»·å»ºè®®</div>
                    <div class="analysis-text" id="analysisText"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleTheme() {
            var theme = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        }
        (function() {
            var saved = localStorage.getItem('theme');
            if (saved) {
                document.body.setAttribute('data-theme', saved);
            } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
                document.body.setAttribute('data-theme', 'light');
            }
        })();

        var selectedStrategy = 'cost';

        function selectStrategy(strategy) {
            selectedStrategy = strategy;
            var cards = document.querySelectorAll('.strategy-card');
            cards.forEach(function(card) {
                card.classList.remove('active');
                if (card.dataset.strategy === strategy) {
                    card.classList.add('active');
                }
            });
        }

        function formatPrice(num) {
            return 'Â¥' + num.toFixed(2);
        }

        function psychologicalPrice(price) {
            if (price < 10) return Math.floor(price) - 0.1 + 0.9;
            if (price < 100) return Math.floor(price / 10) * 10 + 9;
            if (price < 1000) return Math.floor(price / 100) * 100 + 99;
            return Math.floor(price / 1000) * 1000 + 999;
        }

        function calculate() {
            var unitCost = parseFloat(document.getElementById('unitCost').value) || 0;
            var targetMargin = parseFloat(document.getElementById('targetMargin').value) / 100 || 0.3;
            var competitorLow = parseFloat(document.getElementById('competitorLow').value) || 0;
            var competitorHigh = parseFloat(document.getElementById('competitorHigh').value) || 0;
            var marketAvg = parseFloat(document.getElementById('marketAvg').value) || 0;
            var customerExpect = parseFloat(document.getElementById('customerExpect').value) || 0;

            var recommendedPrice = 0;
            var analysis = '';

            switch (selectedStrategy) {
                case 'cost':
                    recommendedPrice = unitCost / (1 - targetMargin);
                    analysis = 'æˆæœ¬åŠ æˆå®šä»·æ³•ä»¥æˆæœ¬ä¸ºåŸºç¡€ï¼ŒåŠ ä¸Šé¢„æœŸåˆ©æ¶¦æ¥ç¡®å®šä»·æ ¼ã€‚å½“å‰æˆæœ¬ ' + formatPrice(unitCost) + 'ï¼Œç›®æ ‡åˆ©æ¶¦ç‡ ' + (targetMargin * 100).toFixed(0) + '%ï¼Œå»ºè®®å®šä»· ' + formatPrice(recommendedPrice) + 'ã€‚æ­¤æ–¹æ³•ç®€å•ç›´æ¥ï¼Œä½†éœ€å…³æ³¨å¸‚åœºæ¥å—åº¦ã€‚';
                    break;
                case 'competition':
                    recommendedPrice = (competitorLow + competitorHigh) / 2;
                    analysis = 'ç«äº‰å¯¼å‘å®šä»·å‚è€ƒå¸‚åœºç«å“ä»·æ ¼ã€‚å½“å‰ç«å“ä»·æ ¼åŒºé—´ ' + formatPrice(competitorLow) + ' - ' + formatPrice(competitorHigh) + 'ï¼Œå»ºè®®å®šä»·åœ¨åŒºé—´ä¸­ä½ã€‚å¯æ ¹æ®äº§å“å·®å¼‚åŒ–ç¨‹åº¦è°ƒæ•´ï¼Œå·®å¼‚åŒ–é«˜å¯å®šä»·åä¸Šï¼ŒåŒè´¨åŒ–ä¸¥é‡åˆ™åä¸‹ã€‚';
                    break;
                case 'value':
                    recommendedPrice = customerExpect * 1.1;
                    analysis = 'ä»·å€¼å¯¼å‘å®šä»·ä»¥é¡¾å®¢æ„ŸçŸ¥ä»·å€¼ä¸ºåŸºç¡€ã€‚é¡¾å®¢å¿ƒç†ä»·ä½ ' + formatPrice(customerExpect) + 'ï¼Œå»ºè®®ç•¥é«˜äºå¿ƒç†ä»·ä½å®šä»·ï¼Œä½“ç°äº§å“ä»·å€¼ã€‚åŒæ—¶éœ€è¦åŠ å¼ºä»·å€¼ä¼ è¾¾ï¼Œè®©é¡¾å®¢è®¤å¯äº§å“å€¼è¿™ä¸ªä»·ã€‚';
                    break;
                case 'psychological':
                    recommendedPrice = psychologicalPrice(unitCost / (1 - targetMargin));
                    analysis = 'å¿ƒç†å®šä»·è¿ç”¨æ¶ˆè´¹å¿ƒç†å­¦åŸç†ã€‚ä»·æ ¼å°¾æ•°ä¸º9ä¼šè®©é¡¾å®¢æ„Ÿè§‰æ›´ä¾¿å®œã€‚ä¾‹å¦‚99å…ƒæ¯”100å…ƒæ›´æœ‰å¸å¼•åŠ›ã€‚å»ºè®®é…åˆä¿ƒé”€æ ‡è¯­å¦‚"ä¸åˆ°ç™¾å…ƒ"ç­‰å¢å¼ºæ•ˆæœã€‚';
                    break;
            }

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultSection').classList.remove('hidden');
            document.getElementById('recommendedPrice').textContent = formatPrice(recommendedPrice);

            // ä¸‰æ¡£ä»·æ ¼
            var lowPrice = Math.max(unitCost * 1.1, competitorLow * 0.95);
            var midPrice = recommendedPrice;
            var highPrice = Math.min(unitCost * 2, competitorHigh * 1.05);

            document.getElementById('lowPrice').textContent = formatPrice(lowPrice);
            document.getElementById('midPrice').textContent = formatPrice(midPrice);
            document.getElementById('highPrice').textContent = formatPrice(highPrice);

            var lowMarginPct = ((lowPrice - unitCost) / lowPrice * 100).toFixed(1);
            var midMarginPct = ((midPrice - unitCost) / midPrice * 100).toFixed(1);
            var highMarginPct = ((highPrice - unitCost) / highPrice * 100).toFixed(1);

            document.getElementById('lowMargin').textContent = 'åˆ©æ¶¦ç‡ ' + lowMarginPct + '%';
            document.getElementById('midMargin').textContent = 'åˆ©æ¶¦ç‡ ' + midMarginPct + '%';
            document.getElementById('highMargin').textContent = 'åˆ©æ¶¦ç‡ ' + highMarginPct + '%';

            // åˆ†ææ•°æ®
            var actualMargin = (recommendedPrice - unitCost) / recommendedPrice * 100;
            var unitProfit = recommendedPrice - unitCost;
            var vsMarket = ((recommendedPrice - marketAvg) / marketAvg * 100);
            
            document.getElementById('actualMargin').textContent = actualMargin.toFixed(1) + '%';
            document.getElementById('unitProfit').textContent = formatPrice(unitProfit);
            
            var vsMarketEl = document.getElementById('vsMarket');
            vsMarketEl.textContent = (vsMarket >= 0 ? '+' : '') + vsMarket.toFixed(1) + '%';
            vsMarketEl.style.color = vsMarket > 10 ? 'var(--orange)' : vsMarket < -10 ? 'var(--green)' : 'var(--accent)';

            var competitiveness = '';
            if (recommendedPrice < competitorLow) {
                competitiveness = 'ä»·æ ¼ä¼˜åŠ¿';
                document.getElementById('competitiveness').style.color = 'var(--green)';
            } else if (recommendedPrice > competitorHigh) {
                competitiveness = 'é«˜ç«¯å®šä½';
                document.getElementById('competitiveness').style.color = 'var(--orange)';
            } else {
                competitiveness = 'ä¸­ç­‰æ°´å¹³';
                document.getElementById('competitiveness').style.color = 'var(--accent)';
            }
            document.getElementById('competitiveness').textContent = competitiveness;

            document.getElementById('analysisText').textContent = analysis;
        }

        calculate();
    </script>
</body>
</html>
