<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>å¾‹å¸ˆè´¹ç”¨è®¡ç®—å™¨ - WebUtils</title>
    <meta name="description" content="æ ¹æ®æ¡ˆä»¶ç±»å‹å’Œæ ‡çš„é¢è®¡ç®—å¾‹å¸ˆä»£ç†è´¹ç”¨" />
    <meta name="keywords" content="å¾‹å¸ˆè´¹ ä»£ç†è´¹ è¯‰è®¼è´¹ æ³•å¾‹æœåŠ¡ è´¹ç”¨è®¡ç®—" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <meta property="og:title" content="å¾‹å¸ˆè´¹ç”¨è®¡ç®—å™¨ - WebUtils" />
    <meta property="og:description" content="æ ¹æ®æ¡ˆä»¶ç±»å‹å’Œæ ‡çš„é¢è®¡ç®—å¾‹å¸ˆä»£ç†è´¹ç”¨" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="å¾‹å¸ˆè´¹ç”¨è®¡ç®—å™¨ - WebUtils" />
    <meta name="twitter:description" content="æ ¹æ®æ¡ˆä»¶ç±»å‹å’Œæ ‡çš„é¢è®¡ç®—å¾‹å¸ˆä»£ç†è´¹ç”¨" />

    <style>
      :root {
        --bg: #f8f9fa;
        --card-bg: #fff;
        --text: #212529;
        --text-muted: #6c757d;
        --border: #dee2e6;
        --primary: #6366f1;
        --primary-hover: #4f46e5;
        --success: #198754;
        --danger: #dc3545;
        --shadow: 0 2px 8px rgb(0, 0, 0, 0.08);
        --radius: 8px;
      }

      [data-theme="dark"] {
        --bg: #0a0a0f;
        --card-bg: #1a1a24;
        --text: #e8e8ed;
        --text-muted: #9898a4;
        --border: #2a2a36;
        --primary: #818cf8;
        --primary-hover: #6366f1;
        --success: #10b981;
        --danger: #ef4444;
        --shadow: 0 2px 8px rgb(0, 0, 0, 0.3);
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family:
          system-ui,
          -apple-system,
          "Segoe UI",
          Roboto,
          sans-serif;
        background: var(--bg);
        color: var(--text);
        margin: 0;
        padding: 24px;
        min-height: 100vh;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
      }

      .back-link {
        display: inline-block;
        margin-bottom: 16px;
        color: var(--primary);
        text-decoration: none;
        font-size: 0.9rem;
      }

      .back-link:hover {
        text-decoration: underline;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border);
        background: var(--card-bg);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      h1 {
        font-size: 1.75rem;
        margin: 0 0 8px;
      }

      .desc {
        color: var(--text-muted);
        margin: 0 0 24px;
        font-size: 0.95rem;
      }

      .card {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--shadow);
        margin-bottom: 20px;
      }

      .form-group {
        margin-bottom: 16px;
      }

      .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 6px;
        font-size: 0.9rem;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 10px 12px;
        font-size: 0.95rem;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        background: var(--card-bg);
        color: var(--text);
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgb(99, 102, 241, 0.15);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      @media (max-width: 640px) {
        .form-row {
          grid-template-columns: 1fr;
        }
      }

      .btn-row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-top: 20px;
      }

      button {
        padding: 10px 20px;
        font-size: 0.95rem;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        background: var(--card-bg);
        color: var(--text);
        cursor: pointer;
        transition: all 0.2s;
      }

      button:hover {
        border-color: var(--primary);
        color: var(--primary);
      }

      button.primary {
        background: var(--primary);
        border-color: var(--primary);
        color: #fff;
      }

      button.primary:hover {
        background: var(--primary-hover);
        border-color: var(--primary-hover);
        color: #fff;
      }

      .results {
        margin-top: 24px;
        display: none;
      }

      .results-title {
        font-weight: 600;
        font-size: 1rem;
        margin-bottom: 16px;
      }

      .result-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 20px;
      }

      .result-item {
        background: var(--bg);
        border-radius: var(--radius);
        padding: 16px;
        text-align: center;
      }

      .result-item-label {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-bottom: 8px;
      }

      .result-item-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary);
      }

      .result-item-value.total {
        color: var(--success);
      }

      .breakdown {
        background: var(--bg);
        border-radius: var(--radius);
        padding: 16px;
      }

      .breakdown-title {
        font-weight: 600;
        font-size: 0.95rem;
        margin-bottom: 12px;
      }

      .breakdown-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        font-size: 0.9rem;
        border-bottom: 1px solid var(--border);
      }

      .breakdown-item:last-child {
        border-bottom: none;
        font-weight: 600;
      }

      .breakdown-label {
        color: var(--text-muted);
      }

      .fee-table {
        margin-top: 20px;
      }

      .fee-table-title {
        font-weight: 600;
        font-size: 0.95rem;
        margin-bottom: 12px;
      }

      .fee-table table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.85rem;
      }

      .fee-table th,
      .fee-table td {
        padding: 10px 12px;
        text-align: left;
        border: 1px solid var(--border);
      }

      .fee-table th {
        background: var(--bg);
        font-weight: 600;
      }

      .status {
        font-size: 0.85rem;
        margin-top: 8px;
        min-height: 20px;
      }

      .status.success {
        color: var(--success);
      }

      .status.error {
        color: var(--danger);
      }

      .disclaimer {
        margin-top: 20px;
        padding: 12px;
        background: rgba(255, 193, 7, 0.1);
        border-radius: var(--radius);
        font-size: 0.85rem;
        color: var(--text-muted);
      }

      footer {
        text-align: center;
        margin-top: 32px;
        padding-top: 16px;
        border-top: 1px solid var(--border);
        color: var(--text-muted);
        font-size: 0.85rem;
      }

      footer a {
        color: var(--primary);
        text-decoration: none;
      }

      footer a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <a href="../../index.html" class="back-link">â† è¿”å›å·¥å…·åˆ—è¡¨</a>
      <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>

      <h1>å¾‹å¸ˆè´¹ç”¨è®¡ç®—å™¨</h1>
      <p class="desc">æ ¹æ®æ¡ˆä»¶ç±»å‹å’Œæ ‡çš„é¢ä¼°ç®—å¾‹å¸ˆä»£ç†è´¹ç”¨ï¼ˆå‚è€ƒæ”¿åºœæŒ‡å¯¼ä»·ï¼‰</p>

      <div class="card">
        <div class="form-row">
          <div class="form-group">
            <label for="caseType">æ¡ˆä»¶ç±»å‹</label>
            <select id="caseType" onchange="updateFeeInfo()">
              <option value="civil">æ°‘äº‹è¯‰è®¼æ¡ˆä»¶</option>
              <option value="criminal">åˆ‘äº‹è¯‰è®¼æ¡ˆä»¶</option>
              <option value="admin">è¡Œæ”¿è¯‰è®¼æ¡ˆä»¶</option>
              <option value="arbitration">ä»²è£æ¡ˆä»¶</option>
              <option value="enforcement">æ‰§è¡Œæ¡ˆä»¶</option>
              <option value="nonlitigation">éè¯‰è®¼æ³•å¾‹äº‹åŠ¡</option>
              <option value="consultation">æ³•å¾‹å’¨è¯¢</option>
            </select>
          </div>
          <div class="form-group">
            <label for="region">æ‰€åœ¨åœ°åŒº</label>
            <select id="region">
              <option value="beijing">åŒ—äº¬</option>
              <option value="shanghai">ä¸Šæµ·</option>
              <option value="guangdong">å¹¿ä¸œ</option>
              <option value="jiangsu">æ±Ÿè‹</option>
              <option value="zhejiang">æµ™æ±Ÿ</option>
              <option value="other">å…¶ä»–åœ°åŒº</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="amount">æ¡ˆä»¶æ ‡çš„é¢ï¼ˆå…ƒï¼‰</label>
            <input type="number" id="amount" placeholder="è¯·è¾“å…¥æ ‡çš„é‡‘é¢" min="0" />
          </div>
          <div class="form-group">
            <label for="stage">è¯‰è®¼é˜¶æ®µ</label>
            <select id="stage">
              <option value="first">ä¸€å®¡</option>
              <option value="second">äºŒå®¡</option>
              <option value="retrial">å†å®¡</option>
              <option value="full">å…¨ç¨‹ä»£ç†</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="complexity">æ¡ˆä»¶å¤æ‚ç¨‹åº¦</label>
            <select id="complexity">
              <option value="simple">ç®€å•</option>
              <option value="normal" selected>ä¸€èˆ¬</option>
              <option value="complex">å¤æ‚</option>
              <option value="major">é‡å¤§ç–‘éš¾</option>
            </select>
          </div>
          <div class="form-group">
            <label for="riskMode">æ”¶è´¹æ¨¡å¼</label>
            <select id="riskMode">
              <option value="fixed">å›ºå®šæ”¶è´¹</option>
              <option value="percentage">æŒ‰æ ‡çš„æ¯”ä¾‹</option>
              <option value="risk">é£é™©ä»£ç†</option>
            </select>
          </div>
        </div>

        <div class="btn-row">
          <button class="primary" onclick="calculate()">è®¡ç®—è´¹ç”¨</button>
          <button onclick="clearForm()">æ¸…ç©º</button>
        </div>

        <div id="status" class="status"></div>

        <div id="results" class="results">
          <div class="results-title">è´¹ç”¨ä¼°ç®—ç»“æœ</div>

          <div class="result-grid">
            <div class="result-item">
              <div class="result-item-label">å¾‹å¸ˆä»£ç†è´¹ï¼ˆå‚è€ƒï¼‰</div>
              <div id="lawyerFee" class="result-item-value">Â¥0</div>
            </div>
            <div class="result-item">
              <div class="result-item-label">æ¡ˆä»¶å—ç†è´¹</div>
              <div id="courtFee" class="result-item-value">Â¥0</div>
            </div>
            <div class="result-item">
              <div class="result-item-label">é¢„ä¼°æ€»è´¹ç”¨</div>
              <div id="totalFee" class="result-item-value total">Â¥0</div>
            </div>
          </div>

          <div class="breakdown">
            <div class="breakdown-title">è´¹ç”¨æ˜ç»†</div>
            <div id="breakdownList"></div>
          </div>
        </div>

        <div class="fee-table">
          <div class="fee-table-title">å¾‹å¸ˆæœåŠ¡æ”¶è´¹å‚è€ƒæ ‡å‡†ï¼ˆæ°‘äº‹è¯‰è®¼ï¼‰</div>
          <table>
            <thead>
              <tr>
                <th>æ ‡çš„é¢èŒƒå›´</th>
                <th>æ”¶è´¹æ¯”ä¾‹</th>
                <th>ç´¯è®¡åŸºæ•°</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>10ä¸‡å…ƒä»¥ä¸‹</td>
                <td>8%-10%ï¼Œæœ€ä½3000å…ƒ</td>
                <td>-</td>
              </tr>
              <tr>
                <td>10ä¸‡-100ä¸‡</td>
                <td>5%-7%</td>
                <td>+5000å…ƒ</td>
              </tr>
              <tr>
                <td>100ä¸‡-500ä¸‡</td>
                <td>3%-5%</td>
                <td>+55000å…ƒ</td>
              </tr>
              <tr>
                <td>500ä¸‡-1000ä¸‡</td>
                <td>2%-3%</td>
                <td>+205000å…ƒ</td>
              </tr>
              <tr>
                <td>1000ä¸‡ä»¥ä¸Š</td>
                <td>1%-2%</td>
                <td>+355000å…ƒ</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="disclaimer">
          <strong>å…è´£å£°æ˜ï¼š</strong>
          æœ¬è®¡ç®—å™¨æä¾›çš„è´¹ç”¨ä»…ä¾›å‚è€ƒï¼Œå®é™…å¾‹å¸ˆè´¹ç”¨å› åœ°åŒºã€å¾‹æ‰€ã€å¾‹å¸ˆèµ„å†ã€æ¡ˆä»¶å…·ä½“æƒ…å†µç­‰å› ç´ è€Œå¼‚ã€‚å…·ä½“æ”¶è´¹è¯·ä¸å¾‹å¸ˆäº‹åŠ¡æ‰€åå•†ç¡®å®šã€‚æ¡ˆä»¶å—ç†è´¹æŒ‰ç°è¡Œã€Šè¯‰è®¼è´¹ç”¨äº¤çº³åŠæ³•ã€‹è®¡ç®—ï¼Œä»…ä¾›å‚è€ƒã€‚
        </div>
      </div>

      <footer>
        çº¯å‰ç«¯å·¥å…· Â· æ— æœåŠ¡å™¨ Â·
        <a href="../../index.html">WebUtils</a>
      </footer>
    </div>

    <script>
      var LS_KEY = "lawyer_fee_v1";

      function calculate() {
        var caseType = document.getElementById("caseType").value;
        var region = document.getElementById("region").value;
        var amount = parseFloat(document.getElementById("amount").value) || 0;
        var stage = document.getElementById("stage").value;
        var complexity = document.getElementById("complexity").value;
        var riskMode = document.getElementById("riskMode").value;

        if (caseType === "consultation") {
          showConsultationResult();
          return;
        }

        if (amount <= 0 && caseType !== "criminal" && caseType !== "consultation") {
          showStatus("è¯·è¾“å…¥æ¡ˆä»¶æ ‡çš„é¢", "error");
          return;
        }

        // Calculate lawyer fee
        var lawyerFee = calculateLawyerFee(amount, caseType, complexity, riskMode);

        // Apply stage multiplier
        var stageMultiplier = {
          first: 1,
          second: 0.8,
          retrial: 0.7,
          full: 1.6
        };
        lawyerFee = lawyerFee * (stageMultiplier[stage] || 1);

        // Apply region adjustment
        var regionMultiplier = {
          beijing: 1.2,
          shanghai: 1.2,
          guangdong: 1.1,
          jiangsu: 1.0,
          zhejiang: 1.0,
          other: 0.9
        };
        lawyerFee = lawyerFee * (regionMultiplier[region] || 1);

        // Calculate court fee
        var courtFee = calculateCourtFee(amount, caseType);

        // Total
        var totalFee = lawyerFee + courtFee;

        // Display results
        document.getElementById("results").style.display = "block";
        document.getElementById("lawyerFee").textContent =
          "Â¥" + formatNumber(Math.round(lawyerFee));
        document.getElementById("courtFee").textContent = "Â¥" + formatNumber(Math.round(courtFee));
        document.getElementById("totalFee").textContent = "Â¥" + formatNumber(Math.round(totalFee));

        // Breakdown
        var breakdownList = document.getElementById("breakdownList");
        breakdownList.textContent = "";

        var breakdownItems = [
          { label: "æ¡ˆä»¶æ ‡çš„é¢", value: "Â¥" + formatNumber(amount) },
          { label: "æ¡ˆä»¶ç±»å‹", value: getCaseTypeName(caseType) },
          { label: "è¯‰è®¼é˜¶æ®µ", value: getStageName(stage) },
          { label: "å¤æ‚ç¨‹åº¦", value: getComplexityName(complexity) },
          { label: "åœ°åŒºè°ƒæ•´", value: getRegionName(region) },
          { label: "æ”¶è´¹æ¨¡å¼", value: getRiskModeName(riskMode) },
          { label: "å¾‹å¸ˆä»£ç†è´¹ï¼ˆå‚è€ƒï¼‰", value: "Â¥" + formatNumber(Math.round(lawyerFee)) },
          { label: "æ¡ˆä»¶å—ç†è´¹", value: "Â¥" + formatNumber(Math.round(courtFee)) },
          { label: "é¢„ä¼°æ€»è´¹ç”¨", value: "Â¥" + formatNumber(Math.round(totalFee)) }
        ];

        breakdownItems.forEach(function (item) {
          var div = document.createElement("div");
          div.className = "breakdown-item";

          var labelSpan = document.createElement("span");
          labelSpan.className = "breakdown-label";
          labelSpan.textContent = item.label;

          var valueSpan = document.createElement("span");
          valueSpan.textContent = item.value;

          div.appendChild(labelSpan);
          div.appendChild(valueSpan);
          breakdownList.appendChild(div);
        });

        saveToStorage();
        showStatus("è®¡ç®—å®Œæˆ", "success");
      }

      function calculateLawyerFee(amount, caseType, complexity, riskMode) {
        var baseFee = 0;

        if (caseType === "criminal") {
          // Criminal case fixed fee range
          var criminalFees = {
            simple: 5000,
            normal: 15000,
            complex: 30000,
            major: 50000
          };
          return criminalFees[complexity] || 15000;
        }

        // Calculate based on amount using tiered rates
        if (amount <= 100000) {
          baseFee = Math.max(amount * 0.08, 3000);
        } else if (amount <= 1000000) {
          baseFee = 5000 + (amount - 100000) * 0.05;
        } else if (amount <= 5000000) {
          baseFee = 55000 + (amount - 1000000) * 0.03;
        } else if (amount <= 10000000) {
          baseFee = 205000 + (amount - 5000000) * 0.02;
        } else {
          baseFee = 305000 + (amount - 10000000) * 0.01;
        }

        // Apply complexity multiplier
        var complexityMultiplier = {
          simple: 0.8,
          normal: 1,
          complex: 1.3,
          major: 1.6
        };
        baseFee = baseFee * (complexityMultiplier[complexity] || 1);

        // Risk mode adjustment
        if (riskMode === "risk") {
          baseFee = baseFee * 0.5; // Base fee lower, but success fee not included
        }

        return baseFee;
      }

      function calculateCourtFee(amount, caseType) {
        if (
          caseType === "criminal" ||
          caseType === "consultation" ||
          caseType === "nonlitigation"
        ) {
          return 0;
        }

        // Property case court fee calculation (simplified)
        if (amount <= 10000) {
          return 50;
        } else if (amount <= 100000) {
          return 50 + (amount - 10000) * 0.025;
        } else if (amount <= 200000) {
          return 2300 + (amount - 100000) * 0.02;
        } else if (amount <= 500000) {
          return 4300 + (amount - 200000) * 0.015;
        } else if (amount <= 1000000) {
          return 8800 + (amount - 500000) * 0.01;
        } else if (amount <= 2000000) {
          return 13800 + (amount - 1000000) * 0.009;
        } else if (amount <= 5000000) {
          return 22800 + (amount - 2000000) * 0.008;
        } else if (amount <= 10000000) {
          return 46800 + (amount - 5000000) * 0.007;
        } else if (amount <= 20000000) {
          return 81800 + (amount - 10000000) * 0.006;
        } else {
          return 141800 + (amount - 20000000) * 0.005;
        }
      }

      function showConsultationResult() {
        document.getElementById("results").style.display = "block";
        document.getElementById("lawyerFee").textContent = "Â¥200-1000/å°æ—¶";
        document.getElementById("courtFee").textContent = "Â¥0";
        document.getElementById("totalFee").textContent = "åå•†ç¡®å®š";

        var breakdownList = document.getElementById("breakdownList");
        breakdownList.textContent = "";

        var items = [
          { label: "ç”µè¯å’¨è¯¢", value: "Â¥100-300/æ¬¡" },
          { label: "ä¹¦é¢å’¨è¯¢", value: "Â¥500-2000/æ¬¡" },
          { label: "å½“é¢å’¨è¯¢", value: "Â¥200-1000/å°æ—¶" },
          { label: "æ³•å¾‹é¡¾é—®ï¼ˆå¹´è´¹ï¼‰", value: "Â¥30000-200000/å¹´" }
        ];

        items.forEach(function (item) {
          var div = document.createElement("div");
          div.className = "breakdown-item";

          var labelSpan = document.createElement("span");
          labelSpan.className = "breakdown-label";
          labelSpan.textContent = item.label;

          var valueSpan = document.createElement("span");
          valueSpan.textContent = item.value;

          div.appendChild(labelSpan);
          div.appendChild(valueSpan);
          breakdownList.appendChild(div);
        });

        showStatus("æ³•å¾‹å’¨è¯¢è´¹ç”¨å‚è€ƒ", "success");
      }

      function formatNumber(num) {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      }

      function getCaseTypeName(type) {
        var names = {
          civil: "æ°‘äº‹è¯‰è®¼",
          criminal: "åˆ‘äº‹è¯‰è®¼",
          admin: "è¡Œæ”¿è¯‰è®¼",
          arbitration: "ä»²è£æ¡ˆä»¶",
          enforcement: "æ‰§è¡Œæ¡ˆä»¶",
          nonlitigation: "éè¯‰è®¼äº‹åŠ¡",
          consultation: "æ³•å¾‹å’¨è¯¢"
        };
        return names[type] || type;
      }

      function getStageName(stage) {
        var names = {
          first: "ä¸€å®¡",
          second: "äºŒå®¡",
          retrial: "å†å®¡",
          full: "å…¨ç¨‹ä»£ç†"
        };
        return names[stage] || stage;
      }

      function getComplexityName(complexity) {
        var names = {
          simple: "ç®€å•",
          normal: "ä¸€èˆ¬",
          complex: "å¤æ‚",
          major: "é‡å¤§ç–‘éš¾"
        };
        return names[complexity] || complexity;
      }

      function getRegionName(region) {
        var names = {
          beijing: "åŒ—äº¬ (+20%)",
          shanghai: "ä¸Šæµ· (+20%)",
          guangdong: "å¹¿ä¸œ (+10%)",
          jiangsu: "æ±Ÿè‹ (åŸºå‡†)",
          zhejiang: "æµ™æ±Ÿ (åŸºå‡†)",
          other: "å…¶ä»–åœ°åŒº (-10%)"
        };
        return names[region] || region;
      }

      function getRiskModeName(mode) {
        var names = {
          fixed: "å›ºå®šæ”¶è´¹",
          percentage: "æŒ‰æ ‡çš„æ¯”ä¾‹",
          risk: "é£é™©ä»£ç†"
        };
        return names[mode] || mode;
      }

      function updateFeeInfo() {
        // Could update the fee table based on case type
      }

      function clearForm() {
        document.getElementById("amount").value = "";
        document.getElementById("results").style.display = "none";
        localStorage.removeItem(LS_KEY);
        showStatus("å·²æ¸…ç©º", "success");
      }

      function saveToStorage() {
        try {
          var data = {
            caseType: document.getElementById("caseType").value,
            region: document.getElementById("region").value,
            amount: document.getElementById("amount").value,
            stage: document.getElementById("stage").value,
            complexity: document.getElementById("complexity").value,
            riskMode: document.getElementById("riskMode").value
          };
          localStorage.setItem(LS_KEY, JSON.stringify(data));
        } catch (e) {}
      }

      function loadFromStorage() {
        try {
          var saved = localStorage.getItem(LS_KEY);
          if (saved) {
            var data = JSON.parse(saved);
            if (data.caseType) document.getElementById("caseType").value = data.caseType;
            if (data.region) document.getElementById("region").value = data.region;
            if (data.amount) document.getElementById("amount").value = data.amount;
            if (data.stage) document.getElementById("stage").value = data.stage;
            if (data.complexity) document.getElementById("complexity").value = data.complexity;
            if (data.riskMode) document.getElementById("riskMode").value = data.riskMode;
          }
        } catch (e) {}
      }

      function showStatus(msg, type) {
        var el = document.getElementById("status");
        el.textContent = msg;
        el.className = "status " + (type || "");
      }

      function toggleTheme() {
        var html = document.documentElement;
        var btn = document.querySelector(".theme-toggle");
        var next = html.getAttribute("data-theme") === "dark" ? "light" : "dark";
        html.setAttribute("data-theme", next);
        btn.textContent = next === "dark" ? "ğŸŒ™" : "â˜€ï¸";
        localStorage.setItem("theme", next);
      }

      (function () {
        var savedTheme = localStorage.getItem("theme");
        if (savedTheme) {
          document.documentElement.setAttribute("data-theme", savedTheme);
          var btn = document.querySelector(".theme-toggle");
          if (btn) btn.textContent = savedTheme === "dark" ? "ğŸŒ™" : "â˜€ï¸";
        }
        loadFromStorage();
      })();
    </script>
  </body>
</html>
