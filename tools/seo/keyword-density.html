<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…³é”®è¯å¯†åº¦åˆ†æå™¨ - SEOå·¥å…·</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --primary-color: #667eea;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        .theme-toggle {
            background: none;
            border: 2px solid var(--pico-primary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background: var(--pico-card-background-color);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--pico-muted-border-color);
        }
        .stat-card h3 {
            margin: 0;
            font-size: 1.5rem;
            color: var(--pico-primary);
        }
        .stat-card p {
            margin: 0.5rem 0 0 0;
            font-size: 0.85rem;
            color: var(--pico-muted-color);
        }
        .keyword-table {
            width: 100%;
            margin-top: 1rem;
        }
        .keyword-table th {
            text-align: left;
        }
        .density-bar {
            background: var(--pico-muted-border-color);
            border-radius: 4px;
            height: 20px;
            overflow: hidden;
        }
        .density-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.3s ease;
        }
        .optimal {
            color: #22c55e;
        }
        .warning {
            color: #f59e0b;
        }
        .danger {
            color: #ef4444;
        }
        textarea {
            min-height: 200px;
        }
        .keyword-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .keyword-input-group input {
            flex: 1;
        }
        .keyword-input-group button {
            flex-shrink: 0;
        }
        .tips {
            background: var(--pico-card-background-color);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            border-left: 4px solid var(--pico-primary);
        }
        .tips h4 {
            margin-top: 0;
        }
        .tips ul {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <main class="container">
        <header>
            <h1>ğŸ” å…³é”®è¯å¯†åº¦åˆ†æå™¨</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
                <span id="theme-icon">ğŸŒ™</span>
            </button>
        </header>

        <article>
            <h3>è¾“å…¥å†…å®¹</h3>
            <textarea id="content" placeholder="åœ¨æ­¤ç²˜è´´æ‚¨è¦åˆ†æçš„æ–‡ç« å†…å®¹..."></textarea>
            
            <div class="keyword-input-group">
                <input type="text" id="targetKeyword" placeholder="è¾“å…¥ç›®æ ‡å…³é”®è¯ï¼ˆå¯é€‰ï¼Œç”¨äºé‡ç‚¹åˆ†æï¼‰">
                <button onclick="analyzeContent()">åˆ†æå†…å®¹</button>
            </div>
        </article>

        <div id="results" style="display: none;">
            <h3>ğŸ“Š åˆ†æç»“æœ</h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalWords">0</h3>
                    <p>æ€»å­—æ•°</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalChars">0</h3>
                    <p>æ€»å­—ç¬¦æ•°</p>
                </div>
                <div class="stat-card">
                    <h3 id="uniqueWords">0</h3>
                    <p>ç‹¬ç«‹è¯æ±‡</p>
                </div>
                <div class="stat-card">
                    <h3 id="avgWordLength">0</h3>
                    <p>å¹³å‡è¯é•¿</p>
                </div>
            </div>

            <div id="targetKeywordResult" style="display: none;">
                <h4>ğŸ¯ ç›®æ ‡å…³é”®è¯åˆ†æ</h4>
                <article>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <span id="targetKeywordText" style="font-weight: bold;"></span>
                        <span id="targetKeywordDensity" style="font-size: 1.2rem;"></span>
                    </div>
                    <div class="density-bar">
                        <div class="density-fill" id="targetDensityBar" style="width: 0%;"></div>
                    </div>
                    <p id="targetKeywordAdvice" style="margin-top: 0.5rem;"></p>
                </article>
            </div>

            <h4>ğŸ“ˆ é«˜é¢‘è¯æ±‡æ’è¡Œ</h4>
            <table class="keyword-table">
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>å…³é”®è¯</th>
                        <th>å‡ºç°æ¬¡æ•°</th>
                        <th>å¯†åº¦</th>
                        <th>å¯†åº¦æ¡</th>
                    </tr>
                </thead>
                <tbody id="keywordTableBody">
                </tbody>
            </table>

            <div class="tips">
                <h4>ğŸ’¡ SEOå»ºè®®</h4>
                <ul>
                    <li>ç›®æ ‡å…³é”®è¯å¯†åº¦å»ºè®®ä¿æŒåœ¨ <strong>1%-3%</strong> ä¹‹é—´</li>
                    <li>é¿å…å…³é”®è¯å †ç Œï¼Œå¯†åº¦è¶…è¿‡5%å¯èƒ½è¢«æœç´¢å¼•æ“åˆ¤å®šä¸ºä½œå¼Š</li>
                    <li>è‡ªç„¶åœ°å°†å…³é”®è¯åˆ†å¸ƒåœ¨æ ‡é¢˜ã€æ®µè½é¦–å¥å’Œæ­£æ–‡ä¸­</li>
                    <li>ä½¿ç”¨åŒä¹‰è¯å’Œç›¸å…³è¯æ¥ä¸°å¯Œå†…å®¹çš„è¯­ä¹‰</li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', newTheme);
        }

        // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        })();

        // ä¸­æ–‡åˆ†è¯ï¼ˆç®€å•å®ç°ï¼‰
        function segmentChinese(text) {
            // ç§»é™¤æ ‡ç‚¹ç¬¦å·å’Œç‰¹æ®Šå­—ç¬¦
            const cleanText = text.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, ' ');
            
            // åˆ†ç¦»ä¸­æ–‡å’Œè‹±æ–‡
            const words = [];
            let currentWord = '';
            let currentType = null; // 'cn' for Chinese, 'en' for English
            
            for (let char of cleanText) {
                if (/[\u4e00-\u9fa5]/.test(char)) {
                    if (currentType === 'en' && currentWord) {
                        words.push(currentWord.toLowerCase());
                        currentWord = '';
                    }
                    // ä¸­æ–‡å­—ç¬¦å•ç‹¬ä½œä¸ºè¯ï¼ˆç®€å•å¤„ç†ï¼‰
                    words.push(char);
                    currentType = 'cn';
                } else if (/[a-zA-Z0-9]/.test(char)) {
                    currentWord += char;
                    currentType = 'en';
                } else {
                    if (currentWord) {
                        words.push(currentWord.toLowerCase());
                        currentWord = '';
                    }
                    currentType = null;
                }
            }
            
            if (currentWord) {
                words.push(currentWord.toLowerCase());
            }
            
            return words.filter(w => w.length > 0);
        }

        // æå–2-4å­—çš„ä¸­æ–‡è¯ç»„
        function extractPhrases(text) {
            const phrases = [];
            const cleanText = text.replace(/[^\u4e00-\u9fa5]/g, '');
            
            for (let len = 2; len <= 4; len++) {
                for (let i = 0; i <= cleanText.length - len; i++) {
                    phrases.push(cleanText.substring(i, i + len));
                }
            }
            
            return phrases;
        }

        // å®‰å…¨åœ°åˆ›å»ºè¡¨æ ¼è¡Œ
        function createTableRow(rank, word, count, density, barWidth, densityClass) {
            const row = document.createElement('tr');
            
            const rankCell = document.createElement('td');
            rankCell.textContent = rank;
            
            const wordCell = document.createElement('td');
            const strong = document.createElement('strong');
            strong.textContent = word;
            wordCell.appendChild(strong);
            
            const countCell = document.createElement('td');
            countCell.textContent = count;
            
            const densityCell = document.createElement('td');
            densityCell.className = densityClass;
            densityCell.textContent = density.toFixed(2) + '%';
            
            const barCell = document.createElement('td');
            const barContainer = document.createElement('div');
            barContainer.className = 'density-bar';
            const barFill = document.createElement('div');
            barFill.className = 'density-fill';
            barFill.style.width = barWidth + '%';
            barContainer.appendChild(barFill);
            barCell.appendChild(barContainer);
            
            row.appendChild(rankCell);
            row.appendChild(wordCell);
            row.appendChild(countCell);
            row.appendChild(densityCell);
            row.appendChild(barCell);
            
            return row;
        }

        // åˆ†æå†…å®¹
        function analyzeContent() {
            const content = document.getElementById('content').value.trim();
            const targetKeyword = document.getElementById('targetKeyword').value.trim();
            
            if (!content) {
                alert('è¯·è¾“å…¥è¦åˆ†æçš„å†…å®¹');
                return;
            }

            // åŸºç¡€ç»Ÿè®¡
            const totalChars = content.replace(/\s/g, '').length;
            const words = segmentChinese(content);
            const totalWords = words.length;

            // è¯é¢‘ç»Ÿè®¡
            const wordCount = {};
            words.forEach(word => {
                if (word.length >= 1) {
                    wordCount[word] = (wordCount[word] || 0) + 1;
                }
            });

            // æ·»åŠ ä¸­æ–‡è¯ç»„ç»Ÿè®¡
            const phrases = extractPhrases(content);
            const phraseCount = {};
            phrases.forEach(phrase => {
                phraseCount[phrase] = (phraseCount[phrase] || 0) + 1;
            });

            // åˆå¹¶å•å­—å’Œè¯ç»„ï¼Œåªä¿ç•™å‡ºç°2æ¬¡ä»¥ä¸Šçš„
            const combinedCount = { ...wordCount };
            Object.keys(phraseCount).forEach(phrase => {
                if (phraseCount[phrase] >= 2) {
                    combinedCount[phrase] = phraseCount[phrase];
                }
            });

            // æ’åº
            const sortedWords = Object.entries(combinedCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 20);

            // è®¡ç®—å¹³å‡è¯é•¿
            const avgLength = words.length > 0 
                ? (words.reduce((sum, w) => sum + w.length, 0) / words.length).toFixed(1)
                : 0;

            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            document.getElementById('totalWords').textContent = totalWords;
            document.getElementById('totalChars').textContent = totalChars;
            document.getElementById('uniqueWords').textContent = Object.keys(wordCount).length;
            document.getElementById('avgWordLength').textContent = avgLength;

            // ç›®æ ‡å…³é”®è¯åˆ†æ
            if (targetKeyword) {
                const keywordRegex = new RegExp(targetKeyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                const matches = content.match(keywordRegex) || [];
                const keywordCount = matches.length;
                const density = totalWords > 0 ? (keywordCount / totalWords * 100) : 0;

                document.getElementById('targetKeywordResult').style.display = 'block';
                document.getElementById('targetKeywordText').textContent = targetKeyword;
                document.getElementById('targetKeywordDensity').textContent = density.toFixed(2) + '% (' + keywordCount + 'æ¬¡)';
                
                const barWidth = Math.min(density * 10, 100);
                document.getElementById('targetDensityBar').style.width = barWidth + '%';

                let advice = '';
                let densityClass = '';
                if (density < 0.5) {
                    advice = 'âš ï¸ å…³é”®è¯å¯†åº¦åä½ï¼Œå»ºè®®é€‚å½“å¢åŠ å…³é”®è¯å‡ºç°æ¬¡æ•°';
                    densityClass = 'warning';
                } else if (density <= 3) {
                    advice = 'âœ… å…³é”®è¯å¯†åº¦åœ¨ç†æƒ³èŒƒå›´å†…ï¼Œç»§ç»­ä¿æŒ';
                    densityClass = 'optimal';
                } else if (density <= 5) {
                    advice = 'âš ï¸ å…³é”®è¯å¯†åº¦åé«˜ï¼Œæ³¨æ„ä¸è¦è¿‡åº¦ä¼˜åŒ–';
                    densityClass = 'warning';
                } else {
                    advice = 'âŒ å…³é”®è¯å¯†åº¦è¿‡é«˜ï¼Œæœ‰å †ç Œå«Œç–‘ï¼Œå»ºè®®å‡å°‘ä½¿ç”¨';
                    densityClass = 'danger';
                }
                document.getElementById('targetKeywordAdvice').textContent = advice;
                document.getElementById('targetKeywordAdvice').className = densityClass;
                document.getElementById('targetKeywordDensity').className = densityClass;
            } else {
                document.getElementById('targetKeywordResult').style.display = 'none';
            }

            // ç”Ÿæˆå…³é”®è¯è¡¨æ ¼
            const tbody = document.getElementById('keywordTableBody');
            tbody.textContent = '';
            
            sortedWords.forEach(([word, count], index) => {
                const density = (count / totalWords * 100);
                const barWidth = Math.min(density * 10, 100);
                
                let densityClass = 'optimal';
                if (density > 5) densityClass = 'danger';
                else if (density > 3) densityClass = 'warning';

                const row = createTableRow(index + 1, word, count, density, barWidth, densityClass);
                tbody.appendChild(row);
            });

            document.getElementById('results').style.display = 'block';
        }

        // å›è½¦é”®è§¦å‘åˆ†æ
        document.getElementById('targetKeyword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeContent();
            }
        });
    </script>
</body>
</html>
