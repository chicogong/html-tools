<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CORS é…ç½®ç”Ÿæˆå™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="CORS é…ç½®ç”Ÿæˆå™¨ - WebUtils" />
    <meta name="keywords" content="cors-generator,security,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link
      rel="canonical"
      href="https://tools.realtime-ai.chat/tools/security/cors-generator.html"
    />

    <!-- Open Graph -->
    <meta property="og:title" content="CORS é…ç½®ç”Ÿæˆå™¨ - WebUtils" />
    <meta property="og:description" content="CORS é…ç½®ç”Ÿæˆå™¨ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/security/cors-generator.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="CORS é…ç½®ç”Ÿæˆå™¨ - WebUtils" />
    <meta name="twitter:description" content="CORS é…ç½®ç”Ÿæˆå™¨ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      :root {
        --color-bg-deep: #0a0a0f;
        --color-bg-surface: #12121a;
        --color-bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --color-text-primary: #e8e8ed;
        --color-text-secondary: #8888a0;
        --color-text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --color-accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --color-accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;

        /* å­—ä½“å˜é‡ */
        --font-sans:
          "Space Grotesk", -apple-system, blinkmacsystemfont, "Segoe UI", roboto, sans-serif;
        --font-mono: "JetBrains Mono", "Courier New", monospace;
      }

      [data-theme="light"] {
        --color-bg-deep: #fafafa;
        --color-bg-surface: #fff;
        --color-bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --color-text-primary: #1a1a1a;
        --color-text-secondary: #666;
        --color-text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      :root {
        --primary-color: #3b82f6;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --error-color: #ef4444;
      }

      body {
        min-height: 100vh;
        padding: 2rem 1rem;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        background: var(--pico-primary);
        border: none;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        cursor: pointer;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s;
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      .config-section {
        background: var(--pico-card-background-color);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .config-section h3 {
        margin-top: 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        border-bottom: 2px solid var(--pico-primary);
        padding-bottom: 0.5rem;
      }

      .form-group {
        margin-bottom: 1rem;
      }

      .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .form-group small {
        color: var(--pico-muted-color);
        display: block;
        margin-top: 0.25rem;
      }

      .checkbox-group {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .checkbox-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .checkbox-item input {
        margin: 0;
      }

      .tag-input-container {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
        padding: 0.5rem;
        border: 1px solid var(--pico-form-element-border-color);
        border-radius: 4px;
        background: var(--pico-form-element-background-color);
        min-height: 44px;
      }

      .tag {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        background: var(--pico-primary);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.85rem;
      }

      .tag button {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        padding: 0;
        font-size: 1rem;
        line-height: 1;
      }

      .tag-input {
        flex: 1;
        min-width: 150px;
        border: none;
        outline: none;
        background: transparent;
        padding: 0.25rem;
      }

      .output-section {
        background: var(--pico-card-background-color);
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .output-tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        flex-wrap: wrap;
      }

      .output-tab {
        padding: 0.5rem 1rem;
        border: none;
        background: var(--pico-secondary-background);
        cursor: pointer;
        border-radius: 4px;
        transition: all 0.2s;
      }

      .output-tab.active {
        background: var(--pico-primary);
        color: white;
      }

      .output-content {
        background: var(--pico-secondary-background);
        border-radius: 8px;
        padding: 1rem;
        font-family: Monaco, Menlo, "Ubuntu Mono", monospace;
        font-size: 0.85rem;
        white-space: pre-wrap;
        word-break: break-all;
        min-height: 150px;
        max-height: 400px;
        overflow-y: auto;
      }

      .btn-group {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
        flex-wrap: wrap;
      }

      .warning-box {
        background: rgba(245, 158, 11, 0.1);
        border: 1px solid var(--warning-color);
        border-radius: 8px;
        padding: 1rem;
        margin-top: 1rem;
        display: none;
      }

      .warning-box.show {
        display: block;
      }

      .info-box {
        background: var(--pico-secondary-background);
        border-radius: 8px;
        padding: 1rem;
        margin-top: 2rem;
      }

      @media (max-width: 768px) {
        .checkbox-group {
          flex-direction: column;
        }
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      CORS é…ç½®ç”Ÿæˆå™¨
    </nav>
    <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>

    <main class="container">
      <header>
        <h1>ğŸŒ CORS é…ç½®ç”Ÿæˆå™¨</h1>
        <p>å¯è§†åŒ–é…ç½®è·¨åŸŸèµ„æºå…±äº« (CORS) ç­–ç•¥</p>
      </header>

      <div class="config-section">
        <h3>ğŸ¯ å…è®¸çš„æ¥æº (Origins)</h3>
        <div class="form-group">
          <label>
            <input type="checkbox" id="allowAllOrigins" onchange="updateConfig()" />
            å…è®¸æ‰€æœ‰æ¥æº (Access-Control-Allow-Origin: *)
          </label>
          <small>âš ï¸ ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©</small>
        </div>
        <div class="form-group" id="originsGroup">
          <label>æŒ‡å®šå…è®¸çš„æ¥æº</label>
          <div class="tag-input-container" id="originsContainer">
            <input
              type="text"
              class="tag-input"
              id="originInput"
              placeholder="è¾“å…¥åŸŸååæŒ‰å›è½¦æ·»åŠ ï¼Œå¦‚ï¼šhttps://example.com"
            />
          </div>
          <small>è¾“å…¥å®Œæ•´çš„ URL åŒ…æ‹¬åè®®ï¼Œå¦‚ https://example.com</small>
        </div>
      </div>

      <div class="config-section">
        <h3>ğŸ“‹ å…è®¸çš„ HTTP æ–¹æ³• (Methods)</h3>
        <div class="checkbox-group">
          <label class="checkbox-item">
            <input type="checkbox" value="GET" checked onchange="updateConfig()" />
            GET
          </label>
          <label class="checkbox-item">
            <input type="checkbox" value="POST" checked onchange="updateConfig()" />
            POST
          </label>
          <label class="checkbox-item">
            <input type="checkbox" value="PUT" onchange="updateConfig()" />
            PUT
          </label>
          <label class="checkbox-item">
            <input type="checkbox" value="DELETE" onchange="updateConfig()" />
            DELETE
          </label>
          <label class="checkbox-item">
            <input type="checkbox" value="PATCH" onchange="updateConfig()" />
            PATCH
          </label>
          <label class="checkbox-item">
            <input type="checkbox" value="OPTIONS" checked onchange="updateConfig()" />
            OPTIONS
          </label>
          <label class="checkbox-item">
            <input type="checkbox" value="HEAD" onchange="updateConfig()" />
            HEAD
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>ğŸ“¨ å…è®¸çš„è¯·æ±‚å¤´ (Headers)</h3>
        <div class="form-group">
          <label>
            <input type="checkbox" id="allowAllHeaders" onchange="updateConfig()" />
            å…è®¸æ‰€æœ‰è¯·æ±‚å¤´ (Access-Control-Allow-Headers: *)
          </label>
        </div>
        <div class="form-group" id="headersGroup">
          <label>æŒ‡å®šå…è®¸çš„è¯·æ±‚å¤´</label>
          <div class="tag-input-container" id="headersContainer">
            <input
              type="text"
              class="tag-input"
              id="headerInput"
              placeholder="è¾“å…¥è¯·æ±‚å¤´åæŒ‰å›è½¦æ·»åŠ ï¼Œå¦‚ï¼šAuthorization"
            />
          </div>
        </div>
        <div class="checkbox-group" style="margin-top: 0.5rem">
          <label class="checkbox-item">
            <input
              type="checkbox"
              data-header="Content-Type"
              checked
              onchange="togglePresetHeader(this)"
            />
            Content-Type
          </label>
          <label class="checkbox-item">
            <input
              type="checkbox"
              data-header="Authorization"
              onchange="togglePresetHeader(this)"
            />
            Authorization
          </label>
          <label class="checkbox-item">
            <input
              type="checkbox"
              data-header="X-Requested-With"
              onchange="togglePresetHeader(this)"
            />
            X-Requested-With
          </label>
          <label class="checkbox-item">
            <input
              type="checkbox"
              data-header="Accept"
              checked
              onchange="togglePresetHeader(this)"
            />
            Accept
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>ğŸ“¤ æš´éœ²çš„å“åº”å¤´ (Expose Headers)</h3>
        <div class="form-group">
          <div class="tag-input-container" id="exposeHeadersContainer">
            <input
              type="text"
              class="tag-input"
              id="exposeHeaderInput"
              placeholder="è¾“å…¥è¦æš´éœ²ç»™å‰ç«¯çš„å“åº”å¤´ï¼Œå¦‚ï¼šX-Total-Count"
            />
          </div>
          <small>æŒ‡å®šå“ªäº›å“åº”å¤´å¯ä»¥è¢«å‰ç«¯ JavaScript è®¿é—®</small>
        </div>
      </div>

      <div class="config-section">
        <h3>âš™ï¸ å…¶ä»–é€‰é¡¹</h3>
        <div class="form-group">
          <label>
            <input type="checkbox" id="allowCredentials" onchange="updateConfig()" />
            å…è®¸æºå¸¦å‡­è¯ (Access-Control-Allow-Credentials: true)
          </label>
          <small>å…è®¸è·¨åŸŸè¯·æ±‚æºå¸¦ Cookie ç­‰å‡­è¯ä¿¡æ¯</small>
        </div>
        <div class="form-group">
          <label for="maxAge">é¢„æ£€è¯·æ±‚ç¼“å­˜æ—¶é—´ (ç§’)</label>
          <input type="number" id="maxAge" value="86400" min="0" onchange="updateConfig()" />
          <small>Access-Control-Max-Age: æµè§ˆå™¨ç¼“å­˜é¢„æ£€è¯·æ±‚ç»“æœçš„æ—¶é—´</small>
        </div>
      </div>

      <div class="warning-box" id="warningBox">
        <strong>âš ï¸ å®‰å…¨è­¦å‘Šï¼š</strong>
        <span id="warningText"></span>
      </div>

      <div class="output-section">
        <h3>ğŸ“„ ç”Ÿæˆçš„é…ç½®</h3>
        <div class="output-tabs">
          <button class="output-tab active" onclick="switchTab('headers')">HTTP Headers</button>
          <button class="output-tab" onclick="switchTab('nginx')">Nginx</button>
          <button class="output-tab" onclick="switchTab('apache')">Apache</button>
          <button class="output-tab" onclick="switchTab('express')">Express.js</button>
          <button class="output-tab" onclick="switchTab('spring')">Spring Boot</button>
        </div>
        <div class="output-content" id="outputContent"></div>
        <div class="btn-group">
          <button onclick="copyOutput()">ğŸ“‹ å¤åˆ¶é…ç½®</button>
          <button class="secondary" onclick="downloadConfig()">ğŸ’¾ ä¸‹è½½é…ç½®</button>
        </div>
      </div>

      <div class="info-box">
        <h4>ğŸ’¡ CORS å·¥ä½œåŸç†</h4>
        <ul>
          <li>
            <strong>ç®€å•è¯·æ±‚</strong>
            ï¼šGET/POST/HEAD ä¸”åªä½¿ç”¨ç®€å•å¤´ï¼Œç›´æ¥å‘é€
          </li>
          <li>
            <strong>é¢„æ£€è¯·æ±‚</strong>
            ï¼šå¤æ‚è¯·æ±‚ä¼šå…ˆå‘é€ OPTIONS è¯·æ±‚è¿›è¡Œé¢„æ£€
          </li>
          <li>
            <strong>å‡­è¯æ¨¡å¼</strong>
            ï¼šæºå¸¦ Cookie æ—¶ï¼ŒOrigin ä¸èƒ½ä¸º *
          </li>
          <li>
            <strong>å®‰å…¨å»ºè®®</strong>
            ï¼šç”Ÿäº§ç¯å¢ƒåº”æ˜ç¡®æŒ‡å®šå…è®¸çš„æ¥æºï¼Œé¿å…ä½¿ç”¨ *
          </li>
        </ul>
      </div>
    </main>

    <script>
      // ä¸»é¢˜åˆ‡æ¢
      window.toggleTheme = function () {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        document.querySelector(".theme-toggle").textContent = newTheme === "light" ? "ğŸŒ™" : "â˜€ï¸";
        localStorage.setItem("theme", newTheme);
      };

      const savedTheme = localStorage.getItem("theme") || "light";
      document.documentElement.setAttribute("data-theme", savedTheme);
      document.querySelector(".theme-toggle").textContent = savedTheme === "light" ? "ğŸŒ™" : "â˜€ï¸";

      // çŠ¶æ€
      const state = {
        origins: [],
        headers: ["Content-Type", "Accept"],
        exposeHeaders: [],
        currentTab: "headers"
      };

      // Tag è¾“å…¥å¤„ç†
      function setupTagInput(inputId, containerId, stateKey) {
        const input = document.getElementById(inputId);
        const container = document.getElementById(containerId);

        input.addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            e.preventDefault();
            const value = this.value.trim();
            if (value && state[stateKey].indexOf(value) === -1) {
              state[stateKey].push(value);
              renderTags(containerId, stateKey);
              this.value = "";
              updateConfig();
            }
          }
        });
      }

      function renderTags(containerId, stateKey) {
        const container = document.getElementById(containerId);
        const input = container.querySelector(".tag-input");

        // ç§»é™¤ç°æœ‰æ ‡ç­¾
        container.querySelectorAll(".tag").forEach((tag) => tag.remove());

        // æ·»åŠ æ ‡ç­¾
        state[stateKey].forEach((value, index) => {
          const tag = document.createElement("span");
          tag.className = "tag";
          tag.textContent = value + " ";

          const removeBtn = document.createElement("button");
          removeBtn.textContent = "Ã—";
          removeBtn.onclick = function () {
            state[stateKey].splice(index, 1);
            renderTags(containerId, stateKey);
            updateConfig();

            // æ›´æ–°é¢„è®¾å¤é€‰æ¡†
            if (stateKey === "headers") {
              const checkbox = document.querySelector('input[data-header="' + value + '"]');
              if (checkbox) checkbox.checked = false;
            }
          };
          tag.appendChild(removeBtn);
          container.insertBefore(tag, input);
        });
      }

      window.togglePresetHeader = function (checkbox) {
        const header = checkbox.dataset.header;
        const index = state.headers.indexOf(header);

        if (checkbox.checked && index === -1) {
          state.headers.push(header);
        } else if (!checkbox.checked && index !== -1) {
          state.headers.splice(index, 1);
        }

        renderTags("headersContainer", "headers");
        updateConfig();
      };

      // åˆå§‹åŒ–
      setupTagInput("originInput", "originsContainer", "origins");
      setupTagInput("headerInput", "headersContainer", "headers");
      setupTagInput("exposeHeaderInput", "exposeHeadersContainer", "exposeHeaders");
      renderTags("headersContainer", "headers");

      function getConfig() {
        const allowAllOrigins = document.getElementById("allowAllOrigins").checked;
        const allowAllHeaders = document.getElementById("allowAllHeaders").checked;
        const allowCredentials = document.getElementById("allowCredentials").checked;
        const maxAge = document.getElementById("maxAge").value;

        const methods = [];
        document.querySelectorAll(".checkbox-group input[value]").forEach((cb) => {
          if (cb.checked && cb.value) methods.push(cb.value);
        });

        return {
          allowAllOrigins,
          origins: state.origins,
          methods,
          allowAllHeaders,
          headers: state.headers,
          exposeHeaders: state.exposeHeaders,
          allowCredentials,
          maxAge: parseInt(maxAge) || 86400
        };
      }

      function updateConfig() {
        const config = getConfig();

        // æ˜¾ç¤º/éšè—æ¥æºè¾“å…¥
        document.getElementById("originsGroup").style.display = config.allowAllOrigins
          ? "none"
          : "block";
        document.getElementById("headersGroup").style.display = config.allowAllHeaders
          ? "none"
          : "block";

        // è­¦å‘Šæ£€æŸ¥
        const warnings = [];
        if (config.allowAllOrigins) {
          warnings.push("å…è®¸æ‰€æœ‰æ¥æºå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜");
        }
        if (config.allowCredentials && config.allowAllOrigins) {
          warnings.push("æºå¸¦å‡­è¯æ—¶ä¸èƒ½ä½¿ç”¨ * ä½œä¸ºæ¥æºï¼Œæµè§ˆå™¨ä¼šæ‹’ç»æ­¤é…ç½®");
        }

        const warningBox = document.getElementById("warningBox");
        if (warnings.length > 0) {
          document.getElementById("warningText").textContent = warnings.join("ï¼›");
          warningBox.classList.add("show");
        } else {
          warningBox.classList.remove("show");
        }

        generateOutput();
      }

      function generateOutput() {
        const config = getConfig();
        const outputDiv = document.getElementById("outputContent");
        let output = "";

        const origin = config.allowAllOrigins
          ? "*"
          : config.origins.length > 0
            ? config.origins[0]
            : "https://example.com";
        const methods = config.methods.join(", ");
        const headers = config.allowAllHeaders ? "*" : config.headers.join(", ");
        const exposeHeaders = config.exposeHeaders.join(", ");

        switch (state.currentTab) {
          case "headers":
            output = "Access-Control-Allow-Origin: " + origin + "\n";
            output += "Access-Control-Allow-Methods: " + methods + "\n";
            output += "Access-Control-Allow-Headers: " + headers + "\n";
            if (exposeHeaders) {
              output += "Access-Control-Expose-Headers: " + exposeHeaders + "\n";
            }
            if (config.allowCredentials) {
              output += "Access-Control-Allow-Credentials: true\n";
            }
            output += "Access-Control-Max-Age: " + config.maxAge;
            break;

          case "nginx":
            output = "# CORS Configuration for Nginx\n";
            output += "location / {\n";
            if (config.allowAllOrigins) {
              output += "    add_header 'Access-Control-Allow-Origin' '*' always;\n";
            } else {
              output += "    # Dynamic origin handling\n";
              output += '    set $cors_origin "";\n';
              config.origins.forEach((o) => {
                output +=
                  '    if ($http_origin = "' + o + '") { set $cors_origin $http_origin; }\n';
              });
              output += "    add_header 'Access-Control-Allow-Origin' $cors_origin always;\n";
            }
            output += "    add_header 'Access-Control-Allow-Methods' '" + methods + "' always;\n";
            output += "    add_header 'Access-Control-Allow-Headers' '" + headers + "' always;\n";
            if (exposeHeaders) {
              output +=
                "    add_header 'Access-Control-Expose-Headers' '" + exposeHeaders + "' always;\n";
            }
            if (config.allowCredentials) {
              output += "    add_header 'Access-Control-Allow-Credentials' 'true' always;\n";
            }
            output += "    add_header 'Access-Control-Max-Age' '" + config.maxAge + "' always;\n\n";
            output += "    # Handle preflight requests\n";
            output += "    if ($request_method = 'OPTIONS') {\n";
            output += "        return 204;\n";
            output += "    }\n";
            output += "}";
            break;

          case "apache":
            output = "# CORS Configuration for Apache\n";
            output += "<IfModule mod_headers.c>\n";
            output += '    Header set Access-Control-Allow-Origin "' + origin + '"\n';
            output += '    Header set Access-Control-Allow-Methods "' + methods + '"\n';
            output += '    Header set Access-Control-Allow-Headers "' + headers + '"\n';
            if (exposeHeaders) {
              output += '    Header set Access-Control-Expose-Headers "' + exposeHeaders + '"\n';
            }
            if (config.allowCredentials) {
              output += '    Header set Access-Control-Allow-Credentials "true"\n';
            }
            output += '    Header set Access-Control-Max-Age "' + config.maxAge + '"\n';
            output += "</IfModule>\n\n";
            output += "# Handle preflight requests\n";
            output += "<IfModule mod_rewrite.c>\n";
            output += "    RewriteEngine On\n";
            output += "    RewriteCond %{REQUEST_METHOD} OPTIONS\n";
            output += "    RewriteRule ^(.*)$ $1 [R=204,L]\n";
            output += "</IfModule>";
            break;

          case "express":
            output = "// CORS Configuration for Express.js\n";
            output += "const cors = require('cors');\n\n";
            output += "const corsOptions = {\n";
            if (config.allowAllOrigins) {
              output += "    origin: '*',\n";
            } else if (config.origins.length === 1) {
              output += "    origin: '" + config.origins[0] + "',\n";
            } else if (config.origins.length > 1) {
              output += "    origin: [\n";
              config.origins.forEach((o, i) => {
                output += "        '" + o + "'" + (i < config.origins.length - 1 ? "," : "") + "\n";
              });
              output += "    ],\n";
            }
            output +=
              "    methods: [" + config.methods.map((m) => "'" + m + "'").join(", ") + "],\n";
            output +=
              "    allowedHeaders: [" +
              (config.allowAllHeaders
                ? "'*'"
                : config.headers.map((h) => "'" + h + "'").join(", ")) +
              "],\n";
            if (exposeHeaders) {
              output +=
                "    exposedHeaders: [" +
                config.exposeHeaders.map((h) => "'" + h + "'").join(", ") +
                "],\n";
            }
            output += "    credentials: " + config.allowCredentials + ",\n";
            output += "    maxAge: " + config.maxAge + "\n";
            output += "};\n\n";
            output += "app.use(cors(corsOptions));";
            break;

          case "spring":
            output = "// CORS Configuration for Spring Boot\n";
            output += "@Configuration\n";
            output += "public class CorsConfig implements WebMvcConfigurer {\n\n";
            output += "    @Override\n";
            output += "    public void addCorsMappings(CorsRegistry registry) {\n";
            output += '        registry.addMapping("/**")\n';
            if (config.allowAllOrigins) {
              output += '            .allowedOrigins("*")\n';
            } else {
              output +=
                "            .allowedOrigins(" +
                (config.origins.length > 0
                  ? config.origins.map((o) => '"' + o + '"').join(", ")
                  : '"https://example.com"') +
                ")\n";
            }
            output +=
              "            .allowedMethods(" +
              config.methods.map((m) => '"' + m + '"').join(", ") +
              ")\n";
            output +=
              "            .allowedHeaders(" +
              (config.allowAllHeaders
                ? '"*"'
                : config.headers.map((h) => '"' + h + '"').join(", ")) +
              ")\n";
            if (exposeHeaders) {
              output +=
                "            .exposedHeaders(" +
                config.exposeHeaders.map((h) => '"' + h + '"').join(", ") +
                ")\n";
            }
            output += "            .allowCredentials(" + config.allowCredentials + ")\n";
            output += "            .maxAge(" + config.maxAge + ");\n";
            output += "    }\n";
            output += "}";
            break;
        }

        outputDiv.textContent = output;
      }

      window.switchTab = function (tab) {
        state.currentTab = tab;
        document.querySelectorAll(".output-tab").forEach((t, i) => {
          const tabs = ["headers", "nginx", "apache", "express", "spring"];
          t.classList.toggle("active", tabs[i] === tab);
        });
        generateOutput();
      };

      window.copyOutput = function () {
        const output = document.getElementById("outputContent").textContent;
        navigator.clipboard.writeText(output).then(function () {
          showToast("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿");
        });
      };

      window.downloadConfig = function () {
        const output = document.getElementById("outputContent").textContent;
        const extensions = {
          headers: "txt",
          nginx: "conf",
          apache: "conf",
          express: "js",
          spring: "java"
        };

        const blob = new Blob([output], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "cors-config." + extensions[state.currentTab];
        a.click();
        URL.revokeObjectURL(url);
      };

      function showToast(message) {
        const toast = document.createElement("div");
        toast.textContent = message;
        toast.style.cssText =
          "position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#10b981;color:white;padding:0.75rem 1.5rem;border-radius:8px;z-index:1000;";
        document.body.appendChild(toast);
        setTimeout(function () {
          toast.remove();
        }, 2000);
      }

      // åˆå§‹åŒ–è¾“å‡º
      updateConfig();
    </script>
  </body>
</html>
