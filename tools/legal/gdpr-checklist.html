<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GDPR åˆè§„æ£€æŸ¥æ¸…å• - WebUtils</title>
  <meta name="description" content="å…¨é¢çš„ GDPR åˆè§„æ€§è‡ªæŸ¥æ¸…å•ï¼Œå¸®åŠ©ä¼ä¸šè¯„ä¼°æ•°æ®ä¿æŠ¤åˆè§„çŠ¶å†µ" />
  <meta name="keywords" content="GDPR åˆè§„ æ£€æŸ¥æ¸…å• æ•°æ®ä¿æŠ¤ éšç§ æ¬§ç›Ÿ" />
  <meta name="author" content="WebUtils" />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="GDPR åˆè§„æ£€æŸ¥æ¸…å• - WebUtils" />
  <meta property="og:description" content="å…¨é¢çš„ GDPR åˆè§„æ€§è‡ªæŸ¥æ¸…å•" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="WebUtils" />
  <meta property="og:locale" content="zh_CN" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="GDPR åˆè§„æ£€æŸ¥æ¸…å• - WebUtils" />
  <meta name="twitter:description" content="å…¨é¢çš„ GDPR åˆè§„æ€§è‡ªæŸ¥æ¸…å•" />

  <style>
    :root {
      --bg: #f8f9fa;
      --card-bg: #fff;
      --text: #212529;
      --text-muted: #6c757d;
      --border: #dee2e6;
      --primary: #6366f1;
      --primary-hover: #4f46e5;
      --success: #198754;
      --warning: #ffc107;
      --danger: #dc3545;
      --shadow: 0 2px 8px rgb(0,0,0,0.08);
      --radius: 8px;
    }

    [data-theme="dark"] {
      --bg: #0a0a0f;
      --card-bg: #1a1a24;
      --text: #e8e8ed;
      --text-muted: #9898a4;
      --border: #2a2a36;
      --primary: #818cf8;
      --primary-hover: #6366f1;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --shadow: 0 2px 8px rgb(0,0,0,0.3);
    }

    * { box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 24px;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .back-link {
      display: inline-block;
      margin-bottom: 16px;
      color: var(--primary);
      text-decoration: none;
      font-size: 0.9rem;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    .theme-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--card-bg);
      cursor: pointer;
      font-size: 1.2rem;
      z-index: 100;
      transition: all .2s;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    h1 {
      font-size: 1.75rem;
      margin: 0 0 8px;
    }

    .desc {
      color: var(--text-muted);
      margin: 0 0 24px;
      font-size: 0.95rem;
    }

    .card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 20px;
    }

    .progress-section {
      margin-bottom: 24px;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .progress-title {
      font-weight: 600;
      font-size: 1rem;
    }

    .progress-stats {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .progress-bar {
      height: 12px;
      background: var(--border);
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--success);
      transition: width 0.3s ease;
      border-radius: 6px;
    }

    .score-display {
      text-align: center;
      padding: 20px;
      background: var(--bg);
      border-radius: var(--radius);
      margin-bottom: 20px;
    }

    .score-value {
      font-size: 3rem;
      font-weight: 700;
      line-height: 1;
    }

    .score-value.good {
      color: var(--success);
    }

    .score-value.warning {
      color: var(--warning);
    }

    .score-value.danger {
      color: var(--danger);
    }

    .score-label {
      color: var(--text-muted);
      margin-top: 8px;
      font-size: 0.9rem;
    }

    .category {
      margin-bottom: 24px;
    }

    .category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: var(--bg);
      border-radius: var(--radius);
      cursor: pointer;
      margin-bottom: 12px;
    }

    .category-header:hover {
      opacity: 0.9;
    }

    .category-title {
      font-weight: 600;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .category-progress {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .category-items {
      padding-left: 8px;
    }

    .checklist-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid var(--border);
    }

    .checklist-item:last-child {
      border-bottom: none;
    }

    .checklist-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      cursor: pointer;
      accent-color: var(--primary);
    }

    .checklist-content {
      flex: 1;
    }

    .checklist-label {
      font-size: 0.95rem;
      margin-bottom: 4px;
      cursor: pointer;
    }

    .checklist-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .btn-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 20px;
    }

    button {
      padding: 10px 20px;
      font-size: 0.95rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--card-bg);
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    button.primary {
      background: var(--primary);
      border-color: var(--primary);
      color: #fff;
    }

    button.primary:hover {
      background: var(--primary-hover);
      border-color: var(--primary-hover);
      color: #fff;
    }

    .status {
      font-size: 0.85rem;
      margin-top: 8px;
      min-height: 20px;
    }

    .status.success {
      color: var(--success);
    }

    .status.error {
      color: var(--danger);
    }

    .recommendations {
      margin-top: 24px;
      padding: 16px;
      background: var(--bg);
      border-radius: var(--radius);
    }

    .recommendations-title {
      font-weight: 600;
      margin-bottom: 12px;
    }

    .recommendation-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 8px 0;
      font-size: 0.9rem;
    }

    .recommendation-item::before {
      content: "!";
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
      background: var(--warning);
      color: #000;
      border-radius: 50%;
      font-size: 0.75rem;
      font-weight: 700;
      flex-shrink: 0;
    }

    footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    footer a {
      color: var(--primary);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../../index.html" class="back-link">â† è¿”å›å·¥å…·åˆ—è¡¨</a>
    <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>

    <h1>GDPR åˆè§„æ£€æŸ¥æ¸…å•</h1>
    <p class="desc">å…¨é¢è¯„ä¼°æ‚¨çš„ç»„ç»‡æ˜¯å¦ç¬¦åˆã€Šé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹ã€‹(GDPR) è¦æ±‚</p>

    <div class="card">
      <div class="score-display">
        <div id="scoreValue" class="score-value">0%</div>
        <div class="score-label">åˆè§„è¯„åˆ†</div>
      </div>

      <div class="progress-section">
        <div class="progress-header">
          <span class="progress-title">æ•´ä½“è¿›åº¦</span>
          <span id="progressStats" class="progress-stats">0 / 0 å·²å®Œæˆ</span>
        </div>
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill" style="width: 0%"></div>
        </div>
      </div>

      <div id="checklistContainer"></div>

      <div id="recommendations" class="recommendations" style="display: none;">
        <div class="recommendations-title">éœ€è¦å…³æ³¨çš„äº‹é¡¹</div>
        <div id="recommendationsList"></div>
      </div>

      <div class="btn-row">
        <button class="primary" onclick="exportReport()">å¯¼å‡ºæŠ¥å‘Š</button>
        <button onclick="resetChecklist()">é‡ç½®</button>
      </div>

      <div id="status" class="status"></div>
    </div>

    <footer>
      çº¯å‰ç«¯å·¥å…· Â· æ— æœåŠ¡å™¨ Â· 
      <a href="../../index.html">WebUtils</a>
    </footer>
  </div>

  <script>
    var LS_KEY = 'gdpr_checklist_v1';

    var checklistData = [
      {
        id: 'lawful-basis',
        title: 'åˆæ³•æ€§åŸºç¡€',
        icon: 'âš–ï¸',
        items: [
          { id: 'lb1', label: 'è¯†åˆ«å¹¶è®°å½•æ¯ç§å¤„ç†æ´»åŠ¨çš„åˆæ³•æ€§åŸºç¡€', desc: 'ç¡®ä¿æ¯é¡¹æ•°æ®å¤„ç†éƒ½æœ‰æ˜ç¡®çš„æ³•å¾‹ä¾æ®ï¼ˆåŒæ„ã€åˆåŒã€æ³•å¾‹ä¹‰åŠ¡ç­‰ï¼‰' },
          { id: 'lb2', label: 'åŒæ„æœºåˆ¶æ¸…æ™°ã€å…·ä½“ã€å¯æ’¤å›', desc: 'ç”¨æˆ·åŒæ„å¿…é¡»æ˜¯è‡ªç”±ç»™äºˆã€å…·ä½“ã€çŸ¥æƒ…å’Œæ˜ç¡®çš„' },
          { id: 'lb3', label: 'è®°å½•æ‰€æœ‰åŒæ„çš„è·å–å’Œæ’¤å›', desc: 'ä¿ç•™åŒæ„è®°å½•ä½œä¸ºåˆè§„è¯æ®' },
          { id: 'lb4', label: 'å®šæœŸå®¡æŸ¥å¤„ç†æ´»åŠ¨çš„åˆæ³•æ€§åŸºç¡€', desc: 'ç¡®ä¿æ³•å¾‹åŸºç¡€æŒç»­æœ‰æ•ˆ' }
        ]
      },
      {
        id: 'data-subject-rights',
        title: 'æ•°æ®ä¸»ä½“æƒåˆ©',
        icon: 'ğŸ‘¤',
        items: [
          { id: 'dsr1', label: 'å»ºç«‹å“åº”æ•°æ®ä¸»ä½“è¯·æ±‚çš„æµç¨‹', desc: 'èƒ½å¤Ÿåœ¨ä¸€ä¸ªæœˆå†…å“åº”è®¿é—®ã€åˆ é™¤ã€æ›´æ­£ç­‰è¯·æ±‚' },
          { id: 'dsr2', label: 'æ”¯æŒæ•°æ®å¯æºå¸¦æƒ', desc: 'èƒ½å¤Ÿä»¥ç»“æ„åŒ–ã€æœºå™¨å¯è¯»çš„æ ¼å¼å¯¼å‡ºç”¨æˆ·æ•°æ®' },
          { id: 'dsr3', label: 'å®æ–½è¢«é—å¿˜æƒï¼ˆåˆ é™¤æƒï¼‰', desc: 'æœ‰èƒ½åŠ›å®Œå…¨åˆ é™¤ç”¨æˆ·æ•°æ®' },
          { id: 'dsr4', label: 'æä¾›é™åˆ¶å¤„ç†çš„æœºåˆ¶', desc: 'å…è®¸ç”¨æˆ·é™åˆ¶å…¶æ•°æ®çš„å¤„ç†æ–¹å¼' },
          { id: 'dsr5', label: 'æ”¯æŒåå¯¹æƒï¼Œç‰¹åˆ«æ˜¯ç›´æ¥è¥é”€', desc: 'ç”¨æˆ·å¯ä»¥åå¯¹å…¶æ•°æ®ç”¨äºè¥é”€ç›®çš„' }
        ]
      },
      {
        id: 'transparency',
        title: 'é€æ˜åº¦ä¸é€šçŸ¥',
        icon: 'ğŸ“‹',
        items: [
          { id: 'tr1', label: 'å‘å¸ƒæ¸…æ™°ã€æ˜“æ‡‚çš„éšç§æ”¿ç­–', desc: 'ä½¿ç”¨ç®€æ˜è¯­è¨€è§£é‡Šæ•°æ®å¤„ç†å®è·µ' },
          { id: 'tr2', label: 'åœ¨æ”¶é›†æ—¶æä¾›éšç§é€šçŸ¥', desc: 'å‘ŠçŸ¥ç”¨æˆ·æ•°æ®æ”¶é›†çš„ç›®çš„å’Œä½¿ç”¨æ–¹å¼' },
          { id: 'tr3', label: 'è¯´æ˜æ•°æ®ä¿ç•™æœŸé™', desc: 'æ˜ç¡®å‘ŠçŸ¥æ•°æ®ä¿å­˜å¤šé•¿æ—¶é—´' },
          { id: 'tr4', label: 'æŠ«éœ²ç¬¬ä¸‰æ–¹æ•°æ®å…±äº«', desc: 'åˆ—å‡ºæ‰€æœ‰æ¥æ”¶æ•°æ®çš„ç¬¬ä¸‰æ–¹' },
          { id: 'tr5', label: 'æä¾›æ•°æ®ä¿æŠ¤å®˜ï¼ˆDPOï¼‰è”ç³»æ–¹å¼', desc: 'å¦‚é€‚ç”¨ï¼Œå…¬å¼€ DPO çš„è”ç³»ä¿¡æ¯' }
        ]
      },
      {
        id: 'data-protection',
        title: 'æ•°æ®ä¿æŠ¤æªæ–½',
        icon: 'ğŸ”’',
        items: [
          { id: 'dp1', label: 'å®æ–½æ•°æ®åŠ å¯†ï¼ˆä¼ è¾“ä¸­å’Œé™æ€ï¼‰', desc: 'ä½¿ç”¨ HTTPSã€æ•°æ®åº“åŠ å¯†ç­‰æŠ€æœ¯' },
          { id: 'dp2', label: 'å®æ–½è®¿é—®æ§åˆ¶å’Œèº«ä»½éªŒè¯', desc: 'é™åˆ¶å¯¹ä¸ªäººæ•°æ®çš„è®¿é—®' },
          { id: 'dp3', label: 'è¿›è¡Œå®šæœŸå®‰å…¨è¯„ä¼°', desc: 'æ¼æ´æ‰«æã€æ¸—é€æµ‹è¯•ç­‰' },
          { id: 'dp4', label: 'å®æ–½æ•°æ®æœ€å°åŒ–åŸåˆ™', desc: 'ä»…æ”¶é›†å’Œä¿ç•™å¿…è¦çš„æ•°æ®' },
          { id: 'dp5', label: 'å®æ–½å‡ååŒ–æˆ–åŒ¿ååŒ–', desc: 'åœ¨å¯èƒ½çš„æƒ…å†µä¸‹é™ä½æ•°æ®è¯†åˆ«æ€§' }
        ]
      },
      {
        id: 'breach-management',
        title: 'æ•°æ®æ³„éœ²ç®¡ç†',
        icon: 'ğŸš¨',
        items: [
          { id: 'bm1', label: 'å»ºç«‹æ•°æ®æ³„éœ²æ£€æµ‹æœºåˆ¶', desc: 'èƒ½å¤ŸåŠæ—¶å‘ç°å®‰å…¨äº‹ä»¶' },
          { id: 'bm2', label: 'åˆ¶å®šæ•°æ®æ³„éœ²å“åº”è®¡åˆ’', desc: 'æ˜ç¡®æ³„éœ²å‘ç”Ÿæ—¶çš„å¤„ç†æµç¨‹' },
          { id: 'bm3', label: 'èƒ½å¤Ÿåœ¨72å°æ—¶å†…é€šçŸ¥ç›‘ç®¡æœºæ„', desc: 'GDPR è¦æ±‚çš„å¼ºåˆ¶é€šçŸ¥æ—¶é™' },
          { id: 'bm4', label: 'å»ºç«‹å—å½±å“ä¸ªäººé€šçŸ¥æµç¨‹', desc: 'é«˜é£é™©æ³„éœ²éœ€é€šçŸ¥æ•°æ®ä¸»ä½“' },
          { id: 'bm5', label: 'è®°å½•æ‰€æœ‰æ•°æ®æ³„éœ²äº‹ä»¶', desc: 'ç»´æŠ¤æ³„éœ²äº‹ä»¶æ—¥å¿—' }
        ]
      },
      {
        id: 'accountability',
        title: 'é—®è´£åˆ¶',
        icon: 'ğŸ“Š',
        items: [
          { id: 'ac1', label: 'ç»´æŠ¤å¤„ç†æ´»åŠ¨è®°å½• (ROPA)', desc: 'è®°å½•æ‰€æœ‰æ•°æ®å¤„ç†æ´»åŠ¨çš„è¯¦ç»†ä¿¡æ¯' },
          { id: 'ac2', label: 'è¿›è¡Œæ•°æ®ä¿æŠ¤å½±å“è¯„ä¼° (DPIA)', desc: 'å¯¹é«˜é£é™©å¤„ç†è¿›è¡Œå½±å“è¯„ä¼°' },
          { id: 'ac3', label: 'ä»»å‘½æ•°æ®ä¿æŠ¤å®˜ï¼ˆå¦‚éœ€è¦ï¼‰', desc: 'å¤§è§„æ¨¡å¤„ç†æ•æ„Ÿæ•°æ®æ—¶å¿…é¡»ä»»å‘½' },
          { id: 'ac4', label: 'å®æ–½éšç§è®¾è®¡å’Œé»˜è®¤éšç§', desc: 'åœ¨äº§å“è®¾è®¡é˜¶æ®µå°±è€ƒè™‘éšç§ä¿æŠ¤' },
          { id: 'ac5', label: 'å¯¹å‘˜å·¥è¿›è¡Œæ•°æ®ä¿æŠ¤åŸ¹è®­', desc: 'ç¡®ä¿å‘˜å·¥äº†è§£ GDPR è¦æ±‚' }
        ]
      },
      {
        id: 'third-party',
        title: 'ç¬¬ä¸‰æ–¹ç®¡ç†',
        icon: 'ğŸ¤',
        items: [
          { id: 'tp1', label: 'ä¸æ•°æ®å¤„ç†è€…ç­¾è®¢åˆåŒ', desc: 'ç¡®ä¿åˆåŒåŒ…å« GDPR è¦æ±‚çš„æ¡æ¬¾' },
          { id: 'tp2', label: 'è¯„ä¼°ç¬¬ä¸‰æ–¹çš„åˆè§„çŠ¶å†µ', desc: 'å°½èŒè°ƒæŸ¥ä¾›åº”å•†çš„æ•°æ®ä¿æŠ¤å®è·µ' },
          { id: 'tp3', label: 'ç›‘æ§ç¬¬ä¸‰æ–¹æ•°æ®å¤„ç†', desc: 'å®šæœŸå®¡æŸ¥ç¬¬ä¸‰æ–¹çš„åˆè§„æ€§' },
          { id: 'tp4', label: 'è·¨å¢ƒæ•°æ®ä¼ è¾“æœ‰é€‚å½“ä¿éšœ', desc: 'ä½¿ç”¨æ ‡å‡†åˆåŒæ¡æ¬¾æˆ–å…¶ä»–æœºåˆ¶' }
        ]
      },
      {
        id: 'special-categories',
        title: 'ç‰¹æ®Šç±»åˆ«æ•°æ®',
        icon: 'âš ï¸',
        items: [
          { id: 'sc1', label: 'è¯†åˆ«æ‰€æœ‰ç‰¹æ®Šç±»åˆ«æ•°æ®å¤„ç†', desc: 'å¥åº·ã€ç”Ÿç‰©ç‰¹å¾ã€å®—æ•™ä¿¡ä»°ç­‰æ•æ„Ÿæ•°æ®' },
          { id: 'sc2', label: 'æœ‰å¤„ç†ç‰¹æ®Šç±»åˆ«æ•°æ®çš„é¢å¤–æ³•å¾‹åŸºç¡€', desc: 'éœ€è¦æ»¡è¶³ç¬¬9æ¡çš„é¢å¤–æ¡ä»¶' },
          { id: 'sc3', label: 'å¯¹ç‰¹æ®Šç±»åˆ«æ•°æ®å®æ–½å¢å¼ºä¿æŠ¤', desc: 'æ›´ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶å’Œå®‰å…¨æªæ–½' }
        ]
      }
    ];

    var checkedItems = {};

    function init() {
      loadFromStorage();
      renderChecklist();
      updateProgress();
    }

    function renderChecklist() {
      var container = document.getElementById('checklistContainer');
      container.textContent = '';

      checklistData.forEach(function(category) {
        var categoryDiv = document.createElement('div');
        categoryDiv.className = 'category';

        var header = document.createElement('div');
        header.className = 'category-header';
        
        var title = document.createElement('span');
        title.className = 'category-title';
        title.textContent = category.icon + ' ' + category.title;
        
        var progress = document.createElement('span');
        progress.className = 'category-progress';
        progress.id = 'progress-' + category.id;
        
        header.appendChild(title);
        header.appendChild(progress);

        var itemsDiv = document.createElement('div');
        itemsDiv.className = 'category-items';

        category.items.forEach(function(item) {
          var itemDiv = document.createElement('div');
          itemDiv.className = 'checklist-item';

          var checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.id = item.id;
          checkbox.checked = !!checkedItems[item.id];
          checkbox.addEventListener('change', function() {
            checkedItems[item.id] = checkbox.checked;
            saveToStorage();
            updateProgress();
          });

          var content = document.createElement('div');
          content.className = 'checklist-content';

          var label = document.createElement('label');
          label.className = 'checklist-label';
          label.htmlFor = item.id;
          label.textContent = item.label;

          var desc = document.createElement('div');
          desc.className = 'checklist-desc';
          desc.textContent = item.desc;

          content.appendChild(label);
          content.appendChild(desc);

          itemDiv.appendChild(checkbox);
          itemDiv.appendChild(content);
          itemsDiv.appendChild(itemDiv);
        });

        categoryDiv.appendChild(header);
        categoryDiv.appendChild(itemsDiv);
        container.appendChild(categoryDiv);
      });
    }

    function updateProgress() {
      var total = 0;
      var completed = 0;
      var uncheckedItems = [];

      checklistData.forEach(function(category) {
        var categoryTotal = category.items.length;
        var categoryCompleted = 0;

        category.items.forEach(function(item) {
          total++;
          if (checkedItems[item.id]) {
            completed++;
            categoryCompleted++;
          } else {
            uncheckedItems.push(item);
          }
        });

        var progressEl = document.getElementById('progress-' + category.id);
        if (progressEl) {
          progressEl.textContent = categoryCompleted + ' / ' + categoryTotal;
        }
      });

      var percentage = total > 0 ? Math.round((completed / total) * 100) : 0;

      document.getElementById('progressStats').textContent = completed + ' / ' + total + ' å·²å®Œæˆ';
      document.getElementById('progressFill').style.width = percentage + '%';

      var scoreEl = document.getElementById('scoreValue');
      scoreEl.textContent = percentage + '%';
      scoreEl.className = 'score-value';
      if (percentage >= 80) {
        scoreEl.classList.add('good');
      } else if (percentage >= 50) {
        scoreEl.classList.add('warning');
      } else {
        scoreEl.classList.add('danger');
      }

      // Update recommendations
      var recommendationsEl = document.getElementById('recommendations');
      var listEl = document.getElementById('recommendationsList');
      
      if (uncheckedItems.length > 0 && uncheckedItems.length <= 10) {
        recommendationsEl.style.display = 'block';
        listEl.textContent = '';
        
        uncheckedItems.slice(0, 5).forEach(function(item) {
          var div = document.createElement('div');
          div.className = 'recommendation-item';
          div.textContent = item.label;
          listEl.appendChild(div);
        });

        if (uncheckedItems.length > 5) {
          var more = document.createElement('div');
          more.className = 'recommendation-item';
          more.textContent = 'è¿˜æœ‰ ' + (uncheckedItems.length - 5) + ' é¡¹éœ€è¦å®Œæˆ...';
          listEl.appendChild(more);
        }
      } else {
        recommendationsEl.style.display = 'none';
      }
    }

    function saveToStorage() {
      try {
        localStorage.setItem(LS_KEY, JSON.stringify(checkedItems));
      } catch (e) {}
    }

    function loadFromStorage() {
      try {
        var saved = localStorage.getItem(LS_KEY);
        if (saved) {
          checkedItems = JSON.parse(saved);
        }
      } catch (e) {
        checkedItems = {};
      }
    }

    function showStatus(msg, type) {
      var el = document.getElementById('status');
      el.textContent = msg;
      el.className = 'status ' + (type || '');
    }

    function exportReport() {
      var total = 0;
      var completed = 0;
      var lines = [];

      lines.push('GDPR åˆè§„æ£€æŸ¥æŠ¥å‘Š');
      lines.push('ç”Ÿæˆæ—¥æœŸï¼š' + new Date().toLocaleString('zh-CN'));
      lines.push('');
      lines.push('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      lines.push('');

      checklistData.forEach(function(category) {
        var categoryCompleted = 0;
        var categoryTotal = category.items.length;

        lines.push(category.icon + ' ' + category.title);
        lines.push('â”€'.repeat(40));

        category.items.forEach(function(item) {
          total++;
          var isChecked = !!checkedItems[item.id];
          if (isChecked) {
            completed++;
            categoryCompleted++;
          }
          lines.push((isChecked ? '[âœ“]' : '[ ]') + ' ' + item.label);
        });

        lines.push('è¿›åº¦: ' + categoryCompleted + '/' + categoryTotal);
        lines.push('');
      });

      var percentage = total > 0 ? Math.round((completed / total) * 100) : 0;

      lines.push('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      lines.push('');
      lines.push('æ€»ä½“åˆè§„è¯„åˆ†: ' + percentage + '%');
      lines.push('å·²å®Œæˆ: ' + completed + ' / ' + total + ' é¡¹');
      lines.push('');

      if (percentage >= 80) {
        lines.push('è¯„ä¼°ç»“æœ: è‰¯å¥½');
        lines.push('æ‚¨çš„ç»„ç»‡åœ¨ GDPR åˆè§„æ–¹é¢è¡¨ç°è‰¯å¥½ï¼Œè¯·ç»§ç»­ä¿æŒå¹¶å®šæœŸå®¡æŸ¥ã€‚');
      } else if (percentage >= 50) {
        lines.push('è¯„ä¼°ç»“æœ: éœ€è¦æ”¹è¿›');
        lines.push('æ‚¨çš„ç»„ç»‡éœ€è¦åœ¨å¤šä¸ªæ–¹é¢åŠ å¼º GDPR åˆè§„å·¥ä½œã€‚');
      } else {
        lines.push('è¯„ä¼°ç»“æœ: é«˜é£é™©');
        lines.push('æ‚¨çš„ç»„ç»‡å­˜åœ¨é‡å¤§åˆè§„ç¼ºå£ï¼Œå»ºè®®ç«‹å³é‡‡å–è¡ŒåŠ¨ã€‚');
      }

      lines.push('');
      lines.push('å…è´£å£°æ˜: æœ¬æ£€æŸ¥æ¸…å•ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæ³•å¾‹å»ºè®®ã€‚');
      lines.push('å¦‚éœ€ä¸“ä¸šæ³•å¾‹æ„è§ï¼Œè¯·å’¨è¯¢æ•°æ®ä¿æŠ¤å¾‹å¸ˆæˆ–é¡¾é—®ã€‚');

      var content = lines.join('\n');
      var blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.href = url;
      a.download = 'GDPRåˆè§„æŠ¥å‘Š_' + new Date().toISOString().split('T')[0] + '.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      showStatus('æŠ¥å‘Šå·²å¯¼å‡º', 'success');
    }

    function resetChecklist() {
      if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ£€æŸ¥é¡¹å—ï¼Ÿ')) {
        checkedItems = {};
        localStorage.removeItem(LS_KEY);
        renderChecklist();
        updateProgress();
        showStatus('å·²é‡ç½®', 'success');
      }
    }

    function toggleTheme() {
      var html = document.documentElement;
      var btn = document.querySelector('.theme-toggle');
      var next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);
      btn.textContent = next === 'dark' ? 'ğŸŒ™' : 'â˜€ï¸';
      localStorage.setItem('theme', next);
    }

    (function() {
      var savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
        var btn = document.querySelector('.theme-toggle');
        if (btn) btn.textContent = savedTheme === 'dark' ? 'ğŸŒ™' : 'â˜€ï¸';
      }
      init();
    })();
  </script>
</body>
</html>
