<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EXIF ä¿¡æ¯ç§»é™¤å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="EXIF ä¿¡æ¯ç§»é™¤å™¨ - WebUtils" />
    <meta name="keywords" content="exif-remover,privacy,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/privacy/exif-remover.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="EXIF ä¿¡æ¯ç§»é™¤å™¨ - WebUtils" />
    <meta property="og:description" content="EXIF ä¿¡æ¯ç§»é™¤å™¨ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/privacy/exif-remover.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="EXIF ä¿¡æ¯ç§»é™¤å™¨ - WebUtils" />
    <meta name="twitter:description" content="EXIF ä¿¡æ¯ç§»é™¤å™¨ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border-subtle);
        background: var(--bg-card);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      .container {
        max-width: 1000px;
        padding: 20px;
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }
      .drop-zone {
        border: 3px dashed var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        padding: 3rem 2rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 1.5rem;
      }
      .drop-zone:hover,
      .drop-zone.dragover {
        border-color: var(--pico-primary);
        background: var(--pico-primary-focus);
      }
      .drop-zone-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
      }
      .drop-zone p {
        margin: 0.5rem 0;
        color: var(--pico-muted-color);
      }
      .file-input {
        display: none;
      }
      .image-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }
      .image-card {
        border: 1px solid var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        overflow: hidden;
        background: var(--pico-card-background-color);
      }
      .image-preview {
        width: 100%;
        height: 180px;
        object-fit: cover;
        background: var(--pico-background-color);
      }
      .image-info {
        padding: 0.75rem;
      }
      .image-name {
        font-weight: bold;
        margin-bottom: 0.25rem;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .image-meta {
        font-size: 0.85rem;
        color: var(--pico-muted-color);
        margin-bottom: 0.5rem;
      }
      .exif-status {
        display: inline-block;
        padding: 0.2rem 0.5rem;
        border-radius: 3px;
        font-size: 0.75rem;
        font-weight: bold;
      }
      .exif-status.has-exif {
        background: #fef3c7;
        color: #92400e;
      }
      .exif-status.no-exif {
        background: #dcfce7;
        color: #166534;
      }
      .exif-status.removed {
        background: #dbeafe;
        color: #1e40af;
      }
      [data-theme="dark"] .exif-status.has-exif {
        background: #92400e;
        color: #fef3c7;
      }
      [data-theme="dark"] .exif-status.no-exif {
        background: #166534;
        color: #dcfce7;
      }
      [data-theme="dark"] .exif-status.removed {
        background: #1e40af;
        color: #dbeafe;
      }
      .image-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.5rem;
      }
      .image-actions button {
        flex: 1;
        padding: 0.3rem 0.5rem;
        font-size: 0.8rem;
        margin: 0;
      }
      .toolbar {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        flex-wrap: wrap;
        padding: 1rem;
        background: var(--pico-card-background-color);
        border-radius: var(--pico-border-radius);
      }
      .toolbar button {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
        margin: 0;
      }
      .stats {
        margin-left: auto;
        display: flex;
        align-items: center;
        gap: 1rem;
        font-size: 0.9rem;
      }
      .stats span {
        color: var(--pico-muted-color);
      }
      .empty-state {
        text-align: center;
        padding: 3rem;
        color: var(--pico-muted-color);
      }
      .panel {
        border: 1px solid var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        padding: 1rem;
        background: var(--pico-card-background-color);
        margin-bottom: 1rem;
      }
      .panel h3 {
        margin-top: 0;
        margin-bottom: 0.5rem;
      }
      .info-box {
        background: var(--pico-background-color);
        border-radius: var(--pico-border-radius);
        padding: 1rem;
        font-size: 0.9rem;
      }
      .info-box ul {
        margin: 0.5rem 0;
        padding-left: 1.5rem;
      }
      .info-box li {
        margin: 0.25rem 0;
      }
      .quality-slider {
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .quality-slider input[type="range"] {
        flex: 1;
      }
      .quality-value {
        min-width: 3rem;
        text-align: center;
        font-weight: bold;
      }
      .processing {
        position: relative;
      }
      .processing::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">
      <span id="theme-icon">ğŸŒ™</span>
    </button>

    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      EXIF ä¿¡æ¯ç§»é™¤å™¨
    </nav>
    <main class="container">
      <div class="header">
        <h1>EXIF ä¿¡æ¯ç§»é™¤å™¨</h1>
        <button id="themeToggle" class="outline">æ·±è‰²æ¨¡å¼</button>
      </div>

      <div class="panel">
        <h3>å…³äº EXIF ä¿¡æ¯</h3>
        <div class="info-box">
          <p>EXIFï¼ˆå¯äº¤æ¢å›¾åƒæ–‡ä»¶æ ¼å¼ï¼‰ä¿¡æ¯åŒ…å«å›¾ç‰‡çš„å…ƒæ•°æ®ï¼Œå¯èƒ½åŒ…æ‹¬ï¼š</p>
          <ul>
            <li>
              <strong>GPS ä½ç½®</strong>
              - æ‹æ‘„åœ°ç‚¹çš„ç²¾ç¡®åæ ‡
            </li>
            <li>
              <strong>æ‹æ‘„æ—¶é—´</strong>
              - ç…§ç‰‡æ‹æ‘„çš„æ—¥æœŸå’Œæ—¶é—´
            </li>
            <li>
              <strong>è®¾å¤‡ä¿¡æ¯</strong>
              - ç›¸æœº/æ‰‹æœºå‹å·ã€é•œå¤´å‚æ•°
            </li>
            <li>
              <strong>æ‹æ‘„å‚æ•°</strong>
              - å…‰åœˆã€å¿«é—¨ã€ISO ç­‰
            </li>
          </ul>
          <p>
            åˆ†äº«ç…§ç‰‡å‰ç§»é™¤è¿™äº›ä¿¡æ¯å¯ä»¥ä¿æŠ¤æ‚¨çš„éšç§ã€‚æ‰€æœ‰å¤„ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œå›¾ç‰‡ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚
          </p>
        </div>
      </div>

      <div class="panel">
        <h3>è¾“å‡ºè®¾ç½®</h3>
        <label>
          è¾“å‡ºè´¨é‡
          <div class="quality-slider">
            <input type="range" id="quality" min="10" max="100" value="92" />
            <span class="quality-value" id="qualityValue">92%</span>
          </div>
        </label>
        <small>è¾ƒé«˜çš„è´¨é‡ä¼šäº§ç”Ÿè¾ƒå¤§çš„æ–‡ä»¶ã€‚JPEG æ ¼å¼å›¾ç‰‡å»ºè®®ä½¿ç”¨ 85-95%ã€‚</small>
      </div>

      <div class="drop-zone" id="dropZone">
        <div class="drop-zone-icon">ğŸ“·</div>
        <p><strong>æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„</strong></p>
        <p>æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
        <p><small>æ”¯æŒ JPGã€PNGã€WebP æ ¼å¼ï¼Œå¯å¤šé€‰</small></p>
        <input
          type="file"
          id="fileInput"
          class="file-input"
          accept="image/jpeg,image/png,image/webp"
          multiple
        />
      </div>

      <div class="toolbar" id="toolbar" style="display: none">
        <button onclick="removeAllExif()">ç§»é™¤æ‰€æœ‰ EXIF</button>
        <button class="secondary" onclick="downloadAll()">ä¸‹è½½å…¨éƒ¨</button>
        <button class="secondary outline" onclick="clearAll()">æ¸…ç©ºåˆ—è¡¨</button>
        <div class="stats">
          <span>
            å…±
            <strong id="totalCount">0</strong>
            å¼ å›¾ç‰‡
          </span>
          <span>
            å·²å¤„ç†
            <strong id="processedCount">0</strong>
            å¼ 
          </span>
        </div>
      </div>

      <div class="image-list" id="imageList">
        <div class="empty-state">
          <p>æš‚æ— å›¾ç‰‡ï¼Œè¯·æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šæ–¹åŒºåŸŸæ·»åŠ </p>
        </div>
      </div>
    </main>

    <script>
      const themeToggle = document.getElementById("themeToggle");
      const dropZone = document.getElementById("dropZone");
      const fileInput = document.getElementById("fileInput");
      const imageList = document.getElementById("imageList");
      const toolbar = document.getElementById("toolbar");
      const qualityInput = document.getElementById("quality");
      const qualityValue = document.getElementById("qualityValue");
      const totalCountEl = document.getElementById("totalCount");
      const processedCountEl = document.getElementById("processedCount");

      let images = [];

      // ä¸»é¢˜åˆ‡æ¢
      function initTheme() {
        const savedTheme = localStorage.getItem("exif-remover-theme") || "light";
        document.documentElement.setAttribute("data-theme", savedTheme);
        updateThemeButton(savedTheme);
      }

      function updateThemeButton(theme) {
        themeToggle.textContent = theme === "dark" ? "æµ…è‰²æ¨¡å¼" : "æ·±è‰²æ¨¡å¼";
      }

      themeToggle.addEventListener("click", () => {
        const currentTheme = document.documentElement.getAttribute("data-theme");
        const newTheme = currentTheme === "dark" ? "light" : "dark";
        document.documentElement.setAttribute("data-theme", newTheme);
        localStorage.setItem("exif-remover-theme", newTheme);
        updateThemeButton(newTheme);
      });

      // è´¨é‡æ»‘å—
      qualityInput.addEventListener("input", () => {
        qualityValue.textContent = qualityInput.value + "%";
      });

      // æ‹–æ‹½å¤„ç†
      dropZone.addEventListener("click", () => fileInput.click());

      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });

      dropZone.addEventListener("dragleave", () => {
        dropZone.classList.remove("dragover");
      });

      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
        handleFiles(e.dataTransfer.files);
      });

      fileInput.addEventListener("change", (e) => {
        handleFiles(e.target.files);
        fileInput.value = "";
      });

      // å¤„ç†æ–‡ä»¶
      function handleFiles(files) {
        const validFiles = Array.from(files).filter(
          (f) => f.type === "image/jpeg" || f.type === "image/png" || f.type === "image/webp"
        );

        if (validFiles.length === 0) {
          alert("è¯·é€‰æ‹©æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶ï¼ˆJPGã€PNG æˆ– WebPï¼‰");
          return;
        }

        validFiles.forEach((file) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const img = {
              id: Date.now() + Math.random(),
              name: file.name,
              type: file.type,
              size: file.size,
              originalData: e.target.result,
              cleanData: null,
              hasExif: checkHasExif(e.target.result),
              processed: false
            };
            images.push(img);
            renderImages();
            updateStats();
          };
          reader.readAsDataURL(file);
        });
      }

      // ç®€å•æ£€æµ‹æ˜¯å¦æœ‰ EXIFï¼ˆæ£€æŸ¥ JPEG APP1 æ ‡è®°ï¼‰
      function checkHasExif(dataUrl) {
        // å¯¹äº JPEGï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å« EXIF æ ‡è®°
        if (dataUrl.includes("data:image/jpeg")) {
          // ç®€å•æ£€æŸ¥ï¼šå¤§éƒ¨åˆ†å¸¦æœ‰ EXIF çš„å›¾ç‰‡éƒ½ä¼šæœ‰è¿™äº›æ ‡è®°
          // è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„æ£€æµ‹æ–¹æ³•
          return true; // å‡è®¾ JPEG éƒ½å¯èƒ½æœ‰ EXIF
        }
        return false;
      }

      // æ¸²æŸ“å›¾ç‰‡åˆ—è¡¨
      function renderImages() {
        if (images.length === 0) {
          imageList.innerHTML =
            '<div class="empty-state"><p>æš‚æ— å›¾ç‰‡ï¼Œè¯·æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šæ–¹åŒºåŸŸæ·»åŠ </p></div>';
          toolbar.style.display = "none";
          return;
        }

        toolbar.style.display = "flex";
        imageList.innerHTML = images
          .map(
            (img) => `
                <div class="image-card" data-id="${img.id}">
                    <img class="image-preview" src="${img.cleanData || img.originalData}" alt="${img.name}">
                    <div class="image-info">
                        <div class="image-name" title="${img.name}">${img.name}</div>
                        <div class="image-meta">
                            ${formatSize(img.size)} | ${img.type.split("/")[1].toUpperCase()}
                        </div>
                        <span class="exif-status ${img.processed ? "removed" : img.hasExif ? "has-exif" : "no-exif"}">
                            ${img.processed ? "EXIF å·²ç§»é™¤" : img.hasExif ? "å¯èƒ½å«æœ‰ EXIF" : "æ—  EXIF"}
                        </span>
                        <div class="image-actions">
                            <button class="secondary" onclick="removeExif('${img.id}')">ç§»é™¤ EXIF</button>
                            <button class="outline" onclick="downloadImage('${img.id}')">ä¸‹è½½</button>
                            <button class="outline" onclick="removeImage('${img.id}')">åˆ é™¤</button>
                        </div>
                    </div>
                </div>
            `
          )
          .join("");
      }

      // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
      function formatSize(bytes) {
        if (bytes < 1024) return bytes + " B";
        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + " KB";
        return (bytes / (1024 * 1024)).toFixed(2) + " MB";
      }

      // ç§»é™¤å•ä¸ªå›¾ç‰‡çš„ EXIF
      function removeExif(id) {
        const img = images.find((i) => i.id == id);
        if (!img) return;

        const quality = parseInt(qualityInput.value) / 100;

        const image = new Image();
        image.onload = () => {
          const canvas = document.createElement("canvas");
          canvas.width = image.naturalWidth;
          canvas.height = image.naturalHeight;

          const ctx = canvas.getContext("2d");
          ctx.drawImage(image, 0, 0);

          // æ ¹æ®åŸå§‹ç±»å‹è¾“å‡º
          let outputType = img.type;
          let outputQuality = quality;

          // PNG ä¸æ”¯æŒè´¨é‡å‚æ•°
          if (outputType === "image/png") {
            img.cleanData = canvas.toDataURL("image/png");
          } else {
            img.cleanData = canvas.toDataURL(outputType, outputQuality);
          }

          img.processed = true;
          img.hasExif = false;

          // æ›´æ–°å¤§å°
          const base64Length = img.cleanData.split(",")[1].length;
          img.cleanSize = Math.round((base64Length * 3) / 4);

          renderImages();
          updateStats();
        };
        image.src = img.originalData;
      }

      // ç§»é™¤æ‰€æœ‰ EXIF
      window.removeAllExif = function () {
        images.forEach((img) => {
          if (!img.processed) {
            removeExif(img.id);
          }
        });
      };

      // ä¸‹è½½å•ä¸ªå›¾ç‰‡
      window.downloadImage = function (id) {
        const img = images.find((i) => i.id == id);
        if (!img) return;

        const data = img.cleanData || img.originalData;
        const a = document.createElement("a");
        a.href = data;

        // ç”Ÿæˆæ–°æ–‡ä»¶å
        const nameParts = img.name.split(".");
        const ext = nameParts.pop();
        const baseName = nameParts.join(".");
        a.download = img.processed ? `${baseName}_no_exif.${ext}` : img.name;

        a.click();
      };

      // ä¸‹è½½æ‰€æœ‰å›¾ç‰‡
      window.downloadAll = function () {
        images.forEach((img, index) => {
          setTimeout(() => {
            downloadImage(img.id);
          }, index * 200);
        });
      };

      // åˆ é™¤å•ä¸ªå›¾ç‰‡
      window.removeImage = function (id) {
        images = images.filter((i) => i.id != id);
        renderImages();
        updateStats();
      };

      // æ¸…ç©ºæ‰€æœ‰
      window.clearAll = function () {
        if (images.length === 0) return;
        if (confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å›¾ç‰‡å—ï¼Ÿ")) {
          images = [];
          renderImages();
          updateStats();
        }
      };

      // æ›´æ–°ç»Ÿè®¡
      function updateStats() {
        totalCountEl.textContent = images.length;
        processedCountEl.textContent = images.filter((i) => i.processed).length;
      }

      // åˆå§‹åŒ–
      initTheme();

      // Theme toggle
      function toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        document.getElementById("theme-icon").textContent = newTheme === "light" ? "â˜€ï¸" : "ğŸŒ™";
        localStorage.setItem("theme", newTheme);
      }

      // Load saved theme
      const savedTheme = localStorage.getItem("theme") || "dark";
      if (savedTheme === "light") {
        document.documentElement.setAttribute("data-theme", "light");
        document.getElementById("theme-icon").textContent = "â˜€ï¸";
      }
    </script>
  </body>
</html>
