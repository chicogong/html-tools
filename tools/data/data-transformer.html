<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>æ•°æ®è½¬æ¢å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="åœ¨çº¿æ•°æ®è½¬æ¢å·¥å…·ï¼Œæ”¯æŒæ·»åŠ å‰ç¼€åç¼€ã€åŒ…è£¹ã€æ•°å­—æ ¼å¼åŒ–ã€æ¨¡æ¿æ›¿æ¢ç­‰æ‰¹é‡å¤„ç†"
    />
    <meta
      name="keywords"
      content="data transform è½¬æ¢ prefix suffix wrap template æ¨¡æ¿ æ‰¹é‡å¤„ç†"
    />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link
      rel="canonical"
      href="https://tools.realtime-ai.chat/tools/data/data-transformer.html"
    />

    <!-- Open Graph -->
    <meta property="og:title" content="æ•°æ®è½¬æ¢å™¨ - WebUtils" />
    <meta
      property="og:description"
      content="åœ¨çº¿æ•°æ®è½¬æ¢å·¥å…·ï¼Œæ”¯æŒæ·»åŠ å‰ç¼€åç¼€ã€åŒ…è£¹ã€æ•°å­—æ ¼å¼åŒ–ã€æ¨¡æ¿æ›¿æ¢ç­‰æ‰¹é‡å¤„ç†"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/data/data-transformer.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="æ•°æ®è½¬æ¢å™¨ - WebUtils" />
    <meta
      name="twitter:description"
      content="åœ¨çº¿æ•°æ®è½¬æ¢å·¥å…·ï¼Œæ”¯æŒæ·»åŠ å‰ç¼€åç¼€ã€åŒ…è£¹ã€æ•°å­—æ ¼å¼åŒ–ã€æ¨¡æ¿æ›¿æ¢ç­‰æ‰¹é‡å¤„ç†"
    />
    <!-- OG Image -->
    <meta
      property="og:image"
      content="https://tools.realtime-ai.chat/social-preview.png"
    />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />
    <meta
      name="twitter:image"
      content="https://tools.realtime-ai.chat/social-preview.png"
    />

    <!-- JSON-LD BreadcrumbList Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "é¦–é¡µ",
            "item": "https://tools.realtime-ai.chat/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "æ•°æ®å·¥å…·",
            "item": "https://tools.realtime-ai.chat/#data"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "æ•°æ®è½¬æ¢å™¨",
            "item": "https://tools.realtime-ai.chat/tools/data/data-transformer.html"
          }
        ]
      }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-magenta: #f72585;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-blue: #4cc9f0;
        --accent-purple: #7b2cbf;
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
        --font-sans: "Space Grotesk", -apple-system, blinkmacsystemfont, "Segoe UI", roboto, sans-serif;
        --font-mono: "JetBrains Mono", "Courier New", monospace;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
        --accent-cyan: #00d4b8;
        --accent-magenta: #e63975;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }
      
      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border-subtle);
        background: var(--color-bg-card);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
      }
      .theme-toggle:hover {
        transform: scale(1.1);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: var(--font-sans);
        background: var(--color-bg-deep);
        color: var(--color-text-primary);
        min-height: 100vh;
        line-height: 1.6;
      }

      .bg-grid {
        position: fixed;
        inset: 0;
        background-image: linear-gradient(
            rgb(0, 245, 212, 0.02) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgb(0, 245, 212, 0.02) 1px, transparent 1px);
        background-size: 40px 40px;
        pointer-events: none;
        z-index: 0;
      }

      .container {
        position: relative;
        z-index: 1;
        max-width: 1200px;
        margin: 0 auto;
        padding: 24px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .header {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 24px;
        flex-wrap: wrap;
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 8px;
        font-family: var(--font-mono);
        font-size: 0.85rem;
        padding: 8px 14px;
        background: var(--color-bg-surface);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-sm);
        flex-wrap: wrap;
      }

      .breadcrumb a {
        color: var(--color-text-secondary);
        text-decoration: none;
        transition: color 0.2s ease;
      }

      .breadcrumb a:hover {
        color: var(--color-accent-cyan);
      }

      .breadcrumb-separator {
        color: var(--text-muted);
        user-select: none;
      }

      .breadcrumb-current {
        color: var(--color-text-primary);
        font-weight: 500;
      }

      .title-section {
        flex: 1;
      }

      .title-section h1 {
        font-family: var(--font-mono);
        font-size: 1.5rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .title-section h1 .icon {
        font-size: 1.8rem;
      }

      .title-section p {
        color: var(--color-text-secondary);
        margin-top: 4px;
        font-size: 0.9rem;
      }

      .main-content {
        background: var(--color-bg-card);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: 24px;
        flex: 1;
      }

      .tool-section {
        margin-bottom: 24px;
      }

      .section-title {
        font-family: var(--font-mono);
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--color-text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 1px solid var(--border-subtle);
      }

      .input-group {
        margin-bottom: 16px;
      }

      .input-label {
        display: block;
        font-family: var(--font-mono);
        font-size: 0.85rem;
        color: var(--color-text-secondary);
        margin-bottom: 8px;
      }

      .input-hint {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-top: 4px;
      }

      input[type="text"],
      input[type="number"],
      select,
      textarea {
        width: 100%;
        padding: 10px 14px;
        font-family: var(--font-mono);
        font-size: 0.9rem;
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-sm);
        color: var(--color-text-primary);
        transition: border-color 0.2s;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: var(--color-accent-cyan);
      }

      textarea {
        min-height: 150px;
        resize: vertical;
      }

      .transform-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
        margin-bottom: 16px;
      }

      .option-card {
        padding: 16px;
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-md);
      }

      .option-card-title {
        font-family: var(--font-mono);
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--color-accent-cyan);
        margin-bottom: 12px;
      }

      .option-row {
        display: flex;
        gap: 12px;
        margin-bottom: 12px;
      }

      .option-row:last-child {
        margin-bottom: 0;
      }

      .option-row input[type="text"] {
        flex: 1;
      }

      .transform-type-select {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 16px;
      }

      .type-btn {
        padding: 10px 16px;
        font-family: var(--font-mono);
        font-size: 0.85rem;
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-sm);
        color: var(--color-text-primary);
        cursor: pointer;
        transition: all 0.2s;
      }

      .type-btn:hover {
        border-color: var(--color-accent-cyan);
      }

      .type-btn.active {
        background: rgba(0, 245, 212, 0.1);
        border-color: var(--color-accent-cyan);
        color: var(--color-accent-cyan);
      }

      .btn-row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      .btn {
        flex: 1;
        min-width: 120px;
        padding: 12px 20px;
        font-family: var(--font-mono);
        font-size: 0.85rem;
        font-weight: 500;
        border: none;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .btn-primary {
        background: var(--color-accent-cyan);
        color: var(--color-bg-deep);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 20px var(--glow-cyan);
      }

      .btn-secondary {
        background: var(--color-bg-surface);
        color: var(--color-text-primary);
        border: 1px solid var(--border-subtle);
      }

      .btn-secondary:hover {
        border-color: var(--color-accent-cyan);
        color: var(--color-accent-cyan);
      }

      .result-box {
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-md);
        padding: 16px;
        font-family: var(--font-mono);
        font-size: 0.9rem;
        color: var(--color-accent-cyan);
        min-height: 150px;
        max-height: 400px;
        overflow-y: auto;
        white-space: pre-wrap;
        word-break: break-all;
      }

      .stats-row {
        display: flex;
        gap: 16px;
        margin-bottom: 16px;
        flex-wrap: wrap;
      }

      .stat-item {
        padding: 12px 16px;
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-sm);
        flex: 1;
        min-width: 100px;
        text-align: center;
      }

      .stat-value {
        font-family: var(--font-mono);
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--color-accent-cyan);
      }

      .stat-label {
        font-size: 0.8rem;
        color: var(--text-muted);
        margin-top: 4px;
      }

      .toast {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: var(--accent-green);
        color: var(--color-bg-deep);
        padding: 12px 24px;
        border-radius: var(--radius-md);
        font-family: var(--font-mono);
        font-size: 0.85rem;
        font-weight: 500;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 1000;
      }

      .toast.show {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }

      .hidden {
        display: none !important;
      }

      @media (max-width: 600px) {
        .container {
          padding: 16px;
        }

        .btn-row {
          flex-direction: column;
        }

        .btn {
          width: 100%;
        }

        .transform-options {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="bg-grid"></div>
    <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
      ğŸŒ“
    </button>

    <div class="container">
      <header class="header">
        <nav class="breadcrumb" aria-label="Breadcrumb">
          <a href="../../index.html">é¦–é¡µ</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">æ•°æ®è½¬æ¢å™¨</span>
        </nav>
        <div class="title-section">
          <h1>
            <span class="icon">ğŸ”„</span>
            æ•°æ®è½¬æ¢å™¨
          </h1>
          <p>æ‰¹é‡è½¬æ¢æ•°æ®ï¼Œæ”¯æŒå‰ç¼€åç¼€ã€åŒ…è£¹ã€æ¨¡æ¿æ›¿æ¢ç­‰</p>
        </div>
      </header>

      <main class="main-content">
        <div class="tool-section">
          <div class="section-title">æ•°æ®è¾“å…¥</div>
          <div class="input-group">
            <label class="input-label">è¾“å…¥æ•°æ®ï¼ˆæ¯è¡Œä¸€æ¡ï¼‰</label>
            <textarea
              id="input"
              placeholder="è¾“å…¥è¦è½¬æ¢çš„æ•°æ®ï¼Œæ¯è¡Œä¸€æ¡...&#10;ç¤ºä¾‹:&#10;apple&#10;banana&#10;cherry"
            ></textarea>
          </div>
        </div>

        <div class="tool-section">
          <div class="section-title">è½¬æ¢ç±»å‹</div>
          <div class="transform-type-select">
            <button class="type-btn active" data-type="prefix-suffix">
              å‰ç¼€/åç¼€
            </button>
            <button class="type-btn" data-type="wrap">åŒ…è£¹</button>
            <button class="type-btn" data-type="template">æ¨¡æ¿æ›¿æ¢</button>
            <button class="type-btn" data-type="number">æ•°å­—æ ¼å¼åŒ–</button>
            <button class="type-btn" data-type="case">å¤§å°å†™</button>
            <button class="type-btn" data-type="replace">æŸ¥æ‰¾æ›¿æ¢</button>
          </div>

          <!-- Prefix/Suffix Options -->
          <div class="transform-options" id="opt-prefix-suffix">
            <div class="option-card">
              <div class="option-card-title">æ·»åŠ å‰ç¼€</div>
              <input
                type="text"
                id="prefix"
                placeholder='ä¾‹å¦‚: "item_"'
              />
            </div>
            <div class="option-card">
              <div class="option-card-title">æ·»åŠ åç¼€</div>
              <input type="text" id="suffix" placeholder='ä¾‹å¦‚: ".txt"' />
            </div>
          </div>

          <!-- Wrap Options -->
          <div class="transform-options hidden" id="opt-wrap">
            <div class="option-card">
              <div class="option-card-title">åŒ…è£¹å­—ç¬¦</div>
              <div class="option-row">
                <input type="text" id="wrapLeft" placeholder="å·¦è¾¹" value='"' />
                <input
                  type="text"
                  id="wrapRight"
                  placeholder="å³è¾¹"
                  value='"'
                />
              </div>
              <div class="input-hint">å¸¸ç”¨: å¼•å· "" '' | æ‹¬å· () [] {} | æ ‡ç­¾ &lt;&gt;</div>
            </div>
            <div class="option-card">
              <div class="option-card-title">è¡Œåˆ†éš”ç¬¦</div>
              <input
                type="text"
                id="wrapSeparator"
                placeholder="ä¾‹å¦‚: ,"
                value=","
              />
              <div class="input-hint">ç”¨äºè¿æ¥å„è¡Œï¼Œç”Ÿæˆæ•°ç»„ç­‰</div>
            </div>
          </div>

          <!-- Template Options -->
          <div class="transform-options hidden" id="opt-template">
            <div class="option-card" style="grid-column: 1 / -1">
              <div class="option-card-title">æ¨¡æ¿</div>
              <input
                type="text"
                id="template"
                placeholder='ä½¿ç”¨ {value} è¡¨ç¤ºåŸå€¼ï¼Œ{index} è¡¨ç¤ºåºå·ï¼ˆä»1å¼€å§‹ï¼‰ï¼Œ{index0} ä»0å¼€å§‹'
              />
              <div class="input-hint">
                ç¤ºä¾‹: &lt;li&gt;{index}. {value}&lt;/li&gt; â†’
                &lt;li&gt;1. apple&lt;/li&gt;
              </div>
            </div>
          </div>

          <!-- Number Format Options -->
          <div class="transform-options hidden" id="opt-number">
            <div class="option-card">
              <div class="option-card-title">æ•°å­—æ ¼å¼</div>
              <select id="numberFormat">
                <option value="thousands">åƒåˆ†ä½åˆ†éš” (1,234,567)</option>
                <option value="fixed2">ä¿ç•™2ä½å°æ•°</option>
                <option value="fixed4">ä¿ç•™4ä½å°æ•°</option>
                <option value="percent">è½¬ä¸ºç™¾åˆ†æ¯”</option>
                <option value="scientific">ç§‘å­¦è®¡æ•°æ³•</option>
                <option value="currency-cny">äººæ°‘å¸ (Â¥)</option>
                <option value="currency-usd">ç¾å…ƒ ($)</option>
              </select>
            </div>
            <div class="option-card">
              <div class="option-card-title">éæ•°å­—å¤„ç†</div>
              <select id="nonNumberAction">
                <option value="keep">ä¿æŒåŸæ ·</option>
                <option value="skip">è·³è¿‡</option>
                <option value="zero">æ›¿æ¢ä¸º0</option>
              </select>
            </div>
          </div>

          <!-- Case Options -->
          <div class="transform-options hidden" id="opt-case">
            <div class="option-card" style="grid-column: 1 / -1">
              <div class="option-card-title">å¤§å°å†™è½¬æ¢</div>
              <select id="caseType" style="width: 100%">
                <option value="upper">å…¨éƒ¨å¤§å†™ (HELLO WORLD)</option>
                <option value="lower">å…¨éƒ¨å°å†™ (hello world)</option>
                <option value="capitalize">é¦–å­—æ¯å¤§å†™ (Hello World)</option>
                <option value="sentence">å¥é¦–å¤§å†™ (Hello world)</option>
                <option value="camel">é©¼å³°å‘½å (helloWorld)</option>
                <option value="pascal">å¸•æ–¯å¡å‘½å (HelloWorld)</option>
                <option value="snake">è›‡å½¢å‘½å (hello_world)</option>
                <option value="kebab">çŸ­æ¨ªçº¿å‘½å (hello-world)</option>
              </select>
            </div>
          </div>

          <!-- Replace Options -->
          <div class="transform-options hidden" id="opt-replace">
            <div class="option-card">
              <div class="option-card-title">æŸ¥æ‰¾</div>
              <input type="text" id="replaceFind" placeholder="è¦æŸ¥æ‰¾çš„æ–‡æœ¬" />
              <label style="margin-top: 8px; display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--color-text-secondary);">
                <input type="checkbox" id="replaceRegex" style="width: auto;" />
                ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
              </label>
            </div>
            <div class="option-card">
              <div class="option-card-title">æ›¿æ¢ä¸º</div>
              <input type="text" id="replaceWith" placeholder="æ›¿æ¢åçš„æ–‡æœ¬" />
            </div>
          </div>

          <div class="btn-row">
            <button class="btn btn-primary" onclick="transformData()">
              ğŸ”„ è½¬æ¢
            </button>
            <button class="btn btn-secondary" onclick="clearAll()">
              ğŸ—‘ï¸ æ¸…ç©º
            </button>
          </div>
        </div>

        <div class="tool-section">
          <div class="section-title">è½¬æ¢ç»“æœ</div>
          <div class="stats-row">
            <div class="stat-item">
              <div class="stat-value" id="inputCount">0</div>
              <div class="stat-label">è¾“å…¥è¡Œæ•°</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="outputCount">0</div>
              <div class="stat-label">è¾“å‡ºè¡Œæ•°</div>
            </div>
          </div>
          <div class="result-box" id="result">è½¬æ¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
          <div class="btn-row" style="margin-top: 16px">
            <button class="btn btn-primary" onclick="copyResult()">
              ğŸ“‹ å¤åˆ¶ç»“æœ
            </button>
            <button class="btn btn-secondary" onclick="downloadResult()">
              ğŸ’¾ ä¸‹è½½
            </button>
          </div>
        </div>
      </main>
    </div>

    <div class="toast" id="toast">æ“ä½œæˆåŠŸ</div>

    <script>
      const LS_KEY = "data-transformer-state";
      let currentType = "prefix-suffix";

      // Elements
      const inputEl = document.getElementById("input");
      const resultEl = document.getElementById("result");

      // Transform type selection
      document.querySelectorAll(".type-btn").forEach((btn) => {
        btn.addEventListener("click", function () {
          document
            .querySelectorAll(".type-btn")
            .forEach((b) => b.classList.remove("active"));
          this.classList.add("active");
          currentType = this.dataset.type;

          // Show/hide options
          document.querySelectorAll(".transform-options").forEach((opt) => {
            opt.classList.add("hidden");
          });
          document
            .getElementById("opt-" + currentType)
            .classList.remove("hidden");
          saveState();
        });
      });

      // Parse lines
      function parseLines(text) {
        return text
          .split("\n")
          .map((l) => l.trim())
          .filter((l) => l !== "");
      }

      // Transform functions
      function transformPrefixSuffix(lines) {
        const prefix = document.getElementById("prefix").value;
        const suffix = document.getElementById("suffix").value;
        return lines.map((line) => prefix + line + suffix);
      }

      function transformWrap(lines) {
        const left = document.getElementById("wrapLeft").value;
        const right = document.getElementById("wrapRight").value;
        const sep = document.getElementById("wrapSeparator").value;
        const wrapped = lines.map((line) => left + line + right);
        return [wrapped.join(sep)];
      }

      function transformTemplate(lines) {
        const template = document.getElementById("template").value;
        if (!template) return lines;
        return lines.map((line, i) =>
          template
            .replace(/{value}/g, line)
            .replace(/{index}/g, i + 1)
            .replace(/{index0}/g, i)
        );
      }

      function transformNumber(lines) {
        const format = document.getElementById("numberFormat").value;
        const nonNumAction = document.getElementById("nonNumberAction").value;

        return lines
          .map((line) => {
            const num = parseFloat(line);
            if (isNaN(num)) {
              if (nonNumAction === "skip") return null;
              if (nonNumAction === "zero") return "0";
              return line;
            }

            switch (format) {
              case "thousands":
                return num.toLocaleString("en-US");
              case "fixed2":
                return num.toFixed(2);
              case "fixed4":
                return num.toFixed(4);
              case "percent":
                return (num * 100).toFixed(2) + "%";
              case "scientific":
                return num.toExponential(2);
              case "currency-cny":
                return "Â¥" + num.toLocaleString("zh-CN", { minimumFractionDigits: 2 });
              case "currency-usd":
                return "$" + num.toLocaleString("en-US", { minimumFractionDigits: 2 });
              default:
                return line;
            }
          })
          .filter((l) => l !== null);
      }

      function transformCase(lines) {
        const caseType = document.getElementById("caseType").value;

        return lines.map((line) => {
          switch (caseType) {
            case "upper":
              return line.toUpperCase();
            case "lower":
              return line.toLowerCase();
            case "capitalize":
              return line.replace(/\b\w/g, (c) => c.toUpperCase());
            case "sentence":
              return line.charAt(0).toUpperCase() + line.slice(1).toLowerCase();
            case "camel":
              return line
                .toLowerCase()
                .replace(/[^a-zA-Z0-9]+(.)/g, (_, c) => c.toUpperCase());
            case "pascal":
              return line
                .toLowerCase()
                .replace(/(?:^|[^a-zA-Z0-9]+)(.)/g, (_, c) => c.toUpperCase());
            case "snake":
              return line
                .replace(/\s+/g, "_")
                .replace(/([a-z])([A-Z])/g, "$1_$2")
                .toLowerCase();
            case "kebab":
              return line
                .replace(/\s+/g, "-")
                .replace(/([a-z])([A-Z])/g, "$1-$2")
                .toLowerCase();
            default:
              return line;
          }
        });
      }

      function transformReplace(lines) {
        const find = document.getElementById("replaceFind").value;
        const replaceWith = document.getElementById("replaceWith").value;
        const useRegex = document.getElementById("replaceRegex").checked;

        if (!find) return lines;

        return lines.map((line) => {
          if (useRegex) {
            try {
              const regex = new RegExp(find, "g");
              return line.replace(regex, replaceWith);
            } catch {
              return line;
            }
          }
          return line.split(find).join(replaceWith);
        });
      }

      // Main transform function
      function transformData() {
        const lines = parseLines(inputEl.value);
        if (lines.length === 0) {
          showToast("è¯·è¾“å…¥æ•°æ®");
          return;
        }

        let result;
        switch (currentType) {
          case "prefix-suffix":
            result = transformPrefixSuffix(lines);
            break;
          case "wrap":
            result = transformWrap(lines);
            break;
          case "template":
            result = transformTemplate(lines);
            break;
          case "number":
            result = transformNumber(lines);
            break;
          case "case":
            result = transformCase(lines);
            break;
          case "replace":
            result = transformReplace(lines);
            break;
          default:
            result = lines;
        }

        document.getElementById("inputCount").textContent = lines.length;
        document.getElementById("outputCount").textContent = result.length;
        resultEl.textContent = result.join("\n");
        saveState();
        showToast("è½¬æ¢å®Œæˆ");
      }

      // Copy result
      function copyResult() {
        const text = resultEl.textContent;
        if (!text || text === "è½¬æ¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...") {
          showToast("æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹");
          return;
        }
        navigator.clipboard.writeText(text).then(() => {
          showToast("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿");
        });
      }

      // Download result
      function downloadResult() {
        const text = resultEl.textContent;
        if (!text || text === "è½¬æ¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...") {
          showToast("æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹");
          return;
        }
        const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "transformed-data.txt";
        a.click();
        URL.revokeObjectURL(url);
        showToast("ä¸‹è½½å·²å¼€å§‹");
      }

      // Clear all
      function clearAll() {
        inputEl.value = "";
        resultEl.textContent = "è½¬æ¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...";
        document.getElementById("inputCount").textContent = "0";
        document.getElementById("outputCount").textContent = "0";
        localStorage.removeItem(LS_KEY);
        showToast("å·²æ¸…ç©º");
      }

      // Save state
      function saveState() {
        const state = {
          input: inputEl.value,
          type: currentType,
          prefix: document.getElementById("prefix").value,
          suffix: document.getElementById("suffix").value,
          wrapLeft: document.getElementById("wrapLeft").value,
          wrapRight: document.getElementById("wrapRight").value,
          wrapSeparator: document.getElementById("wrapSeparator").value,
          template: document.getElementById("template").value,
          numberFormat: document.getElementById("numberFormat").value,
          nonNumberAction: document.getElementById("nonNumberAction").value,
          caseType: document.getElementById("caseType").value,
          replaceFind: document.getElementById("replaceFind").value,
          replaceWith: document.getElementById("replaceWith").value,
          replaceRegex: document.getElementById("replaceRegex").checked,
        };
        localStorage.setItem(LS_KEY, JSON.stringify(state));
      }

      // Load state
      function loadState() {
        try {
          const saved = localStorage.getItem(LS_KEY);
          if (saved) {
            const state = JSON.parse(saved);
            inputEl.value = state.input || "";

            if (state.type) {
              currentType = state.type;
              document.querySelectorAll(".type-btn").forEach((btn) => {
                if (btn.dataset.type === state.type) {
                  btn.classList.add("active");
                } else {
                  btn.classList.remove("active");
                }
              });
              document.querySelectorAll(".transform-options").forEach((opt) => {
                opt.classList.add("hidden");
              });
              document
                .getElementById("opt-" + currentType)
                .classList.remove("hidden");
            }

            document.getElementById("prefix").value = state.prefix || "";
            document.getElementById("suffix").value = state.suffix || "";
            document.getElementById("wrapLeft").value = state.wrapLeft || '"';
            document.getElementById("wrapRight").value = state.wrapRight || '"';
            document.getElementById("wrapSeparator").value =
              state.wrapSeparator || ",";
            document.getElementById("template").value = state.template || "";
            document.getElementById("numberFormat").value =
              state.numberFormat || "thousands";
            document.getElementById("nonNumberAction").value =
              state.nonNumberAction || "keep";
            document.getElementById("caseType").value = state.caseType || "upper";
            document.getElementById("replaceFind").value =
              state.replaceFind || "";
            document.getElementById("replaceWith").value =
              state.replaceWith || "";
            document.getElementById("replaceRegex").checked =
              state.replaceRegex || false;
          }
        } catch {
          // ignore
        }
      }

      // Theme toggle
      function toggleTheme() {
        const body = document.body;
        const isDark = body.getAttribute("data-theme") !== "light";
        body.setAttribute("data-theme", isDark ? "light" : "dark");
        localStorage.setItem("theme", isDark ? "light" : "dark");
      }

      // Show toast
      function showToast(msg) {
        const toast = document.getElementById("toast");
        toast.textContent = msg;
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2000);
      }

      // Init theme
      (function () {
        const saved = localStorage.getItem("theme");
        if (saved === "light") {
          document.body.setAttribute("data-theme", "light");
        }
      })();

      // Auto-save on input
      inputEl.addEventListener("input", saveState);

      // Load state on init
      loadState();
    </script>
  </body>
</html>
