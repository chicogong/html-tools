<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è´·æ¬¾è®¡ç®—å™¨ - WebUtils</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="åœ¨çº¿è´·æ¬¾è®¡ç®—å™¨ï¼Œæ”¯æŒç­‰é¢æœ¬æ¯å’Œç­‰é¢æœ¬é‡‘ä¸¤ç§è¿˜æ¬¾æ–¹å¼ï¼Œæ˜¾ç¤ºè¯¦ç»†è¿˜æ¬¾è®¡åˆ’" />
  <meta name="keywords" content="è´·æ¬¾ æˆ¿è´· è®¡ç®—å™¨ ç­‰é¢æœ¬æ¯ ç­‰é¢æœ¬é‡‘ è¿˜æ¬¾è®¡åˆ’ loan calculator" />
  <meta name="author" content="WebUtils" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tools.realtime-ai.chat/tools/calculator/loan-calculator.html" />
  
  <!-- Open Graph -->
  <meta property="og:title" content="è´·æ¬¾è®¡ç®—å™¨ - WebUtils" />
  <meta property="og:description" content="åœ¨çº¿è´·æ¬¾è®¡ç®—å™¨ï¼Œæ”¯æŒç­‰é¢æœ¬æ¯å’Œç­‰é¢æœ¬é‡‘ä¸¤ç§è¿˜æ¬¾æ–¹å¼ï¼Œæ˜¾ç¤ºè¯¦ç»†è¿˜æ¬¾è®¡åˆ’" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tools.realtime-ai.chat/tools/calculator/loan-calculator.html" />
  <meta property="og:site_name" content="WebUtils" />
  <meta property="og:locale" content="zh_CN" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="è´·æ¬¾è®¡ç®—å™¨ - WebUtils" />
  <meta name="twitter:description" content="åœ¨çº¿è´·æ¬¾è®¡ç®—å™¨ï¼Œæ”¯æŒç­‰é¢æœ¬æ¯å’Œç­‰é¢æœ¬é‡‘ä¸¤ç§è¿˜æ¬¾æ–¹å¼ï¼Œæ˜¾ç¤ºè¯¦ç»†è¿˜æ¬¾è®¡åˆ’" />
  <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="640" />
  <meta property="og:image:type" content="image/png" />
  <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

  <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-hover: #252532;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --bg: #0a0a0f;
      --card-bg: #1a1a24;
      --text: #e8e8ed;
      --border: #2a2a3a;
      --primary: #fbbf24;
      --primary-hover: #f59e0b;
      --success: #10b981;
      --error: #ef4444;
      --shadow: 0 2px 8px rgb(0 0 0 / 30%);
      --radius: 8px;
    }

    [data-theme="light"] {
      --bg-deep: #fafafa;
      --bg-surface: #fff;
      --bg-card: #fff;
      --bg-hover: #f5f5f5;
      --text-primary: #1a1a1a;
      --text-secondary: #666;
      --text-muted: #999;
      --border-subtle: #e5e5e5;
      --bg: #fafafa;
      --card-bg: #fff;
      --text: #1a1a1a;
      --border: #e5e5e5;
      --primary: #d97706;
      --primary-hover: #b45309;
      --success: #198754;
      --shadow: 0 2px 8px rgb(0 0 0 / 8%);
    }

    .theme-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 1px solid var(--border-subtle);
      background: var(--bg-card);
      cursor: pointer;
      font-size: 1.2rem;
      z-index: 100;
      transition: all 0.2s;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    * { box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 24px;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .back-link {
      display: inline-block;
      margin-bottom: 16px;
      color: var(--primary);
      text-decoration: none;
      font-size: 0.9rem;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    h1 {
      font-size: 1.75rem;
      margin: 0 0 8px;
    }

    .desc {
      color: var(--text-muted);
      margin: 0 0 24px;
      font-size: 0.95rem;
    }

    .loan-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
    }

    .input-group label {
      font-size: 0.9rem;
      margin-bottom: 8px;
      color: var(--text-secondary);
    }

    .input-wrapper {
      position: relative;
    }

    input[type="number"],
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 1rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--bg);
      color: var(--text);
    }

    input[type="number"]:focus,
    select:focus {
      outline: none;
      border-color: var(--primary);
    }

    .input-unit {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .method-toggle {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
    }

    .method-btn {
      flex: 1;
      padding: 12px 16px;
      font-size: 0.9rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--bg);
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    .method-btn:hover {
      border-color: var(--primary);
    }

    .method-btn.active {
      background: var(--primary);
      color: #000;
      border-color: var(--primary);
    }

    .btn-calculate {
      width: 100%;
      padding: 14px 24px;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: var(--radius);
      background: var(--primary);
      color: #000;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-calculate:hover {
      background: var(--primary-hover);
    }

    .result-section {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
      display: none;
    }

    .result-section.show {
      display: block;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .summary-card {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 16px;
      text-align: center;
    }

    .summary-card .label {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .summary-card .value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
    }

    .summary-card .value.small {
      font-size: 1.2rem;
    }

    .schedule-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .schedule-header h3 {
      font-size: 1rem;
      margin: 0;
    }

    .schedule-toggle {
      font-size: 0.85rem;
      color: var(--primary);
      cursor: pointer;
      background: none;
      border: none;
      padding: 0;
    }

    .schedule-toggle:hover {
      text-decoration: underline;
    }

    .schedule-table-wrapper {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }

    .schedule-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }

    .schedule-table th,
    .schedule-table td {
      padding: 10px 12px;
      text-align: right;
      border-bottom: 1px solid var(--border);
    }

    .schedule-table th {
      background: var(--bg);
      font-weight: 600;
      position: sticky;
      top: 0;
    }

    .schedule-table th:first-child,
    .schedule-table td:first-child {
      text-align: center;
    }

    .schedule-table tr:last-child td {
      border-bottom: none;
    }

    .schedule-table tr:hover td {
      background: var(--bg-hover);
    }

    footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    footer a {
      color: var(--primary);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../../index.html" class="back-link">â† è¿”å›å·¥å…·åˆ—è¡¨</a>
    <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
    <h1>è´·æ¬¾è®¡ç®—å™¨</h1>
    <p class="desc">è®¡ç®—è´·æ¬¾æœˆä¾›ã€æ€»åˆ©æ¯ï¼Œæ”¯æŒç­‰é¢æœ¬æ¯å’Œç­‰é¢æœ¬é‡‘ä¸¤ç§è¿˜æ¬¾æ–¹å¼</p>

    <div class="loan-card">
      <div class="input-grid">
        <div class="input-group">
          <label>è´·æ¬¾é‡‘é¢</label>
          <div class="input-wrapper">
            <input type="number" id="principal" placeholder="1000000" min="1000" />
            <span class="input-unit">å…ƒ</span>
          </div>
        </div>

        <div class="input-group">
          <label>è´·æ¬¾å¹´é™</label>
          <select id="years">
            <option value="1">1 å¹´</option>
            <option value="2">2 å¹´</option>
            <option value="3">3 å¹´</option>
            <option value="5">5 å¹´</option>
            <option value="10">10 å¹´</option>
            <option value="15">15 å¹´</option>
            <option value="20" selected>20 å¹´</option>
            <option value="25">25 å¹´</option>
            <option value="30">30 å¹´</option>
          </select>
        </div>

        <div class="input-group">
          <label>å¹´åˆ©ç‡</label>
          <div class="input-wrapper">
            <input type="number" id="rate" placeholder="4.2" min="0.1" max="30" step="0.01" value="4.2" />
            <span class="input-unit">%</span>
          </div>
        </div>
      </div>

      <div class="method-toggle">
        <button class="method-btn active" data-method="equal-payment">ç­‰é¢æœ¬æ¯</button>
        <button class="method-btn" data-method="equal-principal">ç­‰é¢æœ¬é‡‘</button>
      </div>

      <button class="btn-calculate" id="btnCalculate">è®¡ç®—</button>

      <div class="result-section" id="resultSection">
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">æœˆä¾›</div>
            <div class="value" id="monthlyPayment">--</div>
          </div>
          <div class="summary-card">
            <div class="label">è¿˜æ¬¾æ€»é¢</div>
            <div class="value small" id="totalPayment">--</div>
          </div>
          <div class="summary-card">
            <div class="label">æ”¯ä»˜åˆ©æ¯</div>
            <div class="value small" id="totalInterest">--</div>
          </div>
        </div>

        <div class="schedule-header">
          <h3>è¿˜æ¬¾è®¡åˆ’è¡¨</h3>
          <button class="schedule-toggle" id="toggleSchedule">å±•å¼€</button>
        </div>

        <div class="schedule-table-wrapper" id="scheduleWrapper" style="display: none;">
          <table class="schedule-table">
            <thead>
              <tr>
                <th>æœŸæ•°</th>
                <th>æœˆä¾›</th>
                <th>æœ¬é‡‘</th>
                <th>åˆ©æ¯</th>
                <th>å‰©ä½™æœ¬é‡‘</th>
              </tr>
            </thead>
            <tbody id="scheduleBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <footer>
      <a href="https://github.com/nicepkg/html-tools" target="_blank" rel="noreferrer">View source</a>
      Â· çº¯å‰ç«¯å·¥å…· Â· æ— æœåŠ¡å™¨ Â· 
      <a href="../../index.html">WebUtils</a>
    </footer>
  </div>

  <script>
    const principalInput = document.getElementById('principal');
    const yearsSelect = document.getElementById('years');
    const rateInput = document.getElementById('rate');
    const btnCalculate = document.getElementById('btnCalculate');
    const resultSection = document.getElementById('resultSection');
    const monthlyPaymentEl = document.getElementById('monthlyPayment');
    const totalPaymentEl = document.getElementById('totalPayment');
    const totalInterestEl = document.getElementById('totalInterest');
    const toggleSchedule = document.getElementById('toggleSchedule');
    const scheduleWrapper = document.getElementById('scheduleWrapper');
    const scheduleBody = document.getElementById('scheduleBody');
    const methodBtns = document.querySelectorAll('.method-btn');

    let currentMethod = 'equal-payment';
    let scheduleVisible = false;

    // Method toggle
    methodBtns.forEach(function(btn) {
      btn.addEventListener('click', function() {
        methodBtns.forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        currentMethod = btn.dataset.method;
      });
    });

    // Toggle schedule visibility
    toggleSchedule.addEventListener('click', function() {
      scheduleVisible = !scheduleVisible;
      scheduleWrapper.style.display = scheduleVisible ? 'block' : 'none';
      toggleSchedule.textContent = scheduleVisible ? 'æ”¶èµ·' : 'å±•å¼€';
    });

    function formatMoney(num) {
      return num.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function calculate() {
      const principal = parseFloat(principalInput.value);
      const years = parseInt(yearsSelect.value);
      const annualRate = parseFloat(rateInput.value);

      if (!principal || principal <= 0) {
        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„è´·æ¬¾é‡‘é¢');
        return;
      }

      if (!annualRate || annualRate <= 0) {
        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´åˆ©ç‡');
        return;
      }

      const months = years * 12;
      const monthlyRate = annualRate / 100 / 12;

      let schedule = [];
      let totalPayment = 0;
      let monthlyPayment = 0;

      if (currentMethod === 'equal-payment') {
        // ç­‰é¢æœ¬æ¯
        monthlyPayment = principal * monthlyRate * Math.pow(1 + monthlyRate, months) / (Math.pow(1 + monthlyRate, months) - 1);
        
        let remainingPrincipal = principal;
        for (let i = 1; i <= months; i++) {
          const interest = remainingPrincipal * monthlyRate;
          const principalPart = monthlyPayment - interest;
          remainingPrincipal -= principalPart;
          
          schedule.push({
            month: i,
            payment: monthlyPayment,
            principal: principalPart,
            interest: interest,
            remaining: Math.max(0, remainingPrincipal)
          });
        }
        
        totalPayment = monthlyPayment * months;
        monthlyPaymentEl.textContent = formatMoney(monthlyPayment);

      } else {
        // ç­‰é¢æœ¬é‡‘
        const monthlyPrincipal = principal / months;
        let remainingPrincipal = principal;
        
        for (let i = 1; i <= months; i++) {
          const interest = remainingPrincipal * monthlyRate;
          const payment = monthlyPrincipal + interest;
          remainingPrincipal -= monthlyPrincipal;
          
          schedule.push({
            month: i,
            payment: payment,
            principal: monthlyPrincipal,
            interest: interest,
            remaining: Math.max(0, remainingPrincipal)
          });
          
          totalPayment += payment;
        }
        
        // æ˜¾ç¤ºé¦–æœˆæœˆä¾›
        monthlyPayment = schedule[0].payment;
        const lastPayment = schedule[months - 1].payment;
        monthlyPaymentEl.innerHTML = formatMoney(monthlyPayment) + '<br><small style="font-size: 0.7rem; color: var(--text-muted);">é€’å‡è‡³ ' + formatMoney(lastPayment) + '</small>';
      }

      const totalInterest = totalPayment - principal;

      totalPaymentEl.textContent = formatMoney(totalPayment);
      totalInterestEl.textContent = formatMoney(totalInterest);

      // Render schedule
      let html = '';
      schedule.forEach(function(item) {
        html += '<tr>' +
          '<td>' + item.month + '</td>' +
          '<td>' + formatMoney(item.payment) + '</td>' +
          '<td>' + formatMoney(item.principal) + '</td>' +
          '<td>' + formatMoney(item.interest) + '</td>' +
          '<td>' + formatMoney(item.remaining) + '</td>' +
          '</tr>';
      });
      scheduleBody.innerHTML = html;

      resultSection.classList.add('show');
    }

    btnCalculate.addEventListener('click', calculate);

    // Enter key to calculate
    principalInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') calculate();
    });
    rateInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') calculate();
    });

    // Theme toggle
    function toggleTheme() {
      const html = document.documentElement;
      const btn = document.querySelector('.theme-toggle');
      const next = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      html.setAttribute('data-theme', next);
      btn.textContent = next === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
      localStorage.setItem('theme', next);
    }

    (function() {
      const saved = localStorage.getItem('theme');
      if (saved) {
        document.documentElement.setAttribute('data-theme', saved);
        const btn = document.querySelector('.theme-toggle');
        if (btn) btn.textContent = saved === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
      }
    })();
  </script>
</body>
</html>
