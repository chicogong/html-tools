<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨ - WebUtils" />
    <meta name="keywords" content="image-filters,media,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/media/image-filters.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨ - WebUtils" />
    <meta property="og:description" content="å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/media/image-filters.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨ - WebUtils" />
    <meta name="twitter:description" content="å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      :root {
        --color-bg-deep: #0a0a0f;
        --color-bg-surface: #12121a;
        --color-bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --color-text-primary: #e8e8ed;
        --color-text-secondary: #8888a0;
        --color-text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --color-accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --color-accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      
  /* å­—ä½“å˜é‡ */
  --font-sans: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-mono: 'JetBrains Mono', 'Courier New', monospace;
}

      [data-theme="light"] {
        --color-bg-deep: #fafafa;
        --color-bg-surface: #fff;
        --color-bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --color-text-primary: #1a1a1a;
        --color-text-secondary: #666;
        --color-text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border-subtle);
        background: var(--color-bg-card);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      :root {
        --canvas-bg: #f0f0f0;
      }
      [data-theme="dark"] {
        --canvas-bg: #2a2a2a;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 1rem;
      }
      .main-layout {
        display: grid;
        grid-template-columns: 1fr 320px;
        gap: 2rem;
      }
      @media (max-width: 900px) {
        .main-layout {
          grid-template-columns: 1fr;
        }
      }
      .canvas-container {
        background: var(--canvas-bg);
        border-radius: 8px;
        overflow: hidden;
        min-height: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #imageCanvas {
        max-width: 100%;
        max-height: 600px;
        display: none;
      }
      .placeholder {
        text-align: center;
        color: var(--muted-color);
        padding: 2rem;
      }
      .controls-panel {
        background: var(--card-background-color);
        border-radius: 8px;
        padding: 1.5rem;
      }
      .control-group {
        margin-bottom: 1.5rem;
      }
      .control-group label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
      }
      .control-group input[type="range"] {
        width: 100%;
        margin: 0;
      }
      .presets {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
        margin-bottom: 1.5rem;
      }
      .presets button {
        padding: 0.5rem;
        font-size: 0.85rem;
      }
      .drop-zone {
        border: 2px dashed var(--muted-color);
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        transition:
          border-color 0.3s,
          background 0.3s;
        margin-bottom: 1rem;
      }
      .drop-zone.dragover {
        border-color: var(--primary);
        background: var(--primary-focus);
      }
      .action-buttons {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }
      .action-buttons button {
        flex: 1;
        min-width: 100px;
      }
      .compare-container {
        position: relative;
        cursor: ew-resize;
        user-select: none;
      }
      .compare-slider {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 4px;
        background: white;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        z-index: 10;
      }
      .compare-slider::before {
        content: "â—€â–¶";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 8px;
        border-radius: 50%;
        font-size: 12px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }
      #originalCanvas {
        position: absolute;
        top: 0;
        left: 0;
        clip-path: inset(0 50% 0 0);
      }
      .hidden {
        display: none !important;
      }
      .section-title {
        font-weight: bold;
        margin-bottom: 0.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid var(--muted-border-color);
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
    <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
  <body>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">
      <span id="theme-icon">ğŸŒ™</span>
    </button>

    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨
    </nav>
    <main class="container">
      <header>
        <h1>ğŸ–¼ï¸ å›¾ç‰‡æ»¤é•œç¼–è¾‘å™¨</h1>
        <button id="themeToggle" class="outline">ğŸŒ™ æš—è‰²æ¨¡å¼</button>
      </header>

      <div class="drop-zone" id="dropZone">
        <p>æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
        <input type="file" id="fileInput" accept="image/*" style="display: none" />
        <button onclick="document.getElementById('fileInput').click()" aria-label="é€‰æ‹©å›¾ç‰‡">
          é€‰æ‹©å›¾ç‰‡
        </button>
      </div>

      <div class="main-layout">
        <div>
          <div class="canvas-container compare-container" id="canvasContainer">
            <canvas id="originalCanvas"></canvas>
            <canvas id="imageCanvas"></canvas>
            <div class="compare-slider hidden" id="compareSlider"></div>
            <div class="placeholder" id="placeholder">è¯·ä¸Šä¼ å›¾ç‰‡å¼€å§‹ç¼–è¾‘</div>
          </div>
          <div class="action-buttons" style="margin-top: 1rem">
            <button onclick="toggleCompare()" id="compareBtn" disabled aria-label="ğŸ‘ï¸ å¯¹æ¯”åŸå›¾">
              ğŸ‘ï¸ å¯¹æ¯”åŸå›¾
            </button>
            <button onclick="resetFilters()" class="secondary" id="resetBtn" disabled>
              â†º é‡ç½®
            </button>
            <button onclick="downloadImage()" class="contrast" id="downloadBtn" disabled>
              ğŸ’¾ ä¸‹è½½
            </button>
          </div>
        </div>

        <div class="controls-panel">
          <div class="section-title">ğŸ“š é¢„è®¾æ»¤é•œ</div>
          <div class="presets">
            <button onclick="applyPreset('original')" class="outline" aria-label="åŸå›¾">
              åŸå›¾
            </button>
            <button onclick="applyPreset('vintage')" class="outline" aria-label="å¤å¤">å¤å¤</button>
            <button onclick="applyPreset('lomo')" class="outline" aria-label="LOMO">LOMO</button>
            <button onclick="applyPreset('blackwhite')" class="outline" aria-label="é»‘ç™½">
              é»‘ç™½
            </button>
            <button onclick="applyPreset('sepia')" class="outline" aria-label="æ€€æ—§">æ€€æ—§</button>
            <button onclick="applyPreset('cool')" class="outline" aria-label="å†·è‰²è°ƒ">
              å†·è‰²è°ƒ
            </button>
            <button onclick="applyPreset('warm')" class="outline" aria-label="æš–è‰²è°ƒ">
              æš–è‰²è°ƒ
            </button>
            <button onclick="applyPreset('dramatic')" class="outline" aria-label="æˆå‰§">
              æˆå‰§
            </button>
            <button onclick="applyPreset('fade')" class="outline" aria-label="è¤ªè‰²">è¤ªè‰²</button>
            <button onclick="applyPreset('vivid')" class="outline" aria-label="é²œè‰³">é²œè‰³</button>
          </div>

          <div class="section-title">ğŸšï¸ æ‰‹åŠ¨è°ƒæ•´</div>

          <div class="control-group">
            <label>
              äº®åº¦
              <span id="brightnessValue">0</span>
            </label>
            <input type="range" id="brightness" min="-100" max="100" value="0" />
          </div>

          <div class="control-group">
            <label>
              å¯¹æ¯”åº¦
              <span id="contrastValue">0</span>
            </label>
            <input type="range" id="contrast" min="-100" max="100" value="0" />
          </div>

          <div class="control-group">
            <label>
              é¥±å’Œåº¦
              <span id="saturationValue">0</span>
            </label>
            <input type="range" id="saturation" min="-100" max="100" value="0" />
          </div>

          <div class="control-group">
            <label>
              è‰²æ¸©
              <span id="temperatureValue">0</span>
            </label>
            <input type="range" id="temperature" min="-100" max="100" value="0" />
          </div>

          <div class="control-group">
            <label>
              è‰²è°ƒ
              <span id="hueValue">0</span>
              Â°
            </label>
            <input type="range" id="hue" min="0" max="360" value="0" />
          </div>

          <div class="control-group">
            <label>
              æ¨¡ç³Š
              <span id="blurValue">0</span>
            </label>
            <input type="range" id="blur" min="0" max="20" value="0" />
          </div>

          <div class="control-group">
            <label>
              é”åŒ–
              <span id="sharpenValue">0</span>
            </label>
            <input type="range" id="sharpen" min="0" max="100" value="0" />
          </div>

          <div class="control-group">
            <label>
              æš—è§’
              <span id="vignetteValue">0</span>
            </label>
            <input type="range" id="vignette" min="0" max="100" value="0" />
          </div>
        </div>
      </div>
    </main>

    <script>
      // Theme toggle
      const themeToggle = document.getElementById("themeToggle");
      const html = document.documentElement;

      function setTheme(dark) {
        html.setAttribute("data-theme", dark ? "dark" : "light");
        themeToggle.textContent = dark ? "â˜€ï¸ äº®è‰²æ¨¡å¼" : "ğŸŒ™ æš—è‰²æ¨¡å¼";
        localStorage.setItem("theme", dark ? "dark" : "light");
      }

      themeToggle.addEventListener("click", () => {
        setTheme(html.getAttribute("data-theme") !== "dark");
      });

      const savedTheme = localStorage.getItem("theme");
      if (savedTheme) {
        setTheme(savedTheme === "dark");
      } else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        setTheme(true);
      }

      // Image handling
      const canvas = document.getElementById("imageCanvas");
      const ctx = canvas.getContext("2d");
      const originalCanvas = document.getElementById("originalCanvas");
      const originalCtx = originalCanvas.getContext("2d");
      const fileInput = document.getElementById("fileInput");
      const dropZone = document.getElementById("dropZone");
      const placeholder = document.getElementById("placeholder");
      const compareSlider = document.getElementById("compareSlider");

      let originalImage = null;
      let originalImageData = null;
      let isComparing = false;

      // Control elements
      const controls = [
        "brightness",
        "contrast",
        "saturation",
        "temperature",
        "hue",
        "blur",
        "sharpen",
        "vignette"
      ];

      controls.forEach((control) => {
        const input = document.getElementById(control);
        const valueDisplay = document.getElementById(control + "Value");
        input.addEventListener("input", () => {
          valueDisplay.textContent = input.value;
          applyFilters();
        });
      });

      // File handling
      fileInput.addEventListener("change", (e) => {
        if (e.target.files[0]) loadImage(e.target.files[0]);
      });

      dropZone.addEventListener("click", () => fileInput.click());
      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });
      dropZone.addEventListener("dragleave", () => dropZone.classList.remove("dragover"));
      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
        if (e.dataTransfer.files[0]) loadImage(e.dataTransfer.files[0]);
      });

      window.loadImage = function (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          const img = new Image();
          img.onload = () => {
            originalImage = img;

            const maxWidth = document.getElementById("canvasContainer").clientWidth - 20;
            const maxHeight = 600;

            let width = img.width;
            let height = img.height;

            if (width > maxWidth) {
              const ratio = maxWidth / width;
              width = maxWidth;
              height = height * ratio;
            }
            if (height > maxHeight) {
              const ratio = maxHeight / height;
              height = maxHeight;
              width = width * ratio;
            }

            canvas.width = width;
            canvas.height = height;
            originalCanvas.width = width;
            originalCanvas.height = height;

            ctx.drawImage(img, 0, 0, width, height);
            originalCtx.drawImage(img, 0, 0, width, height);
            originalImageData = ctx.getImageData(0, 0, width, height);

            canvas.style.display = "block";
            placeholder.style.display = "none";

            document.getElementById("compareBtn").disabled = false;
            document.getElementById("resetBtn").disabled = false;
            document.getElementById("downloadBtn").disabled = false;

            resetFilters();
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(file);
      };

      function applyFilters() {
        if (!originalImageData) return;

        const imageData = new ImageData(
          new Uint8ClampedArray(originalImageData.data),
          originalImageData.width,
          originalImageData.height
        );

        const brightness = parseInt(document.getElementById("brightness").value);
        const contrast = parseInt(document.getElementById("contrast").value);
        const saturation = parseInt(document.getElementById("saturation").value);
        const temperature = parseInt(document.getElementById("temperature").value);
        const hue = parseInt(document.getElementById("hue").value);
        const sharpen = parseInt(document.getElementById("sharpen").value);
        const vignette = parseInt(document.getElementById("vignette").value);

        const data = imageData.data;
        const width = imageData.width;
        const height = imageData.height;

        // Apply pixel-level adjustments
        for (let i = 0; i < data.length; i += 4) {
          let r = data[i];
          let g = data[i + 1];
          let b = data[i + 2];

          // Brightness
          r += brightness * 2.55;
          g += brightness * 2.55;
          b += brightness * 2.55;

          // Contrast
          const factor = (259 * (contrast + 255)) / (255 * (259 - contrast));
          r = factor * (r - 128) + 128;
          g = factor * (g - 128) + 128;
          b = factor * (b - 128) + 128;

          // Temperature
          r += temperature * 0.5;
          b -= temperature * 0.5;

          // Saturation
          const gray = 0.2989 * r + 0.587 * g + 0.114 * b;
          const satFactor = 1 + saturation / 100;
          r = gray + satFactor * (r - gray);
          g = gray + satFactor * (g - gray);
          b = gray + satFactor * (b - gray);

          // Hue rotation
          if (hue !== 0) {
            const hsl = rgbToHsl(r, g, b);
            hsl.h = (hsl.h + hue) % 360;
            const rgb = hslToRgb(hsl.h, hsl.s, hsl.l);
            r = rgb.r;
            g = rgb.g;
            b = rgb.b;
          }

          // Vignette
          if (vignette > 0) {
            const px = (i / 4) % width;
            const py = Math.floor(i / 4 / width);
            const cx = width / 2;
            const cy = height / 2;
            const maxDist = Math.sqrt(cx * cx + cy * cy);
            const dist = Math.sqrt((px - cx) * (px - cx) + (py - cy) * (py - cy));
            const vignetteFactor = 1 - (dist / maxDist) * (vignette / 100);
            r *= vignetteFactor;
            g *= vignetteFactor;
            b *= vignetteFactor;
          }

          data[i] = Math.max(0, Math.min(255, r));
          data[i + 1] = Math.max(0, Math.min(255, g));
          data[i + 2] = Math.max(0, Math.min(255, b));
        }

        // Sharpen using convolution
        if (sharpen > 0) {
          const sharpened = sharpenImage(imageData, sharpen / 100);
          ctx.putImageData(sharpened, 0, 0);
        } else {
          ctx.putImageData(imageData, 0, 0);
        }

        // Apply CSS blur
        const blurValue = document.getElementById("blur").value;
        canvas.style.filter = blurValue > 0 ? "blur(" + blurValue + "px)" : "none";
      }

      function sharpenImage(imageData, amount) {
        const data = imageData.data;
        const width = imageData.width;
        const height = imageData.height;
        const output = new ImageData(width, height);
        const outputData = output.data;

        const kernel = [0, -amount, 0, -amount, 1 + 4 * amount, -amount, 0, -amount, 0];

        for (let y = 1; y < height - 1; y++) {
          for (let x = 1; x < width - 1; x++) {
            for (let c = 0; c < 3; c++) {
              let sum = 0;
              for (let ky = -1; ky <= 1; ky++) {
                for (let kx = -1; kx <= 1; kx++) {
                  const idx = ((y + ky) * width + (x + kx)) * 4 + c;
                  sum += data[idx] * kernel[(ky + 1) * 3 + (kx + 1)];
                }
              }
              outputData[(y * width + x) * 4 + c] = Math.max(0, Math.min(255, sum));
            }
            outputData[(y * width + x) * 4 + 3] = data[(y * width + x) * 4 + 3];
          }
        }

        return output;
      }

      function rgbToHsl(r, g, b) {
        r /= 255;
        g /= 255;
        b /= 255;
        const max = Math.max(r, g, b),
          min = Math.min(r, g, b);
        let h,
          s,
          l = (max + min) / 2;

        if (max === min) {
          h = s = 0;
        } else {
          const d = max - min;
          s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
          switch (max) {
            case r:
              h = ((g - b) / d + (g < b ? 6 : 0)) / 6;
              break;
            case g:
              h = ((b - r) / d + 2) / 6;
              break;
            case b:
              h = ((r - g) / d + 4) / 6;
              break;
          }
          h *= 360;
        }
        return { h, s, l };
      }

      function hslToRgb(h, s, l) {
        h /= 360;
        let r, g, b;

        if (s === 0) {
          r = g = b = l;
        } else {
          const hue2rgb = (p, q, t) => {
            if (t < 0) t += 1;
            if (t > 1) t -= 1;
            if (t < 1 / 6) return p + (q - p) * 6 * t;
            if (t < 1 / 2) return q;
            if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
            return p;
          };
          const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
          const p = 2 * l - q;
          r = hue2rgb(p, q, h + 1 / 3);
          g = hue2rgb(p, q, h);
          b = hue2rgb(p, q, h - 1 / 3);
        }

        return { r: r * 255, g: g * 255, b: b * 255 };
      }

      // Presets
      const presets = {
        original: {
          brightness: 0,
          contrast: 0,
          saturation: 0,
          temperature: 0,
          hue: 0,
          blur: 0,
          sharpen: 0,
          vignette: 0
        },
        vintage: {
          brightness: 5,
          contrast: -10,
          saturation: -30,
          temperature: 20,
          hue: 0,
          blur: 0,
          sharpen: 0,
          vignette: 30
        },
        lomo: {
          brightness: 0,
          contrast: 30,
          saturation: 30,
          temperature: 0,
          hue: 0,
          blur: 0,
          sharpen: 20,
          vignette: 50
        },
        blackwhite: {
          brightness: 0,
          contrast: 10,
          saturation: -100,
          temperature: 0,
          hue: 0,
          blur: 0,
          sharpen: 10,
          vignette: 0
        },
        sepia: {
          brightness: 10,
          contrast: 0,
          saturation: -50,
          temperature: 40,
          hue: 0,
          blur: 0,
          sharpen: 0,
          vignette: 20
        },
        cool: {
          brightness: 0,
          contrast: 5,
          saturation: 10,
          temperature: -30,
          hue: 0,
          blur: 0,
          sharpen: 0,
          vignette: 0
        },
        warm: {
          brightness: 5,
          contrast: 5,
          saturation: 10,
          temperature: 30,
          hue: 0,
          blur: 0,
          sharpen: 0,
          vignette: 0
        },
        dramatic: {
          brightness: -10,
          contrast: 40,
          saturation: -20,
          temperature: 0,
          hue: 0,
          blur: 0,
          sharpen: 30,
          vignette: 40
        },
        fade: {
          brightness: 20,
          contrast: -20,
          saturation: -30,
          temperature: 0,
          hue: 0,
          blur: 0,
          sharpen: 0,
          vignette: 0
        },
        vivid: {
          brightness: 5,
          contrast: 20,
          saturation: 50,
          temperature: 0,
          hue: 0,
          blur: 0,
          sharpen: 20,
          vignette: 0
        }
      };

      window.applyPreset = function (name) {
        const preset = presets[name];
        controls.forEach((control) => {
          const input = document.getElementById(control);
          const valueDisplay = document.getElementById(control + "Value");
          input.value = preset[control];
          valueDisplay.textContent = preset[control];
        });
        applyFilters();
      };

      window.resetFilters = function () {
        applyPreset("original");
      };

      // Compare functionality
      window.toggleCompare = function () {
        isComparing = !isComparing;
        const btn = document.getElementById("compareBtn");

        if (isComparing) {
          btn.textContent = "ğŸ‘ï¸ éšè—å¯¹æ¯”";
          originalCanvas.style.display = "block";
          compareSlider.classList.remove("hidden");
          updateComparePosition(50);
        } else {
          btn.textContent = "ğŸ‘ï¸ å¯¹æ¯”åŸå›¾";
          originalCanvas.style.display = "none";
          compareSlider.classList.add("hidden");
        }
      };

      function updateComparePosition(percent) {
        compareSlider.style.left = percent + "%";
        originalCanvas.style.clipPath = "inset(0 " + (100 - percent) + "% 0 0)";
      }

      // Compare slider drag
      let isDragging = false;
      const canvasContainer = document.getElementById("canvasContainer");

      canvasContainer.addEventListener("mousedown", (e) => {
        if (isComparing) {
          isDragging = true;
          updateSliderFromEvent(e);
        }
      });

      document.addEventListener("mousemove", (e) => {
        if (isDragging && isComparing) {
          updateSliderFromEvent(e);
        }
      });

      document.addEventListener("mouseup", () => {
        isDragging = false;
      });

      function updateSliderFromEvent(e) {
        const rect = canvasContainer.getBoundingClientRect();
        let percent = ((e.clientX - rect.left) / rect.width) * 100;
        percent = Math.max(0, Math.min(100, percent));
        updateComparePosition(percent);
      }

      // Download
      window.downloadImage = function () {
        const link = document.createElement("a");
        link.download = "filtered-image.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
      };

      // Theme toggle
      function toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        document.getElementById("theme-icon").textContent = newTheme === "light" ? "â˜€ï¸" : "ğŸŒ™";
        localStorage.setItem("theme", newTheme);
      }
    </script>
  </body>
</html>
