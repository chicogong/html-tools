<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>食物卡路里查询 - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #dc2626; --accent2: #f97316; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 700px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .search-box { position: relative; }
        .search-box input { width: 100%; padding: 16px 20px; border: 1px solid var(--border); border-radius: 10px; background: var(--bg); color: var(--text); font-size: 1.1rem; }
        .search-box input:focus { outline: none; border-color: var(--accent); }
        .search-box input::placeholder { color: var(--text2); }
        .category-tabs { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 16px; }
        .category-tab { padding: 8px 16px; border: 1px solid var(--border); border-radius: 20px; background: var(--bg); color: var(--text2); cursor: pointer; font-size: 0.85rem; transition: all 0.2s; }
        .category-tab.active { background: linear-gradient(135deg, var(--accent), var(--accent2)); border-color: var(--accent); color: white; }
        .category-tab:hover { border-color: var(--accent); }
        .food-list { max-height: 400px; overflow-y: auto; }
        .food-item { display: flex; justify-content: space-between; align-items: center; padding: 16px; background: var(--bg); border-radius: 10px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s; }
        .food-item:hover { transform: translateX(4px); border-left: 3px solid var(--accent); }
        .food-item .info { flex: 1; }
        .food-item .name { font-weight: 600; margin-bottom: 4px; }
        .food-item .serving { font-size: 0.8rem; color: var(--text2); }
        .food-item .calories { font-size: 1.3rem; font-weight: 700; color: var(--accent2); }
        .food-item .unit { font-size: 0.8rem; color: var(--text2); }
        .selected-list { margin-top: 16px; }
        .selected-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; }
        .selected-item .name { flex: 1; }
        .selected-item .amount-control { display: flex; align-items: center; gap: 8px; }
        .selected-item .amount-control input { width: 60px; padding: 6px; border: 1px solid var(--border); border-radius: 6px; background: var(--card); color: var(--text); text-align: center; font-size: 0.9rem; }
        .selected-item .remove-btn { width: 28px; height: 28px; border: none; border-radius: 50%; background: var(--accent); color: white; cursor: pointer; font-size: 1rem; }
        .summary-hero { background: linear-gradient(135deg, var(--accent), var(--accent2)); padding: 24px; border-radius: 12px; text-align: center; color: white; }
        .summary-hero .label { opacity: 0.9; font-size: 0.9rem; }
        .summary-hero .big { font-size: 3rem; font-weight: 700; }
        .summary-hero .sub { opacity: 0.8; font-size: 0.85rem; margin-top: 4px; }
        .nutrition-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px; }
        .nutrition-item { text-align: center; padding: 16px; background: var(--bg); border-radius: 10px; }
        .nutrition-item .value { font-size: 1.3rem; font-weight: 700; }
        .nutrition-item .label { font-size: 0.75rem; color: var(--text2); margin-top: 4px; }
        .clear-btn { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); cursor: pointer; font-size: 1rem; margin-top: 16px; }
        .clear-btn:hover { border-color: var(--accent); }
        .no-result { text-align: center; padding: 40px; color: var(--text2); }
        @media (max-width: 500px) { .nutrition-grid { grid-template-columns: repeat(3, 1fr); } .nutrition-item { padding: 12px 8px; } .nutrition-item .value { font-size: 1.1rem; } }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">← 返回</a>
        <h1>食物卡路里查询</h1>
        <p class="subtitle">查询常见食物热量和营养成分</p>
        
        <div class="card">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="搜索食物名称..." oninput="searchFood()">
            </div>
            <div class="category-tabs" id="categoryTabs"></div>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 16px;">食物列表</h3>
            <div class="food-list" id="foodList"></div>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 16px;">已选食物</h3>
            <div class="selected-list" id="selectedList">
                <div class="no-result">点击上方食物添加到列表</div>
            </div>
            <button class="clear-btn" onclick="clearSelected()">清空列表</button>
        </div>
        
        <div class="card">
            <div class="summary-hero">
                <div class="label">总热量</div>
                <div class="big" id="totalCalories">0</div>
                <div class="sub">千卡 (kcal)</div>
            </div>
            
            <div class="nutrition-grid">
                <div class="nutrition-item">
                    <div class="value" id="totalProtein">0g</div>
                    <div class="label">蛋白质</div>
                </div>
                <div class="nutrition-item">
                    <div class="value" id="totalCarbs">0g</div>
                    <div class="label">碳水化合物</div>
                </div>
                <div class="nutrition-item">
                    <div class="value" id="totalFat">0g</div>
                    <div class="label">脂肪</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        var foods = [
            { name: '米饭', category: '主食', serving: '100g', calories: 116, protein: 2.6, carbs: 25.6, fat: 0.3 },
            { name: '面条', category: '主食', serving: '100g', calories: 110, protein: 4.0, carbs: 22.0, fat: 0.5 },
            { name: '馒头', category: '主食', serving: '100g', calories: 223, protein: 7.0, carbs: 47.0, fat: 1.1 },
            { name: '面包', category: '主食', serving: '100g', calories: 265, protein: 9.0, carbs: 49.0, fat: 3.2 },
            { name: '燕麦', category: '主食', serving: '100g', calories: 389, protein: 16.9, carbs: 66.3, fat: 6.9 },
            { name: '红薯', category: '主食', serving: '100g', calories: 86, protein: 1.6, carbs: 20.1, fat: 0.1 },
            { name: '玉米', category: '主食', serving: '100g', calories: 112, protein: 4.0, carbs: 22.8, fat: 1.2 },
            { name: '土豆', category: '主食', serving: '100g', calories: 77, protein: 2.0, carbs: 17.5, fat: 0.1 },
            
            { name: '鸡胸肉', category: '肉类', serving: '100g', calories: 133, protein: 31.0, carbs: 0, fat: 1.2 },
            { name: '猪里脊', category: '肉类', serving: '100g', calories: 143, protein: 21.0, carbs: 0.7, fat: 6.0 },
            { name: '牛肉', category: '肉类', serving: '100g', calories: 250, protein: 26.0, carbs: 0, fat: 15.0 },
            { name: '羊肉', category: '肉类', serving: '100g', calories: 294, protein: 25.0, carbs: 0, fat: 21.0 },
            { name: '五花肉', category: '肉类', serving: '100g', calories: 518, protein: 9.5, carbs: 0.5, fat: 53.0 },
            { name: '鸡蛋', category: '肉类', serving: '1个(50g)', calories: 72, protein: 6.3, carbs: 0.4, fat: 5.0 },
            { name: '鸭肉', category: '肉类', serving: '100g', calories: 240, protein: 15.5, carbs: 0, fat: 19.7 },
            
            { name: '三文鱼', category: '海鲜', serving: '100g', calories: 208, protein: 20.0, carbs: 0, fat: 13.0 },
            { name: '虾', category: '海鲜', serving: '100g', calories: 99, protein: 20.3, carbs: 0.2, fat: 1.4 },
            { name: '带鱼', category: '海鲜', serving: '100g', calories: 127, protein: 17.7, carbs: 0, fat: 5.9 },
            { name: '鲫鱼', category: '海鲜', serving: '100g', calories: 108, protein: 17.1, carbs: 0, fat: 4.4 },
            { name: '螃蟹', category: '海鲜', serving: '100g', calories: 95, protein: 13.8, carbs: 2.3, fat: 3.6 },
            { name: '鱿鱼', category: '海鲜', serving: '100g', calories: 92, protein: 17.0, carbs: 1.8, fat: 1.6 },
            
            { name: '西蓝花', category: '蔬菜', serving: '100g', calories: 36, protein: 4.1, carbs: 4.3, fat: 0.6 },
            { name: '菠菜', category: '蔬菜', serving: '100g', calories: 28, protein: 2.6, carbs: 4.5, fat: 0.3 },
            { name: '白菜', category: '蔬菜', serving: '100g', calories: 18, protein: 1.5, carbs: 3.2, fat: 0.2 },
            { name: '番茄', category: '蔬菜', serving: '100g', calories: 20, protein: 0.9, carbs: 4.0, fat: 0.2 },
            { name: '黄瓜', category: '蔬菜', serving: '100g', calories: 16, protein: 0.8, carbs: 2.9, fat: 0.2 },
            { name: '胡萝卜', category: '蔬菜', serving: '100g', calories: 39, protein: 1.0, carbs: 8.8, fat: 0.2 },
            { name: '茄子', category: '蔬菜', serving: '100g', calories: 23, protein: 1.1, carbs: 4.9, fat: 0.2 },
            { name: '青椒', category: '蔬菜', serving: '100g', calories: 23, protein: 1.0, carbs: 5.4, fat: 0.2 },
            
            { name: '苹果', category: '水果', serving: '1个(200g)', calories: 104, protein: 0.4, carbs: 27.6, fat: 0.3 },
            { name: '香蕉', category: '水果', serving: '1根(120g)', calories: 107, protein: 1.3, carbs: 27.5, fat: 0.4 },
            { name: '橙子', category: '水果', serving: '1个(150g)', calories: 71, protein: 1.4, carbs: 17.8, fat: 0.2 },
            { name: '葡萄', category: '水果', serving: '100g', calories: 69, protein: 0.7, carbs: 18.1, fat: 0.2 },
            { name: '草莓', category: '水果', serving: '100g', calories: 32, protein: 0.7, carbs: 7.7, fat: 0.3 },
            { name: '西瓜', category: '水果', serving: '100g', calories: 31, protein: 0.6, carbs: 7.6, fat: 0.1 },
            { name: '芒果', category: '水果', serving: '100g', calories: 60, protein: 0.8, carbs: 15.0, fat: 0.4 },
            { name: '桃子', category: '水果', serving: '1个(150g)', calories: 59, protein: 1.4, carbs: 14.4, fat: 0.4 },
            
            { name: '牛奶', category: '饮品', serving: '250ml', calories: 163, protein: 8.0, carbs: 12.0, fat: 8.8 },
            { name: '酸奶', category: '饮品', serving: '100g', calories: 72, protein: 2.5, carbs: 9.3, fat: 2.7 },
            { name: '豆浆', category: '饮品', serving: '250ml', calories: 35, protein: 3.0, carbs: 2.8, fat: 1.6 },
            { name: '可乐', category: '饮品', serving: '330ml', calories: 139, protein: 0, carbs: 35.0, fat: 0 },
            { name: '橙汁', category: '饮品', serving: '250ml', calories: 112, protein: 1.7, carbs: 25.8, fat: 0.5 },
            { name: '咖啡(黑)', category: '饮品', serving: '240ml', calories: 2, protein: 0.3, carbs: 0, fat: 0 },
            { name: '奶茶', category: '饮品', serving: '500ml', calories: 250, protein: 2.0, carbs: 45.0, fat: 6.0 },
            
            { name: '薯片', category: '零食', serving: '100g', calories: 547, protein: 5.3, carbs: 51.3, fat: 35.5 },
            { name: '巧克力', category: '零食', serving: '100g', calories: 546, protein: 4.9, carbs: 60.0, fat: 31.3 },
            { name: '饼干', category: '零食', serving: '100g', calories: 502, protein: 6.5, carbs: 60.0, fat: 26.0 },
            { name: '坚果(混合)', category: '零食', serving: '30g', calories: 174, protein: 5.0, carbs: 6.0, fat: 15.0 },
            { name: '冰淇淋', category: '零食', serving: '100g', calories: 207, protein: 3.5, carbs: 24.0, fat: 11.0 },
            { name: '蛋糕', category: '零食', serving: '100g', calories: 348, protein: 4.6, carbs: 52.0, fat: 14.0 },
            { name: '瓜子', category: '零食', serving: '100g', calories: 606, protein: 24.0, carbs: 13.0, fat: 52.0 },
            
            { name: '豆腐', category: '豆制品', serving: '100g', calories: 81, protein: 8.1, carbs: 4.2, fat: 3.7 },
            { name: '豆皮', category: '豆制品', serving: '100g', calories: 409, protein: 44.6, carbs: 18.8, fat: 17.4 },
            { name: '腐竹', category: '豆制品', serving: '100g', calories: 461, protein: 44.6, carbs: 22.3, fat: 21.7 },
            { name: '毛豆', category: '豆制品', serving: '100g', calories: 131, protein: 13.1, carbs: 10.5, fat: 5.0 }
        ];
        
        var categories = ['全部', '主食', '肉类', '海鲜', '蔬菜', '水果', '饮品', '零食', '豆制品'];
        var currentCategory = '全部';
        var selectedFoods = [];
        
        function init() {
            renderCategories();
            renderFoodList();
            loadFromStorage();
        }
        
        function renderCategories() {
            var container = document.getElementById('categoryTabs');
            categories.forEach(function(cat) {
                var tab = document.createElement('button');
                tab.className = 'category-tab' + (cat === currentCategory ? ' active' : '');
                tab.textContent = cat;
                tab.onclick = function() { setCategory(cat); };
                container.appendChild(tab);
            });
        }
        
        function setCategory(cat) {
            currentCategory = cat;
            document.querySelectorAll('.category-tab').forEach(function(tab) {
                tab.classList.toggle('active', tab.textContent === cat);
            });
            document.getElementById('searchInput').value = '';
            renderFoodList();
        }
        
        function searchFood() {
            var query = document.getElementById('searchInput').value.toLowerCase();
            var filtered = foods.filter(function(food) {
                return food.name.toLowerCase().indexOf(query) !== -1;
            });
            renderFoodList(filtered);
        }
        
        function renderFoodList(list) {
            var container = document.getElementById('foodList');
            while (container.firstChild) container.removeChild(container.firstChild);
            
            var displayList = list || foods;
            if (currentCategory !== '全部' && !list) {
                displayList = foods.filter(function(f) { return f.category === currentCategory; });
            }
            
            if (displayList.length === 0) {
                var noResult = document.createElement('div');
                noResult.className = 'no-result';
                noResult.textContent = '未找到相关食物';
                container.appendChild(noResult);
                return;
            }
            
            displayList.forEach(function(food) {
                var item = document.createElement('div');
                item.className = 'food-item';
                item.onclick = function() { addFood(food); };
                
                var info = document.createElement('div');
                info.className = 'info';
                
                var name = document.createElement('div');
                name.className = 'name';
                name.textContent = food.name;
                
                var serving = document.createElement('div');
                serving.className = 'serving';
                serving.textContent = food.serving;
                
                info.appendChild(name);
                info.appendChild(serving);
                
                var caloriesDiv = document.createElement('div');
                
                var caloriesSpan = document.createElement('span');
                caloriesSpan.className = 'calories';
                caloriesSpan.textContent = food.calories;
                
                var unitSpan = document.createElement('span');
                unitSpan.className = 'unit';
                unitSpan.textContent = ' kcal';
                
                caloriesDiv.appendChild(caloriesSpan);
                caloriesDiv.appendChild(unitSpan);
                
                item.appendChild(info);
                item.appendChild(caloriesDiv);
                container.appendChild(item);
            });
        }
        
        function addFood(food) {
            var existing = selectedFoods.find(function(f) { return f.name === food.name; });
            if (existing) {
                existing.amount += 1;
            } else {
                selectedFoods.push({
                    name: food.name,
                    serving: food.serving,
                    calories: food.calories,
                    protein: food.protein,
                    carbs: food.carbs,
                    fat: food.fat,
                    amount: 1
                });
            }
            renderSelectedList();
            updateSummary();
            saveToStorage();
        }
        
        function removeFood(index) {
            selectedFoods.splice(index, 1);
            renderSelectedList();
            updateSummary();
            saveToStorage();
        }
        
        function updateAmount(index, value) {
            var amount = parseFloat(value) || 0;
            if (amount <= 0) {
                removeFood(index);
            } else {
                selectedFoods[index].amount = amount;
                updateSummary();
                saveToStorage();
            }
        }
        
        function renderSelectedList() {
            var container = document.getElementById('selectedList');
            while (container.firstChild) container.removeChild(container.firstChild);
            
            if (selectedFoods.length === 0) {
                var noResult = document.createElement('div');
                noResult.className = 'no-result';
                noResult.textContent = '点击上方食物添加到列表';
                container.appendChild(noResult);
                return;
            }
            
            selectedFoods.forEach(function(food, index) {
                var item = document.createElement('div');
                item.className = 'selected-item';
                
                var nameSpan = document.createElement('span');
                nameSpan.className = 'name';
                nameSpan.textContent = food.name + ' (' + food.serving + ')';
                
                var control = document.createElement('div');
                control.className = 'amount-control';
                
                var input = document.createElement('input');
                input.type = 'number';
                input.value = food.amount;
                input.min = '0';
                input.step = '0.5';
                input.onchange = function() { updateAmount(index, this.value); };
                
                var portionSpan = document.createElement('span');
                portionSpan.textContent = '份';
                
                var removeBtn = document.createElement('button');
                removeBtn.className = 'remove-btn';
                removeBtn.textContent = '×';
                removeBtn.onclick = function() { removeFood(index); };
                
                control.appendChild(input);
                control.appendChild(portionSpan);
                control.appendChild(removeBtn);
                
                item.appendChild(nameSpan);
                item.appendChild(control);
                container.appendChild(item);
            });
        }
        
        function updateSummary() {
            var totalCal = 0, totalPro = 0, totalCarb = 0, totalFat = 0;
            
            selectedFoods.forEach(function(food) {
                totalCal += food.calories * food.amount;
                totalPro += food.protein * food.amount;
                totalCarb += food.carbs * food.amount;
                totalFat += food.fat * food.amount;
            });
            
            document.getElementById('totalCalories').textContent = Math.round(totalCal);
            document.getElementById('totalProtein').textContent = totalPro.toFixed(1) + 'g';
            document.getElementById('totalCarbs').textContent = totalCarb.toFixed(1) + 'g';
            document.getElementById('totalFat').textContent = totalFat.toFixed(1) + 'g';
        }
        
        function clearSelected() {
            selectedFoods = [];
            renderSelectedList();
            updateSummary();
            saveToStorage();
        }
        
        function saveToStorage() {
            try {
                localStorage.setItem('calorie-counter-selected', JSON.stringify(selectedFoods));
            } catch (e) {}
        }
        
        function loadFromStorage() {
            try {
                var saved = localStorage.getItem('calorie-counter-selected');
                if (saved) {
                    selectedFoods = JSON.parse(saved);
                    renderSelectedList();
                    updateSummary();
                }
            } catch (e) {}
        }
        
        init();
    </script>
</body>
</html>
