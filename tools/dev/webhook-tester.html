<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebhookÊµãËØïÂô® - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --text-primary: #fff;
            --text-secondary: #88a;
            --accent: #8b5cf6;
            --border: #2a2a3a;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
        }
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #fff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
            padding: 2rem;
            text-align: center;
        }
        .nav {
            max-width: 1200px;
            margin: 0 auto 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .back-link {
            color: rgba(255,255,255,0.9);
            text-decoration: none;
            font-size: 0.9rem;
        }
        .theme-toggle {
            background: rgba(255,255,255,0.2);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            color: white;
            cursor: pointer;
        }
        .header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .header p { opacity: 0.9; }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .section {
            background: var(--bg-secondary);
            border-radius: 1rem;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        .section-header {
            padding: 1rem 1.5rem;
            background: var(--bg-tertiary);
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section-content {
            padding: 1.5rem;
        }
        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .form-group {
            flex: 1;
        }
        .form-group label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        input, select, textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text-primary);
            font-size: 0.95rem;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
        }
        textarea {
            font-family: Monaco, Menlo, monospace;
            resize: vertical;
            min-height: 150px;
        }
        .method-select {
            display: flex;
            gap: 0.5rem;
        }
        .method-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85rem;
        }
        .method-btn.active {
            border-color: var(--accent);
            color: var(--accent);
            background: rgba(139, 92, 246, 0.1);
        }
        .method-get.active { color: #22c55e; border-color: #22c55e; background: rgba(34, 197, 94, 0.1); }
        .method-post.active { color: #3b82f6; border-color: #3b82f6; background: rgba(59, 130, 246, 0.1); }
        .method-put.active { color: #f59e0b; border-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
        .method-patch.active { color: #8b5cf6; border-color: #8b5cf6; background: rgba(139, 92, 246, 0.1); }
        .method-delete.active { color: #ef4444; border-color: #ef4444; background: rgba(239, 68, 68, 0.1); }
        .headers-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .header-row {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        .header-row input {
            flex: 1;
        }
        .remove-btn {
            padding: 0.5rem;
            background: var(--error);
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.8rem;
        }
        .add-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }
        .add-btn:hover { border-color: var(--accent); color: var(--text-primary); }
        .btn {
            padding: 0.75rem 2rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
        }
        .btn:hover { opacity: 0.9; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }
        .response-status {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
        }
        .status-2xx { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .status-3xx { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .status-4xx { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        .status-5xx { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .response-meta {
            display: flex;
            gap: 1.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .tab {
            padding: 0.5rem 1rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.9rem;
            border-bottom: 2px solid transparent;
        }
        .tab.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .code-block {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: Monaco, Menlo, monospace;
            font-size: 0.85rem;
            overflow-x: auto;
            white-space: pre-wrap;
            overflow-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
        }
        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .history-item {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .history-item:hover { background: var(--bg-tertiary); }
        .history-item:last-child { border-bottom: none; }
        .history-method {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            margin-right: 0.5rem;
        }
        .history-url {
            font-family: monospace;
            font-size: 0.85rem;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .history-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .presets {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        .preset-btn {
            padding: 0.375rem 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 0.375rem;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.8rem;
        }
        .preset-btn:hover { border-color: var(--accent); color: var(--text-primary); }
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .form-row { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="nav">
            <a href="../../index.html" class="back-link">‚Üê ËøîÂõûÈ¶ñÈ°µ</a>
            <button class="theme-toggle" onclick="toggleTheme()">üåì ‰∏ªÈ¢ò</button>
        </div>
        <h1>üîó WebhookÊµãËØïÂô®</h1>
        <p>ÂèëÈÄÅHTTPËØ∑Ê±ÇÊµãËØïWebhookÂíåAPIÁ´ØÁÇπ</p>
    </div>

    <div class="container">
        <div class="section">
            <div class="section-header">
                <span>üì§ ËØ∑Ê±ÇÈÖçÁΩÆ</span>
                <div class="presets">
                    <button class="preset-btn" onclick="loadPreset('json')">JSON</button>
                    <button class="preset-btn" onclick="loadPreset('form')">Form</button>
                    <button class="preset-btn" onclick="loadPreset('auth')">Bearer Auth</button>
                </div>
            </div>
            <div class="section-content">
                <div class="form-row">
                    <div class="form-group" style="flex: 0 0 auto;">
                        <label>ËØ∑Ê±ÇÊñπÊ≥ï</label>
                        <div class="method-select">
                            <button class="method-btn method-get active" onclick="setMethod('GET')">GET</button>
                            <button class="method-btn method-post" onclick="setMethod('POST')">POST</button>
                            <button class="method-btn method-put" onclick="setMethod('PUT')">PUT</button>
                            <button class="method-btn method-patch" onclick="setMethod('PATCH')">PATCH</button>
                            <button class="method-btn method-delete" onclick="setMethod('DELETE')">DELETE</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="text" id="urlInput" placeholder="https://api.example.com/webhook">
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label>ËØ∑Ê±ÇÂ§¥</label>
                    <div class="headers-list" id="headersList">
                        <div class="header-row">
                            <input type="text" placeholder="HeaderÂêçÁß∞" value="Content-Type">
                            <input type="text" placeholder="HeaderÂÄº" value="application/json">
                            <button class="remove-btn" onclick="removeHeader(this)">‚úï</button>
                        </div>
                    </div>
                    <button class="add-btn" onclick="addHeader()">+ Ê∑ªÂä†Header</button>
                </div>

                <div class="form-group" id="bodyGroup">
                    <label>ËØ∑Ê±Ç‰Ωì (Body)</label>
                    <textarea id="bodyInput" placeholder="{&quot;key&quot;: &quot;value&quot;}"></textarea>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button class="btn" id="sendBtn" onclick="sendRequest()">
                        <span id="sendText">ÂèëÈÄÅËØ∑Ê±Ç</span>
                        <span id="sendLoading" class="loading" style="display: none;"></span>
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">Ê∏ÖÁ©∫</button>
                </div>
            </div>
        </div>

        <div class="section" id="responseSection" style="display: none;">
            <div class="section-header">
                <span>üì• ÂìçÂ∫îÁªìÊûú</span>
            </div>
            <div class="section-content">
                <div class="response-status">
                    <span class="status-badge" id="statusBadge">200 OK</span>
                    <div class="response-meta">
                        <span id="responseTime">ÂìçÂ∫îÊó∂Èó¥: 0ms</span>
                        <span id="responseSize">Â§ßÂ∞è: 0 B</span>
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab('body')">Body</button>
                    <button class="tab" onclick="switchTab('headers')">Headers</button>
                    <button class="tab" onclick="switchTab('raw')">Raw</button>
                </div>

                <div class="tab-content active" id="bodyTab">
                    <div class="code-block" id="responseBody"></div>
                </div>
                <div class="tab-content" id="headersTab">
                    <div class="code-block" id="responseHeaders"></div>
                </div>
                <div class="tab-content" id="rawTab">
                    <div class="code-block" id="responseRaw"></div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">
                <span>üìã ÂéÜÂè≤ËÆ∞ÂΩï</span>
                <button class="add-btn" onclick="clearHistory()">Ê∏ÖÁ©∫ÂéÜÂè≤</button>
            </div>
            <div class="history-list" id="historyList">
                <div style="padding: 1rem; text-align: center; color: var(--text-secondary);">
                    ÊöÇÊó†ÂéÜÂè≤ËÆ∞ÂΩï
                </div>
            </div>
        </div>
    </div>

    <script>
        window.toggleTheme = function() {
            const theme = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        };
        document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'dark');

        let currentMethod = 'GET';
        let history = JSON.parse(localStorage.getItem('webhook_history') || '[]');

        window.setMethod = function(method) {
            currentMethod = method;
            document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.method-${method.toLowerCase()}`).classList.add('active');
            
            // Show/hide body for GET
            document.getElementById('bodyGroup').style.display = method === 'GET' ? 'none' : 'block';
        };

        function addHeader() {
            const list = document.getElementById('headersList');
            const row = document.createElement('div');
            row.className = 'header-row';
            row.innerHTML = `
                <input type="text" placeholder="HeaderÂêçÁß∞">
                <input type="text" placeholder="HeaderÂÄº">
                <button class="remove-btn" onclick="removeHeader(this)">‚úï</button>
            `;
            list.appendChild(row);
        }

        window.removeHeader = function(btn) {
            btn.parentElement.remove();
        };

        function getHeaders() {
            const headers = {};
            document.querySelectorAll('.header-row').forEach(row => {
                const inputs = row.querySelectorAll('input');
                const name = inputs[0].value.trim();
                const value = inputs[1].value.trim();
                if (name) headers[name] = value;
            });
            return headers;
        }

        window.sendRequest = async function() {
            const url = document.getElementById('urlInput').value.trim();
            if (!url) {
                alert('ËØ∑ËæìÂÖ•URL');
                return;
            }

            const sendBtn = document.getElementById('sendBtn');
            const sendText = document.getElementById('sendText');
            const sendLoading = document.getElementById('sendLoading');

            sendBtn.disabled = true;
            sendText.style.display = 'none';
            sendLoading.style.display = 'inline-block';

            const headers = getHeaders();
            const body = currentMethod !== 'GET' ? document.getElementById('bodyInput').value : undefined;

            const startTime = performance.now();

            try {
                const response = await fetch(url, {
                    method: currentMethod,
                    headers,
                    body
                });

                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);

                // Get response text
                const responseText = await response.text();
                const responseSize = new Blob([responseText]).size;

                // Try to parse as JSON
                let formattedBody;
                try {
                    const json = JSON.parse(responseText);
                    formattedBody = JSON.stringify(json, null, 2);
                } catch {
                    formattedBody = responseText;
                }

                // Get response headers
                const responseHeaders = {};
                response.headers.forEach((value, name) => {
                    responseHeaders[name] = value;
                });

                // Display response
                showResponse({
                    status: response.status,
                    statusText: response.statusText,
                    time: responseTime,
                    size: responseSize,
                    body: formattedBody,
                    headers: responseHeaders,
                    raw: responseText
                });

                // Add to history
                addToHistory(url, currentMethod, response.status);

            } catch (error) {
                showResponse({
                    status: 0,
                    statusText: 'Error',
                    time: Math.round(performance.now() - startTime),
                    size: 0,
                    body: error.message,
                    headers: {},
                    raw: error.toString()
                });
            }

            sendBtn.disabled = false;
            sendText.style.display = 'inline';
            sendLoading.style.display = 'none';
        };

        function showResponse(data) {
            document.getElementById('responseSection').style.display = 'block';

            // Status badge
            const badge = document.getElementById('statusBadge');
            badge.textContent = `${data.status} ${data.statusText}`;
            badge.className = 'status-badge';
            if (data.status >= 200 && data.status < 300) badge.classList.add('status-2xx');
            else if (data.status >= 300 && data.status < 400) badge.classList.add('status-3xx');
            else if (data.status >= 400 && data.status < 500) badge.classList.add('status-4xx');
            else badge.classList.add('status-5xx');

            // Meta
            document.getElementById('responseTime').textContent = `ÂìçÂ∫îÊó∂Èó¥: ${data.time}ms`;
            document.getElementById('responseSize').textContent = `Â§ßÂ∞è: ${formatBytes(data.size)}`;

            // Tabs
            document.getElementById('responseBody').textContent = data.body;
            document.getElementById('responseHeaders').textContent = JSON.stringify(data.headers, null, 2);
            document.getElementById('responseRaw').textContent = data.raw;
        }

        function formatBytes(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
        }

        window.switchTab = function(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector(`.tab[onclick="switchTab('${tab}')"]`).classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
        };

        function addToHistory(url, method, status) {
            history.unshift({
                url,
                method,
                status,
                time: new Date().toLocaleTimeString()
            });
            if (history.length > 20) history.pop();
            localStorage.setItem('webhook_history', JSON.stringify(history));
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            if (history.length === 0) {
                list.innerHTML = '<div style="padding: 1rem; text-align: center; color: var(--text-secondary);">ÊöÇÊó†ÂéÜÂè≤ËÆ∞ÂΩï</div>';
                return;
            }

            list.innerHTML = history.map((item, i) => `
                <div class="history-item" onclick="loadHistory(${i})">
                    <div>
                        <span class="history-method" style="background: ${getMethodColor(item.method)}">${item.method}</span>
                        <span class="history-url">${escapeHtml(item.url)}</span>
                    </div>
                    <span class="history-time">${item.status} - ${item.time}</span>
                </div>
            `).join('');
        }

        window.loadHistory = function(index) {
            const item = history[index];
            document.getElementById('urlInput').value = item.url;
            setMethod(item.method);
        };

        function getMethodColor(method) {
            const colors = {
                GET: 'rgba(34, 197, 94, 0.3)',
                POST: 'rgba(59, 130, 246, 0.3)',
                PUT: 'rgba(245, 158, 11, 0.3)',
                PATCH: 'rgba(139, 92, 246, 0.3)',
                DELETE: 'rgba(239, 68, 68, 0.3)'
            };
            return colors[method] || 'rgba(100, 100, 100, 0.3)';
        }

        window.escapeHtml = function(str) {
            return str.replace(/[&<>"']/g, m => ({
                '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
            })[m]);
        };

        window.clearAll = function() {
            document.getElementById('urlInput').value = '';
            document.getElementById('bodyInput').value = '';
            document.getElementById('headersList').innerHTML = `
                <div class="header-row">
                    <input type="text" placeholder="HeaderÂêçÁß∞" value="Content-Type">
                    <input type="text" placeholder="HeaderÂÄº" value="application/json">
                    <button class="remove-btn" onclick="removeHeader(this)">‚úï</button>
                </div>
            `;
            document.getElementById('responseSection').style.display = 'none';
            setMethod('GET');
        };

        window.clearHistory = function() {
            history = [];
            localStorage.removeItem('webhook_history');
            renderHistory();
        };

        window.loadPreset = function(type) {
            if (type === 'json') {
                document.getElementById('headersList').innerHTML = `
                    <div class="header-row">
                        <input type="text" placeholder="HeaderÂêçÁß∞" value="Content-Type">
                        <input type="text" placeholder="HeaderÂÄº" value="application/json">
                        <button class="remove-btn" onclick="removeHeader(this)">‚úï</button>
                    </div>
                    <div class="header-row">
                        <input type="text" placeholder="HeaderÂêçÁß∞" value="Accept">
                        <input type="text" placeholder="HeaderÂÄº" value="application/json">
                        <button class="remove-btn" onclick="removeHeader(this)">‚úï</button>
                    </div>
                `;
                document.getElementById('bodyInput').value = JSON.stringify({ key: 'value', data: { nested: true } }, null, 2);
            } else if (type === 'form') {
                document.getElementById('headersList').innerHTML = `
                    <div class="header-row">
                        <input type="text" placeholder="HeaderÂêçÁß∞" value="Content-Type">
                        <input type="text" placeholder="HeaderÂÄº" value="application/x-www-form-urlencoded">
                        <button class="remove-btn" onclick="removeHeader(this)">‚úï</button>
                    </div>
                `;
                document.getElementById('bodyInput').value = 'key=value&data=test';
            } else if (type === 'auth') {
                addHeader();
                const rows = document.querySelectorAll('.header-row');
                const lastRow = rows[rows.length - 1];
                lastRow.querySelector('input:first-child').value = 'Authorization';
                lastRow.querySelector('input:nth-child(2)').value = 'Bearer your-token-here';
            }
        };

        // Keyboard shortcut
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                sendRequest();
            }
        });

        renderHistory();
    </script>
</body>
</html>
