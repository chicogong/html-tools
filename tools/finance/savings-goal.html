<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‚¨è“„ç›®æ ‡è®¡ç®—å™¨ - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #8b5cf6; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 700px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus { outline: none; border-color: var(--accent); }
        .result-hero { background: linear-gradient(135deg, var(--accent), #6366f1); padding: 28px; border-radius: 12px; text-align: center; color: white; margin-bottom: 20px; }
        .result-hero .label { opacity: 0.9; font-size: 0.9rem; margin-bottom: 4px; }
        .result-hero .big { font-size: 2.2rem; font-weight: 700; }
        .result-hero .sub { font-size: 0.9rem; opacity: 0.9; margin-top: 8px; }
        .progress-section { margin: 20px 0; }
        .progress-header { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9rem; }
        .progress-bar { height: 24px; background: var(--bg); border-radius: 12px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent), #10b981); border-radius: 12px; transition: width 0.3s; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.75rem; font-weight: 600; }
        .result-row { display: flex; justify-content: space-between; padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; }
        .result-row .label { color: var(--text2); }
        .result-row .value { font-weight: 600; }
        .milestone { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; }
        .milestone-icon { width: 36px; height: 36px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-size: 1rem; }
        .milestone-info { flex: 1; }
        .milestone-title { font-weight: 600; font-size: 0.95rem; }
        .milestone-date { font-size: 0.8rem; color: var(--text2); }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">â† è¿”å›</a>
        <h1>ğŸ¯ å‚¨è“„ç›®æ ‡è®¡ç®—å™¨</h1>
        <p class="subtitle">è®¾å®šç›®æ ‡ï¼Œè®¡ç®—æ¯æœˆå‚¨è“„é‡‘é¢</p>
        
        <div class="card">
            <div class="card-title">ç›®æ ‡è®¾å®š</div>
            <div class="grid">
                <div class="form-group">
                    <label>ç›®æ ‡é‡‘é¢ (å…ƒ)</label>
                    <input type="number" id="goalAmount" value="100000" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>ç›®æ ‡æœˆæ•°</label>
                    <input type="number" id="months" value="24" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>å·²å‚¨è“„é‡‘é¢ (å…ƒ)</label>
                    <input type="number" id="currentSavings" value="10000" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>å¹´åŒ–æ”¶ç›Šç‡ (%, å¯é€‰)</label>
                    <input type="number" id="returnRate" value="3" step="0.1" oninput="calculate()">
                </div>
            </div>
        </div>
        
        <div class="result-hero">
            <div class="label">æ¯æœˆéœ€å‚¨è“„</div>
            <div class="big" id="monthlyRequired">Â¥0</div>
            <div class="sub" id="targetDate"></div>
        </div>
        
        <div class="card">
            <div class="card-title">å‚¨è“„è¿›åº¦</div>
            <div class="progress-section">
                <div class="progress-header">
                    <span id="currentAmount">Â¥0</span>
                    <span id="goalAmountDisplay">Â¥0</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
            </div>
            
            <div class="result-row">
                <span class="label">å‰©ä½™éœ€å‚¨è“„</span>
                <span class="value" id="remaining">Â¥0</span>
            </div>
            <div class="result-row">
                <span class="label">é¢„è®¡åˆ©æ¯æ”¶ç›Š</span>
                <span class="value" id="interestEarned">Â¥0</span>
            </div>
            <div class="result-row">
                <span class="label">æ¯å‘¨éœ€å‚¨è“„</span>
                <span class="value" id="weeklyRequired">Â¥0</span>
            </div>
            <div class="result-row">
                <span class="label">æ¯æ—¥éœ€å‚¨è“„</span>
                <span class="value" id="dailyRequired">Â¥0</span>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">å‚¨è“„é‡Œç¨‹ç¢‘</div>
            <div id="milestones"></div>
        </div>
    </div>
    
    <script>
        function calculate() {
            const goalAmount = parseFloat(document.getElementById('goalAmount').value) || 0;
            const months = parseInt(document.getElementById('months').value) || 1;
            const currentSavings = parseFloat(document.getElementById('currentSavings').value) || 0;
            const returnRate = (parseFloat(document.getElementById('returnRate').value) || 0) / 100;
            
            const remaining = Math.max(0, goalAmount - currentSavings);
            
            // è®¡ç®—æ¯æœˆéœ€å‚¨è“„ï¼ˆè€ƒè™‘å¤åˆ©ï¼‰
            let monthlyRequired;
            if (returnRate > 0) {
                const monthlyRate = returnRate / 12;
                // å…ˆè®¡ç®—ç°æœ‰å‚¨è“„çš„å¢é•¿
                const futureValueOfCurrent = currentSavings * Math.pow(1 + monthlyRate, months);
                const stillNeeded = goalAmount - futureValueOfCurrent;
                
                if (stillNeeded <= 0) {
                    monthlyRequired = 0;
                } else {
                    // PMT å…¬å¼
                    monthlyRequired = stillNeeded * monthlyRate / (Math.pow(1 + monthlyRate, months) - 1);
                }
            } else {
                monthlyRequired = remaining / months;
            }
            
            monthlyRequired = Math.max(0, monthlyRequired);
            
            // è®¡ç®—é¢„è®¡åˆ©æ¯æ”¶ç›Š
            let totalContribution = currentSavings + monthlyRequired * months;
            let finalAmount;
            if (returnRate > 0) {
                const monthlyRate = returnRate / 12;
                finalAmount = currentSavings * Math.pow(1 + monthlyRate, months);
                if (monthlyRequired > 0) {
                    finalAmount += monthlyRequired * ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate);
                }
            } else {
                finalAmount = totalContribution;
            }
            const interestEarned = finalAmount - totalContribution;
            
            // è¿›åº¦ç™¾åˆ†æ¯”
            const progress = goalAmount > 0 ? (currentSavings / goalAmount) * 100 : 0;
            
            // ç›®æ ‡æ—¥æœŸ
            const targetDate = new Date();
            targetDate.setMonth(targetDate.getMonth() + months);
            
            const fmt = (n) => 'Â¥' + n.toLocaleString('zh-CN', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            
            document.getElementById('monthlyRequired').textContent = fmt(monthlyRequired);
            document.getElementById('targetDate').textContent = 
                'é¢„è®¡ ' + targetDate.getFullYear() + 'å¹´' + (targetDate.getMonth() + 1) + 'æœˆè¾¾æˆç›®æ ‡';
            
            document.getElementById('currentAmount').textContent = fmt(currentSavings);
            document.getElementById('goalAmountDisplay').textContent = fmt(goalAmount);
            document.getElementById('progressFill').style.width = Math.min(100, progress) + '%';
            document.getElementById('progressFill').textContent = progress.toFixed(1) + '%';
            
            document.getElementById('remaining').textContent = fmt(remaining);
            document.getElementById('interestEarned').textContent = fmt(interestEarned);
            document.getElementById('weeklyRequired').textContent = fmt(monthlyRequired / 4.33);
            document.getElementById('dailyRequired').textContent = fmt(monthlyRequired / 30);
            
            // ç”Ÿæˆé‡Œç¨‹ç¢‘
            generateMilestones(goalAmount, currentSavings, monthlyRequired, months, returnRate);
        }
        
        function generateMilestones(goal, current, monthly, totalMonths, rate) {
            const container = document.getElementById('milestones');
            container.textContent = '';
            
            const milestones = [25, 50, 75, 100];
            const monthlyRate = rate / 12;
            
            milestones.forEach(percent => {
                const targetAmount = goal * (percent / 100);
                if (targetAmount <= current) {
                    // å·²è¾¾æˆ
                    const div = createMilestone('âœ“', percent + '% - ' + formatMoney(targetAmount), 'å·²è¾¾æˆ', true);
                    container.appendChild(div);
                } else {
                    // è®¡ç®—è¾¾æˆæ—¶é—´
                    let months = 0;
                    let accumulated = current;
                    
                    while (accumulated < targetAmount && months < totalMonths + 120) {
                        months++;
                        accumulated = accumulated * (1 + monthlyRate) + monthly;
                    }
                    
                    const date = new Date();
                    date.setMonth(date.getMonth() + months);
                    const dateStr = date.getFullYear() + 'å¹´' + (date.getMonth() + 1) + 'æœˆ';
                    
                    const div = createMilestone(percent + '%', formatMoney(targetAmount), months <= totalMonths ? dateStr : 'éœ€å»¶é•¿è®¡åˆ’');
                    container.appendChild(div);
                }
            });
        }
        
        function createMilestone(icon, title, date, completed) {
            const div = document.createElement('div');
            div.className = 'milestone';
            if (completed) div.style.opacity = '0.6';
            
            const iconDiv = document.createElement('div');
            iconDiv.className = 'milestone-icon';
            iconDiv.textContent = icon;
            if (completed) iconDiv.style.background = '#10b981';
            
            const infoDiv = document.createElement('div');
            infoDiv.className = 'milestone-info';
            
            const titleDiv = document.createElement('div');
            titleDiv.className = 'milestone-title';
            titleDiv.textContent = title;
            
            const dateDiv = document.createElement('div');
            dateDiv.className = 'milestone-date';
            dateDiv.textContent = date;
            
            infoDiv.appendChild(titleDiv);
            infoDiv.appendChild(dateDiv);
            div.appendChild(iconDiv);
            div.appendChild(infoDiv);
            
            return div;
        }
        
        function formatMoney(n) {
            return 'Â¥' + n.toLocaleString('zh-CN', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        }
        
        calculate();
    </script>
</body>
</html>
