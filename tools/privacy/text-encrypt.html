<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ–‡æœ¬åŠ å¯†è§£å¯† - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="æ–‡æœ¬åŠ å¯†è§£å¯† - WebUtils" />
    <meta name="keywords" content="text-encrypt,privacy,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/privacy/text-encrypt.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="æ–‡æœ¬åŠ å¯†è§£å¯† - WebUtils" />
    <meta property="og:description" content="æ–‡æœ¬åŠ å¯†è§£å¯† - WebUtils" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/privacy/text-encrypt.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="æ–‡æœ¬åŠ å¯†è§£å¯† - WebUtils" />
    <meta name="twitter:description" content="æ–‡æœ¬åŠ å¯†è§£å¯† - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <meta
      name="description"
      content="åœ¨çº¿æ–‡æœ¬åŠ å¯†è§£å¯†å·¥å…·ï¼Œæ”¯æŒ AESã€DES ç­‰å¤šç§åŠ å¯†ç®—æ³•ï¼Œæœ¬åœ°å¤„ç†ä¿æŠ¤éšç§"
    />
    <meta name="keywords" content="encrypt,decrypt,åŠ å¯†,è§£å¯†,AES,DES,æ–‡æœ¬åŠ å¯†,åœ¨çº¿å·¥å…·" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”</text></svg>"
    />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme='light'] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      :root {
        --bg-primary: #fff;
        --bg-secondary: #f8fafc;
        --bg-tertiary: #f1f5f9;
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        --border-color: #e2e8f0;
        --accent-color: #22c55e;
        --accent-hover: #16a34a;
        --error-color: #ef4444;
      }
      [data-theme='dark'] {
        --bg-primary: #0f172a;
        --bg-secondary: #1e293b;
        --bg-tertiary: #334155;
        --text-primary: #f1f5f9;
        --text-secondary: #94a3b8;
        --border-color: #475569;
      }
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        min-height: 100vh;
        padding: 20px;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
      }
      .header {
        text-align: center;
        margin-bottom: 25px;
      }
      .header h1 {
        font-size: 1.8rem;
        margin-bottom: 8px;
      }
      .header p {
        color: var(--text-secondary);
      }
      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 8px 12px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background: var(--bg-secondary);
        cursor: pointer;
        font-size: 1.2rem;
      }
      .card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
      }
      .card-title {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .settings-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }
      .form-group label {
        display: block;
        font-size: 0.85rem;
        font-weight: 500;
        margin-bottom: 8px;
      }
      .form-group select,
      .form-group input {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background: var(--bg-primary);
        color: var(--text-primary);
        font-size: 0.9rem;
      }
      .form-group input[type='password'] {
        font-family: monospace;
      }
      .password-toggle {
        position: relative;
      }
      .password-toggle input {
        padding-right: 40px;
      }
      .password-toggle button {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1.1rem;
        opacity: 0.6;
      }
      .password-toggle button:hover {
        opacity: 1;
      }
      .text-area-group {
        margin-bottom: 15px;
      }
      .text-area-group label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.85rem;
        font-weight: 500;
        margin-bottom: 8px;
      }
      .text-area-group textarea {
        width: 100%;
        min-height: 150px;
        padding: 12px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background: var(--bg-primary);
        color: var(--text-primary);
        font-family: monospace;
        font-size: 0.9rem;
        resize: vertical;
      }
      .char-count {
        font-size: 0.75rem;
        color: var(--text-secondary);
        font-weight: normal;
      }
      .btn-group {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin: 20px 0;
      }
      .btn {
        padding: 12px 24px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background: var(--bg-primary);
        color: var(--text-primary);
        cursor: pointer;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.2s;
      }
      .btn:hover {
        background: var(--bg-tertiary);
      }
      .btn-primary {
        background: var(--accent-color);
        color: white;
        border-color: var(--accent-color);
      }
      .btn-primary:hover {
        background: var(--accent-hover);
      }
      .btn-danger {
        background: var(--error-color);
        color: white;
        border-color: var(--error-color);
      }
      .result-actions {
        display: flex;
        gap: 10px;
        margin-top: 10px;
      }
      .result-actions button {
        padding: 6px 12px;
        font-size: 0.8rem;
      }
      .info-box {
        background: var(--bg-tertiary);
        border-radius: 8px;
        padding: 15px;
        font-size: 0.85rem;
        color: var(--text-secondary);
      }
      .info-box ul {
        margin-left: 20px;
        margin-top: 8px;
      }
      .info-box li {
        margin-bottom: 4px;
      }
      .error-msg {
        background: #fee2e2;
        color: #991b1b;
        padding: 10px 15px;
        border-radius: 8px;
        margin-bottom: 15px;
        display: none;
      }
      [data-theme='dark'] .error-msg {
        background: #7f1d1d;
        color: #fca5a5;
      }
      .error-msg.show {
        display: block;
      }
      .algorithm-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
        margin-top: 15px;
      }
      .algo-card {
        padding: 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
      }
      .algo-card:hover {
        border-color: var(--accent-color);
      }
      .algo-card.selected {
        border-color: var(--accent-color);
        background: var(--bg-tertiary);
      }
      .algo-card .name {
        font-weight: 600;
        margin-bottom: 4px;
      }
      .algo-card .desc {
        font-size: 0.75rem;
        color: var(--text-secondary);
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      æ–‡æœ¬åŠ å¯†è§£å¯†
    </nav>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>

    <div class="container">
      <div class="header">
        <h1>ğŸ” æ–‡æœ¬åŠ å¯†è§£å¯†</h1>
        <p>ä½¿ç”¨ AES ç­‰ç®—æ³•åŠ å¯†å’Œè§£å¯†æ–‡æœ¬ï¼Œæ‰€æœ‰æ“ä½œåœ¨æœ¬åœ°å®Œæˆ</p>
      </div>

      <div class="card">
        <div class="card-title">âš™ï¸ åŠ å¯†è®¾ç½®</div>

        <div class="algorithm-info">
          <div class="algo-card selected" onclick="selectAlgorithm('AES-GCM')">
            <div class="name">AES-GCM</div>
            <div class="desc">æ¨èï¼Œé«˜å®‰å…¨æ€§</div>
          </div>
          <div class="algo-card" onclick="selectAlgorithm('AES-CBC')">
            <div class="name">AES-CBC</div>
            <div class="desc">å…¼å®¹æ€§å¥½</div>
          </div>
          <div class="algo-card" onclick="selectAlgorithm('AES-CTR')">
            <div class="name">AES-CTR</div>
            <div class="desc">æµå¼åŠ å¯†</div>
          </div>
        </div>

        <div class="settings-row" style="margin-top: 20px">
          <div class="form-group">
            <label>å¯†é’¥é•¿åº¦</label>
            <select id="keyLength">
              <option value="128">128 ä½</option>
              <option value="256" selected>256 ä½</option>
            </select>
          </div>
          <div class="form-group password-toggle">
            <label>åŠ å¯†å¯†ç </label>
            <input type="password" id="password" placeholder="è¾“å…¥å¯†ç ..." />
            <button type="button" onclick="togglePassword()">ğŸ‘ï¸</button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“ è¾“å…¥æ–‡æœ¬</div>
        <div class="error-msg" id="errorMsg"></div>
        <div class="text-area-group">
          <label>
            <span>åŸæ–‡ / å¯†æ–‡</span>
            <span class="char-count" id="inputCount">0 å­—ç¬¦</span>
          </label>
          <textarea
            id="inputText"
            placeholder="è¾“å…¥è¦åŠ å¯†æˆ–è§£å¯†çš„æ–‡æœ¬..."
            oninput="updateCount()"
          ></textarea>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="encryptText()">ğŸ”’ åŠ å¯†</button>
          <button class="btn btn-primary" onclick="decryptText()">ğŸ”“ è§£å¯†</button>
          <button class="btn" onclick="swapText()">ğŸ”„ äº¤æ¢</button>
          <button class="btn" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
        </div>

        <div class="text-area-group">
          <label>
            <span>ç»“æœ</span>
            <span class="char-count" id="outputCount">0 å­—ç¬¦</span>
          </label>
          <textarea id="outputText" placeholder="ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
        </div>

        <div class="result-actions">
          <button class="btn" onclick="copyResult()">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
          <button class="btn" onclick="downloadResult()">ğŸ’¾ ä¸‹è½½</button>
        </div>
      </div>

      <div class="info-box">
        <strong>ğŸ›¡ï¸ å®‰å…¨è¯´æ˜</strong>
        <ul>
          <li>æ‰€æœ‰åŠ å¯†è§£å¯†æ“ä½œå®Œå…¨åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨</li>
          <li>ä½¿ç”¨ Web Crypto API è¿›è¡ŒåŠ å¯†ï¼Œå®‰å…¨æ€§æœ‰ä¿éšœ</li>
          <li>å¯†ç ä¼šé€šè¿‡ PBKDF2 ç®—æ³•æ´¾ç”Ÿå‡ºåŠ å¯†å¯†é’¥</li>
          <li>åŠ å¯†ç»“æœä½¿ç”¨ Base64 ç¼–ç ï¼Œä¾¿äºä¼ è¾“å’Œå­˜å‚¨</li>
          <li>è¯·å¦¥å–„ä¿ç®¡å¯†ç ï¼Œé—å¤±å°†æ— æ³•è§£å¯†</li>
        </ul>
      </div>
    </div>

    <script>
      // Theme
      function initTheme() {
        const saved = localStorage.getItem('theme');
        if (saved) {
          document.documentElement.setAttribute('data-theme', saved);
        } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.setAttribute('data-theme', 'dark');
        }
      }
      window.toggleTheme = function () {
        const current = document.documentElement.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
      };
      initTheme();

      let selectedAlgorithm = 'AES-GCM';

      window.selectAlgorithm = function (algo) {
        selectedAlgorithm = algo;
        document.querySelectorAll('.algo-card').forEach((card) => {
          card.classList.toggle('selected', card.querySelector('.name').textContent === algo);
        });
      };

      window.togglePassword = function () {
        const input = document.getElementById('password');
        input.type = input.type === 'password' ? 'text' : 'password';
      };

      function updateCount() {
        const input = document.getElementById('inputText').value;
        const output = document.getElementById('outputText').value;
        document.getElementById('inputCount').textContent = input.length + ' å­—ç¬¦';
        document.getElementById('outputCount').textContent = output.length + ' å­—ç¬¦';
      }

      function showError(msg) {
        const errorEl = document.getElementById('errorMsg');
        errorEl.textContent = msg;
        errorEl.classList.add('show');
        setTimeout(() => errorEl.classList.remove('show'), 5000);
      }

      // Derive key from password
      async function deriveKey(password, salt, keyLength) {
        const encoder = new TextEncoder();
        const passwordKey = await crypto.subtle.importKey(
          'raw',
          encoder.encode(password),
          'PBKDF2',
          false,
          ['deriveBits', 'deriveKey']
        );

        return crypto.subtle.deriveKey(
          {
            name: 'PBKDF2',
            salt: salt,
            iterations: 100000,
            hash: 'SHA-256'
          },
          passwordKey,
          {
            name: selectedAlgorithm.split('-')[0] + '-' + selectedAlgorithm.split('-')[1],
            length: keyLength
          },
          false,
          ['encrypt', 'decrypt']
        );
      }

      window.encryptText = async function () {
        const password = document.getElementById('password').value;
        const plaintext = document.getElementById('inputText').value;
        const keyLength = parseInt(document.getElementById('keyLength').value);

        if (!password) {
          showError('è¯·è¾“å…¥å¯†ç ');
          return;
        }
        if (!plaintext) {
          showError('è¯·è¾“å…¥è¦åŠ å¯†çš„æ–‡æœ¬');
          return;
        }

        try {
          const encoder = new TextEncoder();
          const salt = crypto.getRandomValues(new Uint8Array(16));
          const iv = crypto.getRandomValues(
            new Uint8Array(selectedAlgorithm === 'AES-GCM' ? 12 : 16)
          );

          const key = await deriveKey(password, salt, keyLength);

          let encrypted;
          if (selectedAlgorithm === 'AES-GCM') {
            encrypted = await crypto.subtle.encrypt(
              { name: 'AES-GCM', iv: iv },
              key,
              encoder.encode(plaintext)
            );
          } else if (selectedAlgorithm === 'AES-CBC') {
            encrypted = await crypto.subtle.encrypt(
              { name: 'AES-CBC', iv: iv },
              key,
              encoder.encode(plaintext)
            );
          } else if (selectedAlgorithm === 'AES-CTR') {
            encrypted = await crypto.subtle.encrypt(
              { name: 'AES-CTR', counter: iv, length: 64 },
              key,
              encoder.encode(plaintext)
            );
          }

          // Combine salt + iv + encrypted data
          const combined = new Uint8Array(salt.length + iv.length + encrypted.byteLength);
          combined.set(salt, 0);
          combined.set(iv, salt.length);
          combined.set(new Uint8Array(encrypted), salt.length + iv.length);

          // Encode to base64 with algorithm prefix
          const base64 = btoa(String.fromCharCode(...combined));
          document.getElementById('outputText').value = `${selectedAlgorithm}:${base64}`;
          updateCount();
        } catch (e) {
          showError('åŠ å¯†å¤±è´¥: ' + e.message);
        }
      };

      window.decryptText = async function () {
        const password = document.getElementById('password').value;
        const ciphertext = document.getElementById('inputText').value;
        const keyLength = parseInt(document.getElementById('keyLength').value);

        if (!password) {
          showError('è¯·è¾“å…¥å¯†ç ');
          return;
        }
        if (!ciphertext) {
          showError('è¯·è¾“å…¥è¦è§£å¯†çš„å¯†æ–‡');
          return;
        }

        try {
          // Parse algorithm and data
          let algo = selectedAlgorithm;
          let base64Data = ciphertext;

          if (ciphertext.includes(':')) {
            const parts = ciphertext.split(':');
            algo = parts[0];
            base64Data = parts[1];
          }

          const combined = Uint8Array.from(atob(base64Data), (c) => c.charCodeAt(0));

          const salt = combined.slice(0, 16);
          const ivLength = algo === 'AES-GCM' ? 12 : 16;
          const iv = combined.slice(16, 16 + ivLength);
          const encrypted = combined.slice(16 + ivLength);

          const key = await deriveKey(password, salt, keyLength);

          let decrypted;
          if (algo === 'AES-GCM') {
            decrypted = await crypto.subtle.decrypt({ name: 'AES-GCM', iv: iv }, key, encrypted);
          } else if (algo === 'AES-CBC') {
            decrypted = await crypto.subtle.decrypt({ name: 'AES-CBC', iv: iv }, key, encrypted);
          } else if (algo === 'AES-CTR') {
            decrypted = await crypto.subtle.decrypt(
              { name: 'AES-CTR', counter: iv, length: 64 },
              key,
              encrypted
            );
          }

          const decoder = new TextDecoder();
          document.getElementById('outputText').value = decoder.decode(decrypted);
          updateCount();
        } catch (e) {
          showError('è§£å¯†å¤±è´¥: å¯†ç é”™è¯¯æˆ–å¯†æ–‡æŸå');
        }
      };

      window.swapText = function () {
        const input = document.getElementById('inputText');
        const output = document.getElementById('outputText');
        const temp = input.value;
        input.value = output.value;
        output.value = temp;
        updateCount();
      };

      window.clearAll = function () {
        document.getElementById('inputText').value = '';
        document.getElementById('outputText').value = '';
        document.getElementById('password').value = '';
        updateCount();
      };

      window.copyResult = function () {
        const output = document.getElementById('outputText').value;
        if (output) {
          navigator.clipboard.writeText(output);
          alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }
      };

      window.downloadResult = function () {
        const output = document.getElementById('outputText').value;
        if (!output) return;

        const blob = new Blob([output], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'encrypted.txt';
        a.click();
        URL.revokeObjectURL(url);
      };
    </script>
  </body>
</html>
