<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nginx é…ç½®ç”Ÿæˆå™¨ - WebUtils</title>
    <meta name="description" content="å¯è§†åŒ–ç”Ÿæˆ Nginx é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒåå‘ä»£ç†ã€é™æ€æ–‡ä»¶ã€SSLã€è´Ÿè½½å‡è¡¡ç­‰åœºæ™¯">
    <meta name="keywords" content="Nginx,é…ç½®,åå‘ä»£ç†,SSL,è´Ÿè½½å‡è¡¡,ç”Ÿæˆå™¨">
    <style>
        :root {
            --bg-color: #0a0a0a;
            --card-bg: #141414;
            --border-color: #262626;
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --accent-color: #009639;
            --accent-hover: #007a2f;
            --success-color: #22c55e;
            --warning-color: #eab308;
            --code-bg: #1e1e1e;
        }
        
        [data-theme="light"] {
            --bg-color: #f5f5f5;
            --card-bg: #fff;
            --border-color: #e5e5e5;
            --text-primary: #171717;
            --text-secondary: #525252;
            --code-bg: #f8f8f8;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }
        
        .subtitle { color: var(--text-secondary); }
        
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            z-index: 100;
        }
        
        .back-link {
            position: fixed;
            top: 1rem;
            left: 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            z-index: 100;
        }
        
        .back-link:hover { color: var(--accent-color); }
        
        .main-grid {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 1.5rem;
        }
        
        @media (max-width: 900px) {
            .main-grid { grid-template-columns: 1fr; }
        }
        
        .panel {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1.5rem;
        }
        
        .panel h2 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* åœºæ™¯é€‰æ‹© */
        .scenarios {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .scenario-btn {
            padding: 0.75rem;
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.85rem;
            text-align: center;
            transition: all 0.2s;
        }
        
        .scenario-btn:hover {
            border-color: var(--accent-color);
        }
        
        .scenario-btn.active {
            border-color: var(--accent-color);
            background: rgba(0, 150, 57, 0.1);
        }
        
        .scenario-btn .icon {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 0.25rem;
        }
        
        /* è¡¨å• */
        .form-section {
            margin-bottom: 1.5rem;
        }
        
        .form-section h3 {
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
            color: var(--text-secondary);
        }
        
        .form-group {
            margin-bottom: 0.75rem;
        }
        
        .form-group label {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
            color: var(--text-secondary);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.5rem;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            color: var(--text-primary);
            font-size: 0.9rem;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: var(--accent-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--accent-hover);
        }
        
        .btn-secondary {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        
        /* è¾“å‡º */
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .output-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        #output {
            width: 100%;
            min-height: 600px;
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: Monaco, Menlo, monospace;
            font-size: 0.85rem;
            color: var(--text-primary);
            resize: vertical;
            line-height: 1.5;
        }
        
        /* ä¸Šæ¸¸æœåŠ¡å™¨åˆ—è¡¨ */
        .upstream-list {
            margin-top: 0.5rem;
        }
        
        .upstream-item {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .upstream-item input {
            flex: 1;
        }
        
        .upstream-item button {
            padding: 0.25rem 0.5rem;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
        }
        
        .add-btn {
            font-size: 0.85rem;
            color: var(--accent-color);
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.25rem 0;
        }
        
        .add-btn:hover {
            text-decoration: underline;
        }
        
        .tip {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#dev">å¼€å‘å·¥å…·</a><span>â€º</span>Nginx é…ç½®ç”Ÿæˆå™¨ | åœ¨çº¿å·¥å…·</nav>
    <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
    
    <div class="container">
        <header>
            <h1>Nginx é…ç½®ç”Ÿæˆå™¨</h1>
            <p class="subtitle">å¯è§†åŒ–ç”Ÿæˆå¸¸è§ Nginx é…ç½®åœºæ™¯</p>
        </header>
        
        <div class="main-grid">
            <div class="panel">
                <h2>é€‰æ‹©åœºæ™¯</h2>
                <div class="scenarios">
                    <button class="scenario-btn active" onclick="selectScenario('static')" data-scenario="static">
                        <span class="icon">ğŸ“</span>
                        é™æ€æ–‡ä»¶
                    </button>
                    <button class="scenario-btn" onclick="selectScenario('proxy')" data-scenario="proxy">
                        <span class="icon">ğŸ”„</span>
                        åå‘ä»£ç†
                    </button>
                    <button class="scenario-btn" onclick="selectScenario('spa')" data-scenario="spa">
                        <span class="icon">âš›ï¸</span>
                        SPA åº”ç”¨
                    </button>
                    <button class="scenario-btn" onclick="selectScenario('loadbalance')" data-scenario="loadbalance">
                        <span class="icon">âš–ï¸</span>
                        è´Ÿè½½å‡è¡¡
                    </button>
                    <button class="scenario-btn" onclick="selectScenario('php')" data-scenario="php">
                        <span class="icon">ğŸ˜</span>
                        PHP-FPM
                    </button>
                    <button class="scenario-btn" onclick="selectScenario('websocket')" data-scenario="websocket">
                        <span class="icon">ğŸ”Œ</span>
                        WebSocket
                    </button>
                </div>
                
                <div class="form-section">
                    <h3>åŸºæœ¬é…ç½®</h3>
                    <div class="form-group">
                        <label>åŸŸå</label>
                        <input type="text" id="serverName" value="example.com" onchange="generate()">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>HTTP ç«¯å£</label>
                            <input type="number" id="httpPort" value="80" onchange="generate()">
                        </div>
                        <div class="form-group">
                            <label>HTTPS ç«¯å£</label>
                            <input type="number" id="httpsPort" value="443" onchange="generate()">
                        </div>
                    </div>
                </div>
                
                <!-- é™æ€æ–‡ä»¶é…ç½® -->
                <div class="form-section" id="staticConfig">
                    <h3>é™æ€æ–‡ä»¶é…ç½®</h3>
                    <div class="form-group">
                        <label>ç½‘ç«™æ ¹ç›®å½•</label>
                        <input type="text" id="rootPath" value="/var/www/html" onchange="generate()">
                    </div>
                    <div class="form-group">
                        <label>é»˜è®¤é¦–é¡µ</label>
                        <input type="text" id="indexFiles" value="index.html index.htm" onchange="generate()">
                    </div>
                </div>
                
                <!-- åå‘ä»£ç†é…ç½® -->
                <div class="form-section" id="proxyConfig" style="display:none;">
                    <h3>ä»£ç†é…ç½®</h3>
                    <div class="form-group">
                        <label>åç«¯åœ°å€</label>
                        <input type="text" id="proxyPass" value="http://127.0.0.1:3000" onchange="generate()">
                        <p class="tip">ä¾‹å¦‚: http://127.0.0.1:3000 æˆ– http://backend:8080</p>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="proxyWebsocket" onchange="generate()">
                        <label for="proxyWebsocket">æ”¯æŒ WebSocket</label>
                    </div>
                </div>
                
                <!-- è´Ÿè½½å‡è¡¡é…ç½® -->
                <div class="form-section" id="loadbalanceConfig" style="display:none;">
                    <h3>ä¸Šæ¸¸æœåŠ¡å™¨</h3>
                    <div class="form-group">
                        <label>è´Ÿè½½å‡è¡¡ç­–ç•¥</label>
                        <select id="lbMethod" onchange="generate()">
                            <option value="">è½®è¯¢ (é»˜è®¤)</option>
                            <option value="least_conn">æœ€å°‘è¿æ¥</option>
                            <option value="ip_hash">IP Hash</option>
                            <option value="random">éšæœº</option>
                        </select>
                    </div>
                    <div class="upstream-list" id="upstreamList">
                        <div class="upstream-item">
                            <input type="text" value="127.0.0.1:3001" onchange="generate()">
                            <button onclick="removeUpstream(this)">Ã—</button>
                        </div>
                        <div class="upstream-item">
                            <input type="text" value="127.0.0.1:3002" onchange="generate()">
                            <button onclick="removeUpstream(this)">Ã—</button>
                        </div>
                    </div>
                    <button class="add-btn" onclick="addUpstream()">+ æ·»åŠ æœåŠ¡å™¨</button>
                </div>
                
                <!-- PHP-FPM é…ç½® -->
                <div class="form-section" id="phpConfig" style="display:none;">
                    <h3>PHP-FPM é…ç½®</h3>
                    <div class="form-group">
                        <label>PHP-FPM åœ°å€</label>
                        <input type="text" id="phpFpm" value="unix:/var/run/php/php8.2-fpm.sock" onchange="generate()">
                        <p class="tip">Socket: unix:/path/to/php-fpm.sock æˆ– TCP: 127.0.0.1:9000</p>
                    </div>
                    <div class="form-group">
                        <label>ç½‘ç«™æ ¹ç›®å½•</label>
                        <input type="text" id="phpRoot" value="/var/www/html" onchange="generate()">
                    </div>
                </div>
                
                <!-- SSL é…ç½® -->
                <div class="form-section">
                    <h3>SSL/HTTPS</h3>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="enableSsl" onchange="toggleSsl(); generate()">
                        <label for="enableSsl">å¯ç”¨ HTTPS</label>
                    </div>
                    <div id="sslConfig" style="display:none;">
                        <div class="form-group">
                            <label>è¯ä¹¦æ–‡ä»¶è·¯å¾„</label>
                            <input type="text" id="sslCert" value="/etc/nginx/ssl/cert.pem" onchange="generate()">
                        </div>
                        <div class="form-group">
                            <label>ç§é’¥æ–‡ä»¶è·¯å¾„</label>
                            <input type="text" id="sslKey" value="/etc/nginx/ssl/key.pem" onchange="generate()">
                        </div>
                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="httpRedirect" checked onchange="generate()">
                            <label for="httpRedirect">HTTP é‡å®šå‘åˆ° HTTPS</label>
                        </div>
                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="hsts" onchange="generate()">
                            <label for="hsts">å¯ç”¨ HSTS</label>
                        </div>
                    </div>
                </div>
                
                <!-- é«˜çº§é€‰é¡¹ -->
                <div class="form-section">
                    <h3>é«˜çº§é€‰é¡¹</h3>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="gzip" checked onchange="generate()">
                        <label for="gzip">å¯ç”¨ Gzip å‹ç¼©</label>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="accessLog" checked onchange="generate()">
                        <label for="accessLog">è®¿é—®æ—¥å¿—</label>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="cacheStatic" onchange="generate()">
                        <label for="cacheStatic">é™æ€èµ„æºç¼“å­˜</label>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="output-header">
                    <h2>nginx.conf</h2>
                    <div class="output-actions">
                        <button class="btn btn-secondary" onclick="copyOutput()">ğŸ“‹ å¤åˆ¶</button>
                        <button class="btn btn-primary" onclick="downloadOutput()">ğŸ’¾ ä¸‹è½½</button>
                    </div>
                </div>
                <textarea id="output" readonly></textarea>
            </div>
        </div>
    </div>
    
    <script>
        let currentScenario = 'static';
        
        window.selectScenario = function(scenario) {
            currentScenario = scenario;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.scenario-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.scenario === scenario);
            });
            
            // æ˜¾ç¤º/éšè—é…ç½®åŒºåŸŸ
            document.getElementById('staticConfig').style.display = 
                ['static', 'spa'].includes(scenario) ? 'block' : 'none';
            document.getElementById('proxyConfig').style.display = 
                ['proxy', 'websocket'].includes(scenario) ? 'block' : 'none';
            document.getElementById('loadbalanceConfig').style.display = 
                scenario === 'loadbalance' ? 'block' : 'none';
            document.getElementById('phpConfig').style.display = 
                scenario === 'php' ? 'block' : 'none';
            
            // WebSocket è‡ªåŠ¨å‹¾é€‰
            if (scenario === 'websocket') {
                document.getElementById('proxyWebsocket').checked = true;
            }
            
            generate();
        };
        
        window.toggleSsl = function() {
            const enabled = document.getElementById('enableSsl').checked;
            document.getElementById('sslConfig').style.display = enabled ? 'block' : 'none';
        };
        
        window.addUpstream = function() {
            const list = document.getElementById('upstreamList');
            const item = document.createElement('div');
            item.className = 'upstream-item';
            item.innerHTML = `
                <input type="text" value="127.0.0.1:300${list.children.length + 1}" onchange="generate()">
                <button onclick="removeUpstream(this)">Ã—</button>
            `;
            list.appendChild(item);
            generate();
        };
        
        window.removeUpstream = function(btn) {
            btn.parentElement.remove();
            generate();
        };
        
        function getUpstreams() {
            const inputs = document.querySelectorAll('#upstreamList input');
            return Array.from(inputs).map(i => i.value.trim()).filter(v => v);
        }
        
        window.generate = function() {
            const serverName = document.getElementById('serverName').value || 'example.com';
            const httpPort = document.getElementById('httpPort').value || '80';
            const httpsPort = document.getElementById('httpsPort').value || '443';
            const enableSsl = document.getElementById('enableSsl').checked;
            const httpRedirect = document.getElementById('httpRedirect').checked;
            const hsts = document.getElementById('hsts').checked;
            const gzip = document.getElementById('gzip').checked;
            const accessLog = document.getElementById('accessLog').checked;
            const cacheStatic = document.getElementById('cacheStatic').checked;
            
            let config = '';
            
            // è´Ÿè½½å‡è¡¡ upstream
            if (currentScenario === 'loadbalance') {
                const upstreams = getUpstreams();
                const lbMethod = document.getElementById('lbMethod').value;
                config += 'upstream backend {\n';
                if (lbMethod) config += `    ${lbMethod};\n`;
                upstreams.forEach(u => config += `    server ${u};\n`);
                config += '}\n\n';
            }
            
            // HTTP é‡å®šå‘åˆ° HTTPS
            if (enableSsl && httpRedirect) {
                config += 'server {\n';
                config += `    listen ${httpPort};\n`;
                config += `    listen [::]:${httpPort};\n`;
                config += `    server_name ${serverName};\n\n`;
                config += '    return 301 https://$server_name$request_uri;\n';
                config += '}\n\n';
            }
            
            // ä¸» server å—
            config += 'server {\n';
            
            if (enableSsl) {
                config += `    listen ${httpsPort} ssl http2;\n`;
                config += `    listen [::]:${httpsPort} ssl http2;\n`;
            } else {
                config += `    listen ${httpPort};\n`;
                config += `    listen [::]:${httpPort};\n`;
            }
            
            config += `    server_name ${serverName};\n\n`;
            
            // SSL é…ç½®
            if (enableSsl) {
                const sslCert = document.getElementById('sslCert').value;
                const sslKey = document.getElementById('sslKey').value;
                config += '    # SSL é…ç½®\n';
                config += `    ssl_certificate ${sslCert};\n`;
                config += `    ssl_certificate_key ${sslKey};\n`;
                config += '    ssl_protocols TLSv1.2 TLSv1.3;\n';
                config += '    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\n';
                config += '    ssl_prefer_server_ciphers off;\n';
                if (hsts) {
                    config += '    add_header Strict-Transport-Security "max-age=63072000" always;\n';
                }
                config += '\n';
            }
            
            // æ ¹æ®åœºæ™¯ç”Ÿæˆé…ç½®
            switch (currentScenario) {
                case 'static':
                    config += generateStatic();
                    break;
                case 'spa':
                    config += generateSpa();
                    break;
                case 'proxy':
                case 'websocket':
                    config += generateProxy();
                    break;
                case 'loadbalance':
                    config += generateLoadbalance();
                    break;
                case 'php':
                    config += generatePhp();
                    break;
            }
            
            // Gzip
            if (gzip) {
                config += '\n    # Gzip å‹ç¼©\n';
                config += '    gzip on;\n';
                config += '    gzip_vary on;\n';
                config += '    gzip_min_length 1024;\n';
                config += '    gzip_types text/plain text/css text/xml text/javascript application/javascript application/json application/xml;\n';
            }
            
            // é™æ€èµ„æºç¼“å­˜
            if (cacheStatic) {
                config += '\n    # é™æ€èµ„æºç¼“å­˜\n';
                config += '    location ~* \\.(jpg|jpeg|png|gif|ico|css|js|woff2?)$ {\n';
                config += '        expires 30d;\n';
                config += '        add_header Cache-Control "public, immutable";\n';
                config += '    }\n';
            }
            
            // æ—¥å¿—
            if (accessLog) {
                config += '\n    # æ—¥å¿—\n';
                config += `    access_log /var/log/nginx/${serverName.replace(/\./g, '_')}_access.log;\n`;
                config += `    error_log /var/log/nginx/${serverName.replace(/\./g, '_')}_error.log;\n`;
            }
            
            config += '}\n';
            
            document.getElementById('output').value = config;
        };
        
        function generateStatic() {
            const root = document.getElementById('rootPath').value;
            const index = document.getElementById('indexFiles').value;
            
            let config = '    # é™æ€æ–‡ä»¶æœåŠ¡\n';
            config += `    root ${root};\n`;
            config += `    index ${index};\n\n`;
            config += '    location / {\n';
            config += '        try_files $uri $uri/ =404;\n';
            config += '    }\n';
            
            return config;
        }
        
        function generateSpa() {
            const root = document.getElementById('rootPath').value;
            const index = document.getElementById('indexFiles').value;
            
            let config = '    # SPA å•é¡µåº”ç”¨\n';
            config += `    root ${root};\n`;
            config += `    index ${index};\n\n`;
            config += '    location / {\n';
            config += '        try_files $uri $uri/ /index.html;\n';
            config += '    }\n';
            
            return config;
        }
        
        function generateProxy() {
            const proxyPass = document.getElementById('proxyPass').value;
            const websocket = document.getElementById('proxyWebsocket').checked;
            
            let config = '    # åå‘ä»£ç†\n';
            config += '    location / {\n';
            config += `        proxy_pass ${proxyPass};\n`;
            config += '        proxy_http_version 1.1;\n';
            config += '        proxy_set_header Host $host;\n';
            config += '        proxy_set_header X-Real-IP $remote_addr;\n';
            config += '        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n';
            config += '        proxy_set_header X-Forwarded-Proto $scheme;\n';
            
            if (websocket) {
                config += '\n        # WebSocket æ”¯æŒ\n';
                config += '        proxy_set_header Upgrade $http_upgrade;\n';
                config += '        proxy_set_header Connection "upgrade";\n';
                config += '        proxy_read_timeout 86400;\n';
            }
            
            config += '    }\n';
            
            return config;
        }
        
        function generateLoadbalance() {
            let config = '    # è´Ÿè½½å‡è¡¡\n';
            config += '    location / {\n';
            config += '        proxy_pass http://backend;\n';
            config += '        proxy_http_version 1.1;\n';
            config += '        proxy_set_header Host $host;\n';
            config += '        proxy_set_header X-Real-IP $remote_addr;\n';
            config += '        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n';
            config += '        proxy_set_header X-Forwarded-Proto $scheme;\n';
            config += '    }\n';
            
            return config;
        }
        
        function generatePhp() {
            const phpFpm = document.getElementById('phpFpm').value;
            const root = document.getElementById('phpRoot').value;
            
            let config = '    # PHP-FPM é…ç½®\n';
            config += `    root ${root};\n`;
            config += '    index index.php index.html;\n\n';
            config += '    location / {\n';
            config += '        try_files $uri $uri/ /index.php?$query_string;\n';
            config += '    }\n\n';
            config += '    location ~ \\.php$ {\n';
            config += `        fastcgi_pass ${phpFpm};\n`;
            config += '        fastcgi_index index.php;\n';
            config += '        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n';
            config += '        include fastcgi_params;\n';
            config += '    }\n\n';
            config += '    # ç¦æ­¢è®¿é—®éšè—æ–‡ä»¶\n';
            config += '    location ~ /\\. {\n';
            config += '        deny all;\n';
            config += '    }\n';
            
            return config;
        }
        
        window.copyOutput = function() {
            const output = document.getElementById('output');
            navigator.clipboard.writeText(output.value).then(() => {
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        };
        
        window.downloadOutput = function() {
            const output = document.getElementById('output').value;
            const serverName = document.getElementById('serverName').value || 'example.com';
            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${serverName.replace(/\./g, '_')}.conf`;
            a.click();
            URL.revokeObjectURL(url);
        };
        
        window.toggleTheme = function() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const next = current === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
        };
        
        // åˆå§‹åŒ–
        (function() {
            const saved = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', saved);
            generate();
        })();
    </script>
</body>
</html>
