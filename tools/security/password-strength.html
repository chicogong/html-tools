<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯†ç å¼ºåº¦æ£€æµ‹å™¨ - åœ¨çº¿å·¥å…·</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”’</text></svg>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root { --primary-color: #3b82f6; --weak-color: #ef4444; --fair-color: #f59e0b; --good-color: #10b981; --strong-color: #059669; }
        [data-theme="dark"] { --primary-color: #60a5fa; }
        body { padding: 1rem; min-height: 100vh; }
        .container { max-width: 700px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem; }
        header h1 { margin: 0; font-size: 1.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .header-actions { display: flex; gap: 0.5rem; align-items: center; }
        .theme-toggle { cursor: pointer; background: var(--primary-color); border: none; padding: 0.5rem 1rem; border-radius: 8px; color: white; font-size: 1rem; }
        .back-link { color: var(--primary-color); text-decoration: none; padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--primary-color); font-size: 0.9rem; }
        .input-section { margin-bottom: 1.5rem; }
        .input-section label { font-weight: 600; margin-bottom: 0.5rem; display: block; }
        .password-wrapper { position: relative; }
        .password-wrapper input { padding-right: 100px; font-family: 'SF Mono', Monaco, monospace; font-size: 1.1rem; }
        .password-wrapper .toggle-btn { position: absolute; right: 50px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 1.2rem; padding: 0.5rem; }
        .password-wrapper .generate-btn { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: var(--primary-color); color: white; border: none; padding: 0.4rem 0.6rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem; }
        .strength-meter { margin: 1.5rem 0; }
        .strength-bar { height: 8px; background: var(--code-background-color); border-radius: 4px; overflow: hidden; }
        .strength-fill { height: 100%; width: 0; border-radius: 4px; transition: all 0.3s; }
        .strength-fill.weak { background: var(--weak-color); width: 25%; }
        .strength-fill.fair { background: var(--fair-color); width: 50%; }
        .strength-fill.good { background: var(--good-color); width: 75%; }
        .strength-fill.strong { background: var(--strong-color); width: 100%; }
        .strength-label { display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; }
        .strength-text { font-weight: 600; font-size: 1.1rem; }
        .strength-text.weak { color: var(--weak-color); }
        .strength-text.fair { color: var(--fair-color); }
        .strength-text.good { color: var(--good-color); }
        .strength-text.strong { color: var(--strong-color); }
        .strength-score { font-size: 0.9rem; color: var(--muted-color); }
        .criteria-section { background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; }
        .criteria-section h3 { margin: 0 0 1rem; font-size: 1rem; }
        .criteria-list { list-style: none; padding: 0; margin: 0; }
        .criteria-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0; border-bottom: 1px solid var(--muted-border-color); }
        .criteria-item:last-child { border-bottom: none; }
        .criteria-icon { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }
        .criteria-icon.pass { background: var(--good-color); color: white; }
        .criteria-icon.fail { background: var(--muted-border-color); color: var(--muted-color); }
        .criteria-text { flex: 1; font-size: 0.9rem; }
        .criteria-text.pass { color: var(--color); }
        .criteria-text.fail { color: var(--muted-color); }
        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: var(--card-background-color); border-radius: 12px; padding: 1rem; text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); }
        .stat-label { font-size: 0.8rem; color: var(--muted-color); }
        .suggestions { background: var(--code-background-color); border-radius: 12px; padding: 1.5rem; }
        .suggestions h3 { margin: 0 0 1rem; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        .suggestions ul { margin: 0; padding-left: 1.5rem; }
        .suggestions li { margin: 0.5rem 0; font-size: 0.9rem; }
        .generator-section { margin-top: 1.5rem; background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; }
        .generator-section h3 { margin: 0 0 1rem; font-size: 1rem; }
        .generator-options { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem; }
        .generator-options label { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; cursor: pointer; }
        .generator-options input[type="checkbox"] { margin: 0; }
        .generator-options input[type="number"] { width: 70px; }
        .generated-password { display: flex; gap: 0.5rem; }
        .generated-password input { flex: 1; font-family: 'SF Mono', Monaco, monospace; }
        .toast { position: fixed; bottom: 20px; right: 20px; padding: 1rem 1.5rem; background: #10b981; color: white; border-radius: 8px; font-weight: 500; z-index: 1000; transform: translateY(100px); opacity: 0; transition: all 0.3s; }
        .toast.show { transform: translateY(0); opacity: 1; }
        .warning-box { background: #f59e0b20; border: 1px solid #f59e0b; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem; font-size: 0.85rem; }
        .warning-box strong { color: #f59e0b; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”’ å¯†ç å¼ºåº¦æ£€æµ‹å™¨</h1>
            <div class="header-actions">
                <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
                <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </header>

        <div class="warning-box">
            <strong>âš ï¸ éšç§æç¤ºï¼š</strong>æ‰€æœ‰å¯†ç æ£€æµ‹å‡åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­å®Œæˆï¼Œä¸ä¼šå‘é€åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚
        </div>

        <div class="input-section">
            <label for="passwordInput">è¾“å…¥å¯†ç </label>
            <div class="password-wrapper">
                <input type="password" id="passwordInput" placeholder="è¾“å…¥è¦æ£€æµ‹çš„å¯†ç ..." oninput="checkPassword()" autofocus>
                <button class="toggle-btn" onclick="toggleVisibility()">ğŸ‘ï¸</button>
                <button class="generate-btn" onclick="useGeneratedPassword()">ä½¿ç”¨ç”Ÿæˆ</button>
            </div>
        </div>

        <div class="strength-meter">
            <div class="strength-bar">
                <div class="strength-fill" id="strengthFill"></div>
            </div>
            <div class="strength-label">
                <span class="strength-text" id="strengthText">è¾“å…¥å¯†ç å¼€å§‹æ£€æµ‹</span>
                <span class="strength-score" id="strengthScore"></span>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="lengthStat">0</div>
                <div class="stat-label">å¯†ç é•¿åº¦</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="entropyStat">0</div>
                <div class="stat-label">ç†µå€¼ (bits)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="crackTimeStat">-</div>
                <div class="stat-label">ç ´è§£æ—¶é—´</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="charsetStat">0</div>
                <div class="stat-label">å­—ç¬¦é›†å¤§å°</div>
            </div>
        </div>

        <div class="criteria-section">
            <h3>å®‰å…¨æ ‡å‡†æ£€æµ‹</h3>
            <ul class="criteria-list" id="criteriaList">
                <li class="criteria-item"><span class="criteria-icon fail">âœ—</span><span class="criteria-text fail">è‡³å°‘ 8 ä¸ªå­—ç¬¦</span></li>
                <li class="criteria-item"><span class="criteria-icon fail">âœ—</span><span class="criteria-text fail">åŒ…å«å¤§å†™å­—æ¯ (A-Z)</span></li>
                <li class="criteria-item"><span class="criteria-icon fail">âœ—</span><span class="criteria-text fail">åŒ…å«å°å†™å­—æ¯ (a-z)</span></li>
                <li class="criteria-item"><span class="criteria-icon fail">âœ—</span><span class="criteria-text fail">åŒ…å«æ•°å­— (0-9)</span></li>
                <li class="criteria-item"><span class="criteria-icon fail">âœ—</span><span class="criteria-text fail">åŒ…å«ç‰¹æ®Šå­—ç¬¦ (!@#$%...)</span></li>
                <li class="criteria-item"><span class="criteria-icon fail">âœ—</span><span class="criteria-text fail">ä¸åŒ…å«å¸¸è§å¯†ç æ¨¡å¼</span></li>
            </ul>
        </div>

        <div class="suggestions" id="suggestions" style="display: none;">
            <h3>ğŸ’¡ æ”¹è¿›å»ºè®®</h3>
            <ul id="suggestionList"></ul>
        </div>

        <div class="generator-section">
            <h3>å¯†ç ç”Ÿæˆå™¨</h3>
            <div class="generator-options">
                <label><input type="checkbox" id="genUpper" checked> å¤§å†™å­—æ¯</label>
                <label><input type="checkbox" id="genLower" checked> å°å†™å­—æ¯</label>
                <label><input type="checkbox" id="genNumbers" checked> æ•°å­—</label>
                <label><input type="checkbox" id="genSymbols" checked> ç‰¹æ®Šå­—ç¬¦</label>
                <label>é•¿åº¦: <input type="number" id="genLength" value="16" min="8" max="64"></label>
            </div>
            <div class="generated-password">
                <input type="text" id="generatedPassword" readonly placeholder="ç‚¹å‡»ç”ŸæˆæŒ‰é’®">
                <button onclick="generatePassword()">ç”Ÿæˆ</button>
                <button onclick="copyGenerated()" class="secondary">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        const commonPatterns = [
            /^123456/, /^password/i, /^qwerty/i, /^abc123/i, /^admin/i,
            /^letmein/i, /^welcome/i, /^monkey/i, /^master/i, /^dragon/i,
            /^111111/, /^666666/, /^888888/, /^000000/,
            /(.)\1{3,}/, // Repeated characters
            /^[a-z]+$/i, // Only letters
            /^[0-9]+$/, // Only numbers
            /^(19|20)\d{2}/, // Years
        ];

        window.toggleTheme = function() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        };

        (function() {
            const savedTheme = localStorage.getItem('theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();

        window.toggleVisibility = function() {
            const input = document.getElementById('passwordInput');
            input.type = input.type === 'password' ? 'text' : 'password';
        };

        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            
            if (!password) {
                resetDisplay();
                return;
            }

            // Check criteria
            const criteria = [
                { test: password.length >= 8, text: 'è‡³å°‘ 8 ä¸ªå­—ç¬¦' },
                { test: /[A-Z]/.test(password), text: 'åŒ…å«å¤§å†™å­—æ¯ (A-Z)' },
                { test: /[a-z]/.test(password), text: 'åŒ…å«å°å†™å­—æ¯ (a-z)' },
                { test: /[0-9]/.test(password), text: 'åŒ…å«æ•°å­— (0-9)' },
                { test: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password), text: 'åŒ…å«ç‰¹æ®Šå­—ç¬¦ (!@#$%...)' },
                { test: !commonPatterns.some(p => p.test(password)), text: 'ä¸åŒ…å«å¸¸è§å¯†ç æ¨¡å¼' }
            ];

            // Update criteria display
            const criteriaList = document.getElementById('criteriaList');
            criteriaList.innerHTML = criteria.map(c => `
                <li class="criteria-item">
                    <span class="criteria-icon ${c.test ? 'pass' : 'fail'}">${c.test ? 'âœ“' : 'âœ—'}</span>
                    <span class="criteria-text ${c.test ? 'pass' : 'fail'}">${c.text}</span>
                </li>
            `).join('');

            // Calculate score
            let score = 0;
            score += Math.min(password.length * 4, 40); // Length (max 40)
            score += criteria[0].test ? 10 : 0;
            score += criteria[1].test ? 10 : 0;
            score += criteria[2].test ? 10 : 0;
            score += criteria[3].test ? 10 : 0;
            score += criteria[4].test ? 15 : 0;
            score += criteria[5].test ? 15 : 0;

            // Calculate charset size
            let charsetSize = 0;
            if (/[a-z]/.test(password)) charsetSize += 26;
            if (/[A-Z]/.test(password)) charsetSize += 26;
            if (/[0-9]/.test(password)) charsetSize += 10;
            if (/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)) charsetSize += 32;

            // Calculate entropy
            const entropy = Math.round(password.length * Math.log2(charsetSize || 1));

            // Crack time estimation (assuming 10 billion guesses/sec)
            const combinations = Math.pow(charsetSize || 1, password.length);
            const crackSeconds = combinations / 10000000000;
            const crackTime = formatCrackTime(crackSeconds);

            // Determine strength
            let strength, strengthClass;
            if (score < 40) { strength = 'å¼±'; strengthClass = 'weak'; }
            else if (score < 60) { strength = 'ä¸€èˆ¬'; strengthClass = 'fair'; }
            else if (score < 80) { strength = 'è‰¯å¥½'; strengthClass = 'good'; }
            else { strength = 'å¼º'; strengthClass = 'strong'; }

            // Update display
            document.getElementById('strengthFill').className = `strength-fill ${strengthClass}`;
            document.getElementById('strengthText').textContent = strength;
            document.getElementById('strengthText').className = `strength-text ${strengthClass}`;
            document.getElementById('strengthScore').textContent = `${score}/100`;

            document.getElementById('lengthStat').textContent = password.length;
            document.getElementById('entropyStat').textContent = entropy;
            document.getElementById('crackTimeStat').textContent = crackTime;
            document.getElementById('charsetStat').textContent = charsetSize;

            // Generate suggestions
            const suggestions = [];
            if (password.length < 12) suggestions.push('å¢åŠ å¯†ç é•¿åº¦è‡³å°‘åˆ° 12 ä¸ªå­—ç¬¦');
            if (!criteria[1].test) suggestions.push('æ·»åŠ å¤§å†™å­—æ¯');
            if (!criteria[2].test) suggestions.push('æ·»åŠ å°å†™å­—æ¯');
            if (!criteria[3].test) suggestions.push('æ·»åŠ æ•°å­—');
            if (!criteria[4].test) suggestions.push('æ·»åŠ ç‰¹æ®Šå­—ç¬¦å¦‚ !@#$%^&*');
            if (!criteria[5].test) suggestions.push('é¿å…ä½¿ç”¨å¸¸è§å¯†ç æ¨¡å¼å’Œé‡å¤å­—ç¬¦');
            if (password.length > 0 && password.length < 16) suggestions.push('è€ƒè™‘ä½¿ç”¨å¯†ç ç®¡ç†å™¨ç”Ÿæˆæ›´é•¿çš„éšæœºå¯†ç ');

            const suggestionsEl = document.getElementById('suggestions');
            if (suggestions.length > 0 && score < 100) {
                document.getElementById('suggestionList').innerHTML = suggestions.map(s => `<li>${s}</li>`).join('');
                suggestionsEl.style.display = 'block';
            } else {
                suggestionsEl.style.display = 'none';
            }
        }

        function formatCrackTime(seconds) {
            if (seconds < 1) return 'ç¬é—´';
            if (seconds < 60) return `${Math.round(seconds)} ç§’`;
            if (seconds < 3600) return `${Math.round(seconds / 60)} åˆ†é’Ÿ`;
            if (seconds < 86400) return `${Math.round(seconds / 3600)} å°æ—¶`;
            if (seconds < 31536000) return `${Math.round(seconds / 86400)} å¤©`;
            if (seconds < 31536000 * 100) return `${Math.round(seconds / 31536000)} å¹´`;
            if (seconds < 31536000 * 1000000) return `${Math.round(seconds / 31536000 / 1000)} åƒå¹´`;
            return 'æ•°ç™¾ä¸‡å¹´+';
        }

        function resetDisplay() {
            document.getElementById('strengthFill').className = 'strength-fill';
            document.getElementById('strengthText').textContent = 'è¾“å…¥å¯†ç å¼€å§‹æ£€æµ‹';
            document.getElementById('strengthText').className = 'strength-text';
            document.getElementById('strengthScore').textContent = '';
            document.getElementById('lengthStat').textContent = '0';
            document.getElementById('entropyStat').textContent = '0';
            document.getElementById('crackTimeStat').textContent = '-';
            document.getElementById('charsetStat').textContent = '0';
            document.getElementById('suggestions').style.display = 'none';
        }

        function generatePassword() {
            const length = parseInt(document.getElementById('genLength').value) || 16;
            const useUpper = document.getElementById('genUpper').checked;
            const useLower = document.getElementById('genLower').checked;
            const useNumbers = document.getElementById('genNumbers').checked;
            const useSymbols = document.getElementById('genSymbols').checked;

            let charset = '';
            if (useUpper) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (useLower) charset += 'abcdefghijklmnopqrstuvwxyz';
            if (useNumbers) charset += '0123456789';
            if (useSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';

            if (!charset) {
                showToast('è¯·è‡³å°‘é€‰æ‹©ä¸€ç§å­—ç¬¦ç±»å‹', 'error');
                return;
            }

            let password = '';
            const array = new Uint32Array(length);
            crypto.getRandomValues(array);
            for (let i = 0; i < length; i++) {
                password += charset[array[i] % charset.length];
            }

            document.getElementById('generatedPassword').value = password;
        }

        window.copyGenerated = function() {
            const password = document.getElementById('generatedPassword').value;
            if (password) {
                navigator.clipboard.writeText(password);
                showToast('å¯†ç å·²å¤åˆ¶');
            }
        };

        window.useGeneratedPassword = function() {
            const generated = document.getElementById('generatedPassword').value;
            if (generated) {
                document.getElementById('passwordInput').value = generated;
                document.getElementById('passwordInput').type = 'text';
                checkPassword();
            } else {
                generatePassword();
                useGeneratedPassword();
            }
        };

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'error' ? '#ef4444' : '#10b981';
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Generate initial password
        generatePassword();
    </script>
</body>
</html>
