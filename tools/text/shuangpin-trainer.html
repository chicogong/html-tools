<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒæ‹¼ç»ƒä¹ å™¨ - WebUtils</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="åŒæ‹¼ç»ƒä¹ å™¨ - WebUtils" />
  <meta name="keywords" content="shuangpin-trainer,text,tools,webutils" />
  <meta name="author" content="WebUtils" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tools.realtime-ai.chat/tools/text/shuangpin-trainer.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="åŒæ‹¼ç»ƒä¹ å™¨ - WebUtils" />
  <meta property="og:description" content="åŒæ‹¼ç»ƒä¹ å™¨ - WebUtils" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tools.realtime-ai.chat/tools/text/shuangpin-trainer.html" />
  <meta property="og:site_name" content="WebUtils" />
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="640" />
  <meta property="og:image:type" content="image/png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="åŒæ‹¼ç»ƒä¹ å™¨ - WebUtils" />
  <meta name="twitter:description" content="åŒæ‹¼ç»ƒä¹ å™¨ - WebUtils" />
  <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-input: #0e0e14;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --border-strong: #3a3a4a;
      --accent-cyan: #00f5d4;
      --accent-green: #10b981;
      --accent-red: #f43f5e;
      --accent-yellow: #fbbf24;
      --accent-purple: #a855f7;
      --glow-cyan: rgb(0, 245, 212, 0.15);
      --glow-green: rgb(16, 185, 129, 0.15);
      --glow-red: rgb(244, 63, 94, 0.15);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    [data-theme="light"] {
      --bg-deep: #fafafa;
      --bg-surface: #fff;
      --bg-card: #fff;
      --bg-input: #f5f5f5;
      --bg-hover: #f5f5f5;
      --text-primary: #1a1a1a;
      --text-secondary: #666;
      --text-muted: #999;
      --border-subtle: #e5e5e5;
      --border-strong: #d5d5d5;
    }

        body {
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        header h1 {
            margin: 0;
        }
        .theme-toggle {
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.5rem;
            padding: 0.5rem;
        }
        .controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 2rem;
        }
        .controls select {
            width: auto;
            min-width: 150px;
        }
        .practice-area {
            text-align: center;
            padding: 2rem;
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            margin-bottom: 2rem;
        }
        .chinese-char {
            font-size: 4rem;
            margin-bottom: 1rem;
            font-weight: bold;
        }
        .pinyin-hint {
            font-size: 1.5rem;
            color: var(--pico-muted-color);
            margin-bottom: 1rem;
        }
        .input-row {
            display: flex;
            justify-content: center;
            gap: 1rem;
            align-items: center;
            margin-bottom: 1rem;
        }
        .input-row input {
            width: 200px;
            font-size: 1.5rem;
            text-align: center;
            text-transform: lowercase;
        }
        .feedback {
            font-size: 1.2rem;
            min-height: 2rem;
            margin-top: 1rem;
        }
        .feedback.correct {
            color: #22c55e;
        }
        .feedback.wrong {
            color: #ef4444;
        }
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--pico-primary);
        }
        .stat-label {
            font-size: 0.9rem;
            color: var(--pico-muted-color);
        }
        .keyboard-section {
            margin-top: 2rem;
        }
        .keyboard {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        .keyboard-row {
            display: flex;
            gap: 0.25rem;
        }
        .key {
            width: 50px;
            height: 50px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--pico-secondary-background);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.1s;
        }
        .key:hover {
            background: var(--pico-primary-background);
        }
        .key .letter {
            font-weight: bold;
            font-size: 1rem;
        }
        .key .sheng {
            color: var(--pico-primary);
            font-size: 0.65rem;
        }
        .key .yun {
            color: #22c55e;
            font-size: 0.65rem;
        }
        .key.highlight {
            background: var(--pico-primary);
            color: var(--pico-primary-inverse);
        }
        .key.highlight .sheng,
        .key.highlight .yun {
            color: var(--pico-primary-inverse);
        }
        .scheme-table {
            margin-top: 2rem;
        }
        .scheme-table table {
            font-size: 0.85rem;
        }
        .scheme-table th {
            background: var(--pico-secondary-background);
        }
        .btn-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 1rem;
        }
        .history-list {
            max-height: 200px;
            overflow-y: auto;
        }
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            border-bottom: 1px solid var(--pico-muted-border-color);
        }
        .history-item.correct {
            background: rgba(34, 197, 94, 0.1);
        }
        .history-item.wrong {
            background: rgba(239, 68, 68, 0.1);
        }
        @media (max-width: 600px) {
            .key {
                width: 32px;
                height: 45px;
                font-size: 0.6rem;
            }
            .key .letter {
                font-size: 0.8rem;
            }
            .key .sheng, .key .yun {
                font-size: 0.5rem;
            }
        }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#text">æ–‡æœ¬å·¥å…·</a><span>â€º</span>åŒæ‹¼ç»ƒä¹ å™¨</nav>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>âŒ¨ï¸ åŒæ‹¼ç»ƒä¹ å™¨</h1>
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
        </header>

        <section class="controls">
            <label>
                åŒæ‹¼æ–¹æ¡ˆï¼š
                <select id="schemeSelect" onchange="changeScheme()">
                    <option value="xiaohe">å°é¹¤åŒæ‹¼</option>
                    <option value="ziranma">è‡ªç„¶ç </option>
                    <option value="sogou">æœç‹—åŒæ‹¼</option>
                    <option value="microsoft">å¾®è½¯åŒæ‹¼</option>
                </select>
            </label>
            <label>
                <input type="checkbox" id="showHint" checked onchange="updateDisplay()">
                æ˜¾ç¤ºæ‹¼éŸ³æç¤º
            </label>
            <label>
                <input type="checkbox" id="showKeyboard" checked onchange="toggleKeyboard()">
                æ˜¾ç¤ºé”®ä½å›¾
            </label>
        </section>

        <section class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">ç»ƒä¹ æ¬¡æ•°</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="correctCount">0</div>
                <div class="stat-label">æ­£ç¡®æ¬¡æ•°</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">æ­£ç¡®ç‡</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streak">0</div>
                <div class="stat-label">è¿ç»­æ­£ç¡®</div>
            </div>
        </section>

        <section class="practice-area">
            <div class="chinese-char" id="currentChar">æ±‰</div>
            <div class="pinyin-hint" id="pinyinHint">hÃ n</div>
            <div class="input-row">
                <input type="text" id="userInput" placeholder="è¾“å…¥åŒæ‹¼" maxlength="2" autocomplete="off" autofocus>
                <button onclick="checkAnswer()">ç¡®è®¤</button>
            </div>
            <div class="feedback" id="feedback"></div>
            <div class="btn-group">
                <button class="secondary" onclick="nextChar()">ä¸‹ä¸€ä¸ª</button>
                <button class="secondary" onclick="skipChar()">è·³è¿‡</button>
                <button class="outline" onclick="resetStats()">é‡ç½®ç»Ÿè®¡</button>
            </div>
        </section>

        <section class="keyboard-section" id="keyboardSection">
            <h3>é”®ä½å›¾</h3>
            <div class="keyboard" id="keyboard">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </section>

        <section class="scheme-table">
            <details>
                <summary>æ–¹æ¡ˆå¯¹ç…§è¡¨</summary>
                <div style="overflow-x: auto;" id="schemeTableContainer">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </details>
        </section>

        <section>
            <details>
                <summary>ç»ƒä¹ å†å²</summary>
                <div class="history-list" id="historyList"></div>
                <button class="outline secondary" onclick="clearHistory()" style="margin-top: 0.5rem;">æ¸…ç©ºå†å²</button>
            </details>
        </section>
    </main>

    <script>
        // åŒæ‹¼æ–¹æ¡ˆå®šä¹‰
        const schemes = {
            xiaohe: {
                name: 'å°é¹¤åŒæ‹¼',
                shengmu: {
                    'q': 'q', 'w': 'w', 'e': '', 'r': 'r', 't': 't',
                    'y': 'y', 'u': 'sh', 'i': 'ch', 'o': '', 'p': 'p',
                    'a': '', 's': 's', 'd': 'd', 'f': 'f', 'g': 'g',
                    'h': 'h', 'j': 'j', 'k': 'k', 'l': 'l',
                    'z': 'z', 'x': 'x', 'c': 'c', 'v': 'zh', 'b': 'b',
                    'n': 'n', 'm': 'm'
                },
                yunmu: {
                    'q': 'iu', 'w': 'ei', 'e': 'e', 'r': 'uan', 't': 'ue',
                    'y': 'un', 'u': 'u', 'i': 'i', 'o': 'uo', 'p': 'ie',
                    'a': 'a', 's': 'ong', 'd': 'ai', 'f': 'en', 'g': 'eng',
                    'h': 'ang', 'j': 'an', 'k': 'ao', 'l': 'ou',
                    'z': 'ou', 'x': 'ia', 'c': 'ao', 'v': 'ui', 'b': 'in',
                    'n': 'iao', 'm': 'ian'
                },
                special: {
                    'a': 'aa', 'ai': 'ad', 'an': 'aj', 'ang': 'ah', 'ao': 'ak',
                    'e': 'ee', 'ei': 'ew', 'en': 'ef', 'eng': 'eg', 'er': 'er',
                    'o': 'oo', 'ou': 'ol'
                }
            },
            ziranma: {
                name: 'è‡ªç„¶ç ',
                shengmu: {
                    'q': 'q', 'w': 'w', 'e': '', 'r': 'r', 't': 't',
                    'y': 'y', 'u': 'sh', 'i': 'ch', 'o': '', 'p': 'p',
                    'a': '', 's': 's', 'd': 'd', 'f': 'f', 'g': 'g',
                    'h': 'h', 'j': 'j', 'k': 'k', 'l': 'l',
                    'z': 'z', 'x': 'x', 'c': 'c', 'v': 'zh', 'b': 'b',
                    'n': 'n', 'm': 'm'
                },
                yunmu: {
                    'q': 'iu', 'w': 'ia', 'e': 'e', 'r': 'uan', 't': 'ue',
                    'y': 'ing', 'u': 'u', 'i': 'i', 'o': 'uo', 'p': 'un',
                    'a': 'a', 's': 'ong', 'd': 'uang', 'f': 'en', 'g': 'eng',
                    'h': 'ang', 'j': 'an', 'k': 'ao', 'l': 'ai',
                    'z': 'ei', 'x': 'ie', 'c': 'iao', 'v': 'ui', 'b': 'ou',
                    'n': 'in', 'm': 'ian'
                },
                special: {
                    'a': 'aa', 'ai': 'al', 'an': 'aj', 'ang': 'ah', 'ao': 'ak',
                    'e': 'ee', 'ei': 'ez', 'en': 'ef', 'eng': 'eg', 'er': 'er',
                    'o': 'oo', 'ou': 'ob'
                }
            },
            sogou: {
                name: 'æœç‹—åŒæ‹¼',
                shengmu: {
                    'q': 'q', 'w': 'w', 'e': '', 'r': 'r', 't': 't',
                    'y': 'y', 'u': 'sh', 'i': 'ch', 'o': '', 'p': 'p',
                    'a': '', 's': 's', 'd': 'd', 'f': 'f', 'g': 'g',
                    'h': 'h', 'j': 'j', 'k': 'k', 'l': 'l',
                    'z': 'z', 'x': 'x', 'c': 'c', 'v': 'zh', 'b': 'b',
                    'n': 'n', 'm': 'm'
                },
                yunmu: {
                    'q': 'iu', 'w': 'ia', 'e': 'e', 'r': 'uan', 't': 'ue',
                    'y': 'uai', 'u': 'u', 'i': 'i', 'o': 'uo', 'p': 'un',
                    'a': 'a', 's': 'ong', 'd': 'uang', 'f': 'en', 'g': 'eng',
                    'h': 'ang', 'j': 'an', 'k': 'ao', 'l': 'ai',
                    'z': 'ei', 'x': 'ie', 'c': 'iao', 'v': 'ui', 'b': 'ou',
                    'n': 'in', 'm': 'ian', ';': 'ing'
                },
                special: {
                    'a': 'oa', 'ai': 'ol', 'an': 'oj', 'ang': 'oh', 'ao': 'ok',
                    'e': 'oe', 'ei': 'oz', 'en': 'of', 'eng': 'og', 'er': 'or',
                    'o': 'oo', 'ou': 'ob'
                }
            },
            microsoft: {
                name: 'å¾®è½¯åŒæ‹¼',
                shengmu: {
                    'q': 'q', 'w': 'w', 'e': '', 'r': 'r', 't': 't',
                    'y': 'y', 'u': 'sh', 'i': 'ch', 'o': '', 'p': 'p',
                    'a': '', 's': 's', 'd': 'd', 'f': 'f', 'g': 'g',
                    'h': 'h', 'j': 'j', 'k': 'k', 'l': 'l',
                    'z': 'z', 'x': 'x', 'c': 'c', 'v': 'zh', 'b': 'b',
                    'n': 'n', 'm': 'm'
                },
                yunmu: {
                    'q': 'iu', 'w': 'ia', 'e': 'e', 'r': 'uan', 't': 'ue',
                    'y': 'uai', 'u': 'u', 'i': 'i', 'o': 'uo', 'p': 'un',
                    'a': 'a', 's': 'ong', 'd': 'uang', 'f': 'en', 'g': 'eng',
                    'h': 'ang', 'j': 'an', 'k': 'ao', 'l': 'ai',
                    'z': 'ei', 'x': 'ie', 'c': 'iao', 'v': 'ui', 'b': 'ou',
                    'n': 'in', 'm': 'ian', ';': 'ing'
                },
                special: {
                    'a': 'oa', 'ai': 'ol', 'an': 'oj', 'ang': 'oh', 'ao': 'ok',
                    'e': 'oe', 'ei': 'oz', 'en': 'of', 'eng': 'og', 'er': 'or',
                    'o': 'oo', 'ou': 'ob'
                }
            }
        };

        // å¸¸ç”¨æ±‰å­—åŠå…¶æ‹¼éŸ³
        const chars = [
            {char: 'ä¸­', pinyin: 'zhong'}, {char: 'å›½', pinyin: 'guo'}, {char: 'äºº', pinyin: 'ren'},
            {char: 'çš„', pinyin: 'de'}, {char: 'æ˜¯', pinyin: 'shi'}, {char: 'ä¸', pinyin: 'bu'},
            {char: 'äº†', pinyin: 'le'}, {char: 'åœ¨', pinyin: 'zai'}, {char: 'æœ‰', pinyin: 'you'},
            {char: 'æˆ‘', pinyin: 'wo'}, {char: 'ä»–', pinyin: 'ta'}, {char: 'è¿™', pinyin: 'zhe'},
            {char: 'ä¸ª', pinyin: 'ge'}, {char: 'ä»¬', pinyin: 'men'}, {char: 'æ¥', pinyin: 'lai'},
            {char: 'åˆ°', pinyin: 'dao'}, {char: 'æ—¶', pinyin: 'shi'}, {char: 'å¤§', pinyin: 'da'},
            {char: 'åœ°', pinyin: 'di'}, {char: 'ä¸º', pinyin: 'wei'}, {char: 'å­', pinyin: 'zi'},
            {char: 'è¯´', pinyin: 'shuo'}, {char: 'å‡º', pinyin: 'chu'}, {char: 'ä¹Ÿ', pinyin: 'ye'},
            {char: 'å’Œ', pinyin: 'he'}, {char: 'é‚£', pinyin: 'na'}, {char: 'è¦', pinyin: 'yao'},
            {char: 'ä¸‹', pinyin: 'xia'}, {char: 'ä»¥', pinyin: 'yi'}, {char: 'ç”Ÿ', pinyin: 'sheng'},
            {char: 'ä¼š', pinyin: 'hui'}, {char: 'è‡ª', pinyin: 'zi'}, {char: 'ç€', pinyin: 'zhe'},
            {char: 'å»', pinyin: 'qu'}, {char: 'ä¹‹', pinyin: 'zhi'}, {char: 'è¿‡', pinyin: 'guo'},
            {char: 'å®¶', pinyin: 'jia'}, {char: 'å­¦', pinyin: 'xue'}, {char: 'å¯¹', pinyin: 'dui'},
            {char: 'å¯', pinyin: 'ke'}, {char: 'å¥¹', pinyin: 'ta'}, {char: 'é‡Œ', pinyin: 'li'},
            {char: 'å', pinyin: 'hou'}, {char: 'å°', pinyin: 'xiao'}, {char: 'ä¹ˆ', pinyin: 'me'},
            {char: 'å¿ƒ', pinyin: 'xin'}, {char: 'å¤š', pinyin: 'duo'}, {char: 'å¤©', pinyin: 'tian'},
            {char: 'è€Œ', pinyin: 'er'}, {char: 'èƒ½', pinyin: 'neng'}, {char: 'å¥½', pinyin: 'hao'},
            {char: 'éƒ½', pinyin: 'dou'}, {char: 'ç„¶', pinyin: 'ran'}, {char: 'æ²¡', pinyin: 'mei'},
            {char: 'æ—¥', pinyin: 'ri'}, {char: 'äº', pinyin: 'yu'}, {char: 'èµ·', pinyin: 'qi'},
            {char: 'è¿˜', pinyin: 'hai'}, {char: 'å‘', pinyin: 'fa'}, {char: 'æˆ', pinyin: 'cheng'},
            {char: 'äº‹', pinyin: 'shi'}, {char: 'åª', pinyin: 'zhi'}, {char: 'ä½œ', pinyin: 'zuo'},
            {char: 'å½“', pinyin: 'dang'}, {char: 'æƒ³', pinyin: 'xiang'}, {char: 'çœ‹', pinyin: 'kan'},
            {char: 'æ–‡', pinyin: 'wen'}, {char: 'æ— ', pinyin: 'wu'}, {char: 'å¼€', pinyin: 'kai'},
            {char: 'æ‰‹', pinyin: 'shou'}, {char: 'å', pinyin: 'shi'}, {char: 'ç”¨', pinyin: 'yong'},
            {char: 'ä¸»', pinyin: 'zhu'}, {char: 'è¡Œ', pinyin: 'xing'}, {char: 'æ–¹', pinyin: 'fang'},
            {char: 'åˆ', pinyin: 'you'}, {char: 'å¦‚', pinyin: 'ru'}, {char: 'å‰', pinyin: 'qian'},
            {char: 'æ‰€', pinyin: 'suo'}, {char: 'æœ¬', pinyin: 'ben'}, {char: 'è§', pinyin: 'jian'},
            {char: 'ç»', pinyin: 'jing'}, {char: 'å¤´', pinyin: 'tou'}, {char: 'é¢', pinyin: 'mian'},
            {char: 'å…¬', pinyin: 'gong'}, {char: 'åŒ', pinyin: 'tong'}, {char: 'ä¸‰', pinyin: 'san'},
            {char: 'å·²', pinyin: 'yi'}, {char: 'è€', pinyin: 'lao'}, {char: 'ä»', pinyin: 'cong'},
            {char: 'åŠ¨', pinyin: 'dong'}, {char: 'ä¸¤', pinyin: 'liang'}, {char: 'é•¿', pinyin: 'chang'},
            {char: 'çŸ¥', pinyin: 'zhi'}, {char: 'æ°‘', pinyin: 'min'}, {char: 'æ ·', pinyin: 'yang'}
        ];

        let currentScheme = 'xiaohe';
        let currentChar = null;
        let stats = { total: 0, correct: 0, streak: 0 };
        let history = [];

        // ä¸»é¢˜åˆ‡æ¢
        window.toggleTheme = function() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.querySelector('.theme-toggle').textContent = newTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        };

        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.querySelector('.theme-toggle').textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }

        // æ‹¼éŸ³è½¬åŒæ‹¼
        function pinyinToShuangpin(pinyin, scheme) {
            const s = schemes[scheme];
            pinyin = pinyin.toLowerCase();
            
            // å¤„ç†ç‰¹æ®ŠéŸµæ¯ï¼ˆé›¶å£°æ¯ï¼‰
            if (s.special[pinyin]) {
                return s.special[pinyin];
            }
            
            // åˆ†ç¦»å£°æ¯å’ŒéŸµæ¯
            let shengmu = '';
            let yunmu = pinyin;
            
            const shengmuList = ['zh', 'ch', 'sh', 'b', 'p', 'm', 'f', 'd', 't', 'n', 'l', 
                                 'g', 'k', 'h', 'j', 'q', 'x', 'r', 'z', 'c', 's', 'y', 'w'];
            
            for (const sm of shengmuList) {
                if (pinyin.startsWith(sm)) {
                    shengmu = sm;
                    yunmu = pinyin.slice(sm.length);
                    break;
                }
            }
            
            // æŸ¥æ‰¾å£°æ¯é”®ä½
            let shengKey = '';
            if (shengmu) {
                for (const [key, val] of Object.entries(s.shengmu)) {
                    if (val === shengmu) {
                        shengKey = key;
                        break;
                    }
                }
                if (!shengKey && shengmu.length === 1) {
                    shengKey = shengmu;
                }
            }
            
            // æŸ¥æ‰¾éŸµæ¯é”®ä½
            let yunKey = '';
            // å¤„ç†ç‰¹æ®Šæƒ…å†µ
            if (yunmu === 'v' || yunmu === 'Ã¼') yunmu = 'u';
            if (yunmu === 've' || yunmu === 'Ã¼e') yunmu = 'ue';
            
            // ç›´æ¥åŒ¹é…éŸµæ¯
            for (const [key, val] of Object.entries(s.yunmu)) {
                if (val === yunmu) {
                    yunKey = key;
                    break;
                }
            }
            
            // å•éŸµæ¯ç›´æ¥ä½¿ç”¨
            if (!yunKey && yunmu.length === 1 && 'aeiou'.includes(yunmu)) {
                yunKey = yunmu;
            }
            
            // é›¶å£°æ¯å¤„ç†
            if (!shengmu) {
                if (s.special[yunmu]) {
                    return s.special[yunmu];
                }
                // é›¶å£°æ¯ + éŸµæ¯
                if (yunmu.startsWith('i')) shengKey = 'i';
                else if (yunmu.startsWith('u')) shengKey = 'u';
                else if (yunmu.startsWith('Ã¼')) shengKey = 'v';
                else shengKey = yunmu[0];
            }
            
            return shengKey + yunKey;
        }

        // ç”Ÿæˆé”®ç›˜
        function renderKeyboard() {
            const keyboard = document.getElementById('keyboard');
            keyboard.textContent = '';
            
            const s = schemes[currentScheme];
            const rows = [
                ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],
                ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l'],
                ['z', 'x', 'c', 'v', 'b', 'n', 'm']
            ];
            
            rows.forEach(row => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'keyboard-row';
                
                row.forEach(key => {
                    const keyDiv = document.createElement('div');
                    keyDiv.className = 'key';
                    keyDiv.dataset.key = key;
                    
                    const letterSpan = document.createElement('span');
                    letterSpan.className = 'letter';
                    letterSpan.textContent = key.toUpperCase();
                    
                    const shengSpan = document.createElement('span');
                    shengSpan.className = 'sheng';
                    shengSpan.textContent = s.shengmu[key] || '';
                    
                    const yunSpan = document.createElement('span');
                    yunSpan.className = 'yun';
                    yunSpan.textContent = s.yunmu[key] || '';
                    
                    keyDiv.appendChild(letterSpan);
                    keyDiv.appendChild(shengSpan);
                    keyDiv.appendChild(yunSpan);
                    
                    keyDiv.onclick = () => {
                        const input = document.getElementById('userInput');
                        if (input.value.length < 2) {
                            input.value += key;
                            input.focus();
                        }
                    };
                    
                    rowDiv.appendChild(keyDiv);
                });
                
                keyboard.appendChild(rowDiv);
            });
        }

        // ç”Ÿæˆæ–¹æ¡ˆå¯¹ç…§è¡¨
        function renderSchemeTable() {
            const container = document.getElementById('schemeTableContainer');
            container.textContent = '';
            
            const s = schemes[currentScheme];
            const table = document.createElement('table');
            
            // å£°æ¯è¡¨å¤´
            const theadSheng = document.createElement('thead');
            const trShengHead = document.createElement('tr');
            const thSheng = document.createElement('th');
            thSheng.colSpan = 5;
            thSheng.textContent = 'å£°æ¯';
            trShengHead.appendChild(thSheng);
            theadSheng.appendChild(trShengHead);
            table.appendChild(theadSheng);
            
            // å£°æ¯å†…å®¹
            const tbodySheng = document.createElement('tbody');
            const shengmuEntries = Object.entries(s.shengmu).filter(([k, v]) => v);
            for (let i = 0; i < shengmuEntries.length; i += 5) {
                const tr = document.createElement('tr');
                for (let j = 0; j < 5 && i + j < shengmuEntries.length; j++) {
                    const [key, val] = shengmuEntries[i + j];
                    const td = document.createElement('td');
                    td.textContent = key.toUpperCase() + ' â†’ ' + val;
                    tr.appendChild(td);
                }
                tbodySheng.appendChild(tr);
            }
            table.appendChild(tbodySheng);
            
            // éŸµæ¯è¡¨å¤´
            const theadYun = document.createElement('thead');
            const trYunHead = document.createElement('tr');
            const thYun = document.createElement('th');
            thYun.colSpan = 5;
            thYun.textContent = 'éŸµæ¯';
            trYunHead.appendChild(thYun);
            theadYun.appendChild(trYunHead);
            table.appendChild(theadYun);
            
            // éŸµæ¯å†…å®¹
            const tbodyYun = document.createElement('tbody');
            const yunmuEntries = Object.entries(s.yunmu).filter(([k, v]) => v);
            for (let i = 0; i < yunmuEntries.length; i += 5) {
                const tr = document.createElement('tr');
                for (let j = 0; j < 5 && i + j < yunmuEntries.length; j++) {
                    const [key, val] = yunmuEntries[i + j];
                    const td = document.createElement('td');
                    td.textContent = key.toUpperCase() + ' â†’ ' + val;
                    tr.appendChild(td);
                }
                tbodyYun.appendChild(tr);
            }
            table.appendChild(tbodyYun);
            
            container.appendChild(table);
        }

        // ä¸‹ä¸€ä¸ªå­—
        function nextChar() {
            const idx = Math.floor(Math.random() * chars.length);
            currentChar = chars[idx];
            updateDisplay();
            document.getElementById('userInput').value = '';
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('userInput').focus();
            
            // æ¸…é™¤é”®ç›˜é«˜äº®
            document.querySelectorAll('.key').forEach(k => k.classList.remove('highlight'));
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            if (!currentChar) return;
            document.getElementById('currentChar').textContent = currentChar.char;
            const showHint = document.getElementById('showHint').checked;
            document.getElementById('pinyinHint').textContent = showHint ? currentChar.pinyin : '';
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            if (!currentChar) return;
            
            const userInput = document.getElementById('userInput').value.toLowerCase();
            const correctAnswer = pinyinToShuangpin(currentChar.pinyin, currentScheme);
            const isCorrect = userInput === correctAnswer;
            
            stats.total++;
            if (isCorrect) {
                stats.correct++;
                stats.streak++;
                document.getElementById('feedback').textContent = 'âœ“ æ­£ç¡®ï¼';
                document.getElementById('feedback').className = 'feedback correct';
            } else {
                stats.streak = 0;
                document.getElementById('feedback').textContent = 'âœ— é”™è¯¯ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š' + correctAnswer;
                document.getElementById('feedback').className = 'feedback wrong';
            }
            
            // é«˜äº®æ­£ç¡®æŒ‰é”®
            highlightKeys(correctAnswer);
            
            // æ·»åŠ å†å²
            addHistory(currentChar.char, currentChar.pinyin, userInput, correctAnswer, isCorrect);
            
            updateStats();
            
            // è‡ªåŠ¨ä¸‹ä¸€ä¸ª
            setTimeout(() => {
                nextChar();
            }, isCorrect ? 800 : 2000);
        }

        // é«˜äº®æŒ‰é”®
        function highlightKeys(answer) {
            document.querySelectorAll('.key').forEach(k => k.classList.remove('highlight'));
            if (answer.length >= 1) {
                const key1 = document.querySelector('.key[data-key="' + answer[0] + '"]');
                if (key1) key1.classList.add('highlight');
            }
            if (answer.length >= 2) {
                const key2 = document.querySelector('.key[data-key="' + answer[1] + '"]');
                if (key2) key2.classList.add('highlight');
            }
        }

        // è·³è¿‡
        window.skipChar = function() {
            const correctAnswer = pinyinToShuangpin(currentChar.pinyin, currentScheme);
            document.getElementById('feedback').textContent = 'è·³è¿‡ï¼Œç­”æ¡ˆæ˜¯ï¼š' + correctAnswer;
            document.getElementById('feedback').className = 'feedback';
            highlightKeys(correctAnswer);
            setTimeout(nextChar, 1500);
        };

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('totalCount').textContent = stats.total;
            document.getElementById('correctCount').textContent = stats.correct;
            document.getElementById('accuracy').textContent = stats.total > 0 
                ? Math.round(stats.correct / stats.total * 100) + '%' : '0%';
            document.getElementById('streak').textContent = stats.streak;
            
            localStorage.setItem('shuangpin-stats-' + currentScheme, JSON.stringify(stats));
        }

        // é‡ç½®ç»Ÿè®¡
        window.resetStats = function() {
            stats = { total: 0, correct: 0, streak: 0 };
            updateStats();
        };

        // å†å²è®°å½•
        function addHistory(char, pinyin, input, answer, correct) {
            history.unshift({ char, pinyin, input, answer, correct, time: new Date().toLocaleTimeString() });
            if (history.length > 50) history.pop();
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            list.textContent = '';
            
            history.forEach(item => {
                const div = document.createElement('div');
                div.className = 'history-item ' + (item.correct ? 'correct' : 'wrong');
                
                const infoSpan = document.createElement('span');
                infoSpan.textContent = item.char + ' (' + item.pinyin + ') â†’ ' + 
                    item.input + (item.correct ? ' âœ“' : ' âœ— åº”ä¸º ' + item.answer);
                
                const timeSpan = document.createElement('span');
                timeSpan.textContent = item.time;
                timeSpan.style.color = 'var(--pico-muted-color)';
                
                div.appendChild(infoSpan);
                div.appendChild(timeSpan);
                list.appendChild(div);
            });
        }

        window.clearHistory = function() {
            history = [];
            renderHistory();
        };

        // åˆ‡æ¢æ–¹æ¡ˆ
        window.changeScheme = function() {
            currentScheme = document.getElementById('schemeSelect').value;
            const saved = localStorage.getItem('shuangpin-stats-' + currentScheme);
            stats = saved ? JSON.parse(saved) : { total: 0, correct: 0, streak: 0 };
            updateStats();
            renderKeyboard();
            renderSchemeTable();
            nextChar();
        };

        // åˆ‡æ¢é”®ç›˜æ˜¾ç¤º
        window.toggleKeyboard = function() {
            const show = document.getElementById('showKeyboard').checked;
            document.getElementById('keyboardSection').style.display = show ? 'block' : 'none';
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            
            // åŠ è½½ä¿å­˜çš„ç»Ÿè®¡
            const saved = localStorage.getItem('shuangpin-stats-' + currentScheme);
            if (saved) stats = JSON.parse(saved);
            
            renderKeyboard();
            renderSchemeTable();
            updateStats();
            nextChar();
            
            // å›è½¦ç¡®è®¤
            document.getElementById('userInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
            
            // è‡ªåŠ¨æäº¤ï¼ˆè¾“å…¥ä¸¤ä¸ªå­—ç¬¦åï¼‰
            document.getElementById('userInput').addEventListener('input', (e) => {
                if (e.target.value.length === 2) {
                    setTimeout(checkAnswer, 100);
                }
            });
        });
    </script>
</body>
</html>
