<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ–¹ç¨‹æ±‚è§£å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="æ–¹ç¨‹æ±‚è§£å™¨ - WebUtils" />
    <meta name="keywords" content="equation,calculator,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/calculator/equation.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="æ–¹ç¨‹æ±‚è§£å™¨ - WebUtils" />
    <meta property="og:description" content="æ–¹ç¨‹æ±‚è§£å™¨ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/calculator/equation.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="æ–¹ç¨‹æ±‚è§£å™¨ - WebUtils" />
    <meta name="twitter:description" content="æ–¹ç¨‹æ±‚è§£å™¨ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      :root {
        --spacing-sm: 0.5rem;
        --spacing-md: 1rem;
        --spacing-lg: 1.5rem;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: var(--spacing-lg);
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-lg);
      }
      .grid-inputs {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-md);
      }
      .result-box {
        background: var(--pico-primary-focus);
        border: 2px solid var(--pico-primary);
        border-radius: var(--pico-border-radius);
        padding: var(--spacing-lg);
        text-align: center;
        margin: var(--spacing-md) 0;
      }
      .result-box h2 {
        margin: 0;
        font-size: 1.5rem;
      }
      .result-box p {
        margin: var(--spacing-sm) 0 0 0;
        color: var(--pico-muted-color);
      }
      .btn-group {
        display: flex;
        gap: var(--spacing-sm);
        flex-wrap: wrap;
        margin-top: var(--spacing-md);
      }
      .theme-toggle {
        cursor: pointer;
        background: none;
        border: none;
        font-size: 1.5rem;
        padding: 0.5rem;
      }
      .tabs {
        display: flex;
        gap: var(--spacing-sm);
        border-bottom: 2px solid var(--pico-muted-border-color);
        margin-bottom: var(--spacing-md);
        flex-wrap: wrap;
      }
      .tab {
        padding: var(--spacing-sm) var(--spacing-md);
        cursor: pointer;
        border: none;
        background: none;
        border-bottom: 2px solid transparent;
        margin-bottom: -2px;
      }
      .tab.active {
        border-bottom-color: var(--pico-primary);
        color: var(--pico-primary);
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .formula-box {
        background: var(--pico-card-background-color);
        border: 1px solid var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-md);
        font-family: monospace;
        text-align: center;
        font-size: 1.2rem;
      }
      .step-box {
        background: var(--pico-card-background-color);
        border: 1px solid var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        padding: var(--spacing-md);
        margin-top: var(--spacing-md);
        font-family: monospace;
        white-space: pre-wrap;
        overflow-x: auto;
      }
      .equation-preview {
        font-size: 1.25rem;
        text-align: center;
        padding: var(--spacing-md);
        background: var(--pico-card-background-color);
        border-radius: var(--pico-border-radius);
        margin-bottom: var(--spacing-md);
        font-family: monospace;
      }
      .coef-label {
        text-align: center;
        font-size: 0.875rem;
        color: var(--pico-muted-color);
      }
      .matrix-grid {
        display: grid;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
      }
      .matrix-row {
        display: flex;
        gap: var(--spacing-sm);
        align-items: center;
      }
      .matrix-row input {
        width: 60px;
        text-align: center;
      }
      .matrix-row span {
        min-width: 30px;
        text-align: center;
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      æ–¹ç¨‹æ±‚è§£å™¨
    </nav>
    <main class="container">
      <a
        href="../../index.html"
        style="
          display: inline-block;
          margin-bottom: 1rem;
          color: var(--pico-primary);
          text-decoration: none;
        "
      >
        â† è¿”å›é¦–é¡µ
      </a>
      <div class="header">
        <h1>æ–¹ç¨‹æ±‚è§£å™¨</h1>
        <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
      </div>

      <article>
        <div class="tabs">
          <button class="tab active" onclick="switchTab('linear')">ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹</button>
          <button class="tab" onclick="switchTab('quadratic')">ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹</button>
          <button class="tab" onclick="switchTab('system2')">äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„</button>
          <button class="tab" onclick="switchTab('system3')">ä¸‰å…ƒä¸€æ¬¡æ–¹ç¨‹ç»„</button>
          <button class="tab" onclick="switchTab('cubic')">ä¸€å…ƒä¸‰æ¬¡æ–¹ç¨‹</button>
        </div>

        <!-- Linear Equation Tab -->
        <div id="linear-tab" class="tab-content active">
          <div class="formula-box">ax + b = c</div>
          <div class="equation-preview" id="linearPreview">ax + b = c</div>

          <div class="grid-inputs">
            <div>
              <label>a (ç³»æ•°)</label>
              <input
                type="number"
                id="linearA"
                value="2"
                step="any"
                oninput="updateLinearPreview()"
              />
            </div>
            <div>
              <label>b (å¸¸æ•°)</label>
              <input
                type="number"
                id="linearB"
                value="3"
                step="any"
                oninput="updateLinearPreview()"
              />
            </div>
            <div>
              <label>c (ç­‰å·å³è¾¹)</label>
              <input
                type="number"
                id="linearC"
                value="7"
                step="any"
                oninput="updateLinearPreview()"
              />
            </div>
          </div>

          <div class="btn-group">
            <button onclick="solveLinear()">æ±‚è§£</button>
            <button class="secondary" onclick="clearLinear()">æ¸…ç©º</button>
          </div>
        </div>

        <!-- Quadratic Equation Tab -->
        <div id="quadratic-tab" class="tab-content">
          <div class="formula-box">axÂ² + bx + c = 0</div>
          <div class="equation-preview" id="quadraticPreview">axÂ² + bx + c = 0</div>

          <div class="grid-inputs">
            <div>
              <label>a (xÂ²ç³»æ•°)</label>
              <input
                type="number"
                id="quadA"
                value="1"
                step="any"
                oninput="updateQuadraticPreview()"
              />
            </div>
            <div>
              <label>b (xç³»æ•°)</label>
              <input
                type="number"
                id="quadB"
                value="-5"
                step="any"
                oninput="updateQuadraticPreview()"
              />
            </div>
            <div>
              <label>c (å¸¸æ•°é¡¹)</label>
              <input
                type="number"
                id="quadC"
                value="6"
                step="any"
                oninput="updateQuadraticPreview()"
              />
            </div>
          </div>

          <div class="btn-group">
            <button onclick="solveQuadratic()">æ±‚è§£</button>
            <button class="secondary" onclick="clearQuadratic()">æ¸…ç©º</button>
          </div>
        </div>

        <!-- System of 2 Linear Equations Tab -->
        <div id="system2-tab" class="tab-content">
          <div class="formula-box">
            aâ‚x + bâ‚y = câ‚
            <br />
            aâ‚‚x + bâ‚‚y = câ‚‚
          </div>

          <div class="matrix-grid">
            <div class="matrix-row">
              <input type="number" id="s2a1" value="2" step="any" />
              <span>x +</span>
              <input type="number" id="s2b1" value="3" step="any" />
              <span>y =</span>
              <input type="number" id="s2c1" value="8" step="any" />
            </div>
            <div class="matrix-row">
              <input type="number" id="s2a2" value="4" step="any" />
              <span>x +</span>
              <input type="number" id="s2b2" value="-1" step="any" />
              <span>y =</span>
              <input type="number" id="s2c2" value="2" step="any" />
            </div>
          </div>

          <div class="btn-group">
            <button onclick="solveSystem2()">æ±‚è§£</button>
            <button class="secondary" onclick="clearSystem2()">æ¸…ç©º</button>
          </div>
        </div>

        <!-- System of 3 Linear Equations Tab -->
        <div id="system3-tab" class="tab-content">
          <div class="formula-box">
            aâ‚x + bâ‚y + câ‚z = dâ‚
            <br />
            aâ‚‚x + bâ‚‚y + câ‚‚z = dâ‚‚
            <br />
            aâ‚ƒx + bâ‚ƒy + câ‚ƒz = dâ‚ƒ
          </div>

          <div class="matrix-grid">
            <div class="matrix-row">
              <input type="number" id="s3a1" value="1" step="any" />
              <span>x +</span>
              <input type="number" id="s3b1" value="2" step="any" />
              <span>y +</span>
              <input type="number" id="s3c1" value="3" step="any" />
              <span>z =</span>
              <input type="number" id="s3d1" value="14" step="any" />
            </div>
            <div class="matrix-row">
              <input type="number" id="s3a2" value="2" step="any" />
              <span>x +</span>
              <input type="number" id="s3b2" value="-1" step="any" />
              <span>y +</span>
              <input type="number" id="s3c2" value="1" step="any" />
              <span>z =</span>
              <input type="number" id="s3d2" value="3" step="any" />
            </div>
            <div class="matrix-row">
              <input type="number" id="s3a3" value="3" step="any" />
              <span>x +</span>
              <input type="number" id="s3b3" value="1" step="any" />
              <span>y +</span>
              <input type="number" id="s3c3" value="-2" step="any" />
              <span>z =</span>
              <input type="number" id="s3d3" value="1" step="any" />
            </div>
          </div>

          <div class="btn-group">
            <button onclick="solveSystem3()">æ±‚è§£</button>
            <button class="secondary" onclick="clearSystem3()">æ¸…ç©º</button>
          </div>
        </div>

        <!-- Cubic Equation Tab -->
        <div id="cubic-tab" class="tab-content">
          <div class="formula-box">axÂ³ + bxÂ² + cx + d = 0</div>
          <div class="equation-preview" id="cubicPreview">axÂ³ + bxÂ² + cx + d = 0</div>

          <div class="grid-inputs">
            <div>
              <label>a (xÂ³ç³»æ•°)</label>
              <input
                type="number"
                id="cubicA"
                value="1"
                step="any"
                oninput="updateCubicPreview()"
              />
            </div>
            <div>
              <label>b (xÂ²ç³»æ•°)</label>
              <input
                type="number"
                id="cubicB"
                value="-6"
                step="any"
                oninput="updateCubicPreview()"
              />
            </div>
            <div>
              <label>c (xç³»æ•°)</label>
              <input
                type="number"
                id="cubicC"
                value="11"
                step="any"
                oninput="updateCubicPreview()"
              />
            </div>
            <div>
              <label>d (å¸¸æ•°é¡¹)</label>
              <input
                type="number"
                id="cubicD"
                value="-6"
                step="any"
                oninput="updateCubicPreview()"
              />
            </div>
          </div>

          <div class="btn-group">
            <button onclick="solveCubic()">æ±‚è§£</button>
            <button class="secondary" onclick="clearCubic()">æ¸…ç©º</button>
          </div>
        </div>

        <div class="result-box">
          <h2 id="result">--</h2>
          <p id="resultDetail">è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£</p>
        </div>

        <div class="step-box" id="steps" style="display: none"></div>
      </article>
    </main>

    <script>
      window.toggleTheme = function () {
        const html = document.documentElement;
        const current = html.getAttribute("data-theme");
        html.setAttribute("data-theme", current === "light" ? "dark" : "light");
      };

      window.switchTab = function (tabName) {
        document.querySelectorAll(".tab").forEach(function (t) {
          t.classList.remove("active");
        });
        document.querySelectorAll(".tab-content").forEach(function (c) {
          c.classList.remove("active");
        });
        document
          .querySelector("[onclick=\"switchTab('" + tabName + "')\"]")
          .classList.add("active");
        document.getElementById(tabName + "-tab").classList.add("active");
        document.getElementById("steps").style.display = "none";
        document.getElementById("result").textContent = "--";
        document.getElementById("resultDetail").textContent = "è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£";
      };

      function formatNumber(num) {
        if (Math.abs(num - Math.round(num)) < 1e-10) {
          return Math.round(num).toString();
        }
        return num.toFixed(6).replace(/\.?0+$/, "");
      }

      window.formatCoef = function (num, isFirst, variable) {
        if (num === 0) return "";
        const abs = Math.abs(num);
        const sign = num > 0 ? (isFirst ? "" : " + ") : " - ";
        const coef = abs === 1 ? "" : formatNumber(abs);
        return sign + coef + variable;
      };

      // Linear equation: ax + b = c
      function updateLinearPreview() {
        const a = parseFloat(document.getElementById("linearA").value) || 0;
        const b = parseFloat(document.getElementById("linearB").value) || 0;
        const c = parseFloat(document.getElementById("linearC").value) || 0;

        let eq = formatNumber(a) + "x";
        if (b >= 0) eq += " + " + formatNumber(b);
        else eq += " - " + formatNumber(Math.abs(b));
        eq += " = " + formatNumber(c);

        document.getElementById("linearPreview").textContent = eq;
      }

      window.solveLinear = function () {
        const a = parseFloat(document.getElementById("linearA").value) || 0;
        const b = parseFloat(document.getElementById("linearB").value) || 0;
        const c = parseFloat(document.getElementById("linearC").value) || 0;

        if (a === 0) {
          if (b === c) {
            document.getElementById("result").textContent = "æ— ç©·å¤šè§£";
            document.getElementById("resultDetail").textContent = "æ–¹ç¨‹æ’æˆç«‹";
          } else {
            document.getElementById("result").textContent = "æ— è§£";
            document.getElementById("resultDetail").textContent = "æ–¹ç¨‹çŸ›ç›¾";
          }
          document.getElementById("steps").style.display = "none";
          return;
        }

        const x = (c - b) / a;

        let steps =
          "åŸæ–¹ç¨‹: " + formatNumber(a) + "x + " + formatNumber(b) + " = " + formatNumber(c) + "\n";
        steps +=
          "ç§»é¡¹: " + formatNumber(a) + "x = " + formatNumber(c) + " - " + formatNumber(b) + "\n";
        steps += "       " + formatNumber(a) + "x = " + formatNumber(c - b) + "\n";
        steps += "ä¸¤è¾¹é™¤ä»¥ " + formatNumber(a) + ":\n";
        steps += "       x = " + formatNumber(c - b) + " / " + formatNumber(a) + "\n";
        steps += "       x = " + formatNumber(x);

        document.getElementById("result").textContent = "x = " + formatNumber(x);
        document.getElementById("resultDetail").textContent = "ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹çš„è§£";
        document.getElementById("steps").textContent = steps;
        document.getElementById("steps").style.display = "block";
      };

      window.clearLinear = function () {
        document.getElementById("linearA").value = 2;
        document.getElementById("linearB").value = 3;
        document.getElementById("linearC").value = 7;
        updateLinearPreview();
        document.getElementById("result").textContent = "--";
        document.getElementById("resultDetail").textContent = "è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£";
        document.getElementById("steps").style.display = "none";
      };

      // Quadratic equation: axÂ² + bx + c = 0
      function updateQuadraticPreview() {
        const a = parseFloat(document.getElementById("quadA").value) || 0;
        const b = parseFloat(document.getElementById("quadB").value) || 0;
        const c = parseFloat(document.getElementById("quadC").value) || 0;

        let eq = formatNumber(a) + "xÂ²";
        if (b >= 0) eq += " + " + formatNumber(b) + "x";
        else eq += " - " + formatNumber(Math.abs(b)) + "x";
        if (c >= 0) eq += " + " + formatNumber(c);
        else eq += " - " + formatNumber(Math.abs(c));
        eq += " = 0";

        document.getElementById("quadraticPreview").textContent = eq;
      }

      window.solveQuadratic = function () {
        const a = parseFloat(document.getElementById("quadA").value) || 0;
        const b = parseFloat(document.getElementById("quadB").value) || 0;
        const c = parseFloat(document.getElementById("quadC").value) || 0;

        if (a === 0) {
          alert("aä¸èƒ½ä¸º0ï¼Œå¦åˆ™ä¸æ˜¯äºŒæ¬¡æ–¹ç¨‹");
          return;
        }

        const discriminant = b * b - 4 * a * c;

        let steps =
          "åŸæ–¹ç¨‹: " +
          formatNumber(a) +
          "xÂ² + " +
          formatNumber(b) +
          "x + " +
          formatNumber(c) +
          " = 0\n\n";
        steps += "åˆ¤åˆ«å¼ Î” = bÂ² - 4ac\n";
        steps +=
          "       Î” = " +
          formatNumber(b) +
          "Â² - 4Ã—" +
          formatNumber(a) +
          "Ã—" +
          formatNumber(c) +
          "\n";
        steps += "       Î” = " + formatNumber(b * b) + " - " + formatNumber(4 * a * c) + "\n";
        steps += "       Î” = " + formatNumber(discriminant) + "\n\n";

        let result;
        if (discriminant > 0) {
          const x1 = (-b + Math.sqrt(discriminant)) / (2 * a);
          const x2 = (-b - Math.sqrt(discriminant)) / (2 * a);
          result = "xâ‚ = " + formatNumber(x1) + ", xâ‚‚ = " + formatNumber(x2);
          steps += "Î” > 0, æœ‰ä¸¤ä¸ªä¸ç­‰å®æ ¹:\n";
          steps += "x = (-b Â± âˆšÎ”) / 2a\n";
          steps +=
            "xâ‚ = (" +
            formatNumber(-b) +
            " + âˆš" +
            formatNumber(discriminant) +
            ") / " +
            formatNumber(2 * a) +
            " = " +
            formatNumber(x1) +
            "\n";
          steps +=
            "xâ‚‚ = (" +
            formatNumber(-b) +
            " - âˆš" +
            formatNumber(discriminant) +
            ") / " +
            formatNumber(2 * a) +
            " = " +
            formatNumber(x2);
        } else if (discriminant === 0) {
          const x = -b / (2 * a);
          result = "x = " + formatNumber(x) + " (é‡æ ¹)";
          steps += "Î” = 0, æœ‰ä¸¤ä¸ªç›¸ç­‰å®æ ¹:\n";
          steps +=
            "x = -b / 2a = " +
            formatNumber(-b) +
            " / " +
            formatNumber(2 * a) +
            " = " +
            formatNumber(x);
        } else {
          const realPart = -b / (2 * a);
          const imagPart = Math.sqrt(-discriminant) / (2 * a);
          result =
            "xâ‚ = " +
            formatNumber(realPart) +
            " + " +
            formatNumber(imagPart) +
            "i\nxâ‚‚ = " +
            formatNumber(realPart) +
            " - " +
            formatNumber(imagPart) +
            "i";
          steps += "Î” < 0, æœ‰ä¸¤ä¸ªå…±è½­å¤æ ¹:\n";
          steps += "x = (-b Â± âˆšÎ”) / 2a\n";
          steps +=
            "å®éƒ¨: " +
            formatNumber(-b) +
            " / " +
            formatNumber(2 * a) +
            " = " +
            formatNumber(realPart) +
            "\n";
          steps +=
            "è™šéƒ¨: âˆš" +
            formatNumber(-discriminant) +
            " / " +
            formatNumber(2 * a) +
            " = " +
            formatNumber(imagPart) +
            "\n";
          steps += "xâ‚ = " + formatNumber(realPart) + " + " + formatNumber(imagPart) + "i\n";
          steps += "xâ‚‚ = " + formatNumber(realPart) + " - " + formatNumber(imagPart) + "i";
        }

        document.getElementById("result").textContent = result;
        document.getElementById("resultDetail").textContent =
          discriminant >= 0 ? "å®æ•°è§£" : "å¤æ•°è§£";
        document.getElementById("steps").textContent = steps;
        document.getElementById("steps").style.display = "block";
      };

      window.clearQuadratic = function () {
        document.getElementById("quadA").value = 1;
        document.getElementById("quadB").value = -5;
        document.getElementById("quadC").value = 6;
        updateQuadraticPreview();
        document.getElementById("result").textContent = "--";
        document.getElementById("resultDetail").textContent = "è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£";
        document.getElementById("steps").style.display = "none";
      };

      // System of 2 equations using Cramer's rule
      window.solveSystem2 = function () {
        const a1 = parseFloat(document.getElementById("s2a1").value) || 0;
        const b1 = parseFloat(document.getElementById("s2b1").value) || 0;
        const c1 = parseFloat(document.getElementById("s2c1").value) || 0;
        const a2 = parseFloat(document.getElementById("s2a2").value) || 0;
        const b2 = parseFloat(document.getElementById("s2b2").value) || 0;
        const c2 = parseFloat(document.getElementById("s2c2").value) || 0;

        const det = a1 * b2 - a2 * b1;

        let steps = "æ–¹ç¨‹ç»„:\n";
        steps += formatNumber(a1) + "x + " + formatNumber(b1) + "y = " + formatNumber(c1) + "\n";
        steps += formatNumber(a2) + "x + " + formatNumber(b2) + "y = " + formatNumber(c2) + "\n\n";
        steps += "ä½¿ç”¨å…‹æ‹‰é»˜æ³•åˆ™:\n";
        steps +=
          "D = |a1 b1| = " +
          formatNumber(a1) +
          "Ã—" +
          formatNumber(b2) +
          " - " +
          formatNumber(a2) +
          "Ã—" +
          formatNumber(b1) +
          " = " +
          formatNumber(det) +
          "\n";
        steps += "    |a2 b2|\n\n";

        if (Math.abs(det) < 1e-10) {
          document.getElementById("result").textContent = "æ— å”¯ä¸€è§£";
          document.getElementById("resultDetail").textContent = "æ–¹ç¨‹ç»„æ— è§£æˆ–æœ‰æ— ç©·å¤šè§£";
          document.getElementById("steps").textContent = steps + "è¡Œåˆ—å¼ä¸º0ï¼Œæ–¹ç¨‹ç»„æ— å”¯ä¸€è§£";
          document.getElementById("steps").style.display = "block";
          return;
        }

        const detX = c1 * b2 - c2 * b1;
        const detY = a1 * c2 - a2 * c1;
        const x = detX / det;
        const y = detY / det;

        steps +=
          "Dx = |c1 b1| = " +
          formatNumber(c1) +
          "Ã—" +
          formatNumber(b2) +
          " - " +
          formatNumber(c2) +
          "Ã—" +
          formatNumber(b1) +
          " = " +
          formatNumber(detX) +
          "\n";
        steps += "     |c2 b2|\n\n";
        steps +=
          "Dy = |a1 c1| = " +
          formatNumber(a1) +
          "Ã—" +
          formatNumber(c2) +
          " - " +
          formatNumber(a2) +
          "Ã—" +
          formatNumber(c1) +
          " = " +
          formatNumber(detY) +
          "\n";
        steps += "     |a2 c2|\n\n";
        steps +=
          "x = Dx / D = " +
          formatNumber(detX) +
          " / " +
          formatNumber(det) +
          " = " +
          formatNumber(x) +
          "\n";
        steps +=
          "y = Dy / D = " +
          formatNumber(detY) +
          " / " +
          formatNumber(det) +
          " = " +
          formatNumber(y);

        document.getElementById("result").textContent =
          "x = " + formatNumber(x) + ", y = " + formatNumber(y);
        document.getElementById("resultDetail").textContent = "äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„çš„è§£";
        document.getElementById("steps").textContent = steps;
        document.getElementById("steps").style.display = "block";
      };

      window.clearSystem2 = function () {
        document.getElementById("s2a1").value = 2;
        document.getElementById("s2b1").value = 3;
        document.getElementById("s2c1").value = 8;
        document.getElementById("s2a2").value = 4;
        document.getElementById("s2b2").value = -1;
        document.getElementById("s2c2").value = 2;
        document.getElementById("result").textContent = "--";
        document.getElementById("resultDetail").textContent = "è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£";
        document.getElementById("steps").style.display = "none";
      };

      // System of 3 equations using Cramer's rule
      function det3x3(m) {
        return (
          m[0][0] * (m[1][1] * m[2][2] - m[1][2] * m[2][1]) -
          m[0][1] * (m[1][0] * m[2][2] - m[1][2] * m[2][0]) +
          m[0][2] * (m[1][0] * m[2][1] - m[1][1] * m[2][0])
        );
      }

      window.solveSystem3 = function () {
        const a1 = parseFloat(document.getElementById("s3a1").value) || 0;
        const b1 = parseFloat(document.getElementById("s3b1").value) || 0;
        const c1 = parseFloat(document.getElementById("s3c1").value) || 0;
        const d1 = parseFloat(document.getElementById("s3d1").value) || 0;
        const a2 = parseFloat(document.getElementById("s3a2").value) || 0;
        const b2 = parseFloat(document.getElementById("s3b2").value) || 0;
        const c2 = parseFloat(document.getElementById("s3c2").value) || 0;
        const d2 = parseFloat(document.getElementById("s3d2").value) || 0;
        const a3 = parseFloat(document.getElementById("s3a3").value) || 0;
        const b3 = parseFloat(document.getElementById("s3b3").value) || 0;
        const c3 = parseFloat(document.getElementById("s3c3").value) || 0;
        const d3 = parseFloat(document.getElementById("s3d3").value) || 0;

        const coeffMatrix = [
          [a1, b1, c1],
          [a2, b2, c2],
          [a3, b3, c3]
        ];
        const det = det3x3(coeffMatrix);

        let steps = "æ–¹ç¨‹ç»„:\n";
        steps +=
          formatNumber(a1) +
          "x + " +
          formatNumber(b1) +
          "y + " +
          formatNumber(c1) +
          "z = " +
          formatNumber(d1) +
          "\n";
        steps +=
          formatNumber(a2) +
          "x + " +
          formatNumber(b2) +
          "y + " +
          formatNumber(c2) +
          "z = " +
          formatNumber(d2) +
          "\n";
        steps +=
          formatNumber(a3) +
          "x + " +
          formatNumber(b3) +
          "y + " +
          formatNumber(c3) +
          "z = " +
          formatNumber(d3) +
          "\n\n";
        steps += "ç³»æ•°è¡Œåˆ—å¼ D = " + formatNumber(det) + "\n\n";

        if (Math.abs(det) < 1e-10) {
          document.getElementById("result").textContent = "æ— å”¯ä¸€è§£";
          document.getElementById("resultDetail").textContent = "æ–¹ç¨‹ç»„æ— è§£æˆ–æœ‰æ— ç©·å¤šè§£";
          document.getElementById("steps").textContent = steps + "è¡Œåˆ—å¼ä¸º0ï¼Œæ–¹ç¨‹ç»„æ— å”¯ä¸€è§£";
          document.getElementById("steps").style.display = "block";
          return;
        }

        const detX = det3x3([
          [d1, b1, c1],
          [d2, b2, c2],
          [d3, b3, c3]
        ]);
        const detY = det3x3([
          [a1, d1, c1],
          [a2, d2, c2],
          [a3, d3, c3]
        ]);
        const detZ = det3x3([
          [a1, b1, d1],
          [a2, b2, d2],
          [a3, b3, d3]
        ]);

        const x = detX / det;
        const y = detY / det;
        const z = detZ / det;

        steps += "Dx = " + formatNumber(detX) + "\n";
        steps += "Dy = " + formatNumber(detY) + "\n";
        steps += "Dz = " + formatNumber(detZ) + "\n\n";
        steps += "x = Dx / D = " + formatNumber(x) + "\n";
        steps += "y = Dy / D = " + formatNumber(y) + "\n";
        steps += "z = Dz / D = " + formatNumber(z);

        document.getElementById("result").textContent =
          "x = " + formatNumber(x) + ", y = " + formatNumber(y) + ", z = " + formatNumber(z);
        document.getElementById("resultDetail").textContent = "ä¸‰å…ƒä¸€æ¬¡æ–¹ç¨‹ç»„çš„è§£";
        document.getElementById("steps").textContent = steps;
        document.getElementById("steps").style.display = "block";
      };

      window.clearSystem3 = function () {
        document.getElementById("s3a1").value = 1;
        document.getElementById("s3b1").value = 2;
        document.getElementById("s3c1").value = 3;
        document.getElementById("s3d1").value = 14;
        document.getElementById("s3a2").value = 2;
        document.getElementById("s3b2").value = -1;
        document.getElementById("s3c2").value = 1;
        document.getElementById("s3d2").value = 3;
        document.getElementById("s3a3").value = 3;
        document.getElementById("s3b3").value = 1;
        document.getElementById("s3c3").value = -2;
        document.getElementById("s3d3").value = 1;
        document.getElementById("result").textContent = "--";
        document.getElementById("resultDetail").textContent = "è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£";
        document.getElementById("steps").style.display = "none";
      };

      // Cubic equation
      function updateCubicPreview() {
        const a = parseFloat(document.getElementById("cubicA").value) || 0;
        const b = parseFloat(document.getElementById("cubicB").value) || 0;
        const c = parseFloat(document.getElementById("cubicC").value) || 0;
        const d = parseFloat(document.getElementById("cubicD").value) || 0;

        let eq = formatNumber(a) + "xÂ³";
        if (b >= 0) eq += " + " + formatNumber(b) + "xÂ²";
        else eq += " - " + formatNumber(Math.abs(b)) + "xÂ²";
        if (c >= 0) eq += " + " + formatNumber(c) + "x";
        else eq += " - " + formatNumber(Math.abs(c)) + "x";
        if (d >= 0) eq += " + " + formatNumber(d);
        else eq += " - " + formatNumber(Math.abs(d));
        eq += " = 0";

        document.getElementById("cubicPreview").textContent = eq;
      }

      window.solveCubic = function () {
        const a = parseFloat(document.getElementById("cubicA").value) || 0;
        const b = parseFloat(document.getElementById("cubicB").value) || 0;
        const c = parseFloat(document.getElementById("cubicC").value) || 0;
        const d = parseFloat(document.getElementById("cubicD").value) || 0;

        if (a === 0) {
          alert("aä¸èƒ½ä¸º0ï¼Œå¦åˆ™ä¸æ˜¯ä¸‰æ¬¡æ–¹ç¨‹");
          return;
        }

        // Normalize: xÂ³ + pxÂ² + qx + r = 0
        const p = b / a;
        const q = c / a;
        const r = d / a;

        // Substitution x = t - p/3 to eliminate xÂ² term
        // tÂ³ + pt' + q' = 0
        const pPrime = q - (p * p) / 3;
        const qPrime = r - (p * q) / 3 + (2 * p * p * p) / 27;

        // Discriminant
        const discriminant = (qPrime * qPrime) / 4 + (pPrime * pPrime * pPrime) / 27;

        let steps =
          "åŸæ–¹ç¨‹: " +
          formatNumber(a) +
          "xÂ³ + " +
          formatNumber(b) +
          "xÂ² + " +
          formatNumber(c) +
          "x + " +
          formatNumber(d) +
          " = 0\n\n";
        steps +=
          "æ ‡å‡†åŒ–: xÂ³ + " +
          formatNumber(p) +
          "xÂ² + " +
          formatNumber(q) +
          "x + " +
          formatNumber(r) +
          " = 0\n\n";
        steps += "ä½¿ç”¨å¡å°”ä¸¹å…¬å¼æ±‚è§£...\n";
        steps += "åˆ¤åˆ«å¼ = " + formatNumber(discriminant) + "\n\n";

        let roots = [];

        if (Math.abs(discriminant) < 1e-10) {
          // Triple root or two roots
          if (Math.abs(pPrime) < 1e-10) {
            roots.push(-p / 3);
            steps += "ä¸‰é‡æ ¹æƒ…å†µ\n";
          } else {
            roots.push((3 * qPrime) / pPrime - p / 3);
            roots.push((-3 * qPrime) / (2 * pPrime) - p / 3);
            steps += "æœ‰ä¸€ä¸ªé‡æ ¹\n";
          }
        } else if (discriminant > 0) {
          // One real root
          const sqrtD = Math.sqrt(discriminant);
          const u = Math.cbrt(-qPrime / 2 + sqrtD);
          const v = Math.cbrt(-qPrime / 2 - sqrtD);
          roots.push(u + v - p / 3);
          steps += "ä¸€ä¸ªå®æ ¹ï¼Œä¸¤ä¸ªå…±è½­å¤æ ¹\n";
        } else {
          // Three real roots (Vieta's trigonometric method)
          const rho = Math.sqrt((-pPrime * pPrime * pPrime) / 27);
          const theta = Math.acos(-qPrime / (2 * rho));
          for (let k = 0; k < 3; k++) {
            roots.push(2 * Math.cbrt(rho) * Math.cos((theta + 2 * Math.PI * k) / 3) - p / 3);
          }
          steps += "ä¸‰ä¸ªä¸ç­‰å®æ ¹\n";
        }

        roots = roots.map(function (r) {
          return formatNumber(r);
        });
        const uniqueRoots = roots.filter(function (r, i, arr) {
          return arr.indexOf(r) === i;
        });

        steps += "\nè§£:\n";
        uniqueRoots.forEach(function (r, i) {
          steps += "x" + (i + 1) + " = " + r + "\n";
        });

        document.getElementById("result").textContent = uniqueRoots
          .map(function (r, i) {
            return "x" + (i + 1) + " = " + r;
          })
          .join(", ");
        document.getElementById("resultDetail").textContent = "ä¸€å…ƒä¸‰æ¬¡æ–¹ç¨‹çš„è§£";
        document.getElementById("steps").textContent = steps;
        document.getElementById("steps").style.display = "block";
      };

      window.clearCubic = function () {
        document.getElementById("cubicA").value = 1;
        document.getElementById("cubicB").value = -6;
        document.getElementById("cubicC").value = 11;
        document.getElementById("cubicD").value = -6;
        updateCubicPreview();
        document.getElementById("result").textContent = "--";
        document.getElementById("resultDetail").textContent = "è¾“å…¥ç³»æ•°å¹¶ç‚¹å‡»æ±‚è§£";
        document.getElementById("steps").style.display = "none";
      };

      // Initialize previews
      updateLinearPreview();
      updateQuadraticPreview();
      updateCubicPreview();
    </script>
  </body>
</html>
