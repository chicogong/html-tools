<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON â‡„ YAML è½¬æ¢å™¨ - HTML Tools</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --primary: #8b5cf6;
            --primary-hover: #7c3aed;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        [data-theme="dark"] {
            --card-bg: #1e293b;
            --border-color: #334155;
            --editor-bg: #0f172a;
        }

        [data-theme="light"] {
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --editor-bg: #f8fafc;
        }

        body {
            padding: 2rem;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        header h1 {
            margin: 0;
            font-size: 1.75rem;
        }

        .header-actions {
            display: flex;
            gap: 0.5rem;
        }

        .theme-toggle {
            background: none;
            border: 1px solid var(--border-color);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-size: 1.25rem;
            width: 42px;
            height: 42px;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: stretch;
        }

        @media (max-width: 900px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
            .convert-controls {
                flex-direction: row !important;
                justify-content: center;
            }
        }

        .editor-panel {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background: var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }

        .editor-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .editor-actions {
            display: flex;
            gap: 0.5rem;
        }

        .editor-actions button {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            color: inherit;
        }

        .editor-actions button:hover {
            background: rgba(255,255,255,0.2);
        }

        .editor-body {
            flex: 1;
            position: relative;
        }

        .editor-body textarea {
            width: 100%;
            height: 500px;
            padding: 1rem;
            border: none;
            background: var(--editor-bg);
            color: inherit;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            resize: none;
        }

        .editor-body textarea:focus {
            outline: none;
        }

        .editor-footer {
            padding: 0.5rem 1rem;
            background: var(--border-color);
            font-size: 0.75rem;
            display: flex;
            justify-content: space-between;
            color: var(--muted-color);
        }

        .convert-controls {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 0;
        }

        .convert-btn {
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.5rem;
            background: var(--primary);
            color: white;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .convert-btn:hover {
            background: var(--primary-hover);
            transform: scale(1.05);
        }

        .options-bar {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
        }

        .option-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .option-group label {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .option-group select,
        .option-group input[type="number"] {
            padding: 0.375rem 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            font-size: 0.875rem;
            background: var(--card-bg);
            color: inherit;
        }

        .option-group input[type="number"] {
            width: 60px;
        }

        .option-group input[type="checkbox"] {
            width: auto;
        }

        .status-bar {
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            display: none;
        }

        .status-bar.success {
            display: block;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: var(--success);
        }

        .status-bar.error {
            display: block;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--danger);
        }

        .sample-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .sample-btn {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            background: var(--border-color);
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            color: inherit;
        }

        .sample-btn:hover {
            background: var(--primary);
            color: white;
        }

        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.875rem;
        }

        .info-box h4 {
            margin: 0 0 0.5rem 0;
            color: #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”„ JSON â‡„ YAML è½¬æ¢å™¨</h1>
            <div class="header-actions">
                <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
            </div>
        </header>

        <div class="options-bar">
            <div class="option-group">
                <label>ç¼©è¿›ç©ºæ ¼:</label>
                <input type="number" id="indentSize" value="2" min="1" max="8">
            </div>
            <div class="option-group">
                <label>YAML å¼•å·æ ·å¼:</label>
                <select id="quoteStyle">
                    <option value="minimal">æœ€å°‘å¼•å·</option>
                    <option value="single">å•å¼•å·</option>
                    <option value="double">åŒå¼•å·</option>
                </select>
            </div>
            <div class="option-group">
                <input type="checkbox" id="sortKeys">
                <label for="sortKeys">æŒ‰é”®åæ’åº</label>
            </div>
            <div class="sample-buttons">
                <span style="font-size: 0.875rem; margin-right: 0.5rem;">ç¤ºä¾‹:</span>
                <button class="sample-btn" onclick="loadSample('simple')">ç®€å•å¯¹è±¡</button>
                <button class="sample-btn" onclick="loadSample('nested')">åµŒå¥—ç»“æ„</button>
                <button class="sample-btn" onclick="loadSample('array')">æ•°ç»„æ•°æ®</button>
                <button class="sample-btn" onclick="loadSample('config')">é…ç½®æ–‡ä»¶</button>
            </div>
        </div>

        <div class="editor-container">
            <div class="editor-panel">
                <div class="editor-header">
                    <div class="editor-title">ğŸ“„ JSON</div>
                    <div class="editor-actions">
                        <button onclick="formatJSON()">æ ¼å¼åŒ–</button>
                        <button onclick="minifyJSON()">å‹ç¼©</button>
                        <button onclick="copyText('jsonInput')">å¤åˆ¶</button>
                        <button onclick="clearText('jsonInput')">æ¸…é™¤</button>
                    </div>
                </div>
                <div class="editor-body">
                    <textarea id="jsonInput" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´ JSON..." oninput="updateStats('json')"></textarea>
                </div>
                <div class="editor-footer">
                    <span id="jsonStats">0 å­—ç¬¦ | 0 è¡Œ</span>
                    <span id="jsonValid"></span>
                </div>
            </div>

            <div class="convert-controls">
                <button class="convert-btn" onclick="jsonToYaml()" title="JSON â†’ YAML">â†’</button>
                <button class="convert-btn" onclick="yamlToJson()" title="YAML â†’ JSON">â†</button>
            </div>

            <div class="editor-panel">
                <div class="editor-header">
                    <div class="editor-title">ğŸ“ YAML</div>
                    <div class="editor-actions">
                        <button onclick="copyText('yamlInput')">å¤åˆ¶</button>
                        <button onclick="clearText('yamlInput')">æ¸…é™¤</button>
                        <button onclick="downloadFile('yaml')">ä¸‹è½½</button>
                    </div>
                </div>
                <div class="editor-body">
                    <textarea id="yamlInput" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´ YAML..." oninput="updateStats('yaml')"></textarea>
                </div>
                <div class="editor-footer">
                    <span id="yamlStats">0 å­—ç¬¦ | 0 è¡Œ</span>
                    <span id="yamlValid"></span>
                </div>
            </div>
        </div>

        <div class="status-bar" id="statusBar"></div>

        <div class="info-box">
            <h4>ğŸ’¡ ä½¿ç”¨è¯´æ˜</h4>
            <ul style="margin: 0; padding-left: 1.25rem;">
                <li>æ”¯æŒ JSON å’Œ YAML åŒå‘è½¬æ¢</li>
                <li>è‡ªåŠ¨æ£€æµ‹è¾“å…¥æ ¼å¼æœ‰æ•ˆæ€§</li>
                <li>æ”¯æŒå¤æ‚åµŒå¥—ç»“æ„ã€æ•°ç»„ã€å¤šè¡Œå­—ç¬¦ä¸²</li>
                <li>YAML æ”¯æŒé”šç‚¹(&)å’Œåˆ«å(*) è¯­æ³•</li>
            </ul>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <script>
        // ç¤ºä¾‹æ•°æ®
        const samples = {
            simple: {
                name: "ç¤ºä¾‹é¡¹ç›®",
                version: "1.0.0",
                description: "ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹",
                author: "å¼€å‘è€…",
                license: "MIT"
            },
            nested: {
                database: {
                    host: "localhost",
                    port: 5432,
                    credentials: {
                        username: "admin",
                        password: "secret"
                    }
                },
                cache: {
                    enabled: true,
                    ttl: 3600
                }
            },
            array: {
                users: [
                    { id: 1, name: "å¼ ä¸‰", role: "admin" },
                    { id: 2, name: "æå››", role: "user" },
                    { id: 3, name: "ç‹äº”", role: "user" }
                ],
                tags: ["javascript", "yaml", "json", "converter"]
            },
            config: {
                server: {
                    host: "0.0.0.0",
                    port: 8080,
                    ssl: {
                        enabled: true,
                        cert: "/path/to/cert.pem",
                        key: "/path/to/key.pem"
                    }
                },
                logging: {
                    level: "info",
                    format: "json",
                    outputs: ["stdout", "file"]
                },
                features: {
                    authentication: true,
                    rateLimit: {
                        enabled: true,
                        maxRequests: 100,
                        windowMs: 60000
                    }
                }
            }
        };

        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.querySelector('.theme-toggle').textContent = newTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }

        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.querySelector('.theme-toggle').textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }

        // åŠ è½½ç¤ºä¾‹
        function loadSample(type) {
            const json = JSON.stringify(samples[type], null, 2);
            document.getElementById('jsonInput').value = json;
            updateStats('json');
            jsonToYaml();
        }

        // JSON è½¬ YAML
        function jsonToYaml() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            if (!jsonInput) {
                showStatus('è¯·è¾“å…¥ JSON å†…å®¹', 'error');
                return;
            }

            try {
                const obj = JSON.parse(jsonInput);
                const indent = parseInt(document.getElementById('indentSize').value) || 2;
                const sortKeys = document.getElementById('sortKeys').checked;
                const quoteStyle = document.getElementById('quoteStyle').value;

                let quotingType;
                if (quoteStyle === 'single') quotingType = "'";
                else if (quoteStyle === 'double') quotingType = '"';

                const yamlOptions = {
                    indent: indent,
                    sortKeys: sortKeys,
                    lineWidth: -1,
                    quotingType: quotingType,
                    forceQuotes: quoteStyle !== 'minimal'
                };

                const yaml = jsyaml.dump(obj, yamlOptions);
                document.getElementById('yamlInput').value = yaml;
                updateStats('yaml');
                showStatus('JSON â†’ YAML è½¬æ¢æˆåŠŸ', 'success');
            } catch (e) {
                showStatus('JSON è§£æé”™è¯¯: ' + e.message, 'error');
            }
        }

        // YAML è½¬ JSON
        function yamlToJson() {
            const yamlInput = document.getElementById('yamlInput').value.trim();
            if (!yamlInput) {
                showStatus('è¯·è¾“å…¥ YAML å†…å®¹', 'error');
                return;
            }

            try {
                const obj = jsyaml.load(yamlInput);
                const indent = parseInt(document.getElementById('indentSize').value) || 2;
                const sortKeys = document.getElementById('sortKeys').checked;

                let json;
                if (sortKeys) {
                    json = JSON.stringify(obj, Object.keys(obj).sort(), indent);
                } else {
                    json = JSON.stringify(obj, null, indent);
                }

                document.getElementById('jsonInput').value = json;
                updateStats('json');
                showStatus('YAML â†’ JSON è½¬æ¢æˆåŠŸ', 'success');
            } catch (e) {
                showStatus('YAML è§£æé”™è¯¯: ' + e.message, 'error');
            }
        }

        // æ ¼å¼åŒ– JSON
        function formatJSON() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            if (!jsonInput) return;

            try {
                const obj = JSON.parse(jsonInput);
                const indent = parseInt(document.getElementById('indentSize').value) || 2;
                document.getElementById('jsonInput').value = JSON.stringify(obj, null, indent);
                updateStats('json');
            } catch (e) {
                showStatus('JSON æ ¼å¼åŒ–é”™è¯¯: ' + e.message, 'error');
            }
        }

        // å‹ç¼© JSON
        function minifyJSON() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            if (!jsonInput) return;

            try {
                const obj = JSON.parse(jsonInput);
                document.getElementById('jsonInput').value = JSON.stringify(obj);
                updateStats('json');
            } catch (e) {
                showStatus('JSON å‹ç¼©é”™è¯¯: ' + e.message, 'error');
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats(type) {
            const textarea = document.getElementById(type + 'Input');
            const stats = document.getElementById(type + 'Stats');
            const valid = document.getElementById(type + 'Valid');
            const content = textarea.value;

            const chars = content.length;
            const lines = content ? content.split('\n').length : 0;
            stats.textContent = chars + ' å­—ç¬¦ | ' + lines + ' è¡Œ';

            // éªŒè¯æ ¼å¼
            if (content.trim()) {
                try {
                    if (type === 'json') {
                        JSON.parse(content);
                    } else {
                        jsyaml.load(content);
                    }
                    valid.textContent = 'âœ“ æœ‰æ•ˆ';
                    valid.style.color = 'var(--success)';
                } catch (e) {
                    valid.textContent = 'âœ— æ— æ•ˆ';
                    valid.style.color = 'var(--danger)';
                }
            } else {
                valid.textContent = '';
            }
        }

        // æ˜¾ç¤ºçŠ¶æ€
        function showStatus(message, type) {
            const bar = document.getElementById('statusBar');
            bar.textContent = message;
            bar.className = 'status-bar ' + type;
            setTimeout(() => {
                bar.className = 'status-bar';
            }, 3000);
        }

        // å¤åˆ¶æ–‡æœ¬
        function copyText(id) {
            const textarea = document.getElementById(id);
            navigator.clipboard.writeText(textarea.value).then(() => {
                showStatus('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            });
        }

        // æ¸…é™¤æ–‡æœ¬
        function clearText(id) {
            document.getElementById(id).value = '';
            updateStats(id.replace('Input', ''));
        }

        // ä¸‹è½½æ–‡ä»¶
        function downloadFile(type) {
            const content = document.getElementById(type + 'Input').value;
            if (!content) {
                showStatus('æ²¡æœ‰å†…å®¹å¯ä¸‹è½½', 'error');
                return;
            }

            const ext = type === 'json' ? '.json' : '.yaml';
            const mime = type === 'json' ? 'application/json' : 'text/yaml';
            const blob = new Blob([content], { type: mime });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'data' + ext;
            a.click();
            URL.revokeObjectURL(url);
        }

        // åˆå§‹åŒ–
        initTheme();
        loadSample('config');
    </script>
</body>
</html>
