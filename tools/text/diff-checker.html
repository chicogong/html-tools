<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æœ¬å¯¹æ¯”å·¥å…· - WebUtils</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg-primary: #0a0a0f; --bg-secondary: #12121a; --bg-tertiary: #1a1a25; --text-primary: #fff; --text-secondary: #88a; --accent: #6366f1; --border: #2a2a3a; --success: #22c55e; --danger: #ef4444; --add-bg: rgba(34, 197, 94, 0.15); --del-bg: rgba(239, 68, 68, 0.15); }
        [data-theme="light"] { --bg-primary: #f8fafc; --bg-secondary: #fff; --bg-tertiary: #f1f5f9; --text-primary: #1e293b; --text-secondary: #64748b; --border: #e2e8f0; --add-bg: rgba(34, 197, 94, 0.2); --del-bg: rgba(239, 68, 68, 0.2); }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }
        .header { background: linear-gradient(135deg, #14b8a6, #0ea5e9); padding: 1.5rem 2rem; }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 1.5rem; }
        .back-link { color: rgba(255,255,255,0.9); text-decoration: none; }
        .btn { padding: 0.5rem 1rem; border: none; border-radius: 0.5rem; cursor: pointer; font-size: 0.9rem; transition: all 0.2s; }
        .btn-ghost { background: rgba(255,255,255,0.2); color: white; }
        .container { max-width: 1400px; margin: 0 auto; padding: 1.5rem; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
        @media (max-width: 768px) { .input-grid { grid-template-columns: 1fr; } }
        .input-panel { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 0.75rem; overflow: hidden; }
        .panel-header { padding: 0.75rem 1rem; background: var(--bg-tertiary); border-bottom: 1px solid var(--border); font-size: 0.9rem; color: var(--text-secondary); }
        textarea { width: 100%; height: 200px; padding: 1rem; border: none; background: transparent; color: var(--text-primary); font-family: 'Fira Code', monospace; font-size: 0.9rem; line-height: 1.6; resize: vertical; outline: none; }
        .btn-compare { width: 100%; padding: 0.75rem; background: var(--accent); color: white; border: none; border-radius: 0.5rem; font-size: 1rem; cursor: pointer; transition: all 0.2s; }
        .btn-compare:hover { opacity: 0.9; }
        .stats { display: flex; gap: 1rem; margin: 1rem 0; flex-wrap: wrap; }
        .stat { padding: 0.5rem 1rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 0.5rem; font-size: 0.85rem; }
        .stat.add { border-color: var(--success); color: var(--success); }
        .stat.del { border-color: var(--danger); color: var(--danger); }
        .diff-output { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 0.75rem; overflow: hidden; }
        .diff-header { padding: 0.75rem 1rem; background: var(--bg-tertiary); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .diff-content { padding: 0; max-height: 500px; overflow: auto; }
        .diff-line { display: flex; font-family: 'Fira Code', monospace; font-size: 0.85rem; line-height: 1.6; }
        .diff-line:hover { background: var(--bg-tertiary); }
        .line-num { min-width: 50px; padding: 0 0.5rem; color: var(--text-secondary); text-align: right; background: var(--bg-tertiary); border-right: 1px solid var(--border); user-select: none; }
        .line-content { flex: 1; padding: 0 1rem; white-space: pre-wrap; word-break: break-all; }
        .diff-line.add { background: var(--add-bg); }
        .diff-line.add .line-content::before { content: '+ '; color: var(--success); }
        .diff-line.del { background: var(--del-bg); }
        .diff-line.del .line-content::before { content: '- '; color: var(--danger); }
        .diff-line.unchanged .line-content::before { content: '  '; }
        .view-toggle { display: flex; gap: 0.25rem; }
        .view-btn { padding: 0.25rem 0.75rem; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 0.25rem; color: var(--text-secondary); cursor: pointer; font-size: 0.8rem; }
        .view-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <a href="../../index.html" class="back-link">â† è¿”å›</a>
                <h1>ğŸ“Š æ–‡æœ¬å¯¹æ¯”å·¥å…·</h1>
            </div>
            <button class="btn btn-ghost" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
        </div>
    </div>
    <div class="container">
        <div class="input-grid">
            <div class="input-panel">
                <div class="panel-header">åŸå§‹æ–‡æœ¬</div>
                <textarea id="text1" placeholder="è¾“å…¥åŸå§‹æ–‡æœ¬...">Hello World
This is a test
Line three
Line four</textarea>
            </div>
            <div class="input-panel">
                <div class="panel-header">å¯¹æ¯”æ–‡æœ¬</div>
                <textarea id="text2" placeholder="è¾“å…¥å¯¹æ¯”æ–‡æœ¬...">Hello World!
This is a test
Line three modified
Line five</textarea>
            </div>
        </div>
        
        <button class="btn-compare" onclick="compare()">ğŸ” å¯¹æ¯”æ–‡æœ¬</button>
        
        <div class="stats" id="stats" style="display: none;"></div>
        
        <div class="diff-output" id="diffOutput" style="display: none;">
            <div class="diff-header">
                <span>å¯¹æ¯”ç»“æœ</span>
                <div class="view-toggle">
                    <button class="view-btn active" onclick="setView('unified')">ç»Ÿä¸€è§†å›¾</button>
                    <button class="view-btn" onclick="setView('split')">åˆ†æ è§†å›¾</button>
                </div>
            </div>
            <div class="diff-content" id="diffContent"></div>
        </div>
    </div>
    <script>
        let currentView = 'unified';
        let lastDiff = null;
        
        window.lcs = function(a, b) {
            const m = a.length, n = b.length;
            const dp = Array(m + 1).fill(null).map(() => Array(n + 1).fill(0));
            
            for (let i = 1; i <= m; i++) {
                for (let j = 1; j <= n; j++) {
                    if (a[i - 1] === b[j - 1]) {
                        dp[i][j] = dp[i - 1][j - 1] + 1;
                    } else {
                        dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);
                    }
                }
            }
            
            const result = [];
            let i = m, j = n;
            while (i > 0 && j > 0) {
                if (a[i - 1] === b[j - 1]) {
                    result.unshift({ type: 'unchanged', text: a[i - 1], lineA: i, lineB: j });
                    i--; j--;
                } else if (dp[i - 1][j] > dp[i][j - 1]) {
                    result.unshift({ type: 'del', text: a[i - 1], lineA: i });
                    i--;
                } else {
                    result.unshift({ type: 'add', text: b[j - 1], lineB: j });
                    j--;
                }
            }
            while (i > 0) {
                result.unshift({ type: 'del', text: a[i - 1], lineA: i });
                i--;
            }
            while (j > 0) {
                result.unshift({ type: 'add', text: b[j - 1], lineB: j });
                j--;
            }
            
            return result;
        };
        
        window.compare = function() {
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;
            
            const lines1 = text1.split('\n');
            const lines2 = text2.split('\n');
            
            lastDiff = lcs(lines1, lines2);
            
            const adds = lastDiff.filter(d => d.type === 'add').length;
            const dels = lastDiff.filter(d => d.type === 'del').length;
            const unchanged = lastDiff.filter(d => d.type === 'unchanged').length;
            
            document.getElementById('stats').style.display = 'flex';
            document.getElementById('stats').innerHTML = `
                <div class="stat add">+ ${adds} è¡Œæ·»åŠ </div>
                <div class="stat del">- ${dels} è¡Œåˆ é™¤</div>
                <div class="stat">${unchanged} è¡Œæœªå˜</div>
                <div class="stat">å…± ${lines1.length} â†’ ${lines2.length} è¡Œ</div>
            `;
            
            document.getElementById('diffOutput').style.display = 'block';
            renderDiff();
        };
        
        function renderDiff() {
            if (!lastDiff) return;
            
            const content = document.getElementById('diffContent');
            
            if (currentView === 'unified') {
                let lineNum = 0;
                content.innerHTML = lastDiff.map(d => {
                    if (d.type !== 'del') lineNum++;
                    const num = d.type === 'del' ? d.lineA : (d.type === 'add' ? d.lineB : d.lineA);
                    return `<div class="diff-line ${d.type}">
                        <span class="line-num">${num}</span>
                        <span class="line-content">${escapeHtml(d.text)}</span>
                    </div>`;
                }).join('');
            } else {
                // Split view - simplified
                let html = '<div style="display: grid; grid-template-columns: 1fr 1fr;">';
                html += '<div>' + lastDiff.filter(d => d.type !== 'add').map(d => 
                    `<div class="diff-line ${d.type === 'del' ? 'del' : ''}">
                        <span class="line-num">${d.lineA || ''}</span>
                        <span class="line-content">${escapeHtml(d.text)}</span>
                    </div>`
                ).join('') + '</div>';
                html += '<div>' + lastDiff.filter(d => d.type !== 'del').map(d => 
                    `<div class="diff-line ${d.type === 'add' ? 'add' : ''}">
                        <span class="line-num">${d.lineB || ''}</span>
                        <span class="line-content">${escapeHtml(d.text)}</span>
                    </div>`
                ).join('') + '</div>';
                html += '</div>';
                content.innerHTML = html;
            }
        }
        
        window.setView = function(view) {
            currentView = view;
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.view-btn:nth-child(${view === 'unified' ? 1 : 2})`).classList.add('active');
            renderDiff();
        };
        
        window.escapeHtml = function(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        };
        
        window.toggleTheme = function() {
            const t = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', t);
            localStorage.setItem('theme', t);
        };

        document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'dark');
    </script>
</body>
</html>
