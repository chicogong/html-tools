<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SVGä¼˜åŒ–å™¨ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="SVGä¼˜åŒ–å™¨ - WebUtils" />
    <meta name="keywords" content="svg-optimizer,dev,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/dev/svg-optimizer.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="SVGä¼˜åŒ–å™¨ - WebUtils" />
    <meta property="og:description" content="SVGä¼˜åŒ–å™¨ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/dev/svg-optimizer.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="SVGä¼˜åŒ–å™¨ - WebUtils" />
    <meta name="twitter:description" content="SVGä¼˜åŒ–å™¨ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      :root {
        --bg-primary: #0a0a0f;
        --bg-secondary: #12121a;
        --bg-tertiary: #1a1a25;
        --text-primary: #fff;
        --text-secondary: #88a;
        --accent: #6366f1;
        --border: #2a2a3a;
        --success: #22c55e;
      }
      [data-theme="light"] {
        --bg-primary: #f8fafc;
        --bg-secondary: #fff;
        --bg-tertiary: #f1f5f9;
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        --border: #e2e8f0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        min-height: 100vh;
      }
      .header {
        background: linear-gradient(135deg, #ec4899, #db2777);
        padding: 2rem;
        text-align: center;
      }
      .header h1 {
        font-size: 1.8rem;
        margin-bottom: 0.5rem;
      }
      .nav {
        display: flex;
        justify-content: space-between;
        max-width: 1200px;
        margin: 0 auto 1rem;
      }
      .back-link {
        color: rgba(255, 255, 255, 0.9);
        text-decoration: none;
      }
      .theme-toggle {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        color: white;
        cursor: pointer;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
      }
      .card {
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }
      .drop-zone {
        border: 2px dashed var(--border);
        border-radius: 0.75rem;
        padding: 3rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
      }
      .drop-zone:hover,
      .drop-zone.dragover {
        border-color: var(--accent);
        background: rgba(99, 102, 241, 0.1);
      }
      .drop-zone input {
        display: none;
      }
      .options {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
        margin: 1rem 0;
      }
      .option-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .option-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: var(--accent);
      }
      .editor-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
      }
      @media (max-width: 900px) {
        .editor-grid {
          grid-template-columns: 1fr;
        }
      }
      .editor-box {
        display: flex;
        flex-direction: column;
      }
      .editor-box h3 {
        margin-bottom: 0.75rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .stats {
        font-size: 0.85rem;
        color: var(--text-secondary);
        font-weight: normal;
      }
      .stats .saved {
        color: var(--success);
      }
      textarea {
        width: 100%;
        min-height: 300px;
        padding: 1rem;
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        background: var(--bg-tertiary);
        color: var(--text-primary);
        font-family: Monaco, Menlo, monospace;
        font-size: 0.85rem;
        resize: vertical;
      }
      .preview-box {
        background: var(--bg-tertiary);
        border-radius: 0.5rem;
        padding: 1rem;
        min-height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .preview-box svg {
        max-width: 100%;
        max-height: 300px;
      }
      .btn {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.2s;
      }
      .btn-primary {
        background: var(--accent);
        color: white;
      }
      .btn-success {
        background: var(--success);
        color: white;
      }
      .btn-secondary {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        border: 1px solid var(--border);
      }
      .btn-row {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin: 1rem 0;
        flex-wrap: wrap;
      }
      .toast {
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        background: var(--success);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        opacity: 0;
        transition: opacity 0.3s;
      }
      .toast.show {
        opacity: 1;
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      SVGä¼˜åŒ–å™¨
    </nav>
    <div class="header">
      <div class="nav">
        <a href="../../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
      </div>
      <h1>ğŸ¨ SVGä¼˜åŒ–å™¨</h1>
      <p>ä¼˜åŒ–å’Œå‹ç¼©SVGæ–‡ä»¶</p>
    </div>
    <div class="container">
      <div class="card">
        <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
          <input type="file" id="fileInput" accept=".svg" onchange="handleFile(this.files[0])" />
          <div style="font-size: 3rem">ğŸ“„</div>
          <p>ç‚¹å‡»é€‰æ‹©SVGæ–‡ä»¶æˆ–æ‹–æ”¾åˆ°æ­¤å¤„</p>
          <p style="font-size: 0.85rem; color: var(--text-secondary)">æˆ–ç›´æ¥åœ¨ä¸‹æ–¹ç²˜è´´SVGä»£ç </p>
        </div>
      </div>

      <div class="card">
        <h3 style="margin-bottom: 1rem">ä¼˜åŒ–é€‰é¡¹</h3>
        <div class="options">
          <div class="option-item">
            <input type="checkbox" id="removeComments" checked />
            <label for="removeComments">ç§»é™¤æ³¨é‡Š</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="removeMetadata" checked />
            <label for="removeMetadata">ç§»é™¤å…ƒæ•°æ®</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="removeEmptyAttrs" checked />
            <label for="removeEmptyAttrs">ç§»é™¤ç©ºå±æ€§</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="removeEmptyGroups" checked />
            <label for="removeEmptyGroups">ç§»é™¤ç©ºç»„</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="cleanupIds" />
            <label for="cleanupIds">ç®€åŒ–ID</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="removeDefaultAttrs" checked />
            <label for="removeDefaultAttrs">ç§»é™¤é»˜è®¤å±æ€§</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="prettify" />
            <label for="prettify">æ ¼å¼åŒ–è¾“å‡º</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="minify" checked />
            <label for="minify">å‹ç¼©è¾“å‡º</label>
          </div>
        </div>

        <div class="btn-row">
          <button class="btn btn-primary" onclick="optimize()">ğŸš€ ä¼˜åŒ–SVG</button>
        </div>
      </div>

      <div class="editor-grid">
        <div class="card editor-box">
          <h3>
            åŸå§‹SVG
            <span class="stats" id="inputStats">0 å­—èŠ‚</span>
          </h3>
          <textarea
            id="inputSvg"
            placeholder="ç²˜è´´SVGä»£ç ..."
            oninput="updatePreview('input')"
          ></textarea>
          <div class="preview-box" id="inputPreview">
            <span style="color: var(--text-secondary)">é¢„è§ˆåŒºåŸŸ</span>
          </div>
        </div>

        <div class="card editor-box">
          <h3>
            ä¼˜åŒ–åSVG
            <span class="stats" id="outputStats">
              0 å­—èŠ‚
              <span class="saved"></span>
            </span>
          </h3>
          <textarea id="outputSvg" placeholder="ä¼˜åŒ–åçš„SVGå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
          <div class="preview-box" id="outputPreview">
            <span style="color: var(--text-secondary)">é¢„è§ˆåŒºåŸŸ</span>
          </div>
          <div class="btn-row" style="margin-top: 1rem">
            <button class="btn btn-success" onclick="copySvg()">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <button class="btn btn-secondary" onclick="downloadSvg()">ğŸ’¾ ä¸‹è½½æ–‡ä»¶</button>
          </div>
        </div>
      </div>
    </div>

    <div class="toast" id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>

    <script>
      const dropZone = document.getElementById("dropZone");
      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });
      dropZone.addEventListener("dragleave", () => dropZone.classList.remove("dragover"));
      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
        handleFile(e.dataTransfer.files[0]);
      });

      function handleFile(file) {
        if (!file || !file.name.endsWith(".svg")) {
          alert("è¯·é€‰æ‹©SVGæ–‡ä»¶");
          return;
        }

        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById("inputSvg").value = e.target.result;
          updatePreview("input");
          updateStats();
        };
        reader.readAsText(file);
      }

      window.updatePreview = function (which) {
        const input = document.getElementById(which === "input" ? "inputSvg" : "outputSvg").value;
        const preview = document.getElementById(
          which === "input" ? "inputPreview" : "outputPreview"
        );

        if (input.trim().startsWith("<svg")) {
          preview.innerHTML = input;
        } else {
          preview.innerHTML = '<span style="color: var(--text-secondary);">æ— æ•ˆçš„SVG</span>';
        }

        if (which === "input") updateStats();
      };

      function updateStats() {
        const input = document.getElementById("inputSvg").value;
        const output = document.getElementById("outputSvg").value;

        const inputSize = new Blob([input]).size;
        const outputSize = new Blob([output]).size;

        document.getElementById("inputStats").textContent = formatSize(inputSize);

        if (output && inputSize > 0) {
          const saved = ((1 - outputSize / inputSize) * 100).toFixed(1);
          document.getElementById("outputStats").innerHTML =
            `${formatSize(outputSize)} <span class="saved">(èŠ‚çœ ${saved}%)</span>`;
        } else {
          document.getElementById("outputStats").textContent = "0 å­—èŠ‚";
        }
      }

      function formatSize(bytes) {
        if (bytes < 1024) return bytes + " å­—èŠ‚";
        return (bytes / 1024).toFixed(2) + " KB";
      }

      window.optimize = function () {
        let svg = document.getElementById("inputSvg").value;

        if (!svg.trim()) {
          alert("è¯·è¾“å…¥SVGä»£ç ");
          return;
        }

        const options = {
          removeComments: document.getElementById("removeComments").checked,
          removeMetadata: document.getElementById("removeMetadata").checked,
          removeEmptyAttrs: document.getElementById("removeEmptyAttrs").checked,
          removeEmptyGroups: document.getElementById("removeEmptyGroups").checked,
          cleanupIds: document.getElementById("cleanupIds").checked,
          removeDefaultAttrs: document.getElementById("removeDefaultAttrs").checked,
          prettify: document.getElementById("prettify").checked,
          minify: document.getElementById("minify").checked
        };

        try {
          svg = optimizeSvg(svg, options);
          document.getElementById("outputSvg").value = svg;
          updatePreview("output");
          updateStats();
        } catch (e) {
          alert("ä¼˜åŒ–å¤±è´¥: " + e.message);
        }
      };

      function optimizeSvg(svg, options) {
        // Remove XML declaration
        svg = svg.replace(/<\?xml[^?]*\?>/gi, "");

        // Remove comments
        if (options.removeComments) {
          svg = svg.replace(/<!--[\s\S]*?-->/g, "");
        }

        // Remove metadata
        if (options.removeMetadata) {
          svg = svg.replace(/<metadata[\s\S]*?<\/metadata>/gi, "");
          svg = svg.replace(/<title[\s\S]*?<\/title>/gi, "");
          svg = svg.replace(/<desc[\s\S]*?<\/desc>/gi, "");
        }

        // Remove editor-specific attributes
        const editorAttrs = [
          "xmlns:sodipodi",
          "xmlns:inkscape",
          "sodipodi:docname",
          "inkscape:version",
          "inkscape:export-filename",
          "inkscape:export-xdpi",
          "inkscape:export-ydpi",
          "data-name",
          "sketch:type"
        ];
        editorAttrs.forEach((attr) => {
          const regex = new RegExp(`\\s*${attr}="[^"]*"`, "gi");
          svg = svg.replace(regex, "");
        });

        // Remove empty attributes
        if (options.removeEmptyAttrs) {
          svg = svg.replace(/\s+[a-zA-Z-]+=""/g, "");
        }

        // Remove default attributes
        if (options.removeDefaultAttrs) {
          svg = svg.replace(/\s+fill-opacity="1"/g, "");
          svg = svg.replace(/\s+stroke-opacity="1"/g, "");
          svg = svg.replace(/\s+opacity="1"/g, "");
          svg = svg.replace(/\s+fill-rule="nonzero"/g, "");
        }

        // Remove empty groups
        if (options.removeEmptyGroups) {
          svg = svg.replace(/<g[^>]*>\s*<\/g>/gi, "");
        }

        // Simplify IDs
        if (options.cleanupIds) {
          let idCounter = 0;
          const idMap = new Map();

          svg = svg.replace(/\bid="([^"]+)"/g, (match, id) => {
            if (!idMap.has(id)) {
              idMap.set(id, "a" + idCounter++);
            }
            return `id="${idMap.get(id)}"`;
          });

          // Update references
          idMap.forEach((newId, oldId) => {
            svg = svg.replace(new RegExp(`#${oldId}(?=[^a-zA-Z0-9])`, "g"), "#" + newId);
            svg = svg.replace(new RegExp(`url\\(#${oldId}\\)`, "g"), `url(#${newId})`);
          });
        }

        // Minify or prettify
        if (options.minify && !options.prettify) {
          // Remove whitespace between tags
          svg = svg.replace(/>\s+</g, "><");
          // Remove extra whitespace
          svg = svg.replace(/\s+/g, " ");
          // Remove whitespace around =
          svg = svg.replace(/\s*=\s*/g, "=");
          svg = svg.trim();
        } else if (options.prettify) {
          // Simple prettify
          svg = svg.replace(/>\s*</g, ">\n<");
          const lines = svg.split("\n");
          let indent = 0;
          svg = lines
            .map((line) => {
              line = line.trim();
              if (line.startsWith("</")) indent--;
              const result = "  ".repeat(Math.max(0, indent)) + line;
              if (
                line.startsWith("<") &&
                !line.startsWith("</") &&
                !line.endsWith("/>") &&
                !line.includes("</")
              ) {
                indent++;
              }
              return result;
            })
            .join("\n");
        }

        return svg;
      }

      window.copySvg = function () {
        const output = document.getElementById("outputSvg").value;
        if (!output) {
          alert("æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹");
          return;
        }
        navigator.clipboard.writeText(output);
        showToast();
      };

      window.downloadSvg = function () {
        const output = document.getElementById("outputSvg").value;
        if (!output) {
          alert("æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹");
          return;
        }

        const blob = new Blob([output], { type: "image/svg+xml" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "optimized.svg";
        link.click();
      };

      function showToast() {
        const toast = document.getElementById("toast");
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2000);
      }

      window.toggleTheme = function () {
        const t = document.body.getAttribute("data-theme") === "light" ? "dark" : "light";
        document.body.setAttribute("data-theme", t);
        localStorage.setItem("theme", t);
      };
      document.body.setAttribute("data-theme", localStorage.getItem("theme") || "dark");
    </script>
  </body>
</html>
