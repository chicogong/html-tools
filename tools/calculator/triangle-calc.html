<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰è§’å‡½æ•°è®¡ç®—å™¨</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        body { min-height: 100vh; padding: 2rem 1rem; }
        .container { max-width: 800px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .tabs { display: flex; gap: 0.5rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .tabs button { flex: 1; min-width: 120px; }
        .tabs button.active { background: var(--pico-primary); color: var(--pico-primary-inverse); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .result-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem; }
        .result-card { background: var(--pico-muted-border-color); border-radius: var(--pico-border-radius); padding: 1rem; text-align: center; }
        .result-card h5 { margin: 0 0 0.5rem 0; font-size: 0.9rem; }
        .result-card .value { font-size: 1.3rem; font-weight: bold; font-family: monospace; }
        .unit-circle { width: 300px; height: 300px; margin: 2rem auto; position: relative; }
        .unit-circle svg { width: 100%; height: 100%; }
        .formula-table { margin-top: 2rem; }
        .formula-table td { font-family: monospace; }
        .input-row { display: flex; gap: 1rem; align-items: end; flex-wrap: wrap; }
        .input-row > div { flex: 1; min-width: 150px; }
    </style>
</head>
<body>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä¸‰è§’å‡½æ•°è®¡ç®—å™¨</h1>
            <button id="themeToggle" class="outline" onclick="toggleTheme()">ğŸŒ™</button>
        </header>

        <div class="tabs">
            <button class="active" onclick="showTab('basic')">åŸºæœ¬è®¡ç®—</button>
            <button onclick="showTab('inverse')">åä¸‰è§’å‡½æ•°</button>
            <button onclick="showTab('triangle')">ä¸‰è§’å½¢æ±‚è§£</button>
            <button onclick="showTab('identity')">æ’ç­‰å¼</button>
        </div>

        <div id="basic" class="tab-content active">
            <h3>ä¸‰è§’å‡½æ•°è®¡ç®—</h3>
            <div class="input-row">
                <div>
                    <label>è§’åº¦å€¼</label>
                    <input type="number" id="angleInput" value="45" step="any">
                </div>
                <div>
                    <label>å•ä½</label>
                    <select id="angleUnit">
                        <option value="deg">åº¦ (Â°)</option>
                        <option value="rad">å¼§åº¦ (rad)</option>
                    </select>
                </div>
                <button onclick="calculateTrig()">è®¡ç®—</button>
            </div>

            <div class="result-grid" id="trigResults">
                <div class="result-card"><h5>sin Î¸</h5><div class="value" id="sinVal">-</div></div>
                <div class="result-card"><h5>cos Î¸</h5><div class="value" id="cosVal">-</div></div>
                <div class="result-card"><h5>tan Î¸</h5><div class="value" id="tanVal">-</div></div>
                <div class="result-card"><h5>csc Î¸</h5><div class="value" id="cscVal">-</div></div>
                <div class="result-card"><h5>sec Î¸</h5><div class="value" id="secVal">-</div></div>
                <div class="result-card"><h5>cot Î¸</h5><div class="value" id="cotVal">-</div></div>
            </div>

            <div class="unit-circle" id="unitCircle">
                <svg viewBox="-1.5 -1.5 3 3">
                    <circle cx="0" cy="0" r="1" fill="none" stroke="currentColor" stroke-width="0.02"/>
                    <line x1="-1.3" y1="0" x2="1.3" y2="0" stroke="currentColor" stroke-width="0.01"/>
                    <line x1="0" y1="-1.3" x2="0" y2="1.3" stroke="currentColor" stroke-width="0.01"/>
                    <line id="angleLine" x1="0" y1="0" x2="0.707" y2="-0.707" stroke="var(--pico-primary)" stroke-width="0.03"/>
                    <circle id="anglePoint" cx="0.707" cy="-0.707" r="0.05" fill="var(--pico-primary)"/>
                    <line id="sinLine" x1="0.707" y1="0" x2="0.707" y2="-0.707" stroke="red" stroke-width="0.02" stroke-dasharray="0.05"/>
                    <line id="cosLine" x1="0" y1="-0.707" x2="0.707" y2="-0.707" stroke="blue" stroke-width="0.02" stroke-dasharray="0.05"/>
                </svg>
                <div style="text-align: center; margin-top: 0.5rem;">
                    <span style="color: red;">â” sin</span> &nbsp;
                    <span style="color: blue;">â” cos</span>
                </div>
            </div>
        </div>

        <div id="inverse" class="tab-content">
            <h3>åä¸‰è§’å‡½æ•°</h3>
            <div class="input-row">
                <div>
                    <label>æ•°å€¼</label>
                    <input type="number" id="inverseInput" value="0.5" step="any">
                </div>
                <div>
                    <label>å‡½æ•°</label>
                    <select id="inverseFunc">
                        <option value="asin">arcsin (åæ­£å¼¦)</option>
                        <option value="acos">arccos (åä½™å¼¦)</option>
                        <option value="atan">arctan (åæ­£åˆ‡)</option>
                    </select>
                </div>
                <button onclick="calculateInverse()">è®¡ç®—</button>
            </div>
            <div class="result-grid" id="inverseResults">
                <div class="result-card"><h5>è§’åº¦ (Â°)</h5><div class="value" id="invDeg">-</div></div>
                <div class="result-card"><h5>å¼§åº¦ (rad)</h5><div class="value" id="invRad">-</div></div>
            </div>
        </div>

        <div id="triangle" class="tab-content">
            <h3>ä¸‰è§’å½¢æ±‚è§£</h3>
            <p>å·²çŸ¥ä¸‰è¾¹é•¿ï¼Œæ±‚å„è§’ï¼ˆä½™å¼¦å®šç†ï¼‰</p>
            <div class="input-row">
                <div><label>è¾¹ a</label><input type="number" id="sideA" value="3" step="any"></div>
                <div><label>è¾¹ b</label><input type="number" id="sideB" value="4" step="any"></div>
                <div><label>è¾¹ c</label><input type="number" id="sideC" value="5" step="any"></div>
                <button onclick="solveTriangle()">æ±‚è§£</button>
            </div>
            <div class="result-grid" id="triangleResults">
                <div class="result-card"><h5>è§’ A (Â°)</h5><div class="value" id="angleA">-</div></div>
                <div class="result-card"><h5>è§’ B (Â°)</h5><div class="value" id="angleB">-</div></div>
                <div class="result-card"><h5>è§’ C (Â°)</h5><div class="value" id="angleC">-</div></div>
                <div class="result-card"><h5>é¢ç§¯</h5><div class="value" id="area">-</div></div>
                <div class="result-card"><h5>å‘¨é•¿</h5><div class="value" id="perimeter">-</div></div>
                <div class="result-card"><h5>å¤–æ¥åœ†åŠå¾„</h5><div class="value" id="circumR">-</div></div>
            </div>
        </div>

        <div id="identity" class="tab-content">
            <h3>ä¸‰è§’æ’ç­‰å¼</h3>
            <table class="formula-table">
                <tr><th colspan="2">åŸºæœ¬æ’ç­‰å¼</th></tr>
                <tr><td>sinÂ²Î¸ + cosÂ²Î¸ = 1</td><td>1 + tanÂ²Î¸ = secÂ²Î¸</td></tr>
                <tr><td>1 + cotÂ²Î¸ = cscÂ²Î¸</td><td>tan Î¸ = sin Î¸ / cos Î¸</td></tr>
                <tr><th colspan="2">å’Œå·®å…¬å¼</th></tr>
                <tr><td>sin(AÂ±B) = sinAÂ·cosB Â± cosAÂ·sinB</td><td></td></tr>
                <tr><td>cos(AÂ±B) = cosAÂ·cosB âˆ“ sinAÂ·sinB</td><td></td></tr>
                <tr><td>tan(AÂ±B) = (tanA Â± tanB)/(1 âˆ“ tanAÂ·tanB)</td><td></td></tr>
                <tr><th colspan="2">å€è§’å…¬å¼</th></tr>
                <tr><td>sin 2Î¸ = 2 sin Î¸ cos Î¸</td><td></td></tr>
                <tr><td>cos 2Î¸ = cosÂ²Î¸ - sinÂ²Î¸ = 2cosÂ²Î¸ - 1</td><td></td></tr>
                <tr><td>tan 2Î¸ = 2tan Î¸ / (1 - tanÂ²Î¸)</td><td></td></tr>
                <tr><th colspan="2">åŠè§’å…¬å¼</th></tr>
                <tr><td>sin(Î¸/2) = Â±âˆš[(1 - cos Î¸)/2]</td><td></td></tr>
                <tr><td>cos(Î¸/2) = Â±âˆš[(1 + cos Î¸)/2]</td><td></td></tr>
            </table>
        </div>

        <article style="margin-top: 2rem;">
            <h4>ä½¿ç”¨è¯´æ˜</h4>
            <ul>
                <li><strong>åŸºæœ¬è®¡ç®—</strong>ï¼šè¾“å…¥è§’åº¦è®¡ç®—å…­ä¸ªä¸‰è§’å‡½æ•°å€¼</li>
                <li><strong>åä¸‰è§’å‡½æ•°</strong>ï¼šæ ¹æ®å‡½æ•°å€¼æ±‚è§’åº¦</li>
                <li><strong>ä¸‰è§’å½¢æ±‚è§£</strong>ï¼šå·²çŸ¥ä¸‰è¾¹æ±‚ä¸‰è§’å’Œé¢ç§¯</li>
            </ul>
        </article>
    </main>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const newTheme = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            document.getElementById('themeToggle').textContent = newTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', newTheme);
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('themeToggle').textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function toRadians(deg) { return deg * Math.PI / 180; }
        function toDegrees(rad) { return rad * 180 / Math.PI; }
        function format(num) { return Number.isFinite(num) ? (Math.abs(num) < 1e-10 ? 0 : num.toFixed(6)) : 'æ— å®šä¹‰'; }

        function calculateTrig() {
            let angle = parseFloat(document.getElementById('angleInput').value);
            const unit = document.getElementById('angleUnit').value;
            if (unit === 'deg') angle = toRadians(angle);

            const sin = Math.sin(angle);
            const cos = Math.cos(angle);
            const tan = Math.tan(angle);

            document.getElementById('sinVal').textContent = format(sin);
            document.getElementById('cosVal').textContent = format(cos);
            document.getElementById('tanVal').textContent = format(tan);
            document.getElementById('cscVal').textContent = format(1 / sin);
            document.getElementById('secVal').textContent = format(1 / cos);
            document.getElementById('cotVal').textContent = format(1 / tan);

            // Update unit circle
            const x = cos;
            const y = -sin; // SVG y is inverted
            document.getElementById('angleLine').setAttribute('x2', x);
            document.getElementById('angleLine').setAttribute('y2', y);
            document.getElementById('anglePoint').setAttribute('cx', x);
            document.getElementById('anglePoint').setAttribute('cy', y);
            document.getElementById('sinLine').setAttribute('x1', x);
            document.getElementById('sinLine').setAttribute('x2', x);
            document.getElementById('sinLine').setAttribute('y1', 0);
            document.getElementById('sinLine').setAttribute('y2', y);
            document.getElementById('cosLine').setAttribute('x1', 0);
            document.getElementById('cosLine').setAttribute('x2', x);
            document.getElementById('cosLine').setAttribute('y1', y);
            document.getElementById('cosLine').setAttribute('y2', y);
        }

        function calculateInverse() {
            const val = parseFloat(document.getElementById('inverseInput').value);
            const func = document.getElementById('inverseFunc').value;
            
            let result;
            switch (func) {
                case 'asin': result = Math.asin(val); break;
                case 'acos': result = Math.acos(val); break;
                case 'atan': result = Math.atan(val); break;
            }

            document.getElementById('invRad').textContent = format(result);
            document.getElementById('invDeg').textContent = format(toDegrees(result));
        }

        function solveTriangle() {
            const a = parseFloat(document.getElementById('sideA').value);
            const b = parseFloat(document.getElementById('sideB').value);
            const c = parseFloat(document.getElementById('sideC').value);

            // Check triangle inequality
            if (a + b <= c || b + c <= a || a + c <= b) {
                alert('è¿™ä¸‰è¾¹æ— æ³•æ„æˆä¸‰è§’å½¢');
                return;
            }

            // Law of cosines
            const A = Math.acos((b*b + c*c - a*a) / (2*b*c));
            const B = Math.acos((a*a + c*c - b*b) / (2*a*c));
            const C = Math.PI - A - B;

            // Heron's formula for area
            const s = (a + b + c) / 2;
            const area = Math.sqrt(s * (s-a) * (s-b) * (s-c));

            // Circumradius
            const R = a / (2 * Math.sin(A));

            document.getElementById('angleA').textContent = format(toDegrees(A));
            document.getElementById('angleB').textContent = format(toDegrees(B));
            document.getElementById('angleC').textContent = format(toDegrees(C));
            document.getElementById('area').textContent = format(area);
            document.getElementById('perimeter').textContent = format(a + b + c);
            document.getElementById('circumR').textContent = format(R);
        }

        loadTheme();
        calculateTrig();
    </script>
</body>
</html>
