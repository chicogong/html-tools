<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简历生成器</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --preview-bg: #f8f9fa;
        }
        [data-theme="dark"] {
            --preview-bg: #1a1a2e;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        .form-section {
            background: var(--pico-card-background-color);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        .form-section h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--pico-primary);
            padding-bottom: 0.5rem;
        }
        .preview-section {
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow: auto;
        }
        .resume-preview {
            background: var(--preview-bg);
            padding: 2rem;
            border-radius: 8px;
            min-height: 600px;
        }
        .resume-preview h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }
        .resume-preview .contact-info {
            color: var(--pico-muted-color);
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
        }
        .resume-preview .section {
            margin-bottom: 1.5rem;
        }
        .resume-preview .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            border-bottom: 1px solid var(--pico-muted-border-color);
            padding-bottom: 0.3rem;
            margin-bottom: 0.8rem;
            color: var(--pico-primary);
        }
        .experience-item, .education-item {
            margin-bottom: 1rem;
        }
        .experience-item h4, .education-item h4 {
            margin: 0;
            font-size: 1rem;
        }
        .experience-item .meta, .education-item .meta {
            color: var(--pico-muted-color);
            font-size: 0.85rem;
            margin-bottom: 0.3rem;
        }
        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .skill-tag {
            background: var(--pico-primary);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        .entry-list {
            margin-bottom: 1rem;
        }
        .entry-item {
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }
        .entry-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .entry-item-title {
            font-weight: bold;
        }
        .btn-group {
            display: flex;
            gap: 0.5rem;
        }
        .btn-small {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        .template-select {
            margin-bottom: 1rem;
        }

        /* Template styles */
        .template-modern .section-title {
            color: #2563eb;
        }
        .template-modern .skill-tag {
            background: #2563eb;
        }
        .template-classic .section-title {
            color: #374151;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .template-classic .skill-tag {
            background: #374151;
        }
        .template-creative .section-title {
            color: #7c3aed;
            font-style: italic;
        }
        .template-creative .skill-tag {
            background: linear-gradient(45deg, #7c3aed, #ec4899);
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">← 返回首页</a>
        <header>
            <h1>简历生成器</h1>
            <button id="themeToggle" class="outline">切换主题</button>
        </header>

        <div class="main-content">
            <div class="form-panel">
                <!-- 模板选择 -->
                <div class="form-section template-select">
                    <label for="template">选择模板</label>
                    <select id="template">
                        <option value="modern">现代简约</option>
                        <option value="classic">经典传统</option>
                        <option value="creative">创意风格</option>
                    </select>
                </div>

                <!-- 基本信息 -->
                <div class="form-section">
                    <h3>基本信息</h3>
                    <div class="grid">
                        <label>
                            姓名
                            <input type="text" id="name" placeholder="您的姓名">
                        </label>
                        <label>
                            职位
                            <input type="text" id="title" placeholder="目标职位">
                        </label>
                    </div>
                    <div class="grid">
                        <label>
                            邮箱
                            <input type="email" id="email" placeholder="your@email.com">
                        </label>
                        <label>
                            电话
                            <input type="tel" id="phone" placeholder="手机号码">
                        </label>
                    </div>
                    <label>
                        地址
                        <input type="text" id="location" placeholder="所在城市">
                    </label>
                </div>

                <!-- 个人简介 -->
                <div class="form-section">
                    <h3>个人简介</h3>
                    <textarea id="summary" rows="4" placeholder="简要介绍您的专业背景、核心技能和职业目标..."></textarea>
                </div>

                <!-- 工作经历 -->
                <div class="form-section">
                    <h3>工作经历</h3>
                    <div id="experienceList" class="entry-list"></div>
                    <details>
                        <summary>添加工作经历</summary>
                        <div class="grid">
                            <label>
                                公司名称
                                <input type="text" id="expCompany" placeholder="公司名称">
                            </label>
                            <label>
                                职位
                                <input type="text" id="expPosition" placeholder="职位名称">
                            </label>
                        </div>
                        <div class="grid">
                            <label>
                                开始时间
                                <input type="month" id="expStart">
                            </label>
                            <label>
                                结束时间
                                <input type="month" id="expEnd">
                            </label>
                        </div>
                        <label>
                            <input type="checkbox" id="expCurrent"> 至今
                        </label>
                        <label>
                            工作描述
                            <textarea id="expDescription" rows="3" placeholder="描述您的主要职责和成就..."></textarea>
                        </label>
                        <button type="button" id="addExpBtn">添加</button>
                    </details>
                </div>

                <!-- 教育背景 -->
                <div class="form-section">
                    <h3>教育背景</h3>
                    <div id="educationList" class="entry-list"></div>
                    <details>
                        <summary>添加教育经历</summary>
                        <div class="grid">
                            <label>
                                学校名称
                                <input type="text" id="eduSchool" placeholder="学校名称">
                            </label>
                            <label>
                                学历/学位
                                <input type="text" id="eduDegree" placeholder="如：本科/学士">
                            </label>
                        </div>
                        <div class="grid">
                            <label>
                                专业
                                <input type="text" id="eduMajor" placeholder="专业名称">
                            </label>
                            <label>
                                毕业时间
                                <input type="month" id="eduDate">
                            </label>
                        </div>
                        <button type="button" id="addEduBtn">添加</button>
                    </details>
                </div>

                <!-- 技能 -->
                <div class="form-section">
                    <h3>专业技能</h3>
                    <label>
                        技能（用逗号分隔）
                        <input type="text" id="skills" placeholder="如：JavaScript, Python, 项目管理">
                    </label>
                </div>

                <!-- 操作按钮 -->
                <div class="action-buttons">
                    <button id="exportPdfBtn">导出PDF</button>
                    <button id="exportHtmlBtn" class="secondary">导出HTML</button>
                    <button id="saveDataBtn" class="outline">保存数据</button>
                    <button id="loadDataBtn" class="outline">加载数据</button>
                </div>
            </div>

            <div class="preview-section">
                <h2>预览</h2>
                <div id="resumePreview" class="resume-preview template-modern">
                    <p style="color: var(--pico-muted-color); text-align: center; margin-top: 200px;">
                        在左侧填写信息，预览将实时更新
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 数据存储
        let resumeData = {
            name: '',
            title: '',
            email: '',
            phone: '',
            location: '',
            summary: '',
            experiences: [],
            education: [],
            skills: []
        };

        // 辅助函数：转义HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // 主题切换
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        // 加载保存的主题
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        // 模板切换
        document.getElementById('template').addEventListener('change', (e) => {
            const preview = document.getElementById('resumePreview');
            preview.className = 'resume-preview template-' + e.target.value;
        });

        // 输入监听
        const inputs = ['name', 'title', 'email', 'phone', 'location', 'summary', 'skills'];
        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', updatePreview);
        });

        // 添加工作经历
        document.getElementById('addExpBtn').addEventListener('click', function() {
            const company = document.getElementById('expCompany').value;
            const position = document.getElementById('expPosition').value;
            const start = document.getElementById('expStart').value;
            const end = document.getElementById('expCurrent').checked ? '至今' : document.getElementById('expEnd').value;
            const description = document.getElementById('expDescription').value;

            if (!company || !position) {
                alert('请填写公司名称和职位');
                return;
            }

            resumeData.experiences.push({ company, position, start, end, description });
            renderExperienceList();
            updatePreview();

            // 清空输入
            document.getElementById('expCompany').value = '';
            document.getElementById('expPosition').value = '';
            document.getElementById('expStart').value = '';
            document.getElementById('expEnd').value = '';
            document.getElementById('expCurrent').checked = false;
            document.getElementById('expDescription').value = '';
        });

        // 渲染工作经历列表
        function renderExperienceList() {
            const list = document.getElementById('experienceList');
            list.replaceChildren();
            
            resumeData.experiences.forEach((exp, index) => {
                const item = document.createElement('div');
                item.className = 'entry-item';
                
                const header = document.createElement('div');
                header.className = 'entry-item-header';
                
                const titleSpan = document.createElement('span');
                titleSpan.className = 'entry-item-title';
                titleSpan.textContent = exp.company + ' - ' + exp.position;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-small outline';
                deleteBtn.textContent = '删除';
                deleteBtn.addEventListener('click', () => removeExperience(index));
                
                header.appendChild(titleSpan);
                header.appendChild(deleteBtn);
                
                const dateInfo = document.createElement('small');
                dateInfo.textContent = formatDate(exp.start) + ' - ' + (exp.end === '至今' ? '至今' : formatDate(exp.end));
                
                item.appendChild(header);
                item.appendChild(dateInfo);
                list.appendChild(item);
            });
        }

        // 删除工作经历
        function removeExperience(index) {
            resumeData.experiences.splice(index, 1);
            renderExperienceList();
            updatePreview();
        }

        // 添加教育经历
        document.getElementById('addEduBtn').addEventListener('click', function() {
            const school = document.getElementById('eduSchool').value;
            const degree = document.getElementById('eduDegree').value;
            const major = document.getElementById('eduMajor').value;
            const date = document.getElementById('eduDate').value;

            if (!school || !degree) {
                alert('请填写学校名称和学历');
                return;
            }

            resumeData.education.push({ school, degree, major, date });
            renderEducationList();
            updatePreview();

            // 清空输入
            document.getElementById('eduSchool').value = '';
            document.getElementById('eduDegree').value = '';
            document.getElementById('eduMajor').value = '';
            document.getElementById('eduDate').value = '';
        });

        // 渲染教育经历列表
        function renderEducationList() {
            const list = document.getElementById('educationList');
            list.replaceChildren();
            
            resumeData.education.forEach((edu, index) => {
                const item = document.createElement('div');
                item.className = 'entry-item';
                
                const header = document.createElement('div');
                header.className = 'entry-item-header';
                
                const titleSpan = document.createElement('span');
                titleSpan.className = 'entry-item-title';
                titleSpan.textContent = edu.school + ' - ' + edu.degree;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-small outline';
                deleteBtn.textContent = '删除';
                deleteBtn.addEventListener('click', () => removeEducation(index));
                
                header.appendChild(titleSpan);
                header.appendChild(deleteBtn);
                
                const dateInfo = document.createElement('small');
                dateInfo.textContent = edu.major + ' | ' + formatDate(edu.date);
                
                item.appendChild(header);
                item.appendChild(dateInfo);
                list.appendChild(item);
            });
        }

        // 删除教育经历
        function removeEducation(index) {
            resumeData.education.splice(index, 1);
            renderEducationList();
            updatePreview();
        }

        // 格式化日期
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const [year, month] = dateStr.split('-');
            return year + '年' + month + '月';
        }

        // 更新预览
        function updatePreview() {
            const name = document.getElementById('name').value;
            const title = document.getElementById('title').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const location = document.getElementById('location').value;
            const summary = document.getElementById('summary').value;
            const skillsStr = document.getElementById('skills').value;
            const skills = skillsStr ? skillsStr.split(',').map(s => s.trim()).filter(s => s) : [];

            resumeData = { ...resumeData, name, title, email, phone, location, summary, skills };

            const preview = document.getElementById('resumePreview');
            preview.replaceChildren();
            
            if (!name && !title && !email && resumeData.experiences.length === 0) {
                const placeholder = document.createElement('p');
                placeholder.style.cssText = 'color: var(--pico-muted-color); text-align: center; margin-top: 200px;';
                placeholder.textContent = '在左侧填写信息，预览将实时更新';
                preview.appendChild(placeholder);
                return;
            }

            // 头部信息
            if (name) {
                const h1 = document.createElement('h1');
                h1.textContent = name;
                preview.appendChild(h1);
            }
            
            if (title) {
                const titleP = document.createElement('p');
                titleP.style.cssText = 'font-size: 1.2rem; margin-bottom: 0.5rem;';
                titleP.textContent = title;
                preview.appendChild(titleP);
            }
            
            const contactParts = [];
            if (email) contactParts.push(email);
            if (phone) contactParts.push(phone);
            if (location) contactParts.push(location);
            if (contactParts.length > 0) {
                const contactP = document.createElement('p');
                contactP.className = 'contact-info';
                contactP.textContent = contactParts.join(' | ');
                preview.appendChild(contactP);
            }

            // 个人简介
            if (summary) {
                const section = document.createElement('div');
                section.className = 'section';
                
                const sectionTitle = document.createElement('div');
                sectionTitle.className = 'section-title';
                sectionTitle.textContent = '个人简介';
                
                const summaryP = document.createElement('p');
                summaryP.textContent = summary;
                
                section.appendChild(sectionTitle);
                section.appendChild(summaryP);
                preview.appendChild(section);
            }

            // 工作经历
            if (resumeData.experiences.length > 0) {
                const section = document.createElement('div');
                section.className = 'section';
                
                const sectionTitle = document.createElement('div');
                sectionTitle.className = 'section-title';
                sectionTitle.textContent = '工作经历';
                section.appendChild(sectionTitle);
                
                resumeData.experiences.forEach(exp => {
                    const item = document.createElement('div');
                    item.className = 'experience-item';
                    
                    const h4 = document.createElement('h4');
                    h4.textContent = exp.position;
                    
                    const meta = document.createElement('div');
                    meta.className = 'meta';
                    meta.textContent = exp.company + ' | ' + formatDate(exp.start) + ' - ' + (exp.end === '至今' ? '至今' : formatDate(exp.end));
                    
                    const desc = document.createElement('p');
                    desc.textContent = exp.description;
                    
                    item.appendChild(h4);
                    item.appendChild(meta);
                    item.appendChild(desc);
                    section.appendChild(item);
                });
                
                preview.appendChild(section);
            }

            // 教育背景
            if (resumeData.education.length > 0) {
                const section = document.createElement('div');
                section.className = 'section';
                
                const sectionTitle = document.createElement('div');
                sectionTitle.className = 'section-title';
                sectionTitle.textContent = '教育背景';
                section.appendChild(sectionTitle);
                
                resumeData.education.forEach(edu => {
                    const item = document.createElement('div');
                    item.className = 'education-item';
                    
                    const h4 = document.createElement('h4');
                    h4.textContent = edu.school;
                    
                    const meta = document.createElement('div');
                    meta.className = 'meta';
                    meta.textContent = edu.degree + ' - ' + edu.major + ' | ' + formatDate(edu.date);
                    
                    item.appendChild(h4);
                    item.appendChild(meta);
                    section.appendChild(item);
                });
                
                preview.appendChild(section);
            }

            // 技能
            if (skills.length > 0) {
                const section = document.createElement('div');
                section.className = 'section';
                
                const sectionTitle = document.createElement('div');
                sectionTitle.className = 'section-title';
                sectionTitle.textContent = '专业技能';
                section.appendChild(sectionTitle);
                
                const skillTags = document.createElement('div');
                skillTags.className = 'skill-tags';
                
                skills.forEach(skill => {
                    const tag = document.createElement('span');
                    tag.className = 'skill-tag';
                    tag.textContent = skill;
                    skillTags.appendChild(tag);
                });
                
                section.appendChild(skillTags);
                preview.appendChild(section);
            }
        }

        // 导出PDF
        document.getElementById('exportPdfBtn').addEventListener('click', function() {
            window.print();
        });

        // 导出HTML
        document.getElementById('exportHtmlBtn').addEventListener('click', function() {
            const template = document.getElementById('template').value;
            const templateColor = template === 'modern' ? '#2563eb' : template === 'creative' ? '#7c3aed' : '#374151';
            
            let htmlContent = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>' + escapeHtml(resumeData.name) + '的简历</title>';
            htmlContent += '<style>';
            htmlContent += 'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; max-width: 800px; margin: 0 auto; padding: 2rem; }';
            htmlContent += 'h1 { margin-bottom: 0.5rem; }';
            htmlContent += '.contact-info { color: #666; margin-bottom: 1.5rem; }';
            htmlContent += '.section { margin-bottom: 1.5rem; }';
            htmlContent += '.section-title { font-weight: bold; border-bottom: 1px solid #ddd; padding-bottom: 0.3rem; margin-bottom: 0.8rem; color: ' + templateColor + '; }';
            htmlContent += '.experience-item, .education-item { margin-bottom: 1rem; }';
            htmlContent += '.experience-item h4, .education-item h4 { margin: 0; }';
            htmlContent += '.meta { color: #666; font-size: 0.85rem; }';
            htmlContent += '.skill-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; }';
            htmlContent += '.skill-tag { background: ' + templateColor + '; color: white; padding: 0.2rem 0.6rem; border-radius: 20px; font-size: 0.8rem; }';
            htmlContent += '</style></head><body>';
            
            if (resumeData.name) htmlContent += '<h1>' + escapeHtml(resumeData.name) + '</h1>';
            if (resumeData.title) htmlContent += '<p style="font-size: 1.2rem; margin-bottom: 0.5rem;">' + escapeHtml(resumeData.title) + '</p>';
            
            const contactParts = [];
            if (resumeData.email) contactParts.push(escapeHtml(resumeData.email));
            if (resumeData.phone) contactParts.push(escapeHtml(resumeData.phone));
            if (resumeData.location) contactParts.push(escapeHtml(resumeData.location));
            if (contactParts.length > 0) {
                htmlContent += '<p class="contact-info">' + contactParts.join(' | ') + '</p>';
            }
            
            if (resumeData.summary) {
                htmlContent += '<div class="section"><div class="section-title">个人简介</div><p>' + escapeHtml(resumeData.summary) + '</p></div>';
            }
            
            if (resumeData.experiences.length > 0) {
                htmlContent += '<div class="section"><div class="section-title">工作经历</div>';
                resumeData.experiences.forEach(exp => {
                    htmlContent += '<div class="experience-item">';
                    htmlContent += '<h4>' + escapeHtml(exp.position) + '</h4>';
                    htmlContent += '<div class="meta">' + escapeHtml(exp.company) + ' | ' + formatDate(exp.start) + ' - ' + (exp.end === '至今' ? '至今' : formatDate(exp.end)) + '</div>';
                    htmlContent += '<p>' + escapeHtml(exp.description) + '</p>';
                    htmlContent += '</div>';
                });
                htmlContent += '</div>';
            }
            
            if (resumeData.education.length > 0) {
                htmlContent += '<div class="section"><div class="section-title">教育背景</div>';
                resumeData.education.forEach(edu => {
                    htmlContent += '<div class="education-item">';
                    htmlContent += '<h4>' + escapeHtml(edu.school) + '</h4>';
                    htmlContent += '<div class="meta">' + escapeHtml(edu.degree) + ' - ' + escapeHtml(edu.major) + ' | ' + formatDate(edu.date) + '</div>';
                    htmlContent += '</div>';
                });
                htmlContent += '</div>';
            }
            
            if (resumeData.skills.length > 0) {
                htmlContent += '<div class="section"><div class="section-title">专业技能</div><div class="skill-tags">';
                resumeData.skills.forEach(skill => {
                    htmlContent += '<span class="skill-tag">' + escapeHtml(skill) + '</span>';
                });
                htmlContent += '</div></div>';
            }
            
            htmlContent += '</body></html>';
            
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = (resumeData.name || '简历') + '.html';
            a.click();
            URL.revokeObjectURL(url);
        });

        // 保存数据
        document.getElementById('saveDataBtn').addEventListener('click', function() {
            localStorage.setItem('resumeData', JSON.stringify(resumeData));
            alert('数据已保存到本地');
        });

        // 加载数据
        document.getElementById('loadDataBtn').addEventListener('click', function() {
            const saved = localStorage.getItem('resumeData');
            if (saved) {
                resumeData = JSON.parse(saved);
                document.getElementById('name').value = resumeData.name || '';
                document.getElementById('title').value = resumeData.title || '';
                document.getElementById('email').value = resumeData.email || '';
                document.getElementById('phone').value = resumeData.phone || '';
                document.getElementById('location').value = resumeData.location || '';
                document.getElementById('summary').value = resumeData.summary || '';
                document.getElementById('skills').value = resumeData.skills ? resumeData.skills.join(', ') : '';
                renderExperienceList();
                renderEducationList();
                updatePreview();
                alert('数据已加载');
            } else {
                alert('没有找到保存的数据');
            }
        });

        // 页面加载时尝试加载数据
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('resumeData');
            if (saved) {
                resumeData = JSON.parse(saved);
                document.getElementById('name').value = resumeData.name || '';
                document.getElementById('title').value = resumeData.title || '';
                document.getElementById('email').value = resumeData.email || '';
                document.getElementById('phone').value = resumeData.phone || '';
                document.getElementById('location').value = resumeData.location || '';
                document.getElementById('summary').value = resumeData.summary || '';
                document.getElementById('skills').value = resumeData.skills ? resumeData.skills.join(', ') : '';
                renderExperienceList();
                renderEducationList();
                updatePreview();
            }
        });
    </script>
</body>
</html>
