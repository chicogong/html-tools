<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½“æµ‹æˆç»©è®¡ç®—å™¨ - å›½å®¶å­¦ç”Ÿä½“è´¨å¥åº·æ ‡å‡†</title>
    <meta name="description" content="æ ¹æ®ã€Šå›½å®¶å­¦ç”Ÿä½“è´¨å¥åº·æ ‡å‡†ã€‹è®¡ç®—ä½“æµ‹æˆç»©ï¼Œæ”¯æŒBMIã€è‚ºæ´»é‡ã€50ç±³è·‘ã€åä½ä½“å‰å±ˆã€ç«‹å®šè·³è¿œã€å¼•ä½“å‘ä¸Š/ä»°å§èµ·åã€1000ç±³/800ç±³è·‘ç­‰å…¨éƒ¨é¡¹ç›®">
    <meta name="keywords" content="ä½“æµ‹æˆç»©,ä½“è´¨å¥åº·,BMIè®¡ç®—,è‚ºæ´»é‡,50ç±³è·‘,ç«‹å®šè·³è¿œ,å¼•ä½“å‘ä¸Š,ä»°å§èµ·å,1000ç±³,800ç±³">
    <style>
        :root {
            --bg-color: #f5f7fa;
            --card-bg: #fff;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --border-color: #e1e8ed;
            --primary-color: #3498db;
            --primary-hover: #2980b9;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --excellent-color: #27ae60;
            --good-color: #3498db;
            --pass-color: #f39c12;
            --fail-color: #e74c3c;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #1a1a2e;
                --card-bg: #16213e;
                --text-primary: #eaf0f6;
                --text-secondary: #a0aab4;
                --border-color: #2d3748;
                --primary-color: #5dade2;
                --primary-hover: #3498db;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 8px;
            font-size: 1.8rem;
        }

        .subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-size: 0.95rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select {
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--bg-color);
            color: var(--text-primary);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .input-with-unit {
            display: flex;
            align-items: center;
        }

        .input-with-unit input {
            flex: 1;
            border-radius: 8px 0 0 8px;
        }

        .input-with-unit .unit {
            padding: 10px 12px;
            background: var(--border-color);
            border: 1px solid var(--border-color);
            border-left: none;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
        }

        /* æµ‹è¯•é¡¹ç›®ç½‘æ ¼ */
        .test-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .test-item {
            background: var(--bg-color);
            border-radius: 10px;
            padding: 16px;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .test-item:hover {
            border-color: var(--primary-color);
        }

        .test-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .test-item-name {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .test-item-weight {
            font-size: 0.8rem;
            color: var(--text-secondary);
            background: var(--card-bg);
            padding: 2px 8px;
            border-radius: 10px;
        }

        .test-item-input {
            display: flex;
            gap: 8px;
        }

        .test-item-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.95rem;
            background: var(--card-bg);
            color: var(--text-primary);
        }

        .test-item-input .unit {
            padding: 8px 12px;
            background: var(--card-bg);
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        /* æˆç»©ç»“æœ */
        .result-section {
            display: none;
        }

        .result-section.show {
            display: block;
        }

        .total-score {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
            border-radius: 16px;
            color: white;
            margin-bottom: 20px;
        }

        .total-score-value {
            font-size: 4rem;
            font-weight: 700;
            line-height: 1;
        }

        .total-score-label {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: 8px;
        }

        .grade-badge {
            display: inline-block;
            padding: 8px 24px;
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 12px;
            background: rgba(255,255,255,0.2);
        }

        .grade-excellent { background: var(--excellent-color); }
        .grade-good { background: var(--good-color); }
        .grade-pass { background: var(--pass-color); }
        .grade-fail { background: var(--fail-color); }

        /* å„é¡¹æˆç»©è¡¨æ ¼ */
        .score-table {
            width: 100%;
            border-collapse: collapse;
        }

        .score-table th,
        .score-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .score-table th {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .score-table .item-name {
            font-weight: 500;
        }

        .score-table .score-cell {
            font-weight: 600;
        }

        .score-table .grade-cell {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
            display: inline-block;
        }

        .score-table .grade-excellent { background: rgba(39, 174, 96, 0.15); color: var(--excellent-color); }
        .score-table .grade-good { background: rgba(52, 152, 219, 0.15); color: var(--good-color); }
        .score-table .grade-pass { background: rgba(243, 156, 18, 0.15); color: var(--pass-color); }
        .score-table .grade-fail { background: rgba(231, 76, 60, 0.15); color: var(--fail-color); }

        /* æç¤ºä¿¡æ¯ */
        .info-box {
            background: rgba(52, 152, 219, 0.1);
            border-left: 4px solid var(--primary-color);
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin-top: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .info-box strong {
            color: var(--text-primary);
        }

        /* åŠ åˆ†é¡¹ */
        .bonus-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .bonus-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .bonus-items {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .bonus-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bonus-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .bonus-item label {
            font-size: 0.9rem;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            .test-items {
                grid-template-columns: 1fr;
            }
            .total-score-value {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸƒ ä½“æµ‹æˆç»©è®¡ç®—å™¨</h1>
        <p class="subtitle">ä¾æ®ã€Šå›½å®¶å­¦ç”Ÿä½“è´¨å¥åº·æ ‡å‡†ï¼ˆ2014å¹´ä¿®è®¢ï¼‰ã€‹è®¡ç®—</p>

        <!-- åŸºæœ¬ä¿¡æ¯ -->
        <div class="card">
            <div class="card-title">
                <span>ğŸ“</span> åŸºæœ¬ä¿¡æ¯
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>æ€§åˆ«</label>
                    <select id="gender" onchange="updateTestItems()">
                        <option value="male">ç”·</option>
                        <option value="female">å¥³</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å¹´çº§</label>
                    <select id="grade" onchange="updateTestItems()">
                        <option value="college">å¤§å­¦</option>
                        <option value="high3">é«˜ä¸‰</option>
                        <option value="high2">é«˜äºŒ</option>
                        <option value="high1">é«˜ä¸€</option>
                        <option value="middle3">åˆä¸‰</option>
                        <option value="middle2">åˆäºŒ</option>
                        <option value="middle1">åˆä¸€</option>
                        <option value="primary6">å°å­¦å…­å¹´çº§</option>
                        <option value="primary5">å°å­¦äº”å¹´çº§</option>
                        <option value="primary4">å°å­¦å››å¹´çº§</option>
                        <option value="primary3">å°å­¦ä¸‰å¹´çº§</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>èº«é«˜</label>
                    <div class="input-with-unit">
                        <input type="number" id="height" placeholder="170" step="0.1">
                        <span class="unit">cm</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>ä½“é‡</label>
                    <div class="input-with-unit">
                        <input type="number" id="weight" placeholder="65" step="0.1">
                        <span class="unit">kg</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æµ‹è¯•é¡¹ç›® -->
        <div class="card">
            <div class="card-title">
                <span>ğŸ¯</span> æµ‹è¯•é¡¹ç›®
            </div>
            <div class="test-items" id="testItems">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>

            <div class="bonus-section">
                <div class="bonus-title">é™„åŠ åˆ†ï¼ˆè€åŠ›é¡¹ç›®æˆç»©è¾¾åˆ°è‰¯å¥½åŠä»¥ä¸Šå¯åŠ åˆ†ï¼‰</div>
                <div class="bonus-items">
                    <div class="bonus-item">
                        <input type="checkbox" id="bonusEndurance">
                        <label for="bonusEndurance">è€åŠ›é¡¹ç›®åŠ åˆ†ï¼ˆè‰¯å¥½+10åˆ†ï¼Œä¼˜ç§€+20åˆ†ï¼‰</label>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="calculate()" style="margin-top: 20px;">
                ğŸ“Š è®¡ç®—æˆç»©
            </button>
        </div>

        <!-- è®¡ç®—ç»“æœ -->
        <div class="result-section" id="resultSection">
            <div class="card">
                <div class="total-score" id="totalScoreCard">
                    <div class="total-score-value" id="totalScore">0</div>
                    <div class="total-score-label">æ€»æˆç»©</div>
                    <div class="grade-badge" id="totalGrade">å¾…è®¡ç®—</div>
                </div>

                <div class="card-title">
                    <span>ğŸ“‹</span> å„é¡¹æˆç»©æ˜ç»†
                </div>
                <table class="score-table">
                    <thead>
                        <tr>
                            <th>æµ‹è¯•é¡¹ç›®</th>
                            <th>æˆç»©</th>
                            <th>å¾—åˆ†</th>
                            <th>æƒé‡</th>
                            <th>ç­‰çº§</th>
                        </tr>
                    </thead>
                    <tbody id="scoreTableBody">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>

                <div class="info-box">
                    <strong>è¯„åˆ†æ ‡å‡†ï¼š</strong>90åˆ†åŠä»¥ä¸Šä¸ºä¼˜ç§€ï¼Œ80-89.9åˆ†ä¸ºè‰¯å¥½ï¼Œ60-79.9åˆ†ä¸ºåŠæ ¼ï¼Œ60åˆ†ä»¥ä¸‹ä¸ºä¸åŠæ ¼ã€‚<br>
                    <strong>æ³¨æ„ï¼š</strong>ä½“é‡æŒ‡æ•°(BMI)æˆç»©å’Œè‚ºæ´»é‡ä½“é‡æŒ‡æ•°ä¸åˆæ ¼æ—¶ï¼Œæ€»æˆç»©æœ€é«˜ä¸º59åˆ†ã€‚
                </div>
            </div>
        </div>
    </div>

    <script>
        // è¯„åˆ†æ ‡å‡†æ•°æ®ï¼ˆç®€åŒ–ç‰ˆï¼Œå®é™…åº”æ›´è¯¦ç»†ï¼‰
        const standards = {
            // å¤§å­¦ç”·ç”Ÿæ ‡å‡†
            college_male: {
                bmi: {
                    weight: 15,
                    ranges: [
                        { min: 17.9, max: 23.9, score: 100 },
                        { min: 17.0, max: 17.8, score: 80 },
                        { min: 24.0, max: 27.9, score: 80 },
                        { min: 16.0, max: 16.9, score: 60 },
                        { min: 28.0, max: 29.9, score: 60 },
                        { min: 0, max: 15.9, score: 50 },
                        { min: 30.0, max: 999, score: 50 }
                    ]
                },
                vitalCapacity: {
                    weight: 15,
                    unit: 'ml/kg',
                    ranges: [
                        { min: 78, score: 100 },
                        { min: 70, score: 86 },
                        { min: 62, score: 72 },
                        { min: 54, score: 58 },
                        { min: 46, score: 44 },
                        { min: 0, score: 30 }
                    ]
                },
                run50: {
                    weight: 20,
                    unit: 'ç§’',
                    isLowerBetter: true,
                    ranges: [
                        { max: 6.7, score: 100 },
                        { max: 6.9, score: 95 },
                        { max: 7.1, score: 90 },
                        { max: 7.3, score: 85 },
                        { max: 7.5, score: 80 },
                        { max: 7.7, score: 75 },
                        { max: 7.9, score: 70 },
                        { max: 8.1, score: 65 },
                        { max: 8.3, score: 60 },
                        { max: 9.1, score: 50 },
                        { max: 999, score: 30 }
                    ]
                },
                sitAndReach: {
                    weight: 10,
                    unit: 'cm',
                    ranges: [
                        { min: 24.9, score: 100 },
                        { min: 21.3, score: 86 },
                        { min: 17.7, score: 72 },
                        { min: 14.1, score: 58 },
                        { min: 10.5, score: 44 },
                        { min: -999, score: 30 }
                    ]
                },
                standingJump: {
                    weight: 10,
                    unit: 'cm',
                    ranges: [
                        { min: 273, score: 100 },
                        { min: 256, score: 86 },
                        { min: 238, score: 72 },
                        { min: 220, score: 58 },
                        { min: 202, score: 44 },
                        { min: 0, score: 30 }
                    ]
                },
                pullUp: {
                    weight: 10,
                    unit: 'ä¸ª',
                    ranges: [
                        { min: 19, score: 100 },
                        { min: 16, score: 86 },
                        { min: 12, score: 72 },
                        { min: 8, score: 58 },
                        { min: 5, score: 44 },
                        { min: 0, score: 30 }
                    ]
                },
                run1000: {
                    weight: 20,
                    unit: 'åˆ†ç§’',
                    isLowerBetter: true,
                    isEndurance: true,
                    ranges: [
                        { max: 207, score: 100 },  // 3'27"
                        { max: 217, score: 95 },   // 3'37"
                        { max: 227, score: 90 },   // 3'47"
                        { max: 237, score: 85 },   // 3'57"
                        { max: 247, score: 80 },   // 4'07"
                        { max: 257, score: 75 },   // 4'17"
                        { max: 267, score: 70 },   // 4'27"
                        { max: 277, score: 65 },   // 4'37"
                        { max: 290, score: 60 },   // 4'50"
                        { max: 330, score: 50 },   // 5'30"
                        { max: 9999, score: 30 }
                    ]
                }
            },
            // å¤§å­¦å¥³ç”Ÿæ ‡å‡†
            college_female: {
                bmi: {
                    weight: 15,
                    ranges: [
                        { min: 17.2, max: 23.9, score: 100 },
                        { min: 16.5, max: 17.1, score: 80 },
                        { min: 24.0, max: 27.9, score: 80 },
                        { min: 15.8, max: 16.4, score: 60 },
                        { min: 28.0, max: 29.9, score: 60 },
                        { min: 0, max: 15.7, score: 50 },
                        { min: 30.0, max: 999, score: 50 }
                    ]
                },
                vitalCapacity: {
                    weight: 15,
                    unit: 'ml/kg',
                    ranges: [
                        { min: 66, score: 100 },
                        { min: 58, score: 86 },
                        { min: 50, score: 72 },
                        { min: 42, score: 58 },
                        { min: 34, score: 44 },
                        { min: 0, score: 30 }
                    ]
                },
                run50: {
                    weight: 20,
                    unit: 'ç§’',
                    isLowerBetter: true,
                    ranges: [
                        { max: 7.5, score: 100 },
                        { max: 7.7, score: 95 },
                        { max: 8.0, score: 90 },
                        { max: 8.3, score: 85 },
                        { max: 8.6, score: 80 },
                        { max: 8.9, score: 75 },
                        { max: 9.2, score: 70 },
                        { max: 9.5, score: 65 },
                        { max: 9.8, score: 60 },
                        { max: 10.6, score: 50 },
                        { max: 999, score: 30 }
                    ]
                },
                sitAndReach: {
                    weight: 10,
                    unit: 'cm',
                    ranges: [
                        { min: 25.8, score: 100 },
                        { min: 22.0, score: 86 },
                        { min: 18.2, score: 72 },
                        { min: 14.4, score: 58 },
                        { min: 10.6, score: 44 },
                        { min: -999, score: 30 }
                    ]
                },
                standingJump: {
                    weight: 10,
                    unit: 'cm',
                    ranges: [
                        { min: 207, score: 100 },
                        { min: 193, score: 86 },
                        { min: 178, score: 72 },
                        { min: 163, score: 58 },
                        { min: 148, score: 44 },
                        { min: 0, score: 30 }
                    ]
                },
                sitUp: {
                    weight: 10,
                    unit: 'ä¸ª/åˆ†é’Ÿ',
                    ranges: [
                        { min: 56, score: 100 },
                        { min: 48, score: 86 },
                        { min: 40, score: 72 },
                        { min: 32, score: 58 },
                        { min: 24, score: 44 },
                        { min: 0, score: 30 }
                    ]
                },
                run800: {
                    weight: 20,
                    unit: 'åˆ†ç§’',
                    isLowerBetter: true,
                    isEndurance: true,
                    ranges: [
                        { max: 198, score: 100 },  // 3'18"
                        { max: 208, score: 95 },   // 3'28"
                        { max: 218, score: 90 },   // 3'38"
                        { max: 228, score: 85 },   // 3'48"
                        { max: 238, score: 80 },   // 3'58"
                        { max: 248, score: 75 },   // 4'08"
                        { max: 258, score: 70 },   // 4'18"
                        { max: 268, score: 65 },   // 4'28"
                        { max: 280, score: 60 },   // 4'40"
                        { max: 318, score: 50 },   // 5'18"
                        { max: 9999, score: 30 }
                    ]
                }
            }
        };

        // æµ‹è¯•é¡¹ç›®é…ç½®
        const testItemsConfig = {
            male: [
                { id: 'vitalCapacity', name: 'è‚ºæ´»é‡', unit: 'ml', icon: 'ğŸ«', weight: 15 },
                { id: 'run50', name: '50ç±³è·‘', unit: 'ç§’', icon: 'ğŸƒ', weight: 20 },
                { id: 'sitAndReach', name: 'åä½ä½“å‰å±ˆ', unit: 'cm', icon: 'ğŸ§˜', weight: 10 },
                { id: 'standingJump', name: 'ç«‹å®šè·³è¿œ', unit: 'cm', icon: 'ğŸ¦˜', weight: 10 },
                { id: 'pullUp', name: 'å¼•ä½“å‘ä¸Š', unit: 'ä¸ª', icon: 'ğŸ’ª', weight: 10 },
                { id: 'run1000', name: '1000ç±³è·‘', unit: '', icon: 'ğŸ…', weight: 20, isTime: true }
            ],
            female: [
                { id: 'vitalCapacity', name: 'è‚ºæ´»é‡', unit: 'ml', icon: 'ğŸ«', weight: 15 },
                { id: 'run50', name: '50ç±³è·‘', unit: 'ç§’', icon: 'ğŸƒ', weight: 20 },
                { id: 'sitAndReach', name: 'åä½ä½“å‰å±ˆ', unit: 'cm', icon: 'ğŸ§˜', weight: 10 },
                { id: 'standingJump', name: 'ç«‹å®šè·³è¿œ', unit: 'cm', icon: 'ğŸ¦˜', weight: 10 },
                { id: 'sitUp', name: 'ä»°å§èµ·å', unit: 'ä¸ª/åˆ†', icon: 'ğŸ¤¸', weight: 10 },
                { id: 'run800', name: '800ç±³è·‘', unit: '', icon: 'ğŸ…', weight: 20, isTime: true }
            ]
        };

        function updateTestItems() {
            const gender = document.getElementById('gender').value;
            const items = testItemsConfig[gender];
            const container = document.getElementById('testItems');

            container.innerHTML = items.map(item => {
                if (item.isTime) {
                    return `
                        <div class="test-item">
                            <div class="test-item-header">
                                <span class="test-item-name">${item.icon} ${item.name}</span>
                                <span class="test-item-weight">${item.weight}%</span>
                            </div>
                            <div class="test-item-input">
                                <input type="number" id="${item.id}_min" placeholder="åˆ†" min="0" max="30" style="width: 60px;">
                                <span class="unit">åˆ†</span>
                                <input type="number" id="${item.id}_sec" placeholder="ç§’" min="0" max="59" style="width: 60px;">
                                <span class="unit">ç§’</span>
                            </div>
                        </div>
                    `;
                }
                return `
                    <div class="test-item">
                        <div class="test-item-header">
                            <span class="test-item-name">${item.icon} ${item.name}</span>
                            <span class="test-item-weight">${item.weight}%</span>
                        </div>
                        <div class="test-item-input">
                            <input type="number" id="${item.id}" placeholder="è¾“å…¥æˆç»©" step="0.1">
                            <span class="unit">${item.unit}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getScore(value, ranges, isLowerBetter = false) {
            if (value === null || isNaN(value)) return { score: 0, grade: 'æœªæµ‹' };
            
            for (const range of ranges) {
                if (isLowerBetter) {
                    if (range.max !== undefined && value <= range.max) {
                        return { score: range.score, grade: getGrade(range.score) };
                    }
                } else {
                    if (range.min !== undefined && range.max !== undefined) {
                        if (value >= range.min && value <= range.max) {
                            return { score: range.score, grade: getGrade(range.score) };
                        }
                    } else if (range.min !== undefined && value >= range.min) {
                        return { score: range.score, grade: getGrade(range.score) };
                    }
                }
            }
            return { score: 0, grade: 'æœªæµ‹' };
        }

        function getGrade(score) {
            if (score >= 90) return 'ä¼˜ç§€';
            if (score >= 80) return 'è‰¯å¥½';
            if (score >= 60) return 'åŠæ ¼';
            return 'ä¸åŠæ ¼';
        }

        function getGradeClass(grade) {
            switch(grade) {
                case 'ä¼˜ç§€': return 'grade-excellent';
                case 'è‰¯å¥½': return 'grade-good';
                case 'åŠæ ¼': return 'grade-pass';
                default: return 'grade-fail';
            }
        }

        function calculate() {
            const gender = document.getElementById('gender').value;
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            
            if (!height || !weight) {
                alert('è¯·è¾“å…¥èº«é«˜å’Œä½“é‡');
                return;
            }

            // è·å–æ ‡å‡†ï¼ˆç®€åŒ–ä¸ºå¤§å­¦æ ‡å‡†ï¼‰
            const standardKey = `college_${gender}`;
            const standard = standards[standardKey];
            
            const results = [];
            let totalWeightedScore = 0;
            let bmiPassed = true;
            let enduranceScore = 0;

            // 1. BMIè®¡ç®—
            const bmi = weight / ((height / 100) ** 2);
            const bmiResult = getScore(bmi, standard.bmi.ranges);
            results.push({
                name: 'BMIæŒ‡æ•°',
                value: bmi.toFixed(1),
                unit: 'kg/mÂ²',
                score: bmiResult.score,
                weight: standard.bmi.weight,
                grade: bmiResult.grade
            });
            totalWeightedScore += bmiResult.score * standard.bmi.weight / 100;
            if (bmiResult.score < 60) bmiPassed = false;

            // 2. è‚ºæ´»é‡ä½“é‡æŒ‡æ•°
            const vitalCapacity = parseFloat(document.getElementById('vitalCapacity')?.value);
            if (vitalCapacity) {
                const vitalIndex = vitalCapacity / weight;
                const vitalResult = getScore(vitalIndex, standard.vitalCapacity.ranges);
                results.push({
                    name: 'è‚ºæ´»é‡ä½“é‡æŒ‡æ•°',
                    value: vitalIndex.toFixed(0),
                    unit: 'ml/kg',
                    score: vitalResult.score,
                    weight: standard.vitalCapacity.weight,
                    grade: vitalResult.grade
                });
                totalWeightedScore += vitalResult.score * standard.vitalCapacity.weight / 100;
            }

            // 3. 50ç±³è·‘
            const run50 = parseFloat(document.getElementById('run50')?.value);
            if (run50) {
                const run50Result = getScore(run50, standard.run50.ranges, true);
                results.push({
                    name: '50ç±³è·‘',
                    value: run50.toFixed(1),
                    unit: 'ç§’',
                    score: run50Result.score,
                    weight: standard.run50.weight,
                    grade: run50Result.grade
                });
                totalWeightedScore += run50Result.score * standard.run50.weight / 100;
            }

            // 4. åä½ä½“å‰å±ˆ
            const sitAndReach = parseFloat(document.getElementById('sitAndReach')?.value);
            if (sitAndReach !== undefined && !isNaN(sitAndReach)) {
                const sitAndReachResult = getScore(sitAndReach, standard.sitAndReach.ranges);
                results.push({
                    name: 'åä½ä½“å‰å±ˆ',
                    value: sitAndReach.toFixed(1),
                    unit: 'cm',
                    score: sitAndReachResult.score,
                    weight: standard.sitAndReach.weight,
                    grade: sitAndReachResult.grade
                });
                totalWeightedScore += sitAndReachResult.score * standard.sitAndReach.weight / 100;
            }

            // 5. ç«‹å®šè·³è¿œ
            const standingJump = parseFloat(document.getElementById('standingJump')?.value);
            if (standingJump) {
                const standingJumpResult = getScore(standingJump, standard.standingJump.ranges);
                results.push({
                    name: 'ç«‹å®šè·³è¿œ',
                    value: standingJump.toFixed(0),
                    unit: 'cm',
                    score: standingJumpResult.score,
                    weight: standard.standingJump.weight,
                    grade: standingJumpResult.grade
                });
                totalWeightedScore += standingJumpResult.score * standard.standingJump.weight / 100;
            }

            // 6. å¼•ä½“å‘ä¸Š/ä»°å§èµ·å
            if (gender === 'male') {
                const pullUp = parseFloat(document.getElementById('pullUp')?.value);
                if (pullUp !== undefined && !isNaN(pullUp)) {
                    const pullUpResult = getScore(pullUp, standard.pullUp.ranges);
                    results.push({
                        name: 'å¼•ä½“å‘ä¸Š',
                        value: pullUp,
                        unit: 'ä¸ª',
                        score: pullUpResult.score,
                        weight: standard.pullUp.weight,
                        grade: pullUpResult.grade
                    });
                    totalWeightedScore += pullUpResult.score * standard.pullUp.weight / 100;
                }
            } else {
                const sitUp = parseFloat(document.getElementById('sitUp')?.value);
                if (sitUp !== undefined && !isNaN(sitUp)) {
                    const sitUpResult = getScore(sitUp, standard.sitUp.ranges);
                    results.push({
                        name: 'ä»°å§èµ·å',
                        value: sitUp,
                        unit: 'ä¸ª/åˆ†é’Ÿ',
                        score: sitUpResult.score,
                        weight: standard.sitUp.weight,
                        grade: sitUpResult.grade
                    });
                    totalWeightedScore += sitUpResult.score * standard.sitUp.weight / 100;
                }
            }

            // 7. 1000ç±³/800ç±³è·‘
            const enduranceId = gender === 'male' ? 'run1000' : 'run800';
            const enduranceStandard = gender === 'male' ? standard.run1000 : standard.run800;
            const enduranceMin = parseInt(document.getElementById(`${enduranceId}_min`)?.value) || 0;
            const enduranceSec = parseInt(document.getElementById(`${enduranceId}_sec`)?.value) || 0;
            
            if (enduranceMin > 0 || enduranceSec > 0) {
                const totalSeconds = enduranceMin * 60 + enduranceSec;
                const enduranceResult = getScore(totalSeconds, enduranceStandard.ranges, true);
                enduranceScore = enduranceResult.score;
                
                results.push({
                    name: gender === 'male' ? '1000ç±³è·‘' : '800ç±³è·‘',
                    value: `${enduranceMin}'${enduranceSec.toString().padStart(2, '0')}"`,
                    unit: '',
                    score: enduranceResult.score,
                    weight: enduranceStandard.weight,
                    grade: enduranceResult.grade
                });
                totalWeightedScore += enduranceResult.score * enduranceStandard.weight / 100;
            }

            // è®¡ç®—åŠ åˆ†
            let bonusScore = 0;
            if (document.getElementById('bonusEndurance').checked && enduranceScore >= 80) {
                bonusScore = enduranceScore >= 90 ? 20 : 10;
            }

            // è®¡ç®—æœ€ç»ˆå¾—åˆ†
            let finalScore = totalWeightedScore + bonusScore;
            
            // BMIä¸åˆæ ¼é™åˆ¶æœ€é«˜åˆ†
            if (!bmiPassed) {
                finalScore = Math.min(finalScore, 59);
            }

            finalScore = Math.min(120, Math.max(0, finalScore));

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultSection').classList.add('show');
            document.getElementById('totalScore').textContent = finalScore.toFixed(1);
            
            const finalGrade = getGrade(finalScore);
            const gradeElement = document.getElementById('totalGrade');
            gradeElement.textContent = finalGrade;
            gradeElement.className = `grade-badge ${getGradeClass(finalGrade)}`;

            // æ›´æ–°æ€»åˆ†å¡ç‰‡é¢œè‰²
            const scoreCard = document.getElementById('totalScoreCard');
            if (finalScore >= 90) {
                scoreCard.style.background = `linear-gradient(135deg, ${getComputedStyle(document.documentElement).getPropertyValue('--excellent-color')}, #1e8449)`;
            } else if (finalScore >= 80) {
                scoreCard.style.background = `linear-gradient(135deg, ${getComputedStyle(document.documentElement).getPropertyValue('--good-color')}, #2471a3)`;
            } else if (finalScore >= 60) {
                scoreCard.style.background = `linear-gradient(135deg, ${getComputedStyle(document.documentElement).getPropertyValue('--pass-color')}, #d68910)`;
            } else {
                scoreCard.style.background = `linear-gradient(135deg, ${getComputedStyle(document.documentElement).getPropertyValue('--fail-color')}, #922b21)`;
            }

            // æ¸²æŸ“æˆç»©è¡¨æ ¼
            const tableBody = document.getElementById('scoreTableBody');
            tableBody.innerHTML = results.map(r => `
                <tr>
                    <td class="item-name">${r.name}</td>
                    <td>${r.value} ${r.unit}</td>
                    <td class="score-cell">${r.score}</td>
                    <td>${r.weight}%</td>
                    <td><span class="grade-cell ${getGradeClass(r.grade)}">${r.grade}</span></td>
                </tr>
            `).join('');

            if (bonusScore > 0) {
                tableBody.innerHTML += `
                    <tr>
                        <td class="item-name">è€åŠ›åŠ åˆ†</td>
                        <td colspan="2">-</td>
                        <td class="score-cell" style="color: var(--success-color)">+${bonusScore}</td>
                        <td><span class="grade-cell grade-excellent">åŠ åˆ†</span></td>
                    </tr>
                `;
            }

            // æ»šåŠ¨åˆ°ç»“æœ
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }

        // åˆå§‹åŒ–
        updateTestItems();
    </script>
</body>
</html>
