<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chmod è®¡ç®—å™¨ - åœ¨çº¿å·¥å…·</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”</text></svg>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root { --primary-color: #10b981; --read-color: #3b82f6; --write-color: #f59e0b; --exec-color: #ef4444; }
        [data-theme="dark"] { --primary-color: #34d399; }
        body { padding: 1rem; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem; }
        header h1 { margin: 0; font-size: 1.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .header-actions { display: flex; gap: 0.5rem; align-items: center; }
        .theme-toggle { cursor: pointer; background: var(--primary-color); border: none; padding: 0.5rem 1rem; border-radius: 8px; color: white; font-size: 1rem; }
        .back-link { color: var(--primary-color); text-decoration: none; padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--primary-color); font-size: 0.9rem; }
        .result-display { background: var(--card-background-color); border-radius: 12px; padding: 2rem; text-align: center; margin-bottom: 2rem; }
        .permission-code { font-family: 'SF Mono', Monaco, monospace; font-size: 4rem; font-weight: 700; color: var(--primary-color); margin-bottom: 0.5rem; }
        .permission-string { font-family: 'SF Mono', Monaco, monospace; font-size: 1.5rem; color: var(--muted-color); margin-bottom: 1rem; }
        .permission-string .read { color: var(--read-color); }
        .permission-string .write { color: var(--write-color); }
        .permission-string .exec { color: var(--exec-color); }
        .permission-string .none { color: var(--muted-color); }
        .copy-btn { font-size: 0.9rem; }
        .permissions-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-bottom: 2rem; }
        @media (max-width: 640px) { .permissions-grid { grid-template-columns: 1fr; } }
        .permission-group { background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; }
        .permission-group h3 { margin: 0 0 1rem; font-size: 1rem; text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
        .permission-group h3 .icon { font-size: 1.25rem; }
        .permission-group h3 .value { font-family: 'SF Mono', Monaco, monospace; background: var(--primary-color); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.9rem; }
        .checkbox-group { display: flex; flex-direction: column; gap: 0.75rem; }
        .checkbox-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: var(--code-background-color); border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .checkbox-item:hover { background: color-mix(in srgb, var(--primary-color) 10%, transparent); }
        .checkbox-item input { margin: 0; width: 20px; height: 20px; cursor: pointer; }
        .checkbox-item label { flex: 1; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .checkbox-item .perm-name { font-weight: 500; }
        .checkbox-item .perm-value { font-family: 'SF Mono', Monaco, monospace; font-size: 0.85rem; color: var(--muted-color); }
        .checkbox-item.read .perm-name { color: var(--read-color); }
        .checkbox-item.write .perm-name { color: var(--write-color); }
        .checkbox-item.exec .perm-name { color: var(--exec-color); }
        .octal-input { background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; }
        .octal-input h3 { margin: 0 0 1rem; font-size: 1rem; }
        .octal-input-row { display: flex; gap: 1rem; align-items: center; }
        .octal-input-row input { max-width: 200px; font-family: 'SF Mono', Monaco, monospace; font-size: 1.25rem; text-align: center; }
        .common-permissions { background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; }
        .common-permissions h3 { margin: 0 0 1rem; font-size: 1rem; }
        .common-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 0.75rem; }
        .common-btn { padding: 0.75rem; background: var(--code-background-color); border: 1px solid var(--muted-border-color); border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.2s; }
        .common-btn:hover { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .common-btn .code { font-family: 'SF Mono', Monaco, monospace; font-weight: 600; font-size: 1.1rem; display: block; margin-bottom: 0.25rem; }
        .common-btn .desc { font-size: 0.75rem; color: var(--muted-color); }
        .common-btn:hover .desc { color: rgba(255,255,255,0.8); }
        .command-preview { margin-top: 2rem; background: var(--code-background-color); padding: 1rem; border-radius: 8px; font-family: 'SF Mono', Monaco, monospace; font-size: 0.9rem; display: flex; justify-content: space-between; align-items: center; }
        .toast { position: fixed; bottom: 20px; right: 20px; padding: 1rem 1.5rem; background: #10b981; color: white; border-radius: 8px; font-weight: 500; z-index: 1000; transform: translateY(100px); opacity: 0; transition: all 0.3s; }
        .toast.show { transform: translateY(0); opacity: 1; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ” Chmod è®¡ç®—å™¨</h1>
            <div class="header-actions">
                <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
                <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </header>

        <div class="result-display">
            <div class="permission-code" id="permCode">644</div>
            <div class="permission-string" id="permString">
                <span class="read">r</span><span class="write">w</span><span class="none">-</span>
                <span class="read">r</span><span class="none">-</span><span class="none">-</span>
                <span class="read">r</span><span class="none">-</span><span class="none">-</span>
            </div>
            <button class="copy-btn" onclick="copyPermission()">å¤åˆ¶æƒé™ç </button>
        </div>

        <div class="octal-input">
            <h3>ç›´æ¥è¾“å…¥å…«è¿›åˆ¶æƒé™</h3>
            <div class="octal-input-row">
                <input type="text" id="octalInput" placeholder="644" maxlength="4" oninput="parseOctal()">
                <span style="color: var(--muted-color);">è¾“å…¥ 3-4 ä½æ•°å­— (å¦‚ 644, 755, 0777)</span>
            </div>
        </div>

        <div class="permissions-grid">
            <div class="permission-group">
                <h3><span class="icon">ğŸ‘¤</span> æ‰€æœ‰è€… (Owner) <span class="value" id="ownerValue">6</span></h3>
                <div class="checkbox-group">
                    <div class="checkbox-item read">
                        <input type="checkbox" id="ownerRead" checked onchange="updatePermissions()">
                        <label for="ownerRead">
                            <span class="perm-name">è¯»å– (Read)</span>
                            <span class="perm-value">4</span>
                        </label>
                    </div>
                    <div class="checkbox-item write">
                        <input type="checkbox" id="ownerWrite" checked onchange="updatePermissions()">
                        <label for="ownerWrite">
                            <span class="perm-name">å†™å…¥ (Write)</span>
                            <span class="perm-value">2</span>
                        </label>
                    </div>
                    <div class="checkbox-item exec">
                        <input type="checkbox" id="ownerExec" onchange="updatePermissions()">
                        <label for="ownerExec">
                            <span class="perm-name">æ‰§è¡Œ (Execute)</span>
                            <span class="perm-value">1</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="permission-group">
                <h3><span class="icon">ğŸ‘¥</span> ç”¨æˆ·ç»„ (Group) <span class="value" id="groupValue">4</span></h3>
                <div class="checkbox-group">
                    <div class="checkbox-item read">
                        <input type="checkbox" id="groupRead" checked onchange="updatePermissions()">
                        <label for="groupRead">
                            <span class="perm-name">è¯»å– (Read)</span>
                            <span class="perm-value">4</span>
                        </label>
                    </div>
                    <div class="checkbox-item write">
                        <input type="checkbox" id="groupWrite" onchange="updatePermissions()">
                        <label for="groupWrite">
                            <span class="perm-name">å†™å…¥ (Write)</span>
                            <span class="perm-value">2</span>
                        </label>
                    </div>
                    <div class="checkbox-item exec">
                        <input type="checkbox" id="groupExec" onchange="updatePermissions()">
                        <label for="groupExec">
                            <span class="perm-name">æ‰§è¡Œ (Execute)</span>
                            <span class="perm-value">1</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="permission-group">
                <h3><span class="icon">ğŸŒ</span> å…¶ä»–äºº (Others) <span class="value" id="othersValue">4</span></h3>
                <div class="checkbox-group">
                    <div class="checkbox-item read">
                        <input type="checkbox" id="othersRead" checked onchange="updatePermissions()">
                        <label for="othersRead">
                            <span class="perm-name">è¯»å– (Read)</span>
                            <span class="perm-value">4</span>
                        </label>
                    </div>
                    <div class="checkbox-item write">
                        <input type="checkbox" id="othersWrite" onchange="updatePermissions()">
                        <label for="othersWrite">
                            <span class="perm-name">å†™å…¥ (Write)</span>
                            <span class="perm-value">2</span>
                        </label>
                    </div>
                    <div class="checkbox-item exec">
                        <input type="checkbox" id="othersExec" onchange="updatePermissions()">
                        <label for="othersExec">
                            <span class="perm-name">æ‰§è¡Œ (Execute)</span>
                            <span class="perm-value">1</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="common-permissions">
            <h3>å¸¸ç”¨æƒé™</h3>
            <div class="common-grid">
                <button class="common-btn" onclick="setPermission(644)">
                    <span class="code">644</span>
                    <span class="desc">æ™®é€šæ–‡ä»¶</span>
                </button>
                <button class="common-btn" onclick="setPermission(755)">
                    <span class="code">755</span>
                    <span class="desc">å¯æ‰§è¡Œæ–‡ä»¶/ç›®å½•</span>
                </button>
                <button class="common-btn" onclick="setPermission(777)">
                    <span class="code">777</span>
                    <span class="desc">å®Œå…¨æƒé™</span>
                </button>
                <button class="common-btn" onclick="setPermission(600)">
                    <span class="code">600</span>
                    <span class="desc">ç§æœ‰æ–‡ä»¶</span>
                </button>
                <button class="common-btn" onclick="setPermission(700)">
                    <span class="code">700</span>
                    <span class="desc">ç§æœ‰ç›®å½•</span>
                </button>
                <button class="common-btn" onclick="setPermission(444)">
                    <span class="code">444</span>
                    <span class="desc">åªè¯»æ–‡ä»¶</span>
                </button>
                <button class="common-btn" onclick="setPermission(666)">
                    <span class="code">666</span>
                    <span class="desc">å¯è¯»å†™æ–‡ä»¶</span>
                </button>
                <button class="common-btn" onclick="setPermission(400)">
                    <span class="code">400</span>
                    <span class="desc">SSH ç§é’¥</span>
                </button>
            </div>
        </div>

        <div class="command-preview">
            <span>chmod <span id="cmdCode">644</span> filename</span>
            <button onclick="copyCommand()" class="secondary outline" style="font-size: 0.8rem; padding: 0.3rem 0.6rem;">å¤åˆ¶å‘½ä»¤</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        (function() {
            const savedTheme = localStorage.getItem('theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();

        function getGroupValue(prefix) {
            const read = document.getElementById(prefix + 'Read').checked ? 4 : 0;
            const write = document.getElementById(prefix + 'Write').checked ? 2 : 0;
            const exec = document.getElementById(prefix + 'Exec').checked ? 1 : 0;
            return read + write + exec;
        }

        function setGroupValue(prefix, value) {
            document.getElementById(prefix + 'Read').checked = (value & 4) !== 0;
            document.getElementById(prefix + 'Write').checked = (value & 2) !== 0;
            document.getElementById(prefix + 'Exec').checked = (value & 1) !== 0;
        }

        function updatePermissions() {
            const owner = getGroupValue('owner');
            const group = getGroupValue('group');
            const others = getGroupValue('others');

            document.getElementById('ownerValue').textContent = owner;
            document.getElementById('groupValue').textContent = group;
            document.getElementById('othersValue').textContent = others;

            const code = `${owner}${group}${others}`;
            document.getElementById('permCode').textContent = code;
            document.getElementById('cmdCode').textContent = code;
            document.getElementById('octalInput').value = code;

            updatePermissionString(owner, group, others);
        }

        function updatePermissionString(owner, group, others) {
            const toStr = (val) => {
                const r = (val & 4) ? '<span class="read">r</span>' : '<span class="none">-</span>';
                const w = (val & 2) ? '<span class="write">w</span>' : '<span class="none">-</span>';
                const x = (val & 1) ? '<span class="exec">x</span>' : '<span class="none">-</span>';
                return r + w + x;
            };
            document.getElementById('permString').innerHTML = toStr(owner) + toStr(group) + toStr(others);
        }

        function parseOctal() {
            let input = document.getElementById('octalInput').value.replace(/[^0-7]/g, '');
            if (input.length === 0) return;
            
            // Handle leading 0
            if (input.startsWith('0') && input.length === 4) {
                input = input.slice(1);
            }
            
            if (input.length === 3) {
                const owner = parseInt(input[0]);
                const group = parseInt(input[1]);
                const others = parseInt(input[2]);

                if (owner <= 7 && group <= 7 && others <= 7) {
                    setGroupValue('owner', owner);
                    setGroupValue('group', group);
                    setGroupValue('others', others);
                    
                    document.getElementById('ownerValue').textContent = owner;
                    document.getElementById('groupValue').textContent = group;
                    document.getElementById('othersValue').textContent = others;
                    
                    document.getElementById('permCode').textContent = input;
                    document.getElementById('cmdCode').textContent = input;
                    updatePermissionString(owner, group, others);
                }
            }
        }

        function setPermission(code) {
            document.getElementById('octalInput').value = code;
            parseOctal();
        }

        function copyPermission() {
            const code = document.getElementById('permCode').textContent;
            navigator.clipboard.writeText(code);
            showToast('æƒé™ç å·²å¤åˆ¶');
        }

        function copyCommand() {
            const code = document.getElementById('cmdCode').textContent;
            navigator.clipboard.writeText(`chmod ${code} filename`);
            showToast('å‘½ä»¤å·²å¤åˆ¶');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Init
        updatePermissions();
    </script>
</body>
</html>
