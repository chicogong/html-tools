<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>配色方案生成器 - WebUtils</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --accent-cyan: #00f5d4;
      --accent-green: #10b981;
      --glow-cyan: rgb(0, 245, 212, 0.15);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Space Grotesk', system-ui, sans-serif;
      background: var(--bg-deep);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
    }

    .bg-grid {
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgb(0, 245, 212, 0.02) 1px, transparent 1px),
        linear-gradient(90deg, rgb(0, 245, 212, 0.02) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px;
      min-height: 100vh;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-secondary);
      text-decoration: none;
      padding: 8px 14px;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      transition: all 0.2s ease;
      margin-bottom: 24px;
    }

    .back-link:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    h1 {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      margin-bottom: 8px;
    }

    .desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 24px;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 20px;
    }

    .color-picker-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }

    .color-input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .color-input-group label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    .color-input {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    input[type="color"] {
      width: 60px;
      height: 60px;
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      cursor: pointer;
      background: transparent;
    }

    input[type="text"] {
      flex: 1;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      padding: 10px 12px;
      background: var(--bg-surface);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
    }

    input:focus {
      outline: none;
      border-color: var(--accent-cyan);
    }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .option-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option-group label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    select, input[type="number"] {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      padding: 10px 12px;
      background: var(--bg-surface);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
    }

    .palette-display {
      margin-bottom: 24px;
    }

    .palette-display h3 {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 12px;
      text-transform: uppercase;
    }

    .palette-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
    }

    .palette-color {
      height: 120px;
      border-radius: var(--radius-md);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 12px;
      position: relative;
      transition: all 0.2s ease;
      cursor: pointer;
      border: 2px solid transparent;
    }

    .palette-color:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgb(0, 0, 0, 0.3);
    }

    .palette-color.active {
      border-color: var(--accent-cyan);
    }

    .color-hex {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      font-weight: 600;
      color: white;
      text-shadow: 0 1px 2px rgb(0, 0, 0, 0.5);
      background: rgb(0, 0, 0, 0.3);
      padding: 4px 8px;
      border-radius: var(--radius-sm);
      backdrop-filter: blur(4px);
    }

    .color-name {
      font-size: 0.7rem;
      color: rgb(255, 255, 255, 0.8);
      margin-top: 4px;
      text-shadow: 0 1px 2px rgb(0, 0, 0, 0.5);
    }

    .code-output {
      margin-bottom: 20px;
    }

    .code-output label {
      display: block;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      margin-bottom: 10px;
    }

    textarea {
      width: 100%;
      min-height: 100px;
      padding: 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      background: var(--bg-surface);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      resize: vertical;
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent-cyan);
      box-shadow: 0 0 0 4px var(--glow-cyan);
    }

    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      padding: 10px 16px;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    button.primary {
      background: var(--accent-cyan);
      border-color: var(--accent-cyan);
      color: var(--bg-deep);
    }

    button.primary:hover {
      background: #00dfc4;
    }

    .status {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 16px;
    }

    .status.success {
      color: var(--accent-green);
    }

    .status.success::before {
      content: '✓ ';
    }

    footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 16px;
      border-top: 1px solid var(--border-subtle);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    footer a {
      color: var(--accent-cyan);
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>

  <div class="container">
    <a href="../../index.html" class="back-link">← 返回</a>

    <h1>配色方案生成器</h1>
    <p class="desc">基于色相、饱和度、亮度生成协调的配色方案</p>

    <div class="card">
      <div class="color-picker-section">
        <div class="color-input-group">
          <label>主色调</label>
          <div class="color-input">
            <input type="color" id="primaryColor" value="#00f5d4" />
            <input type="text" id="primaryHex" value="#00f5d4" />
          </div>
        </div>
        <div class="color-input-group">
          <label>副色调</label>
          <div class="color-input">
            <input type="color" id="secondaryColor" value="#4cc9f0" />
            <input type="text" id="secondaryHex" value="#4cc9f0" />
          </div>
        </div>
      </div>

      <div class="options-grid">
        <div class="option-group">
          <label>配色方案</label>
          <select id="schemeType">
            <option value="analogous">类似色</option>
            <option value="complementary">互补色</option>
            <option value="triadic">三色</option>
            <option value="tetradic">四色</option>
            <option value="monochromatic">单色</option>
            <option value="shades">渐变色</option>
          </select>
        </div>
        <div class="option-group">
          <label>颜色数量</label>
          <input type="number" id="colorCount" value="5" min="2" max="12" />
        </div>
        <div class="option-group">
          <label>饱和度</label>
          <input type="number" id="saturation" value="70" min="0" max="100" />
        </div>
        <div class="option-group">
          <label>亮度</label>
          <input type="number" id="lightness" value="50" min="0" max="100" />
        </div>
      </div>

      <div class="palette-display">
        <h3>配色方案</h3>
        <div class="palette-grid" id="paletteGrid"></div>
      </div>

      <div class="code-output">
        <label>CSS 代码</label>
        <textarea id="output" readonly></textarea>
      </div>

      <div class="actions">
        <button id="btnGenerate" class="primary">生成配色</button>
        <button id="btnCopy">复制代码</button>
        <button id="btnRandom">随机配色</button>
        <button id="btnClear">重置</button>
      </div>

      <div id="status" class="status"></div>
    </div>

    <footer>
      <a href="https://github.com/chicogong/html-tools" target="_blank">GitHub</a> ·
      纯前端 · 无服务器 ·
      <a href="../../index.html">WebUtils</a>
    </footer>
  </div>

  <script>
    const primaryColorEl = document.getElementById('primaryColor');
    const primaryHexEl = document.getElementById('primaryHex');
    const secondaryColorEl = document.getElementById('secondaryColor');
    const secondaryHexEl = document.getElementById('secondaryHex');
    const schemeTypeEl = document.getElementById('schemeType');
    const colorCountEl = document.getElementById('colorCount');
    const saturationEl = document.getElementById('saturation');
    const lightnessEl = document.getElementById('lightness');
    const paletteGridEl = document.getElementById('paletteGrid');
    const outputEl = document.getElementById('output');
    const statusEl = document.getElementById('status');

    function hexToHSL(hex) {
      let r = 0, g = 0, b = 0;
      if (hex.length === 4) {
        r = parseInt(hex[1] + hex[1], 16);
        g = parseInt(hex[2] + hex[2], 16);
        b = parseInt(hex[3] + hex[3], 16);
      } else if (hex.length === 7) {
        r = parseInt(hex[1] + hex[2], 16);
        g = parseInt(hex[3] + hex[4], 16);
        b = parseInt(hex[5] + hex[6], 16);
      }
      r /= 255;
      g /= 255;
      b /= 255;
      const max = Math.max(r, g, b);
      const min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;

      if (max === min) {
        h = s = 0;
      } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }

      return {
        h: Math.round(h * 360),
        s: Math.round(s * 100),
        l: Math.round(l * 100)
      };
    }

    function HSLToHex(h, s, l) {
      s /= 100;
      l /= 100;

      const c = (1 - Math.abs(2 * l - 1)) * s;
      const x = c * (1 - Math.abs((h / 60) % 2 - 1));
      const m = l - c / 2;
      let r = 0, g = 0, b = 0;

      if (h >= 0 && h < 60) {
        r = c; g = x; b = 0;
      } else if (h >= 60 && h < 120) {
        r = x; g = c; b = 0;
      } else if (h >= 120 && h < 180) {
        r = 0; g = c; b = x;
      } else if (h >= 180 && h < 240) {
        r = 0; g = x; b = c;
      } else if (h >= 240 && h < 300) {
        r = x; g = 0; b = c;
      } else if (h >= 300 && h < 360) {
        r = c; g = 0; b = x;
      }

      r = Math.round((r + m) * 255);
      g = Math.round((g + m) * 255);
      b = Math.round((b + m) * 255);

      return '#' + [r, g, b].map(x => {
        const hex = x.toString(16);
        return hex.length === 1 ? '0' + hex : hex;
      }).join('');
    }

    function generateColorScheme(baseHSL, schemeType, count) {
      const s = parseInt(saturationEl.value) || 70;
      const l = parseInt(lightnessEl.value) || 50;
      const colors = [];
      const baseH = baseHSL.h;

      for (let i = 0; i < count; i++) {
        let h;
        switch (schemeType) {
          case 'analogous':
            h = (baseH + (i - Math.floor(count / 2)) * 30 + 360) % 360;
            break;
          case 'complementary':
            h = (baseH + (i % 2 === 0 ? 0 : 180)) % 360;
            break;
          case 'triadic':
            h = (baseH + i * 120) % 360;
            break;
          case 'tetradic':
            h = (baseH + i * 90) % 360;
            break;
          case 'monochromatic':
            h = baseH;
            break;
          case 'shades':
            h = baseH;
            break;
          default:
            h = (baseH + i * (360 / count)) % 360;
        }

        let colorS = s;
        let colorL = l;

        if (schemeType === 'shades') {
          colorL = 10 + i * (80 / (count - 1));
        } else if (schemeType === 'monochromatic') {
          colorL = 30 + i * (50 / (count - 1));
        }

        colors.push(HSLToHex(h, colorS, colorL));
      }

      return colors;
    }

    function generatePalette() {
      const primaryHex = primaryHexEl.value;
      const schemeType = schemeTypeEl.value;
      const count = parseInt(colorCountEl.value) || 5;

      if (!/^#[0-9A-Fa-f]{3,6}$/.test(primaryHex)) {
        showStatus('颜色格式无效', 'error');
        return;
      }

      const baseHSL = hexToHSL(primaryHex);
      const colors = generateColorScheme(baseHSL, schemeType, count);

      paletteGridEl.innerHTML = '';
      colors.forEach(function(hex, index) {
        const colorDiv = document.createElement('div');
        colorDiv.className = 'palette-color';
        colorDiv.style.backgroundColor = hex;
        colorDiv.innerHTML =
          '<div class="color-hex">' + hex + '</div>' +
          '<div class="color-name">颜色 ' + (index + 1) + '</div>';
        paletteGridEl.appendChild(colorDiv);

        colorDiv.addEventListener('click', function() {
          document.querySelectorAll('.palette-color').forEach(function(c) {
            c.classList.remove('active');
          });
          colorDiv.classList.add('active');
          primaryColorEl.value = hex;
          primaryHexEl.value = hex;
          updateHexInputs();
        });
      });

      // Generate CSS code
      const css = ':root {\n' + colors.map(function(hex, index) {
        return `  --color-${index + 1}: ${hex};`;
      }).join('\n') + '\n}';
      outputEl.value = css;

      showStatus('配色方案已生成', 'success');
    }

    function updateHexInputs() {
      primaryColorEl.value = primaryHexEl.value;
      secondaryColorEl.value = secondaryHexEl.value;
    }

    function showStatus(msg, type) {
      statusEl.textContent = msg;
      statusEl.className = 'status ' + (type || '');
    }

    function randomColor() {
      const hex = '#' + Math.floor(Math.random() * 0x1000000).toString(16).padStart(6, '0');
      primaryHexEl.value = hex;
      updateHexInputs();
      generatePalette();
    }

    function reset() {
      primaryHexEl.value = '#00f5d4';
      secondaryHexEl.value = '#4cc9f0';
      schemeTypeEl.value = 'analogous';
      colorCountEl.value = '5';
      saturationEl.value = '70';
      lightnessEl.value = '50';
      updateHexInputs();
      generatePalette();
    }

    primaryColorEl.addEventListener('input', function() {
      primaryHexEl.value = this.value;
      generatePalette();
    });

    primaryHexEl.addEventListener('input', function() {
      primaryColorEl.value = this.value;
      if (this.value.length === 7 || this.value.length === 4) {
        generatePalette();
      }
    });

    secondaryColorEl.addEventListener('input', function() {
      secondaryHexEl.value = this.value;
    });

    secondaryHexEl.addEventListener('input', function() {
      secondaryColorEl.value = this.value;
    });

    document.getElementById('btnGenerate').onclick = generatePalette;
    document.getElementById('btnRandom').onclick = randomColor;
    document.getElementById('btnClear').onclick = reset;

    document.getElementById('btnCopy').onclick = async function() {
      try {
        await navigator.clipboard.writeText(outputEl.value);
        showStatus('已复制', 'success');
      } catch (e) {
        showStatus('复制失败');
      }
    };

    [schemeTypeEl, colorCountEl, saturationEl, lightnessEl].forEach(function(el) {
      el.addEventListener('change', generatePalette);
    });

    // Initial generation
    updateHexInputs();
    generatePalette();
  </script>
</body>
</html>
