<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker Compose ÁîüÊàêÂô®</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --primary-color: #2496ed;
            --secondary-color: #384d54;
            --accent-color: #f5f5f5;
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }
        
        [data-theme="dark"] {
            --accent-color: #1a2634;
        }
        
        body {
            min-height: 100vh;
            padding: 2rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--primary-color);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .logo svg {
            width: 48px;
            height: 48px;
        }
        
        h1 {
            margin: 0;
            background: linear-gradient(135deg, var(--primary-color), #0db7ed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .theme-toggle {
            background: none;
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .theme-toggle:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 1.5rem;
            min-height: 75vh;
        }
        
        @media (max-width: 1000px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: var(--accent-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--primary-color);
        }
        
        .panel-title {
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }
        
        .services-list {
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .service-card {
            background: rgba(36, 150, 237, 0.1);
            border: 1px solid rgba(36, 150, 237, 0.2);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1rem;
            transition: var(--transition);
        }
        
        .service-card:hover {
            border-color: var(--primary-color);
        }
        
        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .service-name {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .service-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .service-actions button {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        
        .form-group {
            margin-bottom: 0.75rem;
        }
        
        .form-group label {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
            color: var(--secondary-color);
        }
        
        .form-group input, .form-group select {
            margin-bottom: 0;
        }
        
        .port-mapping, .env-var, .volume-mapping {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            align-items: center;
        }
        
        .port-mapping input, .env-var input, .volume-mapping input {
            margin-bottom: 0;
        }
        
        .add-btn {
            width: 100%;
            padding: 0.5rem;
            margin-top: 0.5rem;
            background: transparent;
            border: 1px dashed var(--primary-color);
            color: var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .add-btn:hover {
            background: rgba(36, 150, 237, 0.1);
        }
        
        pre {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: var(--border-radius);
            overflow: auto;
            white-space: pre;
            min-height: 500px;
            max-height: 75vh;
        }
        
        .yaml-key { color: #9cdcfe; }
        .yaml-value { color: #ce9178; }
        .yaml-number { color: #b5cea8; }
        .yaml-comment { color: #6a9955; }
        
        .btn-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .btn-primary {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background: #1a7bc9;
            border-color: #1a7bc9;
        }
        
        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-danger {
            background: #dc3545;
            border-color: #dc3545;
            color: white;
        }
        
        .template-btns {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        
        .template-btn {
            padding: 0.25rem 0.75rem;
            font-size: 0.85rem;
            border-radius: 20px;
            background: rgba(36, 150, 237, 0.1);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .template-btn:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 2rem;
            background: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: var(--transition);
            z-index: 1000;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .collapsible {
            cursor: pointer;
            user-select: none;
        }
        
        .collapsible::before {
            content: '‚ñº';
            display: inline-block;
            margin-right: 0.5rem;
            font-size: 0.75rem;
            transition: var(--transition);
        }
        
        .collapsible.collapsed::before {
            transform: rotate(-90deg);
        }
        
        .collapse-content {
            max-height: 1000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .collapse-content.collapsed {
            max-height: 0;
        }
        
        .checkbox-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        
        .checkbox-group input[type="checkbox"] {
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 50 L20 50 L20 40 L30 40 L30 50 L40 50 L40 40 L50 40 L50 50 L60 50 L60 40 L70 40 L70 50 L80 50 L80 60 L10 60 Z" fill="#2496ed"/>
                    <ellipse cx="85" cy="55" rx="12" ry="8" fill="#2496ed"/>
                    <rect x="15" y="45" width="8" height="8" fill="#fff"/>
                    <rect x="25" y="45" width="8" height="8" fill="#fff"/>
                    <rect x="35" y="45" width="8" height="8" fill="#fff"/>
                    <rect x="45" y="45" width="8" height="8" fill="#fff"/>
                    <rect x="55" y="45" width="8" height="8" fill="#fff"/>
                    <rect x="65" y="45" width="8" height="8" fill="#fff"/>
                </svg>
                <h1>Docker Compose ÁîüÊàêÂô®</h1>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" title="ÂàáÊç¢‰∏ªÈ¢ò">
                <span id="theme-icon">üåô</span>
            </button>
        </header>
        
        <div class="template-btns">
            <button class="template-btn" onclick="loadTemplate('webApp')">WebÂ∫îÁî®</button>
            <button class="template-btn" onclick="loadTemplate('wordpress')">WordPress</button>
            <button class="template-btn" onclick="loadTemplate('mern')">MERN Stack</button>
            <button class="template-btn" onclick="loadTemplate('lamp')">LAMP Stack</button>
            <button class="template-btn" onclick="loadTemplate('redis')">RedisÈõÜÁæ§</button>
        </div>
        
        <div class="main-grid">
            <div class="panel">
                <div class="panel-header">
                    <h3 class="panel-title">üê≥ ÊúçÂä°ÈÖçÁΩÆ</h3>
                    <button class="btn-primary" onclick="addService()">+ Ê∑ªÂä†ÊúçÂä°</button>
                </div>
                
                <div id="servicesList" class="services-list">
                    <!-- Âä®ÊÄÅÁîüÊàêÊúçÂä°ÂàóË°® -->
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <h3 class="panel-title">üìÑ docker-compose.yml</h3>
                    <div class="btn-group">
                        <button class="btn-primary" onclick="copyYaml()">Â§çÂà∂</button>
                        <button class="btn-secondary" onclick="downloadYaml()">‰∏ãËΩΩ</button>
                    </div>
                </div>
                <pre id="yamlOutput"></pre>
            </div>
        </div>
    </div>
    
    <div id="toast" class="toast"></div>

    <script>
        let services = [];
        let serviceIdCounter = 0;
        
        const templates = {
            webApp: [
                {
                    name: 'nginx',
                    image: 'nginx:alpine',
                    ports: [{ host: '80', container: '80' }],
                    volumes: [{ host: './nginx.conf', container: '/etc/nginx/nginx.conf' }],
                    env: [],
                    depends_on: ['app'],
                    restart: 'always'
                },
                {
                    name: 'app',
                    image: 'node:18-alpine',
                    ports: [{ host: '3000', container: '3000' }],
                    volumes: [{ host: '.', container: '/app' }],
                    env: [{ key: 'NODE_ENV', value: 'production' }],
                    depends_on: ['db'],
                    restart: 'always',
                    command: 'npm start'
                },
                {
                    name: 'db',
                    image: 'postgres:15-alpine',
                    ports: [{ host: '5432', container: '5432' }],
                    volumes: [{ host: 'postgres_data', container: '/var/lib/postgresql/data' }],
                    env: [
                        { key: 'POSTGRES_USER', value: 'admin' },
                        { key: 'POSTGRES_PASSWORD', value: 'secret' },
                        { key: 'POSTGRES_DB', value: 'myapp' }
                    ],
                    depends_on: [],
                    restart: 'always'
                }
            ],
            wordpress: [
                {
                    name: 'wordpress',
                    image: 'wordpress:latest',
                    ports: [{ host: '8080', container: '80' }],
                    volumes: [{ host: 'wordpress_data', container: '/var/www/html' }],
                    env: [
                        { key: 'WORDPRESS_DB_HOST', value: 'mysql:3306' },
                        { key: 'WORDPRESS_DB_USER', value: 'wordpress' },
                        { key: 'WORDPRESS_DB_PASSWORD', value: 'wordpress' },
                        { key: 'WORDPRESS_DB_NAME', value: 'wordpress' }
                    ],
                    depends_on: ['mysql'],
                    restart: 'always'
                },
                {
                    name: 'mysql',
                    image: 'mysql:8.0',
                    ports: [],
                    volumes: [{ host: 'mysql_data', container: '/var/lib/mysql' }],
                    env: [
                        { key: 'MYSQL_DATABASE', value: 'wordpress' },
                        { key: 'MYSQL_USER', value: 'wordpress' },
                        { key: 'MYSQL_PASSWORD', value: 'wordpress' },
                        { key: 'MYSQL_ROOT_PASSWORD', value: 'rootpassword' }
                    ],
                    depends_on: [],
                    restart: 'always'
                }
            ],
            mern: [
                {
                    name: 'frontend',
                    image: 'node:18-alpine',
                    ports: [{ host: '3000', container: '3000' }],
                    volumes: [{ host: './frontend', container: '/app' }],
                    env: [{ key: 'REACT_APP_API_URL', value: 'http://localhost:5000' }],
                    depends_on: ['backend'],
                    restart: 'always',
                    command: 'npm start'
                },
                {
                    name: 'backend',
                    image: 'node:18-alpine',
                    ports: [{ host: '5000', container: '5000' }],
                    volumes: [{ host: './backend', container: '/app' }],
                    env: [
                        { key: 'MONGODB_URI', value: 'mongodb://mongo:27017/myapp' },
                        { key: 'JWT_SECRET', value: 'your-secret-key' }
                    ],
                    depends_on: ['mongo'],
                    restart: 'always',
                    command: 'npm start'
                },
                {
                    name: 'mongo',
                    image: 'mongo:6',
                    ports: [{ host: '27017', container: '27017' }],
                    volumes: [{ host: 'mongo_data', container: '/data/db' }],
                    env: [],
                    depends_on: [],
                    restart: 'always'
                }
            ],
            lamp: [
                {
                    name: 'apache',
                    image: 'php:8.2-apache',
                    ports: [{ host: '80', container: '80' }],
                    volumes: [{ host: './www', container: '/var/www/html' }],
                    env: [],
                    depends_on: ['mysql'],
                    restart: 'always'
                },
                {
                    name: 'mysql',
                    image: 'mysql:8.0',
                    ports: [{ host: '3306', container: '3306' }],
                    volumes: [{ host: 'mysql_data', container: '/var/lib/mysql' }],
                    env: [
                        { key: 'MYSQL_ROOT_PASSWORD', value: 'rootpassword' },
                        { key: 'MYSQL_DATABASE', value: 'app' }
                    ],
                    depends_on: [],
                    restart: 'always'
                },
                {
                    name: 'phpmyadmin',
                    image: 'phpmyadmin:latest',
                    ports: [{ host: '8080', container: '80' }],
                    volumes: [],
                    env: [{ key: 'PMA_HOST', value: 'mysql' }],
                    depends_on: ['mysql'],
                    restart: 'always'
                }
            ],
            redis: [
                {
                    name: 'redis-master',
                    image: 'redis:7-alpine',
                    ports: [{ host: '6379', container: '6379' }],
                    volumes: [{ host: 'redis_master_data', container: '/data' }],
                    env: [],
                    depends_on: [],
                    restart: 'always',
                    command: 'redis-server --appendonly yes'
                },
                {
                    name: 'redis-slave',
                    image: 'redis:7-alpine',
                    ports: [{ host: '6380', container: '6379' }],
                    volumes: [{ host: 'redis_slave_data', container: '/data' }],
                    env: [],
                    depends_on: ['redis-master'],
                    restart: 'always',
                    command: 'redis-server --replicaof redis-master 6379'
                }
            ]
        };
        
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }
        
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').textContent = savedTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }
        
        function loadTemplate(templateName) {
            services = templates[templateName].map(svc => ({
                ...svc,
                id: serviceIdCounter++,
                ports: [...svc.ports],
                volumes: [...svc.volumes],
                env: [...svc.env],
                depends_on: [...svc.depends_on]
            }));
            renderServices();
            generateYaml();
        }
        
        function addService() {
            services.push({
                id: serviceIdCounter++,
                name: 'service' + (services.length + 1),
                image: 'alpine:latest',
                ports: [],
                volumes: [],
                env: [],
                depends_on: [],
                restart: 'always',
                command: ''
            });
            renderServices();
            generateYaml();
        }
        
        function removeService(id) {
            services = services.filter(s => s.id !== id);
            renderServices();
            generateYaml();
        }
        
        function updateService(id, field, value) {
            const service = services.find(s => s.id === id);
            if (service) {
                service[field] = value;
                generateYaml();
            }
        }
        
        function addPort(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.ports.push({ host: '', container: '' });
                renderServices();
            }
        }
        
        function removePort(serviceId, index) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.ports.splice(index, 1);
                renderServices();
                generateYaml();
            }
        }
        
        function updatePort(serviceId, index, field, value) {
            const service = services.find(s => s.id === serviceId);
            if (service && service.ports[index]) {
                service.ports[index][field] = value;
                generateYaml();
            }
        }
        
        function addVolume(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.volumes.push({ host: '', container: '' });
                renderServices();
            }
        }
        
        function removeVolume(serviceId, index) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.volumes.splice(index, 1);
                renderServices();
                generateYaml();
            }
        }
        
        function updateVolume(serviceId, index, field, value) {
            const service = services.find(s => s.id === serviceId);
            if (service && service.volumes[index]) {
                service.volumes[index][field] = value;
                generateYaml();
            }
        }
        
        function addEnv(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.env.push({ key: '', value: '' });
                renderServices();
            }
        }
        
        function removeEnv(serviceId, index) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.env.splice(index, 1);
                renderServices();
                generateYaml();
            }
        }
        
        function updateEnv(serviceId, index, field, value) {
            const service = services.find(s => s.id === serviceId);
            if (service && service.env[index]) {
                service.env[index][field] = value;
                generateYaml();
            }
        }
        
        function renderServices() {
            const container = document.getElementById('servicesList');
            while (container.firstChild) {
                container.removeChild(container.firstChild);
            }
            
            services.forEach(service => {
                const card = document.createElement('div');
                card.className = 'service-card';
                card.id = 'service-' + service.id;
                
                // Header
                const header = document.createElement('div');
                header.className = 'service-header';
                
                const nameInput = document.createElement('input');
                nameInput.type = 'text';
                nameInput.className = 'service-name';
                nameInput.value = service.name;
                nameInput.style.marginBottom = '0';
                nameInput.style.width = '150px';
                nameInput.onchange = function() { updateService(service.id, 'name', this.value); };
                header.appendChild(nameInput);
                
                const actions = document.createElement('div');
                actions.className = 'service-actions';
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-danger';
                deleteBtn.textContent = 'Âà†Èô§';
                deleteBtn.onclick = function() { removeService(service.id); };
                actions.appendChild(deleteBtn);
                
                header.appendChild(actions);
                card.appendChild(header);
                
                // Image
                const imageGroup = document.createElement('div');
                imageGroup.className = 'form-group';
                const imageLabel = document.createElement('label');
                imageLabel.textContent = 'ÈïúÂÉè';
                imageGroup.appendChild(imageLabel);
                const imageInput = document.createElement('input');
                imageInput.type = 'text';
                imageInput.value = service.image;
                imageInput.placeholder = 'nginx:latest';
                imageInput.onchange = function() { updateService(service.id, 'image', this.value); };
                imageGroup.appendChild(imageInput);
                card.appendChild(imageGroup);
                
                // Ports section
                const portsTitle = document.createElement('label');
                portsTitle.className = 'collapsible';
                portsTitle.textContent = 'Á´ØÂè£Êò†Â∞Ñ';
                portsTitle.onclick = function() {
                    this.classList.toggle('collapsed');
                    this.nextElementSibling.classList.toggle('collapsed');
                };
                card.appendChild(portsTitle);
                
                const portsContent = document.createElement('div');
                portsContent.className = 'collapse-content';
                
                service.ports.forEach((port, index) => {
                    const portRow = document.createElement('div');
                    portRow.className = 'port-mapping';
                    
                    const hostInput = document.createElement('input');
                    hostInput.type = 'text';
                    hostInput.placeholder = '‰∏ªÊú∫Á´ØÂè£';
                    hostInput.value = port.host;
                    hostInput.onchange = function() { updatePort(service.id, index, 'host', this.value); };
                    portRow.appendChild(hostInput);
                    
                    const containerInput = document.createElement('input');
                    containerInput.type = 'text';
                    containerInput.placeholder = 'ÂÆπÂô®Á´ØÂè£';
                    containerInput.value = port.container;
                    containerInput.onchange = function() { updatePort(service.id, index, 'container', this.value); };
                    portRow.appendChild(containerInput);
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.textContent = '√ó';
                    removeBtn.style.padding = '0.5rem';
                    removeBtn.onclick = function() { removePort(service.id, index); };
                    portRow.appendChild(removeBtn);
                    
                    portsContent.appendChild(portRow);
                });
                
                const addPortBtn = document.createElement('button');
                addPortBtn.className = 'add-btn';
                addPortBtn.textContent = '+ Ê∑ªÂä†Á´ØÂè£';
                addPortBtn.onclick = function() { addPort(service.id); };
                portsContent.appendChild(addPortBtn);
                card.appendChild(portsContent);
                
                // Volumes section
                const volumesTitle = document.createElement('label');
                volumesTitle.className = 'collapsible';
                volumesTitle.textContent = 'ÊåÇËΩΩÂç∑';
                volumesTitle.onclick = function() {
                    this.classList.toggle('collapsed');
                    this.nextElementSibling.classList.toggle('collapsed');
                };
                card.appendChild(volumesTitle);
                
                const volumesContent = document.createElement('div');
                volumesContent.className = 'collapse-content';
                
                service.volumes.forEach((vol, index) => {
                    const volRow = document.createElement('div');
                    volRow.className = 'volume-mapping';
                    
                    const hostInput = document.createElement('input');
                    hostInput.type = 'text';
                    hostInput.placeholder = '‰∏ªÊú∫Ë∑ØÂæÑ';
                    hostInput.value = vol.host;
                    hostInput.onchange = function() { updateVolume(service.id, index, 'host', this.value); };
                    volRow.appendChild(hostInput);
                    
                    const containerInput = document.createElement('input');
                    containerInput.type = 'text';
                    containerInput.placeholder = 'ÂÆπÂô®Ë∑ØÂæÑ';
                    containerInput.value = vol.container;
                    containerInput.onchange = function() { updateVolume(service.id, index, 'container', this.value); };
                    volRow.appendChild(containerInput);
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.textContent = '√ó';
                    removeBtn.style.padding = '0.5rem';
                    removeBtn.onclick = function() { removeVolume(service.id, index); };
                    volRow.appendChild(removeBtn);
                    
                    volumesContent.appendChild(volRow);
                });
                
                const addVolBtn = document.createElement('button');
                addVolBtn.className = 'add-btn';
                addVolBtn.textContent = '+ Ê∑ªÂä†ÊåÇËΩΩ';
                addVolBtn.onclick = function() { addVolume(service.id); };
                volumesContent.appendChild(addVolBtn);
                card.appendChild(volumesContent);
                
                // Environment section
                const envTitle = document.createElement('label');
                envTitle.className = 'collapsible';
                envTitle.textContent = 'ÁéØÂ¢ÉÂèòÈáè';
                envTitle.onclick = function() {
                    this.classList.toggle('collapsed');
                    this.nextElementSibling.classList.toggle('collapsed');
                };
                card.appendChild(envTitle);
                
                const envContent = document.createElement('div');
                envContent.className = 'collapse-content';
                
                service.env.forEach((env, index) => {
                    const envRow = document.createElement('div');
                    envRow.className = 'env-var';
                    
                    const keyInput = document.createElement('input');
                    keyInput.type = 'text';
                    keyInput.placeholder = 'ÂèòÈáèÂêç';
                    keyInput.value = env.key;
                    keyInput.onchange = function() { updateEnv(service.id, index, 'key', this.value); };
                    envRow.appendChild(keyInput);
                    
                    const valueInput = document.createElement('input');
                    valueInput.type = 'text';
                    valueInput.placeholder = 'ÂèòÈáèÂÄº';
                    valueInput.value = env.value;
                    valueInput.onchange = function() { updateEnv(service.id, index, 'value', this.value); };
                    envRow.appendChild(valueInput);
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.textContent = '√ó';
                    removeBtn.style.padding = '0.5rem';
                    removeBtn.onclick = function() { removeEnv(service.id, index); };
                    envRow.appendChild(removeBtn);
                    
                    envContent.appendChild(envRow);
                });
                
                const addEnvBtn = document.createElement('button');
                addEnvBtn.className = 'add-btn';
                addEnvBtn.textContent = '+ Ê∑ªÂä†ÁéØÂ¢ÉÂèòÈáè';
                addEnvBtn.onclick = function() { addEnv(service.id); };
                envContent.appendChild(addEnvBtn);
                card.appendChild(envContent);
                
                // Restart policy
                const restartGroup = document.createElement('div');
                restartGroup.className = 'form-group';
                const restartLabel = document.createElement('label');
                restartLabel.textContent = 'ÈáçÂêØÁ≠ñÁï•';
                restartGroup.appendChild(restartLabel);
                const restartSelect = document.createElement('select');
                ['no', 'always', 'on-failure', 'unless-stopped'].forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt;
                    option.textContent = opt;
                    option.selected = service.restart === opt;
                    restartSelect.appendChild(option);
                });
                restartSelect.onchange = function() { updateService(service.id, 'restart', this.value); };
                restartGroup.appendChild(restartSelect);
                card.appendChild(restartGroup);
                
                // Command
                const cmdGroup = document.createElement('div');
                cmdGroup.className = 'form-group';
                const cmdLabel = document.createElement('label');
                cmdLabel.textContent = 'ÂêØÂä®ÂëΩ‰ª§ (ÂèØÈÄâ)';
                cmdGroup.appendChild(cmdLabel);
                const cmdInput = document.createElement('input');
                cmdInput.type = 'text';
                cmdInput.value = service.command || '';
                cmdInput.placeholder = 'npm start';
                cmdInput.onchange = function() { updateService(service.id, 'command', this.value); };
                cmdGroup.appendChild(cmdInput);
                card.appendChild(cmdGroup);
                
                container.appendChild(card);
            });
        }
        
        function generateYaml() {
            let yaml = 'version: "3.8"\n\nservices:\n';
            
            const volumes = new Set();
            
            services.forEach(service => {
                yaml += '  ' + service.name + ':\n';
                yaml += '    image: ' + service.image + '\n';
                
                if (service.ports.length > 0) {
                    const validPorts = service.ports.filter(p => p.host && p.container);
                    if (validPorts.length > 0) {
                        yaml += '    ports:\n';
                        validPorts.forEach(port => {
                            yaml += '      - "' + port.host + ':' + port.container + '"\n';
                        });
                    }
                }
                
                if (service.volumes.length > 0) {
                    const validVols = service.volumes.filter(v => v.host && v.container);
                    if (validVols.length > 0) {
                        yaml += '    volumes:\n';
                        validVols.forEach(vol => {
                            yaml += '      - ' + vol.host + ':' + vol.container + '\n';
                            // Ê£ÄÊµãÂëΩÂêçÂç∑
                            if (!vol.host.startsWith('.') && !vol.host.startsWith('/')) {
                                volumes.add(vol.host);
                            }
                        });
                    }
                }
                
                if (service.env.length > 0) {
                    const validEnv = service.env.filter(e => e.key);
                    if (validEnv.length > 0) {
                        yaml += '    environment:\n';
                        validEnv.forEach(env => {
                            yaml += '      - ' + env.key + '=' + env.value + '\n';
                        });
                    }
                }
                
                if (service.depends_on && service.depends_on.length > 0) {
                    yaml += '    depends_on:\n';
                    service.depends_on.forEach(dep => {
                        yaml += '      - ' + dep + '\n';
                    });
                }
                
                if (service.restart && service.restart !== 'no') {
                    yaml += '    restart: ' + service.restart + '\n';
                }
                
                if (service.command) {
                    yaml += '    command: ' + service.command + '\n';
                }
                
                yaml += '\n';
            });
            
            if (volumes.size > 0) {
                yaml += 'volumes:\n';
                volumes.forEach(vol => {
                    yaml += '  ' + vol + ':\n';
                });
            }
            
            document.getElementById('yamlOutput').textContent = yaml;
        }
        
        function copyYaml() {
            const yaml = document.getElementById('yamlOutput').textContent;
            navigator.clipboard.writeText(yaml).then(function() {
                showToast('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
            });
        }
        
        function downloadYaml() {
            const yaml = document.getElementById('yamlOutput').textContent;
            const blob = new Blob([yaml], { type: 'text/yaml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'docker-compose.yml';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('Êñá‰ª∂Â∑≤‰∏ãËΩΩÔºÅ');
        }
        
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(function() {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // ÂàùÂßãÂåñ
        initTheme();
        loadTemplate('webApp');
    </script>
</body>
</html>
