<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç ´å†°æ¸¸æˆç”Ÿæˆå™¨ - WebUtils</title>
    <meta name="description" content="ç ´å†°æ¸¸æˆç”Ÿæˆå™¨ï¼šåœ¨çº¿å®ç”¨å·¥å…·ï¼Œå…è´¹åœ¨çº¿ä½¿ç”¨ï¼Œæ— éœ€å®‰è£…" />
    <meta name="keywords" content="ç ´å†°æ¸¸æˆç”Ÿæˆå™¨, å·¥å…·, åœ¨çº¿, å®ç”¨" />
    <meta property="og:title" content="ç ´å†°æ¸¸æˆç”Ÿæˆå™¨ - WebUtils" />
    <meta property="og:description" content="ç ´å†°æ¸¸æˆç”Ÿæˆå™¨ï¼šåœ¨çº¿å®ç”¨å·¥å…·ï¼Œå…è´¹åœ¨çº¿ä½¿ç”¨ï¼Œæ— éœ€å®‰è£…" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/team-tools/icebreaker.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/team-tools/icebreaker.html" />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-magenta: #f72585;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-blue: #4cc9f0;
        --accent-purple: #7b2cbf;
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
        --font-sans: "Space Grotesk", -apple-system, blinkmacsystemfont, "Segoe UI", roboto, sans-serif;
        --font-mono: "JetBrains Mono", "Courier New", monospace;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
        --accent-cyan: #00d4b8;
        --accent-magenta: #e63975;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      

      

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-sans);
        background: var(--bg-color);
        color: var(--text-color);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        position: relative;
      }

      .header h1 {
        font-size: 2rem;
        margin-bottom: 10px;
        background: linear-gradient(135deg, var(--accent-color), #a855f7);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .theme-toggle {
        position: absolute;
        right: 0;
        top: 0;
        background: var(--bg-card);
        border: 1px solid var(--border-subtle);
        color: var(--text-color);
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
      }

      .back-link {
        position: absolute;
        left: 0;
        top: 0;
        color: var(--accent-color);
        text-decoration: none;
        font-size: 14px;
      }

      .back-link:hover {
        text-decoration: underline;
      }

      .panel {
        background: var(--bg-card);
        border-radius: 16px;
        padding: 25px;
        border: 1px solid var(--border-subtle);
        margin-bottom: 20px;
      }

      .panel-title {
        font-size: 1rem;
        margin-bottom: 15px;
        color: var(--accent-color);
      }

      .category-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 10px;
        margin-bottom: 20px;
      }

      .category-btn {
        padding: 15px;
        background: var(--bg-input);
        border: 2px solid var(--border-subtle);
        border-radius: 12px;
        color: var(--text-color);
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .category-btn:hover {
        border-color: var(--accent-color);
      }

      .category-btn.active {
        border-color: var(--accent-color);
        background: rgba(0, 217, 255, 0.1);
      }

      .category-icon {
        font-size: 2rem;
        margin-bottom: 8px;
      }

      .category-name {
        font-size: 13px;
        font-weight: 500;
      }

      .result-card {
        background: linear-gradient(135deg, var(--primary-color), var(--bg-card));
        border-radius: 16px;
        padding: 40px;
        text-align: center;
        min-height: 250px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        position: relative;
        overflow: hidden;
      }

      .result-card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(0, 217, 255, 0.1) 0%, transparent 70%);
        animation: rotate 20s linear infinite;
      }

      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      .result-emoji {
        font-size: 4rem;
        margin-bottom: 20px;
        position: relative;
        z-index: 1;
      }

      .result-text {
        font-size: 1.4rem;
        line-height: 1.6;
        max-width: 500px;
        position: relative;
        z-index: 1;
      }

      .result-category {
        margin-top: 20px;
        padding: 8px 16px;
        background: var(--accent-color);
        color: #000;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        position: relative;
        z-index: 1;
      }

      .btn {
        padding: 12px 24px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: var(--accent-color);
        color: #000;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 20px rgba(0, 217, 255, 0.3);
      }

      .btn-secondary {
        background: var(--primary-color);
        color: var(--text-color);
      }

      .btn-group {
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .generate-btn {
        width: 100%;
        padding: 20px;
        font-size: 1.2rem;
        margin-top: 20px;
      }

      .history-list {
        max-height: 300px;
        overflow-y: auto;
      }

      .history-item {
        padding: 15px;
        background: var(--bg-input);
        border-radius: 8px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .history-item:hover {
        background: var(--primary-color);
      }

      .history-text {
        font-size: 14px;
        margin-bottom: 5px;
      }

      .history-meta {
        font-size: 12px;
        opacity: 0.6;
      }

      .form-group {
        margin-bottom: 15px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .form-group input,
      .form-group textarea {
        width: 100%;
        padding: 12px;
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: 8px;
        color: var(--text-color);
        font-size: 14px;
      }

      .form-group input:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: var(--accent-color);
      }

      .custom-questions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      .custom-tag {
        background: var(--primary-color);
        padding: 6px 12px;
        border-radius: 16px;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .custom-tag button {
        background: none;
        border: none;
        color: var(--danger-color);
        cursor: pointer;
        padding: 0;
        font-size: 14px;
      }

      .difficulty-selector {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }

      .difficulty-btn {
        flex: 1;
        padding: 12px;
        background: var(--bg-input);
        border: 1px solid var(--border-subtle);
        border-radius: 8px;
        color: var(--text-color);
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .difficulty-btn.active {
        border-color: var(--accent-color);
        background: rgba(0, 217, 255, 0.1);
      }

      .stats-row {
        display: flex;
        gap: 20px;
        justify-content: center;
        margin-top: 20px;
        font-size: 13px;
        opacity: 0.7;
      }

      .timer-display {
        font-size: 3rem;
        font-weight: 300;
        font-family: var(--font-mono);
        text-align: center;
        margin: 20px 0;
      }

      .timer-controls {
        display: flex;
        gap: 10px;
        justify-content: center;
      }

      .timer-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        cursor: pointer;
        font-size: 1.2rem;
        transition: all 0.3s ease;
      }

      .timer-btn.play {
        background: var(--success-color);
        color: #000;
      }

      .timer-btn.pause {
        background: var(--warning-color);
        color: #000;
      }

      .timer-btn.reset {
        background: var(--primary-color);
        color: var(--text-color);
      }
    </style>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <a href="../../index.html" class="back-link">â† è¿”å›å·¥å…·åˆ—è¡¨</a>
        <h1>ç ´å†°æ¸¸æˆç”Ÿæˆå™¨</h1>
        <p>è®©å›¢é˜Ÿæ´»åŠ¨æ›´æœ‰è¶£</p>
        <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ åˆ‡æ¢ä¸»é¢˜</button>
      </div>

      <div class="panel">
        <div class="panel-title">ğŸ¯ é€‰æ‹©ç±»åˆ«</div>
        <div class="category-grid" id="categoryGrid"></div>

        <div class="panel-title">âš¡ éš¾åº¦é€‰æ‹©</div>
        <div class="difficulty-selector">
          <button class="difficulty-btn active" onclick="setDifficulty('easy', this)">
            ğŸ˜Š è½»æ¾
          </button>
          <button class="difficulty-btn" onclick="setDifficulty('medium', this)">ğŸ¤” ä¸­ç­‰</button>
          <button class="difficulty-btn" onclick="setDifficulty('hard', this)">ğŸ”¥ æŒ‘æˆ˜</button>
        </div>
      </div>

      <div class="panel">
        <div class="result-card" id="resultCard">
          <div class="result-emoji" id="resultEmoji">ğŸ²</div>
          <div class="result-text" id="resultText">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ç”Ÿæˆç ´å†°é—®é¢˜</div>
          <div class="result-category" id="resultCategory" style="display: none"></div>
        </div>
        <button class="btn btn-primary generate-btn" onclick="generate()">ğŸ² éšæœºç”Ÿæˆ</button>
        <div class="stats-row">
          <span>
            å·²ç”Ÿæˆ:
            <strong id="generatedCount">0</strong>
            æ¬¡
          </span>
          <span>
            æ”¶è—:
            <strong id="favoriteCount">0</strong>
            ä¸ª
          </span>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">â±ï¸ å›ç­”è®¡æ—¶å™¨</div>
        <div class="timer-display" id="timerDisplay">01:00</div>
        <div class="timer-controls">
          <button class="timer-btn play" id="timerPlayBtn" onclick="toggleTimer()">â–¶</button>
          <button class="timer-btn reset" onclick="resetTimer()">â†º</button>
        </div>
        <div style="text-align: center; margin-top: 15px">
          <label style="font-size: 13px">
            æ—¶é•¿:
            <select
              id="timerDuration"
              onchange="updateTimerDuration()"
              style="
                padding: 5px;
                background: var(--bg-input);
                border: 1px solid var(--border-subtle);
                border-radius: 4px;
                color: var(--text-color);
              "
            >
              <option value="30">30ç§’</option>
              <option value="60" selected>1åˆ†é’Ÿ</option>
              <option value="90">1åˆ†30ç§’</option>
              <option value="120">2åˆ†é’Ÿ</option>
            </select>
          </label>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">â• è‡ªå®šä¹‰é—®é¢˜</div>
        <div class="form-group">
          <input
            type="text"
            id="customInput"
            placeholder="è¾“å…¥è‡ªå®šä¹‰çš„ç ´å†°é—®é¢˜"
            onkeypress="handleCustomKeypress(event)"
          />
        </div>
        <div class="btn-group" style="justify-content: flex-start">
          <button class="btn btn-secondary" onclick="addCustomQuestion()">æ·»åŠ é—®é¢˜</button>
        </div>
        <div class="custom-questions" id="customQuestions"></div>
      </div>

      <div class="panel">
        <div class="panel-title">ğŸ“œ å†å²è®°å½•</div>
        <div class="history-list" id="historyList"></div>
        <div class="btn-group" style="margin-top: 15px">
          <button class="btn btn-secondary" onclick="clearHistory()">æ¸…ç©ºå†å²</button>
          <button class="btn btn-secondary" onclick="exportHistory()">å¯¼å‡ºæ”¶è—</button>
        </div>
      </div>
    </div>

    <script>
      var LS_KEY = "icebreaker-data";
      var selectedCategories = ["general"];
      var difficulty = "easy";
      var history = [];
      var favorites = [];
      var customQuestions = [];
      var generatedCount = 0;

      var timerInterval = null;
      var timerSeconds = 60;
      var isTimerRunning = false;

      var categories = {
        general: {
          icon: "ğŸ’¬",
          name: "é€šç”¨",
          questions: {
            easy: [
              "ä½ æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ‰ä»€ä¹ˆå…´è¶£çˆ±å¥½ï¼Ÿ",
              "ä½ æœ€å–œæ¬¢çš„ç”µå½±æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€å–œæ¬¢çš„å­£èŠ‚æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€è¿‘åœ¨è¿½ä»€ä¹ˆå‰§ï¼Ÿ",
              "ä½ å–œæ¬¢çŒ«è¿˜æ˜¯ç‹—ï¼Ÿ",
              "ä½ æœ€å–œæ¬¢çš„é¢œè‰²æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€å¸¸ç”¨çš„è¡¨æƒ…åŒ…æ˜¯ä»€ä¹ˆï¼Ÿ"
            ],
            medium: [
              "å¦‚æœå¯ä»¥æ‹¥æœ‰ä¸€é¡¹è¶…èƒ½åŠ›ï¼Œä½ ä¼šé€‰æ‹©ä»€ä¹ˆï¼Ÿ",
              "ä½ å°æ—¶å€™çš„æ¢¦æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ",
              "å¦‚æœå¯ä»¥å’Œä»»ä½•äººå…±è¿›æ™šé¤ï¼Œä½ ä¼šé€‰è°ï¼Ÿ",
              "ä½ åšè¿‡æœ€ç–¯ç‹‚çš„äº‹æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€æƒ³å»çš„æ—…è¡Œç›®çš„åœ°æ˜¯å“ªé‡Œï¼Ÿ"
            ],
            hard: [
              "ä½ äººç”Ÿä¸­æœ€é‡è¦çš„è½¬æŠ˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€åæ‚”çš„ä¸€ä¸ªå†³å®šæ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä»€ä¹ˆäº‹æƒ…è®©ä½ é‡æ–°å®šä¹‰äº†è‡ªå·±ï¼Ÿ",
              "ä½ è®¤ä¸ºä»€ä¹ˆæ˜¯æˆåŠŸï¼Ÿ"
            ]
          }
        },
        work: {
          icon: "ğŸ’¼",
          name: "å·¥ä½œ",
          questions: {
            easy: [
              "ä½ æ˜¯å¦‚ä½•è¿›å…¥è¿™ä¸ªè¡Œä¸šçš„ï¼Ÿ",
              "ä½ å·¥ä½œä¸­æœ€æœ‰æˆå°±æ„Ÿçš„æ—¶åˆ»æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€å–œæ¬¢å·¥ä½œçš„å“ªä¸ªéƒ¨åˆ†ï¼Ÿ",
              "ä½ é€šå¸¸æ€ä¹ˆåº¦è¿‡åˆä¼‘æ—¶é—´ï¼Ÿ",
              "ä½ çš„å·¥ä½œæ¡Œä¸Šå¿…å¤‡çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ"
            ],
            medium: [
              "ä½ ä»å¤±è´¥ä¸­å­¦åˆ°çš„æœ€é‡è¦çš„ä¸€è¯¾æ˜¯ä»€ä¹ˆï¼Ÿ",
              "å¦‚æœå¯ä»¥æ”¹å˜å…¬å¸çš„ä¸€ä»¶äº‹ï¼Œä½ ä¼šæ”¹å˜ä»€ä¹ˆï¼Ÿ",
              "ä½ èŒä¸šç”Ÿæ¶¯ä¸­æœ€éš¾å¿˜çš„é¡¹ç›®æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ å¦‚ä½•ä¿æŒå·¥ä½œä¸ç”Ÿæ´»çš„å¹³è¡¡ï¼Ÿ"
            ],
            hard: [
              "ä½ è®¤ä¸ºè‡ªå·±5å¹´åä¼šåœ¨å“ªé‡Œï¼Ÿ",
              "ä»€ä¹ˆæ ·çš„é¢†å¯¼è€…æœ€èƒ½æ¿€åŠ±ä½ ï¼Ÿ",
              "ä½ å¦‚ä½•å®šä¹‰è‡ªå·±çš„èŒä¸šä»·å€¼ï¼Ÿ"
            ]
          }
        },
        fun: {
          icon: "ğŸ‰",
          name: "è¶£å‘³",
          questions: {
            easy: [
              "ä½ æœ€å°´å°¬çš„æ—¶åˆ»æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ‰ä»€ä¹ˆå¥‡æ€ªçš„æ‰è‰ºï¼Ÿ",
              "ä½ æœ€æ€•çš„åŠ¨ç‰©æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ åšè¿‡æœ€å‚»çš„äº‹æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€å–œæ¬¢çš„é›¶é£Ÿæ˜¯ä»€ä¹ˆï¼Ÿ"
            ],
            medium: [
              "å¦‚æœä½ æ˜¯ä¸€ç§åŠ¨ç‰©ï¼Œä½ ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ",
              "å¦‚æœä½ çš„äººç”Ÿæ˜¯ä¸€éƒ¨ç”µå½±ï¼Œå«ä»€ä¹ˆåå­—ï¼Ÿ",
              "ä½ æœ‰ä»€ä¹ˆç‹¬ç‰¹çš„æ”¶è—çˆ±å¥½ï¼Ÿ",
              "ä½ æœ€æƒ³å­¦ä¼šçš„æŠ€èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ"
            ],
            hard: ["å¦‚æœæ˜å¤©å°±æ˜¯ä¸–ç•Œæœ«æ—¥ï¼Œä½ ä»Šå¤©ä¼šåšä»€ä¹ˆï¼Ÿ", "ä½ æ„¿æ„æ”¾å¼ƒä»€ä¹ˆæ¥æ¢å–ä¸€é¡¹è¶…èƒ½åŠ›ï¼Ÿ"]
          }
        },
        creative: {
          icon: "ğŸ¨",
          name: "åˆ›æ„",
          questions: {
            easy: [
              "ç”¨ä¸‰ä¸ªè¯å½¢å®¹è‡ªå·±",
              "å¦‚æœä½ æ˜¯ä¸€é“èœï¼Œä½ ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ æœ€æƒ³æˆä¸ºå“ªä¸ªè™šæ„äººç‰©ï¼Ÿ",
              "ä½ çš„äººç”Ÿåº§å³é“­æ˜¯ä»€ä¹ˆï¼Ÿ"
            ],
            medium: [
              "å¦‚æœå¯ä»¥å‘æ˜ä¸€æ ·ä¸œè¥¿ï¼Œä½ ä¼šå‘æ˜ä»€ä¹ˆï¼Ÿ",
              "ç”¨ä¸€é¦–æ­Œæ¥å½¢å®¹ä½ çš„äººç”Ÿ",
              "å¦‚æœå¯ä»¥æ´»åœ¨ä»»ä½•æ—¶ä»£ï¼Œä½ ä¼šé€‰æ‹©å“ªä¸ªï¼Ÿ",
              "ä½ ä¼šå¦‚ä½•å‘å¤–æ˜Ÿäººä»‹ç»åœ°çƒï¼Ÿ"
            ],
            hard: ["å¦‚æœè¦å†™ä¸€æœ¬å…³äºè‡ªå·±çš„ä¹¦ï¼Œä¹¦åæ˜¯ä»€ä¹ˆï¼Ÿ", "ä½ è®¤ä¸ºä»€ä¹ˆæ˜¯åˆ›é€ åŠ›ï¼Ÿ"]
          }
        },
        team: {
          icon: "ğŸ‘¥",
          name: "å›¢é˜Ÿ",
          questions: {
            easy: [
              "ä½ æœ€æ¬£èµåŒäº‹èº«ä¸Šçš„ä»€ä¹ˆå“è´¨ï¼Ÿ",
              "ä½ è§‰å¾—å¥½çš„å›¢é˜Ÿåä½œæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ",
              "ä½ å–œæ¬¢ä»€ä¹ˆæ ·çš„å·¥ä½œæ°›å›´ï¼Ÿ",
              "å›¢é˜Ÿæ´»åŠ¨ä½ æœ€å–œæ¬¢åšä»€ä¹ˆï¼Ÿ"
            ],
            medium: [
              "ä½ åœ¨å›¢é˜Ÿä¸­é€šå¸¸æ‰®æ¼”ä»€ä¹ˆè§’è‰²ï¼Ÿ",
              "ä½ è®¤ä¸ºä»€ä¹ˆè®©ä¸€ä¸ªå›¢é˜Ÿå˜å¾—å‡ºè‰²ï¼Ÿ",
              "ä½ ä»å›¢é˜Ÿæˆå‘˜èº«ä¸Šå­¦åˆ°çš„æœ€é‡è¦çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ"
            ],
            hard: ["ä½ å¦‚ä½•å¤„ç†å›¢é˜Ÿä¸­çš„å†²çªï¼Ÿ", "ä½ è®¤ä¸ºä¿¡ä»»åœ¨å›¢é˜Ÿä¸­æœ‰å¤šé‡è¦ï¼Ÿ"]
          }
        },
        deep: {
          icon: "ğŸ§ ",
          name: "æ·±åº¦",
          questions: {
            easy: ["ä½ æœ€æ„Ÿæ¿€çš„ä¸€ä»¶äº‹æ˜¯ä»€ä¹ˆï¼Ÿ", "ä»€ä¹ˆè®©ä½ æ„Ÿåˆ°å¿«ä¹ï¼Ÿ", "ä½ æœ€çè§†çš„å›å¿†æ˜¯ä»€ä¹ˆï¼Ÿ"],
            medium: [
              "ä½ å¦‚ä½•å®šä¹‰å¹¸ç¦ï¼Ÿ",
              "ä»€ä¹ˆä»·å€¼è§‚å¯¹ä½ æœ€é‡è¦ï¼Ÿ",
              "ä½ æœ€å¤§çš„ææƒ§æ˜¯ä»€ä¹ˆï¼Ÿ",
              "ä½ å¸Œæœ›åˆ«äººæ€ä¹ˆè®°ä½ä½ ï¼Ÿ"
            ],
            hard: ["ä½ çš„äººç”Ÿç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ", "ä»€ä¹ˆäº‹æƒ…è®©ä½ å¤œä¸èƒ½å¯ï¼Ÿ", "ä½ è®¤ä¸ºç”Ÿå‘½çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ"]
          }
        }
      };

      function init() {
        var savedTheme = localStorage.getItem("theme") || "dark";
        if (savedTheme === "light") {
          document.body.setAttribute("data-theme", "light");
        }

        loadFromStorage();
        renderCategories();
        renderCustomQuestions();
        renderHistory();
        updateStats();
      }

      function renderCategories() {
        var container = document.getElementById("categoryGrid");
        container.textContent = "";

        Object.keys(categories).forEach(function (key) {
          var cat = categories[key];
          var btn = document.createElement("button");
          btn.className =
            "category-btn" + (selectedCategories.indexOf(key) !== -1 ? " active" : "");

          var icon = document.createElement("div");
          icon.className = "category-icon";
          icon.textContent = cat.icon;

          var name = document.createElement("div");
          name.className = "category-name";
          name.textContent = cat.name;

          btn.appendChild(icon);
          btn.appendChild(name);
          btn.onclick = function () {
            toggleCategory(key, btn);
          };
          container.appendChild(btn);
        });
      }

      function toggleCategory(key, btn) {
        var index = selectedCategories.indexOf(key);
        if (index !== -1) {
          if (selectedCategories.length > 1) {
            selectedCategories.splice(index, 1);
            btn.classList.remove("active");
          }
        } else {
          selectedCategories.push(key);
          btn.classList.add("active");
        }
        saveToStorage();
      }

      function setDifficulty(level, btn) {
        difficulty = level;
        document.querySelectorAll(".difficulty-btn").forEach(function (b) {
          b.classList.remove("active");
        });
        btn.classList.add("active");
        saveToStorage();
      }

      function generate() {
        var allQuestions = [];

        selectedCategories.forEach(function (catKey) {
          var cat = categories[catKey];
          if (cat && cat.questions[difficulty]) {
            cat.questions[difficulty].forEach(function (q) {
              allQuestions.push({ text: q, category: cat.name, icon: cat.icon });
            });
          }
        });

        customQuestions.forEach(function (q) {
          allQuestions.push({ text: q, category: "è‡ªå®šä¹‰", icon: "âœ¨" });
        });

        if (allQuestions.length === 0) {
          showToast("æ²¡æœ‰å¯ç”¨çš„é—®é¢˜");
          return;
        }

        var question = allQuestions[Math.floor(Math.random() * allQuestions.length)];

        document.getElementById("resultEmoji").textContent = question.icon;
        document.getElementById("resultText").textContent = question.text;
        document.getElementById("resultCategory").textContent = question.category;
        document.getElementById("resultCategory").style.display = "inline-block";

        history.unshift({
          text: question.text,
          category: question.category,
          time: new Date().toISOString()
        });

        if (history.length > 50) {
          history = history.slice(0, 50);
        }

        generatedCount++;
        renderHistory();
        updateStats();
        saveToStorage();

        var card = document.getElementById("resultCard");
        card.style.animation = "none";
        card.offsetHeight;
        card.style.animation = "pulse 0.3s ease";
      }

      function addCustomQuestion() {
        var input = document.getElementById("customInput");
        var text = input.value.trim();
        if (text && customQuestions.indexOf(text) === -1) {
          customQuestions.push(text);
          input.value = "";
          renderCustomQuestions();
          saveToStorage();
          showToast("å·²æ·»åŠ è‡ªå®šä¹‰é—®é¢˜");
        }
      }

      function handleCustomKeypress(e) {
        if (e.key === "Enter") {
          addCustomQuestion();
        }
      }

      function removeCustomQuestion(index) {
        customQuestions.splice(index, 1);
        renderCustomQuestions();
        saveToStorage();
      }

      function renderCustomQuestions() {
        var container = document.getElementById("customQuestions");
        container.textContent = "";

        customQuestions.forEach(function (q, index) {
          var tag = document.createElement("div");
          tag.className = "custom-tag";

          var text = document.createElement("span");
          text.textContent = q.length > 20 ? q.substring(0, 20) + "..." : q;
          text.title = q;

          var btn = document.createElement("button");
          btn.textContent = "Ã—";
          btn.onclick = function () {
            removeCustomQuestion(index);
          };

          tag.appendChild(text);
          tag.appendChild(btn);
          container.appendChild(tag);
        });
      }

      function renderHistory() {
        var container = document.getElementById("historyList");
        container.textContent = "";

        if (history.length === 0) {
          var empty = document.createElement("div");
          empty.style.textAlign = "center";
          empty.style.padding = "20px";
          empty.style.opacity = "0.6";
          empty.textContent = "è¿˜æ²¡æœ‰å†å²è®°å½•";
          container.appendChild(empty);
          return;
        }

        history.slice(0, 20).forEach(function (item, index) {
          var div = document.createElement("div");
          div.className = "history-item";

          var text = document.createElement("div");
          text.className = "history-text";
          text.textContent = item.text;

          var meta = document.createElement("div");
          meta.className = "history-meta";
          var time = new Date(item.time);
          meta.textContent = item.category + " Â· " + formatTime(time);

          div.appendChild(text);
          div.appendChild(meta);
          div.onclick = function () {
            document.getElementById("resultText").textContent = item.text;
            document.getElementById("resultCategory").textContent = item.category;
            document.getElementById("resultCategory").style.display = "inline-block";
          };
          container.appendChild(div);
        });
      }

      function formatTime(date) {
        var now = new Date();
        var diff = now - date;

        if (diff < 60000) return "åˆšåˆš";
        if (diff < 3600000) return Math.floor(diff / 60000) + "åˆ†é’Ÿå‰";
        if (diff < 86400000) return Math.floor(diff / 3600000) + "å°æ—¶å‰";
        return Math.floor(diff / 86400000) + "å¤©å‰";
      }

      function updateStats() {
        document.getElementById("generatedCount").textContent = generatedCount;
        document.getElementById("favoriteCount").textContent = favorites.length;
      }

      function clearHistory() {
        if (confirm("ç¡®å®šè¦æ¸…ç©ºå†å²è®°å½•å—ï¼Ÿ")) {
          history = [];
          renderHistory();
          saveToStorage();
        }
      }

      function exportHistory() {
        if (history.length === 0) {
          showToast("æ²¡æœ‰å†å²è®°å½•å¯å¯¼å‡º");
          return;
        }

        var lines = ["# ç ´å†°é—®é¢˜æ”¶è—", ""];
        history.forEach(function (item, index) {
          lines.push(index + 1 + ". " + item.text);
          lines.push("   åˆ†ç±»: " + item.category);
          lines.push("");
        });

        var content = lines.join("\n");
        var blob = new Blob([content], { type: "text/plain;charset=utf-8" });
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url;
        a.download = "ç ´å†°é—®é¢˜æ”¶è—.txt";
        a.click();
        URL.revokeObjectURL(url);
      }

      function toggleTimer() {
        if (isTimerRunning) {
          pauseTimer();
        } else {
          startTimer();
        }
      }

      function startTimer() {
        isTimerRunning = true;
        document.getElementById("timerPlayBtn").textContent = "â¸";
        document.getElementById("timerPlayBtn").classList.remove("play");
        document.getElementById("timerPlayBtn").classList.add("pause");

        timerInterval = setInterval(function () {
          timerSeconds--;
          updateTimerDisplay();

          if (timerSeconds <= 0) {
            pauseTimer();
            playSound();
            showToast("æ—¶é—´åˆ°ï¼");
          }
        }, 1000);
      }

      function pauseTimer() {
        isTimerRunning = false;
        document.getElementById("timerPlayBtn").textContent = "â–¶";
        document.getElementById("timerPlayBtn").classList.remove("pause");
        document.getElementById("timerPlayBtn").classList.add("play");

        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
      }

      function resetTimer() {
        pauseTimer();
        timerSeconds = parseInt(document.getElementById("timerDuration").value);
        updateTimerDisplay();
      }

      function updateTimerDuration() {
        if (!isTimerRunning) {
          timerSeconds = parseInt(document.getElementById("timerDuration").value);
          updateTimerDisplay();
        }
      }

      function updateTimerDisplay() {
        var mins = Math.floor(timerSeconds / 60);
        var secs = timerSeconds % 60;
        document.getElementById("timerDisplay").textContent =
          String(mins).padStart(2, "0") + ":" + String(secs).padStart(2, "0");
      }

      function playSound() {
        try {
          var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
          var oscillator = audioCtx.createOscillator();
          var gainNode = audioCtx.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(audioCtx.destination);

          oscillator.frequency.value = 800;
          oscillator.type = "sine";
          gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);

          oscillator.start(audioCtx.currentTime);
          oscillator.stop(audioCtx.currentTime + 0.5);
        } catch (e) {
          console.log("Sound not supported");
        }
      }

      function saveToStorage() {
        var data = {
          selectedCategories: selectedCategories,
          difficulty: difficulty,
          history: history,
          favorites: favorites,
          customQuestions: customQuestions,
          generatedCount: generatedCount
        };
        localStorage.setItem(LS_KEY, JSON.stringify(data));
      }

      function loadFromStorage() {
        var saved = localStorage.getItem(LS_KEY);
        if (saved) {
          try {
            var data = JSON.parse(saved);
            if (data.selectedCategories) selectedCategories = data.selectedCategories;
            if (data.difficulty) difficulty = data.difficulty;
            if (data.history) history = data.history;
            if (data.favorites) favorites = data.favorites;
            if (data.customQuestions) customQuestions = data.customQuestions;
            if (data.generatedCount) generatedCount = data.generatedCount;

            document.querySelectorAll(".difficulty-btn").forEach(function (btn) {
              btn.classList.remove("active");
              if (
                (difficulty === "easy" && btn.textContent.indexOf("è½»æ¾") !== -1) ||
                (difficulty === "medium" && btn.textContent.indexOf("ä¸­ç­‰") !== -1) ||
                (difficulty === "hard" && btn.textContent.indexOf("æŒ‘æˆ˜") !== -1)
              ) {
                btn.classList.add("active");
              }
            });
          } catch (e) {
            console.error("Failed to load from storage");
          }
        }
      }

      function showToast(message) {
        var toast = document.createElement("div");
        toast.style.cssText =
          "position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:var(--accent-color);color:#000;padding:12px 24px;border-radius:8px;z-index:1000;font-size:14px;";
        toast.textContent = message;
        document.body.appendChild(toast);
        setTimeout(function () {
          toast.remove();
        }, 2000);
      }

      window.toggleTheme = function () {
        var body = document.body;
        var currentTheme = body.getAttribute("data-theme");
        var newTheme = currentTheme === "light" ? "dark" : "light";
        body.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      };

      init();
    </script>
  </body>
</html>
