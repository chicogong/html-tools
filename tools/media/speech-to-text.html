<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯­éŸ³è½¬æ–‡å­— - HTML Tools</title>
    <meta name="description" content="ä½¿ç”¨ Web Speech API å®æ—¶å°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡å­—ï¼Œæ”¯æŒå¤šç§è¯­è¨€">
    <meta name="keywords" content="è¯­éŸ³è¯†åˆ«,è¯­éŸ³è½¬æ–‡å­—,STT,speech recognition,Web Speech API">
    <link rel="canonical" href="https://html-tools.cnb.cool/tools/media/speech-to-text.html">
    <style>
        :root {
            --bg-color: #f5f5f5;
            --text-color: #333;
            --border-color: #ddd;
            --card-bg: #fff;
            --primary-color: #673ab7;
            --primary-hover: #5e35b1;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --success-color: #4caf50;
            --error-color: #f44336;
        }
        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --border-color: #444;
            --card-bg: #2d2d2d;
            --shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; }
        h1 { font-size: 1.8rem; margin-bottom: 10px; color: var(--primary-color); }
        .subtitle { color: var(--text-color); opacity: 0.7; font-size: 0.95rem; }
        .theme-toggle {
            position: fixed; top: 20px; right: 20px;
            padding: 8px 16px; border: 1px solid var(--border-color);
            border-radius: 20px; background: var(--card-bg);
            color: var(--text-color); cursor: pointer; font-size: 14px;
        }
        .card {
            background: var(--card-bg); border-radius: 12px;
            padding: 24px; box-shadow: var(--shadow); margin-bottom: 20px;
        }
        .card-title {
            font-size: 1rem; font-weight: 600; margin-bottom: 16px;
            padding-bottom: 10px; border-bottom: 1px solid var(--border-color);
        }
        .settings-row {
            display: flex; gap: 16px; flex-wrap: wrap; margin-bottom: 20px;
        }
        .setting-item { flex: 1; min-width: 200px; }
        .setting-item label {
            display: block; margin-bottom: 6px;
            font-size: 14px; font-weight: 500;
        }
        select {
            width: 100%; padding: 10px 12px;
            border: 1px solid var(--border-color); border-radius: 6px;
            font-size: 14px; background: var(--bg-color);
            color: var(--text-color); cursor: pointer;
        }
        .mic-container {
            display: flex; flex-direction: column; align-items: center;
            padding: 40px 20px;
        }
        .mic-btn {
            width: 120px; height: 120px; border-radius: 50%;
            border: none; background: var(--primary-color);
            color: white; font-size: 48px; cursor: pointer;
            transition: all 0.3s; display: flex;
            align-items: center; justify-content: center;
            box-shadow: 0 4px 20px rgba(103, 58, 183, 0.3);
        }
        .mic-btn:hover { transform: scale(1.05); }
        .mic-btn.listening {
            background: var(--error-color);
            animation: pulse 1.5s infinite;
        }
        .mic-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0.4); }
            70% { box-shadow: 0 0 0 30px rgba(244, 67, 54, 0); }
            100% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0); }
        }
        .status {
            margin-top: 20px; font-size: 14px;
            color: var(--text-color); opacity: 0.7;
        }
        .status.listening { color: var(--error-color); opacity: 1; font-weight: 500; }
        .interim-text {
            min-height: 40px; padding: 12px;
            background: var(--bg-color); border-radius: 8px;
            margin-top: 20px; font-style: italic;
            color: var(--text-color); opacity: 0.6;
        }
        .result-area {
            min-height: 200px; padding: 16px;
            border: 1px solid var(--border-color); border-radius: 8px;
            background: var(--bg-color); font-size: 16px;
            line-height: 1.8; white-space: pre-wrap;
        }
        .actions {
            display: flex; gap: 10px; flex-wrap: wrap; margin-top: 16px;
        }
        .btn {
            padding: 10px 20px; border: none; border-radius: 6px;
            font-size: 14px; cursor: pointer; transition: all 0.3s;
        }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-secondary {
            background: transparent; border: 1px solid var(--border-color);
            color: var(--text-color);
        }
        .btn-secondary:hover { border-color: var(--primary-color); }
        .stats {
            display: flex; gap: 20px; flex-wrap: wrap;
            margin-top: 16px; padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }
        .stat-item { font-size: 13px; }
        .stat-item span { color: var(--primary-color); font-weight: 600; }
        .tips { font-size: 13px; color: var(--text-color); opacity: 0.7; line-height: 1.8; }
        .tips li { margin-bottom: 6px; }
        .not-supported {
            text-align: center; padding: 40px; color: var(--error-color);
        }
        .copy-toast {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: var(--success-color); color: white; padding: 10px 20px;
            border-radius: 8px; font-size: 14px; opacity: 0; transition: opacity 0.3s;
        }
        .copy-toast.show { opacity: 1; }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
    
    <div class="container">
        <header>
            <h1>ğŸ¤ è¯­éŸ³è½¬æ–‡å­—</h1>
            <p class="subtitle">ä½¿ç”¨ Web Speech API å®æ—¶è¯†åˆ«è¯­éŸ³å¹¶è½¬æ¢ä¸ºæ–‡å­—</p>
        </header>

        <div id="app">
            <div class="card">
                <div class="card-title">è¯­éŸ³è®¾ç½®</div>
                <div class="settings-row">
                    <div class="setting-item">
                        <label for="langSelect">è¯†åˆ«è¯­è¨€</label>
                        <select id="langSelect">
                            <option value="zh-CN">ä¸­æ–‡ (ç®€ä½“)</option>
                            <option value="zh-TW">ä¸­æ–‡ (ç¹ä½“)</option>
                            <option value="en-US">English (US)</option>
                            <option value="en-GB">English (UK)</option>
                            <option value="ja-JP">æ—¥æœ¬èª</option>
                            <option value="ko-KR">í•œêµ­ì–´</option>
                            <option value="de-DE">Deutsch</option>
                            <option value="fr-FR">FranÃ§ais</option>
                            <option value="es-ES">EspaÃ±ol</option>
                            <option value="ru-RU">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="modeSelect">è¯†åˆ«æ¨¡å¼</label>
                        <select id="modeSelect">
                            <option value="continuous">è¿ç»­è¯†åˆ«</option>
                            <option value="single">å•æ¬¡è¯†åˆ«</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="mic-container">
                    <button class="mic-btn" id="micBtn" onclick="toggleRecognition()">ğŸ¤</button>
                    <div class="status" id="status">ç‚¹å‡»éº¦å…‹é£å¼€å§‹å½•éŸ³</div>
                    <div class="interim-text" id="interimText"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">è¯†åˆ«ç»“æœ</div>
                <div class="result-area" id="resultArea"></div>
                <div class="stats">
                    <div class="stat-item">å­—æ•°: <span id="charCount">0</span></div>
                    <div class="stat-item">è¯æ•°: <span id="wordCount">0</span></div>
                    <div class="stat-item">æ®µè½: <span id="paraCount">0</span></div>
                </div>
                <div class="actions">
                    <button class="btn btn-primary" onclick="copyText()">ğŸ“‹ å¤åˆ¶æ–‡æœ¬</button>
                    <button class="btn btn-secondary" onclick="downloadText()">ğŸ’¾ ä¸‹è½½</button>
                    <button class="btn btn-secondary" onclick="clearText()">ğŸ—‘ï¸ æ¸…ç©º</button>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ä½¿ç”¨æç¤º</div>
                <ul class="tips">
                    <li>æœ¬å·¥å…·ä½¿ç”¨æµè§ˆå™¨å†…ç½®çš„ Web Speech APIï¼Œæ‰€æœ‰å¤„ç†åœ¨æœ¬åœ°å®Œæˆ</li>
                    <li>é¦–æ¬¡ä½¿ç”¨éœ€è¦æˆæƒéº¦å…‹é£è®¿é—®æƒé™</li>
                    <li>å»ºè®®åœ¨å®‰é™çš„ç¯å¢ƒä¸­ä½¿ç”¨ä»¥è·å¾—æ›´å¥½çš„è¯†åˆ«æ•ˆæœ</li>
                    <li>è¿ç»­è¯†åˆ«æ¨¡å¼ä¼šæŒç»­ç›‘å¬ï¼Œå•æ¬¡è¯†åˆ«æ¨¡å¼åœ¨åœé¡¿åè‡ªåŠ¨åœæ­¢</li>
                    <li>æ”¯æŒå¤šç§è¯­è¨€ï¼Œè¯·é€‰æ‹©ä¸è¯´è¯è¯­è¨€åŒ¹é…çš„é€‰é¡¹</li>
                </ul>
            </div>
        </div>

        <div class="not-supported" id="notSupported" style="display: none;">
            <h2>ğŸ˜” æµè§ˆå™¨ä¸æ”¯æŒ</h2>
            <p>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Speech API</p>
            <p>è¯·å°è¯•ä½¿ç”¨ Chromeã€Edge ç­‰ç°ä»£æµè§ˆå™¨</p>
        </div>
    </div>

    <div class="copy-toast" id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>

    <script>
        window.toggleTheme = function() {
            const html = document.documentElement;
            const newTheme = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        };
        (function() {
            const savedTheme = localStorage.getItem('theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();

        // Check browser support
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        
        if (!SpeechRecognition) {
            document.getElementById('app').style.display = 'none';
            document.getElementById('notSupported').style.display = 'block';
        }

        let recognition = null;
        let isListening = false;
        let finalTranscript = '';

        const micBtn = document.getElementById('micBtn');
        const status = document.getElementById('status');
        const interimText = document.getElementById('interimText');
        const resultArea = document.getElementById('resultArea');

        function initRecognition() {
            recognition = new SpeechRecognition();
            recognition.lang = document.getElementById('langSelect').value;
            recognition.continuous = document.getElementById('modeSelect').value === 'continuous';
            recognition.interimResults = true;
            recognition.maxAlternatives = 1;

            recognition.onstart = () => {
                isListening = true;
                micBtn.classList.add('listening');
                micBtn.textContent = 'â¹ï¸';
                status.textContent = 'æ­£åœ¨è†å¬...';
                status.classList.add('listening');
            };

            recognition.onend = () => {
                isListening = false;
                micBtn.classList.remove('listening');
                micBtn.textContent = 'ğŸ¤';
                status.textContent = 'ç‚¹å‡»éº¦å…‹é£å¼€å§‹å½•éŸ³';
                status.classList.remove('listening');
                interimText.textContent = '';
            };

            recognition.onresult = (event) => {
                let interim = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript;
                        resultArea.textContent = finalTranscript;
                        updateStats();
                    } else {
                        interim += transcript;
                    }
                }
                
                interimText.textContent = interim;
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
                let errorMsg = 'è¯†åˆ«å‡ºé”™';
                switch (event.error) {
                    case 'no-speech':
                        errorMsg = 'æœªæ£€æµ‹åˆ°è¯­éŸ³';
                        break;
                    case 'audio-capture':
                        errorMsg = 'æœªæ‰¾åˆ°éº¦å…‹é£';
                        break;
                    case 'not-allowed':
                        errorMsg = 'è¯·æˆæƒéº¦å…‹é£è®¿é—®æƒé™';
                        break;
                    case 'network':
                        errorMsg = 'ç½‘ç»œé”™è¯¯';
                        break;
                }
                status.textContent = errorMsg;
                status.classList.remove('listening');
            };
        }

        window.toggleRecognition = function() {
            if (isListening) {
                recognition.stop();
            } else {
                initRecognition();
                recognition.start();
            }
        };

        function updateStats() {
            const text = finalTranscript;
            document.getElementById('charCount').textContent = text.length;
            document.getElementById('wordCount').textContent = 
                text.trim() ? text.trim().split(/\s+/).length : 0;
            document.getElementById('paraCount').textContent = 
                text.trim() ? text.trim().split(/\n\n+/).length : 0;
        }

        window.copyText = function() {
            if (finalTranscript) {
                navigator.clipboard.writeText(finalTranscript);
                showToast();
            }
        };

        window.downloadText = function() {
            if (!finalTranscript) return;
            const blob = new Blob([finalTranscript], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'speech-transcript.txt';
            a.click();
            URL.revokeObjectURL(url);
        };

        window.clearText = function() {
            finalTranscript = '';
            resultArea.textContent = '';
            interimText.textContent = '';
            updateStats();
        };

        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Update language when changed
        document.getElementById('langSelect').addEventListener('change', () => {
            if (isListening) {
                recognition.stop();
                setTimeout(() => {
                    initRecognition();
                    recognition.start();
                }, 100);
            }
        });
    </script>
</body>
</html>
