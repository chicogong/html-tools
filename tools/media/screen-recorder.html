<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±å¹•å½•åˆ¶ - WebUtils</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="å±å¹•å½•åˆ¶ - WebUtils" />
  <meta name="keywords" content="screen-recorder,media,tools,webutils" />
  <meta name="author" content="WebUtils" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tools.realtime-ai.chat/tools/media/screen-recorder.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="å±å¹•å½•åˆ¶ - WebUtils" />
  <meta property="og:description" content="å±å¹•å½•åˆ¶ - WebUtils" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tools.realtime-ai.chat/tools/media/screen-recorder.html" />
  <meta property="og:site_name" content="WebUtils" />
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="640" />
  <meta property="og:image:type" content="image/png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="å±å¹•å½•åˆ¶ - WebUtils" />
  <meta name="twitter:description" content="å±å¹•å½•åˆ¶ - WebUtils" />
  <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¬</text></svg>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-input: #0e0e14;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --border-strong: #3a3a4a;
      --accent-cyan: #00f5d4;
      --accent-green: #10b981;
      --accent-red: #f43f5e;
      --accent-yellow: #fbbf24;
      --accent-purple: #a855f7;
      --glow-cyan: rgb(0, 245, 212, 0.15);
      --glow-green: rgb(16, 185, 129, 0.15);
      --glow-red: rgb(244, 63, 94, 0.15);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    [data-theme="light"] {
      --bg-deep: #fafafa;
      --bg-surface: #fff;
      --bg-card: #fff;
      --bg-input: #f5f5f5;
      --bg-hover: #f5f5f5;
      --text-primary: #1a1a1a;
      --text-secondary: #666;
      --text-muted: #999;
      --border-subtle: #e5e5e5;
      --border-strong: #d5d5d5;
    }

        :root { --primary-color: #ef4444; }
        [data-theme="dark"] { --primary-color: #f87171; }
        body { padding: 1rem; min-height: 100vh; }
        .container { max-width: 1000px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem; }
        header h1 { margin: 0; font-size: 1.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .header-actions { display: flex; gap: 0.5rem; align-items: center; }
        .theme-toggle { cursor: pointer; background: #3b82f6; border: none; padding: 0.5rem 1rem; border-radius: 8px; color: white; font-size: 1rem; }
        .back-link { color: #3b82f6; text-decoration: none; padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid #3b82f6; font-size: 0.9rem; }
        .preview-container { background: #000; border-radius: 12px; overflow: hidden; aspect-ratio: 16/9; display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem; position: relative; }
        .preview-container video { width: 100%; height: 100%; object-fit: contain; }
        .preview-placeholder { color: #666; text-align: center; }
        .preview-placeholder .icon { font-size: 4rem; margin-bottom: 1rem; }
        .recording-indicator { position: absolute; top: 1rem; left: 1rem; align-items: center; gap: 0.5rem; background: rgba(0,0,0,0.7); padding: 0.5rem 1rem; border-radius: 8px; color: white; font-size: 0.9rem; display: none; }
        .recording-indicator .dot { width: 12px; height: 12px; background: #ef4444; border-radius: 50%; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .timer { position: absolute; top: 1rem; right: 1rem; background: rgba(0,0,0,0.7); padding: 0.5rem 1rem; border-radius: 8px; color: white; font-family: 'SF Mono', Monaco, monospace; font-size: 1.1rem; display: none; }
        .controls { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1.5rem; }
        .controls button { min-width: 140px; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
        .controls button.record { background: var(--primary-color); }
        .controls button.record:hover { background: #dc2626; }
        .controls button.stop { background: #6b7280; }
        .options-section { background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; }
        .options-section h3 { margin: 0 0 1rem; font-size: 1rem; }
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .option-group label { display: block; font-size: 0.85rem; margin-bottom: 0.25rem; color: var(--muted-color); }
        .option-group select, .option-group input { width: 100%; }
        .checkbox-option { display: flex; align-items: center; gap: 0.5rem; }
        .checkbox-option input { margin: 0; }
        .recordings-section { background: var(--card-background-color); border-radius: 12px; padding: 1.5rem; }
        .recordings-section h3 { margin: 0 0 1rem; font-size: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .recordings-list { display: flex; flex-direction: column; gap: 0.75rem; }
        .recording-item { display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--code-background-color); border-radius: 8px; }
        .recording-item .thumbnail { width: 120px; height: 68px; background: #000; border-radius: 6px; overflow: hidden; flex-shrink: 0; }
        .recording-item .thumbnail video { width: 100%; height: 100%; object-fit: cover; }
        .recording-item .info { flex: 1; min-width: 0; }
        .recording-item .name { font-weight: 600; margin-bottom: 0.25rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .recording-item .meta { font-size: 0.8rem; color: var(--muted-color); }
        .recording-item .actions { display: flex; gap: 0.5rem; flex-shrink: 0; }
        .recording-item .actions button { font-size: 0.8rem; padding: 0.4rem 0.8rem; }
        .empty-state { text-align: center; padding: 2rem; color: var(--muted-color); }
        .toast { position: fixed; bottom: 20px; right: 20px; padding: 1rem 1.5rem; background: #10b981; color: white; border-radius: 8px; font-weight: 500; z-index: 1000; transform: translateY(100px); opacity: 0; transition: all 0.3s; }
        .toast.show { transform: translateY(0); opacity: 1; }
        .support-warning { background: #f59e0b20; border: 1px solid #f59e0b; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem; font-size: 0.9rem; display: none; }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#media">åª’ä½“å·¥å…·</a><span>â€º</span>å±å¹•å½•åˆ¶å™¨</nav>
    <div class="container">
        <header>
            <h1>ğŸ¬ å±å¹•å½•åˆ¶</h1>
            <div class="header-actions">
                <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
                <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </header>

        <div class="support-warning" id="supportWarning">
            <strong>âš ï¸ æµè§ˆå™¨æ”¯æŒï¼š</strong>æ‚¨çš„æµè§ˆå™¨å¯èƒ½ä¸å®Œå…¨æ”¯æŒå±å¹•å½•åˆ¶åŠŸèƒ½ã€‚å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ Chromeã€Edge æˆ– Firefoxã€‚
        </div>

        <div class="preview-container">
            <video id="preview" autoplay muted playsinline></video>
            <div class="preview-placeholder" id="placeholder">
                <div class="icon">ğŸ–¥ï¸</div>
                <p>ç‚¹å‡»"å¼€å§‹å½•åˆ¶"é€‰æ‹©è¦å½•åˆ¶çš„å±å¹•æˆ–çª—å£</p>
            </div>
            <div class="recording-indicator" id="recordingIndicator">
                <span class="dot"></span>
                <span>æ­£åœ¨å½•åˆ¶</span>
            </div>
            <div class="timer" id="timer">00:00:00</div>
        </div>

        <div class="controls">
            <button class="record" id="startBtn" onclick="startRecording()">
                <span>âº</span> å¼€å§‹å½•åˆ¶
            </button>
            <button class="stop secondary" id="stopBtn" onclick="stopRecording()" disabled>
                <span>â¹</span> åœæ­¢å½•åˆ¶
            </button>
            <button class="secondary" id="pauseBtn" onclick="togglePause()" disabled>
                <span>â¸</span> æš‚åœ
            </button>
        </div>

        <div class="options-section">
            <h3>å½•åˆ¶é€‰é¡¹</h3>
            <div class="options-grid">
                <div class="option-group">
                    <label>è§†é¢‘è´¨é‡</label>
                    <select id="quality">
                        <option value="high">é«˜è´¨é‡ (1080p)</option>
                        <option value="medium" selected>ä¸­ç­‰è´¨é‡ (720p)</option>
                        <option value="low">ä½è´¨é‡ (480p)</option>
                    </select>
                </div>
                <div class="option-group">
                    <label>å¸§ç‡</label>
                    <select id="framerate">
                        <option value="60">60 fps</option>
                        <option value="30" selected>30 fps</option>
                        <option value="24">24 fps</option>
                        <option value="15">15 fps</option>
                    </select>
                </div>
                <div class="option-group">
                    <label>è¾“å‡ºæ ¼å¼</label>
                    <select id="format">
                        <option value="webm" selected>WebM</option>
                        <option value="mp4">MP4 (å¦‚æ”¯æŒ)</option>
                    </select>
                </div>
                <div class="option-group checkbox-option">
                    <input type="checkbox" id="includeAudio" checked>
                    <label for="includeAudio">å½•åˆ¶ç³»ç»ŸéŸ³é¢‘</label>
                </div>
                <div class="option-group checkbox-option">
                    <input type="checkbox" id="includeMic">
                    <label for="includeMic">å½•åˆ¶éº¦å…‹é£</label>
                </div>
                <div class="option-group checkbox-option">
                    <input type="checkbox" id="showCursor" checked>
                    <label for="showCursor">æ˜¾ç¤ºé¼ æ ‡å…‰æ ‡</label>
                </div>
            </div>
        </div>

        <div class="recordings-section">
            <h3>
                å½•åˆ¶åˆ—è¡¨
                <button class="secondary outline" onclick="clearRecordings()" style="font-size: 0.8rem; padding: 0.3rem 0.6rem;">æ¸…ç©º</button>
            </h3>
            <div class="recordings-list" id="recordingsList">
                <div class="empty-state">æš‚æ— å½•åˆ¶</div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        let mediaRecorder = null;
        let recordedChunks = [];
        let stream = null;
        let timerInterval = null;
        let startTime = null;
        let pausedTime = 0;
        let isPaused = false;
        let recordings = [];

        window.toggleTheme = function() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        };

        (function() {
            const savedTheme = localStorage.getItem('theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);

            // Check browser support
            if (!navigator.mediaDevices || !navigator.mediaDevices.getDisplayMedia) {
                document.getElementById('supportWarning').style.display = 'block';
            }
        })();

        window.startRecording = async function() {
            try {
                const quality = document.getElementById('quality').value;
                const framerate = parseInt(document.getElementById('framerate').value);
                const includeAudio = document.getElementById('includeAudio').checked;
                const includeMic = document.getElementById('includeMic').checked;
                const showCursor = document.getElementById('showCursor').checked;

                const videoConstraints = {
                    high: { width: 1920, height: 1080 },
                    medium: { width: 1280, height: 720 },
                    low: { width: 854, height: 480 }
                };

                // Get display media
                const displayStream = await navigator.mediaDevices.getDisplayMedia({
                    video: {
                        ...videoConstraints[quality],
                        frameRate: framerate,
                        cursor: showCursor ? 'always' : 'never'
                    },
                    audio: includeAudio
                });

                stream = displayStream;

                // Add microphone if requested
                if (includeMic) {
                    try {
                        const micStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        micStream.getAudioTracks().forEach(track => {
                            stream.addTrack(track);
                        });
                    } catch (e) {
                        console.warn('Could not get microphone:', e);
                    }
                }

                // Show preview
                const preview = document.getElementById('preview');
                preview.srcObject = stream;
                document.getElementById('placeholder').style.display = 'none';

                // Setup recorder
                const format = document.getElementById('format').value;
                const mimeType = format === 'mp4' && MediaRecorder.isTypeSupported('video/mp4')
                    ? 'video/mp4'
                    : 'video/webm;codecs=vp9';

                recordedChunks = [];
                mediaRecorder = new MediaRecorder(stream, { mimeType });

                mediaRecorder.ondataavailable = (e) => {
                    if (e.data.size > 0) {
                        recordedChunks.push(e.data);
                    }
                };

                mediaRecorder.onstop = () => {
                    saveRecording();
                };

                mediaRecorder.start(1000); // Collect data every second

                // Update UI
                document.getElementById('startBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = false;
                document.getElementById('recordingIndicator').style.display = 'flex';
                document.getElementById('timer').style.display = 'block';

                // Start timer
                startTime = Date.now();
                pausedTime = 0;
                timerInterval = setInterval(updateTimer, 1000);

                // Handle stream end
                stream.getVideoTracks()[0].onended = () => {
                    stopRecording();
                };

                showToast('å¼€å§‹å½•åˆ¶');
            } catch (err) {
                console.error('Error starting recording:', err);
                showToast('æ— æ³•å¼€å§‹å½•åˆ¶: ' + err.message, 'error');
            }
        };

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }

            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }

            clearInterval(timerInterval);

            // Update UI
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('pauseBtn').innerHTML = '<span>â¸</span> æš‚åœ';
            document.getElementById('recordingIndicator').style.display = 'none';
            document.getElementById('timer').style.display = 'none';
            document.getElementById('placeholder').style.display = 'block';
            document.getElementById('preview').srcObject = null;

            isPaused = false;
        }

        window.togglePause = function() {
            if (!mediaRecorder) return;

            if (isPaused) {
                mediaRecorder.resume();
                startTime = Date.now() - pausedTime;
                timerInterval = setInterval(updateTimer, 1000);
                document.getElementById('pauseBtn').innerHTML = '<span>â¸</span> æš‚åœ';
                document.getElementById('recordingIndicator').style.display = 'flex';
            } else {
                mediaRecorder.pause();
                pausedTime = Date.now() - startTime;
                clearInterval(timerInterval);
                document.getElementById('pauseBtn').innerHTML = '<span>â–¶</span> ç»§ç»­';
                document.getElementById('recordingIndicator').style.display = 'none';
            }
            isPaused = !isPaused;
        };

        function updateTimer() {
            const elapsed = Date.now() - startTime;
            const seconds = Math.floor(elapsed / 1000) % 60;
            const minutes = Math.floor(elapsed / 60000) % 60;
            const hours = Math.floor(elapsed / 3600000);

            document.getElementById('timer').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function saveRecording() {
            if (recordedChunks.length === 0) return;

            const format = document.getElementById('format').value;
            const mimeType = format === 'mp4' ? 'video/mp4' : 'video/webm';
            const blob = new Blob(recordedChunks, { type: mimeType });
            const url = URL.createObjectURL(blob);

            const recording = {
                id: Date.now(),
                name: `å½•åˆ¶_${new Date().toLocaleString('zh-CN').replace(/[/:]/g, '-')}`,
                url: url,
                blob: blob,
                size: blob.size,
                format: format,
                duration: document.getElementById('timer').textContent,
                date: new Date().toLocaleString('zh-CN')
            };

            recordings.unshift(recording);
            renderRecordings();
            showToast('å½•åˆ¶å·²ä¿å­˜');
        }

        function renderRecordings() {
            const list = document.getElementById('recordingsList');
            
            if (recordings.length === 0) {
                list.innerHTML = '<div class="empty-state">æš‚æ— å½•åˆ¶</div>';
                return;
            }

            list.innerHTML = recordings.map(rec => `
                <div class="recording-item">
                    <div class="thumbnail">
                        <video src="${rec.url}" muted></video>
                    </div>
                    <div class="info">
                        <div class="name">${rec.name}</div>
                        <div class="meta">${rec.duration} Â· ${formatSize(rec.size)} Â· ${rec.format.toUpperCase()}</div>
                    </div>
                    <div class="actions">
                        <button onclick="playRecording('${rec.id}')" class="secondary outline">æ’­æ”¾</button>
                        <button onclick="downloadRecording('${rec.id}')">ä¸‹è½½</button>
                        <button onclick="deleteRecording('${rec.id}')" class="secondary outline">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / 1024 / 1024).toFixed(1) + ' MB';
        }

        window.playRecording = function(id) {
            const rec = recordings.find(r => r.id == id);
            if (rec) {
                const preview = document.getElementById('preview');
                preview.srcObject = null;
                preview.src = rec.url;
                preview.muted = false;
                preview.controls = true;
                preview.play();
                document.getElementById('placeholder').style.display = 'none';
            }
        };

        window.downloadRecording = function(id) {
            const rec = recordings.find(r => r.id == id);
            if (rec) {
                const a = document.createElement('a');
                a.href = rec.url;
                a.download = `${rec.name}.${rec.format}`;
                a.click();
            }
        };

        window.deleteRecording = function(id) {
            const index = recordings.findIndex(r => r.id == id);
            if (index !== -1) {
                URL.revokeObjectURL(recordings[index].url);
                recordings.splice(index, 1);
                renderRecordings();
                showToast('å·²åˆ é™¤');
            }
        };

        window.clearRecordings = function() {
            recordings.forEach(rec => URL.revokeObjectURL(rec.url));
            recordings = [];
            renderRecordings();
            showToast('å·²æ¸…ç©º');
        };

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'error' ? '#ef4444' : '#10b981';
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }
    </script>
</body>
</html>
