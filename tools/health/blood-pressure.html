<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>血压分析工具 - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #ef4444; --accent2: #f97316; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus { outline: none; border-color: var(--accent); }
        button { padding: 12px 24px; border: none; border-radius: 8px; background: var(--accent); color: white; font-size: 1rem; cursor: pointer; transition: opacity 0.2s; }
        button:hover { opacity: 0.9; }
        button.secondary { background: var(--border); color: var(--text); }
        .bp-display { display: flex; align-items: center; justify-content: center; gap: 16px; padding: 32px; }
        .bp-value { text-align: center; }
        .bp-value .number { font-size: 3rem; font-weight: 700; }
        .bp-value .label { font-size: 0.85rem; color: var(--text2); margin-top: 4px; }
        .bp-separator { font-size: 2rem; color: var(--text2); }
        .result-hero { border-radius: 12px; padding: 24px; text-align: center; color: white; margin-bottom: 20px; }
        .result-hero .category { font-size: 1.5rem; font-weight: 700; margin-bottom: 8px; }
        .result-hero .desc { font-size: 0.9rem; opacity: 0.9; }
        .category-optimal { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .category-normal { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .category-elevated { background: linear-gradient(135deg, #eab308, #ca8a04); }
        .category-high1 { background: linear-gradient(135deg, #f97316, #ea580c); }
        .category-high2 { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .category-crisis { background: linear-gradient(135deg, #991b1b, #7f1d1d); }
        .bp-chart { position: relative; height: 200px; margin: 20px 0; border-left: 2px solid var(--border); border-bottom: 2px solid var(--border); }
        .bp-zones { position: absolute; inset: 0; }
        .bp-zone { position: absolute; opacity: 0.3; }
        .bp-marker { position: absolute; width: 16px; height: 16px; background: white; border: 3px solid var(--accent); border-radius: 50%; transform: translate(-50%, -50%); z-index: 10; }
        .bp-axis-x, .bp-axis-y { position: absolute; font-size: 0.7rem; color: var(--text2); }
        .range-table { width: 100%; font-size: 0.85rem; }
        .range-table th, .range-table td { padding: 10px; text-align: left; border-bottom: 1px solid var(--border); }
        .range-table th { color: var(--text2); font-weight: 500; }
        .range-dot { display: inline-block; width: 12px; height: 12px; border-radius: 3px; margin-right: 8px; }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; }
        .history-item .reading { font-weight: 600; }
        .history-item .time { font-size: 0.85rem; color: var(--text2); }
        .history-item .category { font-size: 0.75rem; padding: 4px 8px; border-radius: 4px; color: white; }
        .history-item .delete { color: #ef4444; cursor: pointer; padding: 4px 8px; }
        .tips { margin-top: 16px; }
        .tip { padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; font-size: 0.9rem; }
        .tip-title { font-weight: 600; color: var(--accent); margin-bottom: 4px; }
        .note { margin-top: 16px; padding: 12px; background: var(--bg); border-radius: 8px; font-size: 0.85rem; color: var(--text2); }
    </style>
</head>
<body>
    <div class="container">
        <h1>血压分析工具</h1>
        <p class="subtitle">记录和分析血压数据，了解心血管健康状况</p>
        
        <div class="grid">
            <div class="card">
                <div class="card-title">输入血压</div>
                <div class="bp-display">
                    <div class="bp-value">
                        <input type="number" id="systolic" value="120" min="60" max="250" style="font-size: 2rem; text-align: center; width: 100px;" oninput="analyze()">
                        <div class="label">收缩压 (高压)</div>
                    </div>
                    <div class="bp-separator">/</div>
                    <div class="bp-value">
                        <input type="number" id="diastolic" value="80" min="40" max="150" style="font-size: 2rem; text-align: center; width: 100px;" oninput="analyze()">
                        <div class="label">舒张压 (低压)</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>心率 (次/分钟, 可选)</label>
                    <input type="number" id="pulse" placeholder="输入心率" min="40" max="200">
                </div>
                <div style="display: flex; gap: 8px;">
                    <button onclick="saveReading()">保存记录</button>
                    <button class="secondary" onclick="clearHistory()">清除历史</button>
                </div>
            </div>
            
            <div>
                <div class="result-hero" id="resultHero">
                    <div class="category" id="categoryName">正常血压</div>
                    <div class="desc" id="categoryDesc">血压处于健康范围</div>
                </div>
                
                <div class="card">
                    <div class="card-title">血压分布图</div>
                    <div class="bp-chart" id="bpChart">
                        <div class="bp-zones" id="bpZones"></div>
                        <div class="bp-marker" id="bpMarker"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text2); margin-top: 4px;">
                        <span>舒张压 (mmHg)</span>
                        <span>收缩压 (mmHg) →</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="grid">
            <div class="card">
                <div class="card-title">血压分类标准</div>
                <table class="range-table">
                    <thead>
                        <tr>
                            <th>分类</th>
                            <th>收缩压</th>
                            <th>舒张压</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="range-dot" style="background: #22c55e;"></span>理想</td>
                            <td>&lt;120</td>
                            <td>&lt;80</td>
                        </tr>
                        <tr>
                            <td><span class="range-dot" style="background: #3b82f6;"></span>正常</td>
                            <td>120-129</td>
                            <td>&lt;80</td>
                        </tr>
                        <tr>
                            <td><span class="range-dot" style="background: #eab308;"></span>偏高</td>
                            <td>130-139</td>
                            <td>80-89</td>
                        </tr>
                        <tr>
                            <td><span class="range-dot" style="background: #f97316;"></span>高血压1级</td>
                            <td>140-159</td>
                            <td>90-99</td>
                        </tr>
                        <tr>
                            <td><span class="range-dot" style="background: #ef4444;"></span>高血压2级</td>
                            <td>160-179</td>
                            <td>100-109</td>
                        </tr>
                        <tr>
                            <td><span class="range-dot" style="background: #991b1b;"></span>高血压危象</td>
                            <td>≥180</td>
                            <td>≥110</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="card">
                <div class="card-title">
                    <span>历史记录</span>
                    <span style="font-size: 0.8rem; color: var(--text2);" id="recordCount">0 条记录</span>
                </div>
                <div id="history" style="max-height: 250px; overflow-y: auto;"></div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">健康建议</div>
            <div class="tips" id="tips"></div>
        </div>
        
        <div class="note">
            血压值会受到多种因素影响，包括情绪、运动、饮食等。建议在安静状态下测量，每天固定时间测量2-3次。如血压持续异常，请及时就医。
        </div>
    </div>
    
    <script>
        const LS_KEY = 'bp_history';
        let history = [];
        
        const categories = [
            { name: '理想血压', sysMax: 120, diaMax: 80, class: 'category-optimal', color: '#22c55e', desc: '血压非常健康，继续保持良好的生活习惯' },
            { name: '正常血压', sysMax: 130, diaMax: 80, class: 'category-normal', color: '#3b82f6', desc: '血压处于正常范围，注意定期监测' },
            { name: '血压偏高', sysMax: 140, diaMax: 90, class: 'category-elevated', color: '#eab308', desc: '血压略高于正常，建议调整生活方式' },
            { name: '高血压1级', sysMax: 160, diaMax: 100, class: 'category-high1', color: '#f97316', desc: '轻度高血压，建议就医咨询并改善生活方式' },
            { name: '高血压2级', sysMax: 180, diaMax: 110, class: 'category-high2', color: '#ef4444', desc: '中度高血压，需要医疗干预和药物治疗' },
            { name: '高血压危象', sysMax: 999, diaMax: 999, class: 'category-crisis', color: '#991b1b', desc: '血压严重升高，请立即就医！' }
        ];
        
        function loadHistory() {
            const saved = localStorage.getItem(LS_KEY);
            if (saved) {
                history = JSON.parse(saved);
            }
            renderHistory();
        }
        
        function saveHistory() {
            localStorage.setItem(LS_KEY, JSON.stringify(history));
        }
        
        function getCategory(systolic, diastolic) {
            for (const cat of categories) {
                if (systolic < cat.sysMax && diastolic < cat.diaMax) {
                    return cat;
                }
            }
            return categories[categories.length - 1];
        }
        
        function analyze() {
            const systolic = parseInt(document.getElementById('systolic').value) || 120;
            const diastolic = parseInt(document.getElementById('diastolic').value) || 80;
            
            const category = getCategory(systolic, diastolic);
            
            const hero = document.getElementById('resultHero');
            hero.className = 'result-hero ' + category.class;
            document.getElementById('categoryName').textContent = category.name;
            document.getElementById('categoryDesc').textContent = category.desc;
            
            // 更新图表标记
            updateChart(systolic, diastolic);
            
            // 更新建议
            renderTips(category);
        }
        
        function updateChart(systolic, diastolic) {
            const marker = document.getElementById('bpMarker');
            
            // 将血压值映射到图表位置 (收缩压60-200, 舒张压40-130)
            const xPercent = Math.min(100, Math.max(0, ((systolic - 60) / 140) * 100));
            const yPercent = Math.min(100, Math.max(0, 100 - ((diastolic - 40) / 90) * 100));
            
            marker.style.left = xPercent + '%';
            marker.style.top = yPercent + '%';
            
            // 渲染区域
            const zones = document.getElementById('bpZones');
            zones.textContent = '';
            
            // 简化的区域显示
            const zoneData = [
                { sysMin: 60, sysMax: 120, diaMin: 40, diaMax: 80, color: '#22c55e' },
                { sysMin: 120, sysMax: 130, diaMin: 40, diaMax: 80, color: '#3b82f6' },
                { sysMin: 130, sysMax: 140, diaMin: 80, diaMax: 90, color: '#eab308' },
                { sysMin: 140, sysMax: 160, diaMin: 90, diaMax: 100, color: '#f97316' },
                { sysMin: 160, sysMax: 200, diaMin: 100, diaMax: 130, color: '#ef4444' }
            ];
            
            zoneData.forEach(zone => {
                const div = document.createElement('div');
                div.className = 'bp-zone';
                div.style.background = zone.color;
                div.style.left = ((zone.sysMin - 60) / 140 * 100) + '%';
                div.style.right = (100 - (zone.sysMax - 60) / 140 * 100) + '%';
                div.style.top = (100 - (zone.diaMax - 40) / 90 * 100) + '%';
                div.style.bottom = ((zone.diaMin - 40) / 90 * 100) + '%';
                zones.appendChild(div);
            });
        }
        
        function saveReading() {
            const systolic = parseInt(document.getElementById('systolic').value) || 120;
            const diastolic = parseInt(document.getElementById('diastolic').value) || 80;
            const pulse = document.getElementById('pulse').value;
            
            const reading = {
                systolic,
                diastolic,
                pulse: pulse ? parseInt(pulse) : null,
                time: new Date().toISOString(),
                category: getCategory(systolic, diastolic).name
            };
            
            history.unshift(reading);
            if (history.length > 100) history.pop();
            
            saveHistory();
            renderHistory();
        }
        
        function deleteReading(index) {
            history.splice(index, 1);
            saveHistory();
            renderHistory();
        }
        
        function clearHistory() {
            if (confirm('确定要清除所有历史记录吗？')) {
                history = [];
                saveHistory();
                renderHistory();
            }
        }
        
        function renderHistory() {
            const container = document.getElementById('history');
            container.textContent = '';
            
            document.getElementById('recordCount').textContent = history.length + ' 条记录';
            
            if (history.length === 0) {
                const div = document.createElement('div');
                div.style.cssText = 'text-align: center; color: var(--text2); padding: 20px;';
                div.textContent = '暂无记录';
                container.appendChild(div);
                return;
            }
            
            history.slice(0, 20).forEach((reading, index) => {
                const div = document.createElement('div');
                div.className = 'history-item';
                
                const left = document.createElement('div');
                const readingDiv = document.createElement('div');
                readingDiv.className = 'reading';
                readingDiv.textContent = reading.systolic + '/' + reading.diastolic + ' mmHg' + 
                    (reading.pulse ? ' · ' + reading.pulse + ' bpm' : '');
                
                const timeDiv = document.createElement('div');
                timeDiv.className = 'time';
                timeDiv.textContent = new Date(reading.time).toLocaleString('zh-CN');
                
                left.appendChild(readingDiv);
                left.appendChild(timeDiv);
                
                const right = document.createElement('div');
                right.style.display = 'flex';
                right.style.alignItems = 'center';
                right.style.gap = '8px';
                
                const categorySpan = document.createElement('span');
                categorySpan.className = 'category';
                const cat = categories.find(c => c.name === reading.category);
                categorySpan.style.background = cat ? cat.color : '#666';
                categorySpan.textContent = reading.category;
                
                const deleteBtn = document.createElement('span');
                deleteBtn.className = 'delete';
                deleteBtn.textContent = '删除';
                deleteBtn.onclick = () => deleteReading(index);
                
                right.appendChild(categorySpan);
                right.appendChild(deleteBtn);
                
                div.appendChild(left);
                div.appendChild(right);
                container.appendChild(div);
            });
        }
        
        function renderTips(category) {
            const container = document.getElementById('tips');
            container.textContent = '';
            
            let tips = [];
            
            if (category.name === '理想血压' || category.name === '正常血压') {
                tips = [
                    { title: '保持健康', text: '继续保持均衡饮食、适量运动和充足睡眠的良好生活习惯' },
                    { title: '定期监测', text: '建议每月测量1-2次血压，关注变化趋势' }
                ];
            } else if (category.name === '血压偏高') {
                tips = [
                    { title: '控制饮食', text: '减少盐分摄入（每天不超过6克），多吃蔬果，控制体重' },
                    { title: '规律运动', text: '每周进行150分钟中等强度有氧运动，如快走、游泳' },
                    { title: '戒烟限酒', text: '戒烟并限制酒精摄入，减轻心血管负担' }
                ];
            } else {
                tips = [
                    { title: '及时就医', text: '建议尽快就医，在医生指导下进行治疗' },
                    { title: '规律服药', text: '如已确诊高血压，请遵医嘱规律服药，不要自行停药' },
                    { title: '监测血压', text: '每天早晚各测量一次血压，记录数据供医生参考' },
                    { title: '生活调整', text: '低盐饮食、适量运动、控制体重、保持情绪稳定' }
                ];
            }
            
            tips.forEach(tip => {
                const div = document.createElement('div');
                div.className = 'tip';
                
                const title = document.createElement('div');
                title.className = 'tip-title';
                title.textContent = tip.title;
                
                const text = document.createElement('div');
                text.textContent = tip.text;
                
                div.appendChild(title);
                div.appendChild(text);
                container.appendChild(div);
            });
        }
        
        loadHistory();
        analyze();
    </script>
</body>
</html>
