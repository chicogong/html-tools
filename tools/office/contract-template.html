<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>åˆåŒæ¨¡æ¿ç”Ÿæˆå™¨ - WebUtils</title>
    <meta name="description" content="åœ¨çº¿åˆåŒæ¨¡æ¿ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒæœåŠ¡åˆåŒã€é›‡ä½£åˆåŒã€ç§ŸèµåˆåŒï¼Œå¿«é€Ÿç”Ÿæˆè§„èŒƒåˆåŒæ–‡æœ¬" />
    <meta name="keywords" content="åˆåŒ contract æ¨¡æ¿ template åè®® æœåŠ¡åˆåŒ é›‡ä½£åˆåŒ ç§ŸèµåˆåŒ åŠ³åŠ¨åˆåŒ" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/office/contract-template.html" />
    <meta property="og:title" content="åˆåŒæ¨¡æ¿ç”Ÿæˆå™¨ - WebUtils" />
    <meta property="og:description" content="åœ¨çº¿åˆåŒæ¨¡æ¿ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒæœåŠ¡åˆåŒã€é›‡ä½£åˆåŒã€ç§ŸèµåˆåŒ" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/office/contract-template.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="åˆåŒæ¨¡æ¿ç”Ÿæˆå™¨ - WebUtils" />
    <meta name="twitter:description" content="åœ¨çº¿åˆåŒæ¨¡æ¿ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒæœåŠ¡åˆåŒã€é›‡ä½£åˆåŒã€ç§ŸèµåˆåŒ" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          { "@type": "ListItem", "position": 1, "name": "é¦–é¡µ", "item": "https://tools.realtime-ai.chat/" },
          { "@type": "ListItem", "position": 2, "name": "åŠå…¬å·¥å…·", "item": "https://tools.realtime-ai.chat/#office" },
          { "@type": "ListItem", "position": 3, "name": "åˆåŒæ¨¡æ¿ç”Ÿæˆå™¨", "item": "https://tools.realtime-ai.chat/tools/office/contract-template.html" }
        ]
      }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
    <style>
      :root {
        --color-bg-deep: #0a0a0f;
        --color-bg-surface: #1a1a22;
        --color-bg-subtle: #242430;
        --color-bg-input: #0e0e14;
        --color-text-primary: #f5f5f7;
        --color-text-secondary: #a1a1aa;
        --color-text-muted: #71717a;
        --color-border-default: rgba(255, 255, 255, 0.08);
        --color-border-subtle: rgba(255, 255, 255, 0.04);
        --color-border-strong: rgba(255, 255, 255, 0.12);
        --color-accent-primary: #3b82f6;
        --color-accent-secondary: #8b5cf6;
        --color-accent-tertiary: #06b6d4;
        --color-success: #22c55e;
        --color-warning: #f59e0b;
        --color-error: #ef4444;
        --glass-bg: rgba(26, 26, 34, 0.72);
        --glass-border: rgba(255, 255, 255, 0.08);
        --glass-blur: 24px;
        --glass-saturate: 180%;
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.4);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
        --shadow-glow: 0 0 20px rgba(59, 130, 246, 0.15);
        --space-1: 4px; --space-2: 8px; --space-3: 12px; --space-4: 16px; --space-5: 20px; --space-6: 24px; --space-8: 32px;
        --radius-sm: 6px; --radius-md: 10px; --radius-lg: 16px; --radius-full: 9999px;
        --font-sans: "Inter", -apple-system, blinkmacsystemfont, "Segoe UI", sans-serif;
        --font-mono: "JetBrains Mono", "SF Mono", "Fira Code", monospace;
        --transition-fast: 150ms ease; --transition-normal: 250ms ease;
        --nav-height: 56px; --container-max: 1200px;
        --safe-area-top: env(safe-area-inset-top, 0px); --safe-area-bottom: env(safe-area-inset-bottom, 0px);
      }
      [data-theme="light"] {
        --color-bg-deep: #f8fafc; --color-bg-surface: #fff; --color-bg-subtle: #f1f5f9; --color-bg-input: #f8fafc;
        --color-text-primary: #0f172a; --color-text-secondary: #475569; --color-text-muted: #94a3b8;
        --color-border-default: rgba(0, 0, 0, 0.08); --color-border-subtle: rgba(0, 0, 0, 0.04); --color-border-strong: rgba(0, 0, 0, 0.12);
        --color-accent-primary: #2563eb;
        --glass-bg: rgba(255, 255, 255, 0.78); --glass-border: rgba(0, 0, 0, 0.06);
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06); --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08); --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);
        --shadow-glow: 0 0 20px rgba(37, 99, 235, 0.12);
      }
      *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
      html { font-size: 16px; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
      body { font-family: var(--font-sans); background: var(--color-bg-deep); color: var(--color-text-primary); min-height: 100vh; min-height: 100dvh; line-height: 1.5; transition: background-color var(--transition-normal), color var(--transition-normal); }
      body::before { content: ""; position: fixed; inset: 0; pointer-events: none; z-index: 0; background: radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.03) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.03) 0%, transparent 50%); }
      [data-theme="light"] body::before { background: radial-gradient(circle at 20% 20%, rgba(37, 99, 235, 0.05) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(124, 58, 237, 0.05) 0%, transparent 50%); }
      .nav-bar { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; height: calc(var(--nav-height) + var(--safe-area-top)); padding-top: var(--safe-area-top); background: var(--glass-bg); backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur)); -webkit-backdrop-filter: saturate(var(--glass-saturate)) blur(var(--glass-blur)); border-bottom: 1px solid var(--glass-border); display: flex; align-items: center; justify-content: center; transition: background var(--transition-normal); }
      .nav-content { width: 100%; max-width: var(--container-max); height: var(--nav-height); padding: 0 var(--space-6); display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: var(--space-4); }
      .nav-back { display: flex; align-items: center; gap: var(--space-1); color: var(--color-accent-primary); text-decoration: none; font-size: 0.9375rem; font-weight: 500; padding: var(--space-2) var(--space-1); margin-left: calc(var(--space-2) * -1); border-radius: var(--radius-sm); transition: all var(--transition-fast); justify-self: start; }
      .nav-back:hover { background: var(--color-border-subtle); }
      .nav-back-icon { width: 20px; height: 20px; stroke-width: 2.5; }
      .nav-back-text { display: inline; }
      .nav-title { font-size: 1rem; font-weight: 600; color: var(--color-text-primary); text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
      .nav-actions { display: flex; align-items: center; gap: var(--space-2); justify-self: end; }
      .theme-toggle { display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; border: none; border-radius: var(--radius-full); background: var(--color-bg-subtle); color: var(--color-text-secondary); cursor: pointer; transition: all var(--transition-fast); }
      .theme-toggle:hover { background: var(--color-border-strong); color: var(--color-text-primary); transform: scale(1.05); }
      .theme-toggle svg { width: 18px; height: 18px; }
      .theme-icon-dark, .theme-icon-light { display: none; }
      [data-theme="dark"] .theme-icon-light, :root:not([data-theme]) .theme-icon-light { display: block; }
      [data-theme="light"] .theme-icon-dark { display: block; }
      .main-content { position: relative; z-index: 1; min-height: 100vh; min-height: 100dvh; padding-top: calc(var(--nav-height) + var(--safe-area-top) + var(--space-5)); padding-bottom: calc(var(--space-6) + var(--safe-area-bottom)); padding-left: var(--space-6); padding-right: var(--space-6); display: flex; flex-direction: column; align-items: center; }
      .tool-card { width: 100%; max-width: var(--container-max); background: var(--glass-bg); backdrop-filter: saturate(var(--glass-saturate)) blur(16px); -webkit-backdrop-filter: saturate(var(--glass-saturate)) blur(16px); border: 1px solid var(--glass-border); border-radius: var(--radius-lg); padding: var(--space-6); box-shadow: var(--shadow-lg); flex: 1; display: flex; flex-direction: column; transition: all var(--transition-normal); animation: fade-in-up 0.4s ease-out; }
      @keyframes fade-in-up { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
      .tool-header { display: flex; align-items: center; gap: var(--space-4); margin-bottom: var(--space-5); padding-bottom: var(--space-5); border-bottom: 1px solid var(--color-border-subtle); }
      .tool-icon { width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--color-accent-primary), var(--color-accent-tertiary)); border-radius: var(--radius-md); color: #fff; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25); }
      .tool-info h1 { font-size: 1.25rem; font-weight: 700; color: var(--color-text-primary); }
      .tool-info .desc { font-size: 0.875rem; color: var(--color-text-muted); margin-top: var(--space-1); }
      .toolbar { display: flex; flex-wrap: wrap; gap: var(--space-3); margin-bottom: var(--space-5); }
      .btn-group { display: flex; gap: 2px; background: var(--color-bg-subtle); border-radius: var(--radius-sm); padding: 2px; }
      .btn { display: inline-flex; align-items: center; justify-content: center; gap: var(--space-2); height: 36px; padding: 0 var(--space-4); font-family: var(--font-mono); font-size: 0.8125rem; font-weight: 500; color: var(--color-text-secondary); background: transparent; border: none; border-radius: var(--radius-sm); cursor: pointer; transition: all var(--transition-fast); white-space: nowrap; }
      .btn:hover { background: var(--color-bg-surface); color: var(--color-text-primary); }
      .btn-primary { background: var(--color-accent-primary); color: #fff; }
      .btn-primary:hover { filter: brightness(1.1); box-shadow: var(--shadow-glow); }
      .panels { display: grid; grid-template-columns: 380px 1fr; gap: var(--space-5); flex: 1; min-height: 500px; }
      .panel { display: flex; flex-direction: column; min-height: 0; }
      .panel-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3); }
      .panel-label { font-family: var(--font-mono); font-size: 0.75rem; font-weight: 500; color: var(--color-text-muted); text-transform: uppercase; letter-spacing: 0.1em; }
      .form-section { margin-bottom: var(--space-5); }
      .form-section h3 { font-size: 0.8125rem; font-weight: 600; color: var(--color-text-secondary); margin-bottom: var(--space-3); display: flex; align-items: center; gap: var(--space-2); }
      .form-section h3::before { content: ""; width: 3px; height: 14px; background: var(--color-accent-primary); border-radius: 2px; }
      .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3); }
      .form-group { display: flex; flex-direction: column; gap: var(--space-1); }
      .form-group.full { grid-column: 1 / -1; }
      .form-group label { font-size: 0.75rem; font-weight: 500; color: var(--color-text-muted); }
      .form-group input, .form-group select, .form-group textarea { font-family: var(--font-sans); font-size: 0.875rem; padding: var(--space-2) var(--space-3); background: var(--color-bg-input); border: 1px solid var(--color-border-default); border-radius: var(--radius-sm); color: var(--color-text-primary); transition: all var(--transition-fast); }
      .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--color-accent-primary); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15); }
      .form-group textarea { min-height: 80px; resize: vertical; line-height: 1.5; }
      .type-selector { display: flex; gap: var(--space-2); margin-bottom: var(--space-4); }
      .type-btn { flex: 1; padding: var(--space-3) var(--space-2); border: 2px solid var(--color-border-default); border-radius: var(--radius-md); background: transparent; color: var(--color-text-secondary); cursor: pointer; font-size: 0.8125rem; font-weight: 500; transition: all var(--transition-fast); text-align: center; }
      .type-btn:hover { border-color: var(--color-text-muted); color: var(--color-text-primary); }
      .type-btn.active { border-color: var(--color-accent-primary); background: rgba(59, 130, 246, 0.1); color: var(--color-accent-primary); }
      .type-btn .type-icon { font-size: 1.25rem; display: block; margin-bottom: var(--space-1); }
      .preview-panel { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
      .contract-preview { flex: 1; background: var(--color-bg-surface); border: 1px solid var(--color-border-default); border-radius: var(--radius-md); padding: var(--space-6); font-size: 0.9375rem; line-height: 1.8; overflow-y: auto; }
      .contract-preview h2 { font-size: 1.375rem; text-align: center; margin-bottom: var(--space-6); font-weight: 700; letter-spacing: 0.1em; }
      .contract-preview .contract-number { text-align: center; font-size: 0.8125rem; color: var(--color-text-muted); margin-bottom: var(--space-5); }
      .contract-preview .parties { margin-bottom: var(--space-5); padding: var(--space-4); background: var(--color-bg-subtle); border-radius: var(--radius-sm); }
      .contract-preview .parties p { margin-bottom: var(--space-2); text-indent: 0; }
      .contract-preview .parties p:last-child { margin-bottom: 0; }
      .contract-preview p { margin-bottom: var(--space-4); text-indent: 2em; }
      .contract-preview .section-title { font-weight: 600; text-indent: 0; color: var(--color-text-primary); margin-top: var(--space-5); }
      .contract-preview .signature { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-8); margin-top: var(--space-8); padding-top: var(--space-6); border-top: 1px solid var(--color-border-default); }
      .contract-preview .sig-block { text-align: left; }
      .contract-preview .sig-label { font-size: 0.875rem; color: var(--color-text-secondary); margin-bottom: var(--space-2); }
      .contract-preview .sig-line { border-bottom: 1px solid var(--color-border-default); height: 32px; margin-bottom: var(--space-3); }
      .status-bar { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: var(--space-4); margin-top: var(--space-5); padding-top: var(--space-5); border-top: 1px solid var(--color-border-subtle); }
      .status { font-family: var(--font-mono); font-size: 0.8125rem; color: var(--color-text-muted); display: flex; align-items: center; gap: var(--space-2); }
      .status.success { color: var(--color-success); }
      .status.success::before { content: "OK"; }
      .footer { text-align: center; margin-top: var(--space-5); padding-top: var(--space-4); }
      .footer p { font-family: var(--font-mono); font-size: 0.75rem; color: var(--color-text-muted); display: flex; align-items: center; justify-content: center; gap: var(--space-2); flex-wrap: wrap; }
      .footer a { color: var(--color-accent-primary); text-decoration: none; transition: color var(--transition-fast); }
      .footer a:hover { color: var(--color-text-primary); }
      .template-fields { display: none; }
      .template-fields.active { display: block; }
      @media print {
        @page { size: a4; margin: 20mm; }
        body { background: #fff !important; color: #000 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        body::before { display: none !important; }
        .nav-bar, .toolbar, .panel:first-child, .status-bar, .footer { display: none !important; }
        .main-content { padding: 0 !important; min-height: auto !important; }
        .tool-card { background: transparent !important; border: none !important; box-shadow: none !important; padding: 0 !important; backdrop-filter: none !important; }
        .panels { display: block !important; }
        .panel-header { display: none !important; }
        .contract-preview { background: #fff !important; border: none !important; padding: 0 !important; max-height: none !important; overflow: visible !important; font-size: 12pt !important; color: #000 !important; }
        .contract-preview h2 { color: #000 !important; }
        .contract-preview .parties { background: #f5f5f5 !important; }
      }
      @media (max-width: 900px) {
        .panels { grid-template-columns: 1fr; }
        .contract-preview { min-height: 400px; }
      }
      @media (max-width: 640px) {
        :root { --nav-height: 52px; }
        .nav-content { padding: 0 var(--space-4); }
        .nav-back-text { display: none; }
        .main-content { padding: calc(var(--nav-height) + var(--safe-area-top) + var(--space-4)) var(--space-4) calc(var(--space-5) + var(--safe-area-bottom)); }
        .tool-card { padding: var(--space-4); border-radius: var(--radius-md); }
        .tool-header { flex-direction: column; align-items: flex-start; gap: var(--space-3); margin-bottom: var(--space-4); padding-bottom: var(--space-4); }
        .tool-icon { width: 40px; height: 40px; }
        .tool-info h1 { font-size: 1.125rem; }
        .toolbar { gap: var(--space-2); margin-bottom: var(--space-4); }
        .btn-group { flex-wrap: wrap; }
        .btn { height: 34px; padding: 0 var(--space-3); font-size: 0.75rem; }
        .type-selector { flex-wrap: wrap; }
        .type-btn { flex: none; width: calc(33.333% - 6px); }
        .form-grid { grid-template-columns: 1fr; }
        .contract-preview { padding: var(--space-4); font-size: 0.875rem; }
        .contract-preview .signature { grid-template-columns: 1fr; gap: var(--space-5); }
      }
      @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
      }
      :focus-visible { outline: 2px solid var(--color-accent-primary); outline-offset: 2px; }
      button:focus:not(:focus-visible), a:focus:not(:focus-visible), input:focus:not(:focus-visible), select:focus:not(:focus-visible), textarea:focus:not(:focus-visible) { outline: none; }
    </style>
  </head>
  <body>
    <nav class="nav-bar">
      <div class="nav-content">
        <a href="../../index.html" class="nav-back" aria-label="è¿”å›é¦–é¡µ">
          <svg class="nav-back-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
          <span class="nav-back-text">é¦–é¡µ</span>
        </a>
        <h1 class="nav-title">åˆåŒæ¨¡æ¿ç”Ÿæˆå™¨</h1>
        <div class="nav-actions">
          <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">
            <svg class="theme-icon-light" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            <svg class="theme-icon-dark" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
          </button>
        </div>
      </div>
    </nav>
    <main class="main-content">
      <div class="tool-card">
        <div class="tool-header">
          <div class="tool-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><line x1="10" y1="9" x2="8" y2="9"></line></svg>
          </div>
          <div class="tool-info">
            <h1>åˆåŒæ¨¡æ¿ç”Ÿæˆå™¨</h1>
            <p class="desc">å¿«é€Ÿç”ŸæˆæœåŠ¡åˆåŒã€é›‡ä½£åˆåŒã€ç§ŸèµåˆåŒï¼Œæ”¯æŒè‡ªå®šä¹‰æ¡æ¬¾å’Œæ‰“å°</p>
          </div>
        </div>
        <div class="toolbar">
          <div class="btn-group">
            <button id="btnGenerate" class="btn btn-primary">ç”ŸæˆåˆåŒ</button>
            <button id="btnCopy" class="btn">å¤åˆ¶æ–‡æœ¬</button>
            <button id="btnPrint" class="btn">æ‰“å°</button>
            <button id="btnClear" class="btn">æ¸…ç©º</button>
          </div>
        </div>
        <div class="panels">
          <div class="panel">
            <div class="panel-header"><span class="panel-label">åˆåŒä¿¡æ¯</span></div>
            <div class="type-selector">
              <button class="type-btn active" data-type="service">
                <span class="type-icon">ğŸ“‹</span>
                æœåŠ¡åˆåŒ
              </button>
              <button class="type-btn" data-type="employment">
                <span class="type-icon">ğŸ‘”</span>
                é›‡ä½£åˆåŒ
              </button>
              <button class="type-btn" data-type="rental">
                <span class="type-icon">ğŸ </span>
                ç§ŸèµåˆåŒ
              </button>
            </div>
            
            <div class="form-section">
              <h3>åŸºæœ¬ä¿¡æ¯</h3>
              <div class="form-grid">
                <div class="form-group"><label for="contractNo">åˆåŒç¼–å·</label><input type="text" id="contractNo" placeholder="HT-2024-001" /></div>
                <div class="form-group"><label for="contractDate">ç­¾è®¢æ—¥æœŸ</label><input type="date" id="contractDate" /></div>
                <div class="form-group"><label for="partyA">ç”²æ–¹åç§°</label><input type="text" id="partyA" placeholder="ç”²æ–¹å…¬å¸/ä¸ªäººåç§°" /></div>
                <div class="form-group"><label for="partyB">ä¹™æ–¹åç§°</label><input type="text" id="partyB" placeholder="ä¹™æ–¹å…¬å¸/ä¸ªäººåç§°" /></div>
              </div>
            </div>

            <div class="form-section">
              <h3>åˆåŒæœŸé™</h3>
              <div class="form-grid">
                <div class="form-group"><label for="startDate">å¼€å§‹æ—¥æœŸ</label><input type="date" id="startDate" /></div>
                <div class="form-group"><label for="endDate">ç»“æŸæ—¥æœŸ</label><input type="date" id="endDate" /></div>
              </div>
            </div>

            <div class="form-section">
              <h3>é‡‘é¢ä¸ä»˜æ¬¾</h3>
              <div class="form-grid">
                <div class="form-group"><label for="amount">é‡‘é¢ (å…ƒ)</label><input type="number" id="amount" placeholder="10000" /></div>
                <div class="form-group"><label for="paymentMethod">ä»˜æ¬¾æ–¹å¼</label>
                  <select id="paymentMethod">
                    <option value="ä¸€æ¬¡æ€§ä»˜æ¸…">ä¸€æ¬¡æ€§ä»˜æ¸…</option>
                    <option value="åˆ†æœŸä»˜æ¬¾">åˆ†æœŸä»˜æ¬¾</option>
                    <option value="æŒ‰æœˆæ”¯ä»˜">æŒ‰æœˆæ”¯ä»˜</option>
                    <option value="æŒ‰å­£åº¦æ”¯ä»˜">æŒ‰å­£åº¦æ”¯ä»˜</option>
                    <option value="å®Œå·¥åæ”¯ä»˜">å®Œå·¥åæ”¯ä»˜</option>
                  </select>
                </div>
              </div>
            </div>

            <div id="serviceFields" class="template-fields active">
              <div class="form-section">
                <h3>æœåŠ¡å†…å®¹</h3>
                <div class="form-grid">
                  <div class="form-group full"><label for="serviceScope">æœåŠ¡èŒƒå›´</label><textarea id="serviceScope" placeholder="è¯¦ç»†æè¿°æœåŠ¡å†…å®¹ã€äº¤ä»˜æ ‡å‡†ç­‰..."></textarea></div>
                  <div class="form-group full"><label for="serviceLocation">æœåŠ¡åœ°ç‚¹</label><input type="text" id="serviceLocation" placeholder="æœåŠ¡æ‰§è¡Œåœ°ç‚¹" /></div>
                </div>
              </div>
            </div>

            <div id="employmentFields" class="template-fields">
              <div class="form-section">
                <h3>å²—ä½ä¿¡æ¯</h3>
                <div class="form-grid">
                  <div class="form-group"><label for="position">å²—ä½åç§°</label><input type="text" id="position" placeholder="å¦‚ï¼šè½¯ä»¶å·¥ç¨‹å¸ˆ" /></div>
                  <div class="form-group"><label for="department">æ‰€å±éƒ¨é—¨</label><input type="text" id="department" placeholder="å¦‚ï¼šæŠ€æœ¯éƒ¨" /></div>
                  <div class="form-group full"><label for="jobDuties">å·¥ä½œèŒè´£</label><textarea id="jobDuties" placeholder="è¯¦ç»†æè¿°å·¥ä½œèŒè´£å’Œè¦æ±‚..."></textarea></div>
                  <div class="form-group"><label for="workLocation">å·¥ä½œåœ°ç‚¹</label><input type="text" id="workLocation" placeholder="å·¥ä½œåœ°ç‚¹" /></div>
                  <div class="form-group"><label for="probation">è¯•ç”¨æœŸ (æœˆ)</label><input type="number" id="probation" placeholder="3" min="0" max="6" /></div>
                </div>
              </div>
            </div>

            <div id="rentalFields" class="template-fields">
              <div class="form-section">
                <h3>ç§Ÿèµç‰©ä¿¡æ¯</h3>
                <div class="form-grid">
                  <div class="form-group full"><label for="rentalItem">ç§Ÿèµç‰©æè¿°</label><textarea id="rentalItem" placeholder="è¯¦ç»†æè¿°ç§Ÿèµç‰©å“ã€æˆ¿å±‹åœ°å€ã€é¢ç§¯ç­‰..."></textarea></div>
                  <div class="form-group"><label for="deposit">æŠ¼é‡‘ (å…ƒ)</label><input type="number" id="deposit" placeholder="5000" /></div>
                  <div class="form-group"><label for="rentalUse">ä½¿ç”¨ç”¨é€”</label>
                    <select id="rentalUse">
                      <option value="å±…ä½">å±…ä½</option>
                      <option value="åŠå…¬">åŠå…¬</option>
                      <option value="å•†ä¸šç»è¥">å•†ä¸šç»è¥</option>
                      <option value="ä»“å‚¨">ä»“å‚¨</option>
                      <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3>é™„åŠ æ¡æ¬¾ (å¯é€‰)</h3>
              <div class="form-grid">
                <div class="form-group full"><label for="extraTerms">å…¶ä»–çº¦å®š</label><textarea id="extraTerms" placeholder="æ·»åŠ å…¶ä»–ç‰¹æ®Šçº¦å®šæ¡æ¬¾..."></textarea></div>
              </div>
            </div>
          </div>

          <div class="panel preview-panel">
            <div class="panel-header"><span class="panel-label">åˆåŒé¢„è§ˆ</span></div>
            <div id="contractPreview" class="contract-preview"></div>
          </div>
        </div>
        <div class="status-bar">
          <div id="status" class="status"></div>
        </div>
      </div>
      <footer class="footer">
        <p>
          <a href="https://github.com/chicogong/html-tools" target="_blank" rel="noreferrer">GitHub</a>
          <span>Â·</span>
          <span>çº¯å‰ç«¯ Â· æ— æœåŠ¡å™¨</span>
          <span>Â·</span>
          <a href="../../index.html">WebUtils</a>
        </p>
      </footer>
    </main>
    <script>
      var LS_KEY = "contract_template_v2";
      var currentType = "service";

      var previewEl = document.getElementById("contractPreview");
      var statusEl = document.getElementById("status");
      
      var contractNoEl = document.getElementById("contractNo");
      var contractDateEl = document.getElementById("contractDate");
      var partyAEl = document.getElementById("partyA");
      var partyBEl = document.getElementById("partyB");
      var startDateEl = document.getElementById("startDate");
      var endDateEl = document.getElementById("endDate");
      var amountEl = document.getElementById("amount");
      var paymentMethodEl = document.getElementById("paymentMethod");
      var extraTermsEl = document.getElementById("extraTerms");
      
      var serviceScopeEl = document.getElementById("serviceScope");
      var serviceLocationEl = document.getElementById("serviceLocation");
      
      var positionEl = document.getElementById("position");
      var departmentEl = document.getElementById("department");
      var jobDutiesEl = document.getElementById("jobDuties");
      var workLocationEl = document.getElementById("workLocation");
      var probationEl = document.getElementById("probation");
      
      var rentalItemEl = document.getElementById("rentalItem");
      var depositEl = document.getElementById("deposit");
      var rentalUseEl = document.getElementById("rentalUse");

      var templates = {
        service: {
          title: "æœåŠ¡åˆåŒ",
          intro: "ç”²ä¹™åŒæ–¹æœ¬ç€å¹³ç­‰è‡ªæ„¿ã€è¯šå®ä¿¡ç”¨çš„åŸåˆ™ï¼Œç»å‹å¥½åå•†ï¼Œå°±ç”²æ–¹å§”æ‰˜ä¹™æ–¹æä¾›æœåŠ¡äº‹å®œï¼Œè¾¾æˆå¦‚ä¸‹åè®®ï¼š",
          sections: [
            { title: "ç¬¬ä¸€æ¡ æœåŠ¡å†…å®¹", content: "ä¹™æ–¹åŒæ„æŒ‰ç…§æœ¬åˆåŒçº¦å®šï¼Œä¸ºç”²æ–¹æä¾›ä»¥ä¸‹æœåŠ¡ï¼š\n{serviceScope}\næœåŠ¡åœ°ç‚¹ï¼š{serviceLocation}" },
            { title: "ç¬¬äºŒæ¡ æœåŠ¡æœŸé™", content: "æœ¬åˆåŒæœåŠ¡æœŸé™è‡ª {startDate} èµ·è‡³ {endDate} æ­¢ã€‚" },
            { title: "ç¬¬ä¸‰æ¡ æœåŠ¡è´¹ç”¨", content: "æœ¬åˆåŒæœåŠ¡è´¹ç”¨æ€»è®¡äººæ°‘å¸ {amount} å…ƒæ•´ï¼ˆå¤§å†™ï¼š{amountCN}ï¼‰ã€‚\nä»˜æ¬¾æ–¹å¼ï¼š{paymentMethod}ã€‚" },
            { title: "ç¬¬å››æ¡ ç”²æ–¹æƒåˆ©ä¹‰åŠ¡", content: "1. ç”²æ–¹æœ‰æƒæŒ‰ç…§åˆåŒçº¦å®šè¦æ±‚ä¹™æ–¹æä¾›æœåŠ¡ï¼Œå¹¶ç›‘ç£æœåŠ¡è´¨é‡ï¼›\n2. ç”²æ–¹åº”æŒ‰çº¦å®šæ—¶é—´å’Œæ–¹å¼æ”¯ä»˜æœåŠ¡è´¹ç”¨ï¼›\n3. ç”²æ–¹åº”é…åˆä¹™æ–¹å®ŒæˆæœåŠ¡å·¥ä½œï¼Œæä¾›å¿…è¦çš„å·¥ä½œæ¡ä»¶å’Œèµ„æ–™ã€‚" },
            { title: "ç¬¬äº”æ¡ ä¹™æ–¹æƒåˆ©ä¹‰åŠ¡", content: "1. ä¹™æ–¹æœ‰æƒæŒ‰çº¦å®šæ”¶å–æœåŠ¡è´¹ç”¨ï¼›\n2. ä¹™æ–¹åº”æŒ‰ç…§åˆåŒçº¦å®šçš„å†…å®¹ã€æ ‡å‡†å’ŒæœŸé™æä¾›æœåŠ¡ï¼›\n3. ä¹™æ–¹åº”ä¿è¯æœåŠ¡è´¨é‡ï¼Œå¯¹æœåŠ¡è¿‡ç¨‹ä¸­çŸ¥æ‚‰çš„ç”²æ–¹å•†ä¸šç§˜å¯†è´Ÿæœ‰ä¿å¯†ä¹‰åŠ¡ã€‚" },
            { title: "ç¬¬å…­æ¡ è¿çº¦è´£ä»»", content: "1. ä»»ä½•ä¸€æ–¹è¿åæœ¬åˆåŒçº¦å®šï¼Œåº”æ‰¿æ‹…è¿çº¦è´£ä»»ï¼Œèµ”å¿å¯¹æ–¹å› æ­¤é€ æˆçš„æŸå¤±ï¼›\n2. ç”²æ–¹é€¾æœŸä»˜æ¬¾çš„ï¼Œåº”æŒ‰æ—¥æ”¯ä»˜é€¾æœŸé‡‘é¢çš„ä¸‡åˆ†ä¹‹äº”ä½œä¸ºè¿çº¦é‡‘ï¼›\n3. ä¹™æ–¹æœªæŒ‰çº¦å®šæä¾›æœåŠ¡æˆ–æœåŠ¡è´¨é‡ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œç”²æ–¹æœ‰æƒè¦æ±‚ä¹™æ–¹é‡æ–°æä¾›æœåŠ¡æˆ–é€€è¿˜ç›¸åº”è´¹ç”¨ã€‚" },
            { title: "ç¬¬ä¸ƒæ¡ åˆåŒè§£é™¤", content: "1. ç»åŒæ–¹åå•†ä¸€è‡´ï¼Œå¯ä»¥è§£é™¤æœ¬åˆåŒï¼›\n2. ä¸€æ–¹ä¸¥é‡è¿çº¦ï¼Œå¦ä¸€æ–¹æœ‰æƒè§£é™¤æœ¬åˆåŒå¹¶è¦æ±‚èµ”å¿æŸå¤±ã€‚" },
            { title: "ç¬¬å…«æ¡ äº‰è®®è§£å†³", content: "å› æœ¬åˆåŒå¼•èµ·çš„æˆ–ä¸æœ¬åˆåŒæœ‰å…³çš„äº‰è®®ï¼ŒåŒæ–¹åº”é¦–å…ˆåå•†è§£å†³ï¼›åå•†ä¸æˆçš„ï¼Œä»»ä½•ä¸€æ–¹å‡å¯å‘åˆåŒç­¾è®¢åœ°äººæ°‘æ³•é™¢æèµ·è¯‰è®¼ã€‚" }
          ]
        },
        employment: {
          title: "åŠ³åŠ¨åˆåŒ",
          intro: "ç”²ä¹™åŒæ–¹æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åŠ³åŠ¨åˆåŒæ³•ã€‹åŠç›¸å…³æ³•å¾‹æ³•è§„ï¼Œåœ¨å¹³ç­‰è‡ªæ„¿ã€åå•†ä¸€è‡´çš„åŸºç¡€ä¸Šï¼Œç­¾è®¢æœ¬åˆåŒï¼š",
          sections: [
            { title: "ç¬¬ä¸€æ¡ å·¥ä½œå†…å®¹ä¸å²—ä½", content: "ä¹™æ–¹åŒæ„åœ¨ç”²æ–¹ {department} éƒ¨é—¨æ‹…ä»» {position} å²—ä½å·¥ä½œã€‚\nä¸»è¦å·¥ä½œèŒè´£ï¼š{jobDuties}\nå·¥ä½œåœ°ç‚¹ï¼š{workLocation}" },
            { title: "ç¬¬äºŒæ¡ åˆåŒæœŸé™", content: "æœ¬åˆåŒä¸ºå›ºå®šæœŸé™åŠ³åŠ¨åˆåŒï¼ŒæœŸé™è‡ª {startDate} èµ·è‡³ {endDate} æ­¢ã€‚\nè¯•ç”¨æœŸä¸º {probation} ä¸ªæœˆï¼Œè‡ª {startDate} èµ·è‡³è¯•ç”¨æœŸå±Šæ»¡ã€‚" },
            { title: "ç¬¬ä¸‰æ¡ åŠ³åŠ¨æŠ¥é…¬", content: "ç”²æ–¹æ¯æœˆæ”¯ä»˜ä¹™æ–¹å·¥èµ„äººæ°‘å¸ {amount} å…ƒæ•´ï¼ˆå¤§å†™ï¼š{amountCN}ï¼‰ã€‚\nä»˜æ¬¾æ–¹å¼ï¼š{paymentMethod}ã€‚\nç”²æ–¹åº”äºæ¯æœˆ15æ—¥å‰æ”¯ä»˜ä¸Šæœˆå·¥èµ„ã€‚" },
            { title: "ç¬¬å››æ¡ å·¥ä½œæ—¶é—´ä¸ä¼‘æ¯ä¼‘å‡", content: "1. ä¹™æ–¹å®è¡Œæ ‡å‡†å·¥æ—¶åˆ¶åº¦ï¼Œæ¯æ—¥å·¥ä½œ8å°æ—¶ï¼Œæ¯å‘¨å·¥ä½œ40å°æ—¶ï¼›\n2. ä¹™æ–¹ä¾æ³•äº«æœ‰å›½å®¶è§„å®šçš„æ³•å®šèŠ‚å‡æ—¥ã€å¹´ä¼‘å‡ã€å©šå‡ã€äº§å‡ç­‰å‡æœŸï¼›\n3. ç”²æ–¹å› å·¥ä½œéœ€è¦å®‰æ’ä¹™æ–¹åŠ ç­çš„ï¼Œåº”ä¾æ³•æ”¯ä»˜åŠ ç­å·¥èµ„æˆ–å®‰æ’è¡¥ä¼‘ã€‚" },
            { title: "ç¬¬äº”æ¡ ç¤¾ä¼šä¿é™©ä¸ç¦åˆ©", content: "1. ç”²æ–¹æŒ‰ç…§å›½å®¶å’Œåœ°æ–¹è§„å®šä¸ºä¹™æ–¹ç¼´çº³ç¤¾ä¼šä¿é™©è´¹ï¼ˆå…»è€ã€åŒ»ç–—ã€å¤±ä¸šã€å·¥ä¼¤ã€ç”Ÿè‚²ä¿é™©ï¼‰ï¼›\n2. ç”²æ–¹ä¸ºä¹™æ–¹ç¼´çº³ä½æˆ¿å…¬ç§¯é‡‘ï¼›\n3. ä¹™æ–¹ä¾æ³•äº«æœ‰ç”²æ–¹è§„å®šçš„å…¶ä»–ç¦åˆ©å¾…é‡ã€‚" },
            { title: "ç¬¬å…­æ¡ åŠ³åŠ¨ä¿æŠ¤ä¸æ¡ä»¶", content: "ç”²æ–¹åº”ä¸ºä¹™æ–¹æä¾›ç¬¦åˆå›½å®¶è§„å®šçš„åŠ³åŠ¨å®‰å…¨å«ç”Ÿæ¡ä»¶å’Œå¿…è¦çš„åŠ³åŠ¨é˜²æŠ¤ç”¨å“ï¼Œä¿éšœä¹™æ–¹çš„äººèº«å®‰å…¨å’Œå¥åº·ã€‚" },
            { title: "ç¬¬ä¸ƒæ¡ åˆåŒå˜æ›´ã€è§£é™¤ä¸ç»ˆæ­¢", content: "1. ç»åŒæ–¹åå•†ä¸€è‡´ï¼Œå¯ä»¥å˜æ›´æˆ–è§£é™¤æœ¬åˆåŒï¼›\n2. ä¹™æ–¹æå‰30æ—¥ä»¥ä¹¦é¢å½¢å¼é€šçŸ¥ç”²æ–¹ï¼Œå¯ä»¥è§£é™¤æœ¬åˆåŒï¼›è¯•ç”¨æœŸå†…æå‰3æ—¥é€šçŸ¥ï¼›\n3. ç”²æ–¹è§£é™¤æœ¬åˆåŒåº”ç¬¦åˆæ³•å¾‹è§„å®šçš„æ¡ä»¶å’Œç¨‹åºã€‚" },
            { title: "ç¬¬å…«æ¡ ä¿å¯†ä¸ç«ä¸šé™åˆ¶", content: "ä¹™æ–¹åº”å¯¹å·¥ä½œä¸­çŸ¥æ‚‰çš„ç”²æ–¹å•†ä¸šç§˜å¯†å’ŒæŠ€æœ¯ç§˜å¯†è´Ÿæœ‰ä¿å¯†ä¹‰åŠ¡ï¼Œæœªç»ç”²æ–¹ä¹¦é¢åŒæ„ï¼Œä¸å¾—å‘ä»»ä½•ç¬¬ä¸‰æ–¹æŠ«éœ²ã€‚" }
          ]
        },
        rental: {
          title: "ç§ŸèµåˆåŒ",
          intro: "ç”²ä¹™åŒæ–¹å°±ç§Ÿèµäº‹å®œï¼Œç»å¹³ç­‰åå•†ï¼Œè¾¾æˆå¦‚ä¸‹åè®®ï¼š",
          sections: [
            { title: "ç¬¬ä¸€æ¡ ç§Ÿèµç‰©", content: "ç”²æ–¹åŒæ„å°†ä»¥ä¸‹ç‰©å“/æˆ¿å±‹å‡ºç§Ÿç»™ä¹™æ–¹ä½¿ç”¨ï¼š\n{rentalItem}\nä½¿ç”¨ç”¨é€”ï¼š{rentalUse}" },
            { title: "ç¬¬äºŒæ¡ ç§ŸèµæœŸé™", content: "ç§ŸèµæœŸé™è‡ª {startDate} èµ·è‡³ {endDate} æ­¢ã€‚\nç§ŸèµæœŸæ»¡ï¼Œå¦‚ä¹™æ–¹éœ€ç»§ç»­ç§Ÿç”¨ï¼Œåº”æå‰30æ—¥å‘ç”²æ–¹æå‡ºä¹¦é¢ç”³è¯·ï¼ŒåŒæ–¹å¦è¡Œç­¾è®¢åˆåŒã€‚" },
            { title: "ç¬¬ä¸‰æ¡ ç§Ÿé‡‘ä¸æŠ¼é‡‘", content: "1. ç§Ÿé‡‘æ€»è®¡äººæ°‘å¸ {amount} å…ƒæ•´ï¼ˆå¤§å†™ï¼š{amountCN}ï¼‰ï¼›\n2. ä»˜æ¬¾æ–¹å¼ï¼š{paymentMethod}ï¼›\n3. ä¹™æ–¹åº”äºæœ¬åˆåŒç­¾è®¢æ—¶å‘ç”²æ–¹æ”¯ä»˜æŠ¼é‡‘äººæ°‘å¸ {deposit} å…ƒæ•´ï¼›\n4. ç§ŸèµæœŸæ»¡ä¸”ä¹™æ–¹æ— è¿çº¦è¡Œä¸ºçš„ï¼Œç”²æ–¹åº”äºäº¤è¿˜ç§Ÿèµç‰©å7æ—¥å†…é€€è¿˜æŠ¼é‡‘ã€‚" },
            { title: "ç¬¬å››æ¡ ç”²æ–¹æƒåˆ©ä¹‰åŠ¡", content: "1. ç”²æ–¹åº”æŒ‰çº¦å®šæ—¶é—´å°†ç§Ÿèµç‰©äº¤ä»˜ä¹™æ–¹ä½¿ç”¨ï¼Œå¹¶ä¿è¯ç§Ÿèµç‰©ç¬¦åˆçº¦å®šçš„ä½¿ç”¨æ¡ä»¶ï¼›\n2. ç”²æ–¹åº”ä¿è¯ç§Ÿèµç‰©ä¸å­˜åœ¨æƒå±çº çº·ï¼Œä¸å½±å“ä¹™æ–¹æ­£å¸¸ä½¿ç”¨ï¼›\n3. ç”²æ–¹è´Ÿè´£ç§Ÿèµç‰©çš„ç»“æ„æ€§ç»´ä¿®ã€‚" },
            { title: "ç¬¬äº”æ¡ ä¹™æ–¹æƒåˆ©ä¹‰åŠ¡", content: "1. ä¹™æ–¹åº”æŒ‰çº¦å®šç”¨é€”ä½¿ç”¨ç§Ÿèµç‰©ï¼Œä¸å¾—æ“…è‡ªæ”¹å˜ç”¨é€”ï¼›\n2. æœªç»ç”²æ–¹ä¹¦é¢åŒæ„ï¼Œä¹™æ–¹ä¸å¾—å°†ç§Ÿèµç‰©è½¬ç§Ÿã€è½¬å€Ÿç»™ç¬¬ä¸‰æ–¹ï¼›\n3. ä¹™æ–¹åº”å¦¥å–„ä¿ç®¡ã€åˆç†ä½¿ç”¨ç§Ÿèµç‰©ï¼Œå¦‚æœ‰æŸååº”ç…§ä»·èµ”å¿ï¼›\n4. ä¹™æ–¹è´Ÿè´£ç§ŸèµæœŸé—´çš„æ—¥å¸¸ç»´æŠ¤å’Œæ°´ç”µç­‰è´¹ç”¨ã€‚" },
            { title: "ç¬¬å…­æ¡ ç§Ÿèµç‰©è¿”è¿˜", content: "1. ç§ŸèµæœŸæ»¡æˆ–åˆåŒè§£é™¤æ—¶ï¼Œä¹™æ–¹åº”å°†ç§Ÿèµç‰©æŒ‰åŸçŠ¶è¿”è¿˜ç”²æ–¹ï¼›\n2. ä¹™æ–¹å¯¹ç§Ÿèµç‰©è¿›è¡Œçš„è£…ä¿®ã€æ”¹é€ ï¼Œåº”äº‹å…ˆå¾å¾—ç”²æ–¹ä¹¦é¢åŒæ„ï¼›\n3. ç§ŸèµæœŸæ»¡ï¼Œè£…ä¿®ã€æ”¹é€ ç‰©çš„å½’å±ç”±åŒæ–¹å¦è¡Œåå•†ã€‚" },
            { title: "ç¬¬ä¸ƒæ¡ è¿çº¦è´£ä»»", content: "1. ç”²æ–¹é€¾æœŸäº¤ä»˜ç§Ÿèµç‰©çš„ï¼Œæ¯é€¾æœŸä¸€æ—¥ï¼Œåº”å‘ä¹™æ–¹æ”¯ä»˜æ—¥ç§Ÿé‡‘çš„åŒå€ä½œä¸ºè¿çº¦é‡‘ï¼›\n2. ä¹™æ–¹é€¾æœŸæ”¯ä»˜ç§Ÿé‡‘çš„ï¼Œæ¯é€¾æœŸä¸€æ—¥ï¼Œåº”å‘ç”²æ–¹æ”¯ä»˜é€¾æœŸç§Ÿé‡‘çš„ä¸‡åˆ†ä¹‹äº”ä½œä¸ºè¿çº¦é‡‘ï¼›\n3. ä»»ä½•ä¸€æ–¹æ“…è‡ªè§£é™¤åˆåŒçš„ï¼Œåº”å‘å¯¹æ–¹æ”¯ä»˜ä¸€ä¸ªæœˆç§Ÿé‡‘ä½œä¸ºè¿çº¦é‡‘ã€‚" },
            { title: "ç¬¬å…«æ¡ åˆåŒè§£é™¤", content: "1. ç»åŒæ–¹åå•†ä¸€è‡´ï¼Œå¯ä»¥è§£é™¤æœ¬åˆåŒï¼›\n2. ä¸€æ–¹ä¸¥é‡è¿çº¦ï¼Œå¦ä¸€æ–¹æœ‰æƒè§£é™¤æœ¬åˆåŒå¹¶è¦æ±‚èµ”å¿æŸå¤±ï¼›\n3. å› ä¸å¯æŠ—åŠ›è‡´ä½¿åˆåŒç›®çš„æ— æ³•å®ç°çš„ï¼ŒåŒæ–¹å¯ä»¥è§£é™¤åˆåŒã€‚" }
          ]
        }
      };

      function showStatus(msg, type) {
        statusEl.textContent = msg;
        statusEl.className = "status " + (type || "");
      }

      function formatDate(dateStr) {
        if (!dateStr) return "____å¹´__æœˆ__æ—¥";
        var d = new Date(dateStr);
        return d.getFullYear() + "å¹´" + (d.getMonth() + 1) + "æœˆ" + d.getDate() + "æ—¥";
      }

      function numberToChinese(num) {
        if (!num || isNaN(num)) return "____";
        var digits = ["é›¶", "å£¹", "è´°", "å", "è‚†", "ä¼", "é™†", "æŸ’", "æŒ", "ç–"];
        var units = ["", "æ‹¾", "ä½°", "ä»Ÿ"];
        var bigUnits = ["", "ä¸‡", "äº¿"];
        
        num = Math.floor(parseFloat(num));
        if (num === 0) return "é›¶å…ƒæ•´";
        
        var result = "";
        var unitIndex = 0;
        
        while (num > 0) {
          var section = num % 10000;
          var sectionStr = "";
          var zeroFlag = false;
          
          for (var i = 0; section > 0; i++) {
            var digit = section % 10;
            if (digit === 0) {
              zeroFlag = true;
            } else {
              if (zeroFlag) {
                sectionStr = "é›¶" + sectionStr;
                zeroFlag = false;
              }
              sectionStr = digits[digit] + units[i] + sectionStr;
            }
            section = Math.floor(section / 10);
          }
          
          if (sectionStr) {
            result = sectionStr + bigUnits[unitIndex] + result;
          }
          
          num = Math.floor(num / 10000);
          unitIndex++;
        }
        
        return result + "å…ƒæ•´";
      }

      function escapeHtml(text) {
        var div = document.createElement("div");
        div.textContent = text;
        return div.textContent;
      }

      function getFormData() {
        return {
          type: currentType,
          contractNo: contractNoEl.value || "ã€åˆåŒç¼–å·ã€‘",
          contractDate: formatDate(contractDateEl.value),
          partyA: partyAEl.value || "ã€ç”²æ–¹åç§°ã€‘",
          partyB: partyBEl.value || "ã€ä¹™æ–¹åç§°ã€‘",
          startDate: formatDate(startDateEl.value),
          endDate: formatDate(endDateEl.value),
          amount: amountEl.value || "____",
          amountCN: numberToChinese(amountEl.value),
          paymentMethod: paymentMethodEl.value,
          extraTerms: extraTermsEl.value,
          serviceScope: serviceScopeEl.value || "ã€æœåŠ¡å†…å®¹ã€‘",
          serviceLocation: serviceLocationEl.value || "ã€æœåŠ¡åœ°ç‚¹ã€‘",
          position: positionEl.value || "ã€å²—ä½åç§°ã€‘",
          department: departmentEl.value || "ã€éƒ¨é—¨åç§°ã€‘",
          jobDuties: jobDutiesEl.value || "ã€å·¥ä½œèŒè´£ã€‘",
          workLocation: workLocationEl.value || "ã€å·¥ä½œåœ°ç‚¹ã€‘",
          probation: probationEl.value || "3",
          rentalItem: rentalItemEl.value || "ã€ç§Ÿèµç‰©æè¿°ã€‘",
          deposit: depositEl.value || "____",
          rentalUse: rentalUseEl.value
        };
      }

      function generateContract() {
        var data = getFormData();
        var tpl = templates[currentType];
        
        while (previewEl.firstChild) {
          previewEl.removeChild(previewEl.firstChild);
        }
        
        var h2 = document.createElement("h2");
        h2.textContent = tpl.title;
        previewEl.appendChild(h2);
        
        var contractNum = document.createElement("div");
        contractNum.className = "contract-number";
        contractNum.textContent = "åˆåŒç¼–å·ï¼š" + escapeHtml(data.contractNo);
        previewEl.appendChild(contractNum);
        
        var partiesDiv = document.createElement("div");
        partiesDiv.className = "parties";
        var pA = document.createElement("p");
        var pAStrong = document.createElement("strong");
        pAStrong.textContent = "ç”²æ–¹ï¼ˆå§”æ‰˜æ–¹/ç”¨äººå•ä½/å‡ºç§Ÿæ–¹ï¼‰ï¼š";
        pA.appendChild(pAStrong);
        pA.appendChild(document.createTextNode(escapeHtml(data.partyA)));
        var pB = document.createElement("p");
        var pBStrong = document.createElement("strong");
        pBStrong.textContent = "ä¹™æ–¹ï¼ˆæœåŠ¡æ–¹/åŠ³åŠ¨è€…/æ‰¿ç§Ÿæ–¹ï¼‰ï¼š";
        pB.appendChild(pBStrong);
        pB.appendChild(document.createTextNode(escapeHtml(data.partyB)));
        partiesDiv.appendChild(pA);
        partiesDiv.appendChild(pB);
        previewEl.appendChild(partiesDiv);
        
        var introP = document.createElement("p");
        introP.textContent = tpl.intro;
        previewEl.appendChild(introP);
        
        tpl.sections.forEach(function(section) {
          var titleP = document.createElement("p");
          titleP.className = "section-title";
          titleP.textContent = section.title;
          previewEl.appendChild(titleP);
          
          var content = section.content;
          Object.keys(data).forEach(function(key) {
            content = content.replace(new RegExp("\\{" + key + "\\}", "g"), data[key]);
          });
          
          content.split("\n").forEach(function(line) {
            var p = document.createElement("p");
            p.textContent = line;
            previewEl.appendChild(p);
          });
        });
        
        if (data.extraTerms) {
          var extraTitle = document.createElement("p");
          extraTitle.className = "section-title";
          extraTitle.textContent = "ç¬¬ä¹æ¡ é™„åŠ æ¡æ¬¾";
          previewEl.appendChild(extraTitle);
          
          data.extraTerms.split("\n").forEach(function(line) {
            var p = document.createElement("p");
            p.textContent = line;
            previewEl.appendChild(p);
          });
        }
        
        var finalP = document.createElement("p");
        finalP.textContent = "æœ¬åˆåŒä¸€å¼ä¸¤ä»½ï¼Œç”²ä¹™åŒæ–¹å„æ‰§ä¸€ä»½ï¼Œå…·æœ‰åŒç­‰æ³•å¾‹æ•ˆåŠ›ã€‚æœ¬åˆåŒè‡ªåŒæ–¹ç­¾å­—ï¼ˆç›–ç« ï¼‰ä¹‹æ—¥èµ·ç”Ÿæ•ˆã€‚";
        previewEl.appendChild(finalP);
        
        var sigDiv = document.createElement("div");
        sigDiv.className = "signature";
        
        var sigA = document.createElement("div");
        sigA.className = "sig-block";
        var sigALabel1 = document.createElement("div");
        sigALabel1.className = "sig-label";
        sigALabel1.textContent = "ç”²æ–¹ï¼ˆç­¾å­—/ç›–ç« ï¼‰ï¼š";
        var sigALine1 = document.createElement("div");
        sigALine1.className = "sig-line";
        var sigALabel2 = document.createElement("div");
        sigALabel2.className = "sig-label";
        sigALabel2.textContent = "æ—¥æœŸï¼š";
        var sigALine2 = document.createElement("div");
        sigALine2.className = "sig-line";
        sigA.appendChild(sigALabel1);
        sigA.appendChild(sigALine1);
        sigA.appendChild(sigALabel2);
        sigA.appendChild(sigALine2);
        
        var sigB = document.createElement("div");
        sigB.className = "sig-block";
        var sigBLabel1 = document.createElement("div");
        sigBLabel1.className = "sig-label";
        sigBLabel1.textContent = "ä¹™æ–¹ï¼ˆç­¾å­—/ç›–ç« ï¼‰ï¼š";
        var sigBLine1 = document.createElement("div");
        sigBLine1.className = "sig-line";
        var sigBLabel2 = document.createElement("div");
        sigBLabel2.className = "sig-label";
        sigBLabel2.textContent = "æ—¥æœŸï¼š";
        var sigBLine2 = document.createElement("div");
        sigBLine2.className = "sig-line";
        sigB.appendChild(sigBLabel1);
        sigB.appendChild(sigBLine1);
        sigB.appendChild(sigBLabel2);
        sigB.appendChild(sigBLine2);
        
        sigDiv.appendChild(sigA);
        sigDiv.appendChild(sigB);
        previewEl.appendChild(sigDiv);
        
        showStatus("åˆåŒå·²ç”Ÿæˆ", "success");
      }

      function getPlainText() {
        return previewEl.innerText;
      }

      function saveToStorage() {
        var data = {
          type: currentType,
          contractNo: contractNoEl.value,
          contractDate: contractDateEl.value,
          partyA: partyAEl.value,
          partyB: partyBEl.value,
          startDate: startDateEl.value,
          endDate: endDateEl.value,
          amount: amountEl.value,
          paymentMethod: paymentMethodEl.value,
          extraTerms: extraTermsEl.value,
          serviceScope: serviceScopeEl.value,
          serviceLocation: serviceLocationEl.value,
          position: positionEl.value,
          department: departmentEl.value,
          jobDuties: jobDutiesEl.value,
          workLocation: workLocationEl.value,
          probation: probationEl.value,
          rentalItem: rentalItemEl.value,
          deposit: depositEl.value,
          rentalUse: rentalUseEl.value
        };
        localStorage.setItem(LS_KEY, JSON.stringify(data));
      }

      function loadFromStorage() {
        var saved = localStorage.getItem(LS_KEY);
        if (saved) {
          try {
            var data = JSON.parse(saved);
            currentType = data.type || "service";
            contractNoEl.value = data.contractNo || "";
            contractDateEl.value = data.contractDate || "";
            partyAEl.value = data.partyA || "";
            partyBEl.value = data.partyB || "";
            startDateEl.value = data.startDate || "";
            endDateEl.value = data.endDate || "";
            amountEl.value = data.amount || "";
            paymentMethodEl.value = data.paymentMethod || "ä¸€æ¬¡æ€§ä»˜æ¸…";
            extraTermsEl.value = data.extraTerms || "";
            serviceScopeEl.value = data.serviceScope || "";
            serviceLocationEl.value = data.serviceLocation || "";
            positionEl.value = data.position || "";
            departmentEl.value = data.department || "";
            jobDutiesEl.value = data.jobDuties || "";
            workLocationEl.value = data.workLocation || "";
            probationEl.value = data.probation || "";
            rentalItemEl.value = data.rentalItem || "";
            depositEl.value = data.deposit || "";
            rentalUseEl.value = data.rentalUse || "å±…ä½";
            
            updateTypeUI();
            return true;
          } catch (e) {
            return false;
          }
        }
        return false;
      }

      function updateTypeUI() {
        document.querySelectorAll(".type-btn").forEach(function(btn) {
          btn.classList.toggle("active", btn.dataset.type === currentType);
        });
        document.querySelectorAll(".template-fields").forEach(function(el) {
          el.classList.remove("active");
        });
        document.getElementById(currentType + "Fields").classList.add("active");
      }

      function clearForm() {
        if (!confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†…å®¹å—ï¼Ÿ")) return;
        
        contractNoEl.value = "";
        contractDateEl.value = new Date().toISOString().split("T")[0];
        partyAEl.value = "";
        partyBEl.value = "";
        startDateEl.value = "";
        endDateEl.value = "";
        amountEl.value = "";
        paymentMethodEl.value = "ä¸€æ¬¡æ€§ä»˜æ¸…";
        extraTermsEl.value = "";
        serviceScopeEl.value = "";
        serviceLocationEl.value = "";
        positionEl.value = "";
        departmentEl.value = "";
        jobDutiesEl.value = "";
        workLocationEl.value = "";
        probationEl.value = "";
        rentalItemEl.value = "";
        depositEl.value = "";
        rentalUseEl.value = "å±…ä½";
        
        currentType = "service";
        updateTypeUI();
        localStorage.removeItem(LS_KEY);
        while (previewEl.firstChild) {
          previewEl.removeChild(previewEl.firstChild);
        }
        showStatus("å·²æ¸…ç©º", "success");
      }

      document.querySelectorAll(".type-btn").forEach(function(btn) {
        btn.addEventListener("click", function() {
          currentType = btn.dataset.type;
          updateTypeUI();
          saveToStorage();
          generateContract();
        });
      });

      var allInputs = [
        contractNoEl, contractDateEl, partyAEl, partyBEl, startDateEl, endDateEl,
        amountEl, paymentMethodEl, extraTermsEl, serviceScopeEl, serviceLocationEl,
        positionEl, departmentEl, jobDutiesEl, workLocationEl, probationEl,
        rentalItemEl, depositEl, rentalUseEl
      ];
      
      allInputs.forEach(function(el) {
        el.addEventListener("input", saveToStorage);
        el.addEventListener("change", saveToStorage);
      });

      document.getElementById("btnGenerate").addEventListener("click", generateContract);
      
      document.getElementById("btnCopy").addEventListener("click", function() {
        var text = getPlainText();
        if (!text) {
          showStatus("è¯·å…ˆç”ŸæˆåˆåŒ", "error");
          return;
        }
        navigator.clipboard.writeText(text).then(function() {
          showStatus("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿", "success");
        }).catch(function() {
          showStatus("å¤åˆ¶å¤±è´¥", "error");
        });
      });

      document.getElementById("btnPrint").addEventListener("click", function() {
        if (!previewEl.textContent) {
          generateContract();
        }
        window.print();
      });

      document.getElementById("btnClear").addEventListener("click", clearForm);

      window.toggleTheme = function() {
        var html = document.documentElement;
        var currentTheme = html.getAttribute("data-theme") || "dark";
        var newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      };

      function initTheme() {
        var savedTheme = localStorage.getItem("theme");
        var prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        var theme = savedTheme || (prefersDark ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", theme);
      }

      window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", function(e) {
        if (!localStorage.getItem("theme")) {
          document.documentElement.setAttribute("data-theme", e.matches ? "dark" : "light");
        }
      });

      initTheme();
      
      if (!contractDateEl.value) {
        contractDateEl.value = new Date().toISOString().split("T")[0];
      }
      
      loadFromStorage();
      updateTypeUI();
      generateContract();
    </script>
  </body>
</html>
