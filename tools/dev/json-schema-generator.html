<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Schema ç”Ÿæˆå™¨ | åœ¨çº¿å·¥å…·</title>
    <meta name="description" content="ä» JSON æ•°æ®è‡ªåŠ¨ç”Ÿæˆ JSON Schemaï¼Œæ”¯æŒ Draft-07 è§„èŒƒ">
    <meta name="keywords" content="JSON,Schema,ç”Ÿæˆå™¨,éªŒè¯,API">
    <style>
        :root {
            --bg-color: #0a0a0a;
            --card-bg: #141414;
            --border-color: #262626;
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --accent-color: #f59e0b;
            --accent-hover: #d97706;
            --success-color: #22c55e;
            --error-color: #ef4444;
            --code-bg: #1e1e1e;
        }
        
        [data-theme="light"] {
            --bg-color: #f5f5f5;
            --card-bg: #fff;
            --border-color: #e5e5e5;
            --text-primary: #171717;
            --text-secondary: #525252;
            --code-bg: #f8f8f8;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }
        
        .subtitle { color: var(--text-secondary); }
        
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            z-index: 100;
        }
        
        .back-link {
            position: fixed;
            top: 1rem;
            left: 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            z-index: 100;
        }
        
        .back-link:hover { color: var(--accent-color); }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        @media (max-width: 900px) {
            .main-grid { grid-template-columns: 1fr; }
        }
        
        .panel {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .panel h2 {
            font-size: 1rem;
        }
        
        .panel-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: var(--accent-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--accent-hover);
        }
        
        .btn-secondary {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        
        .btn-secondary:hover {
            border-color: var(--accent-color);
        }
        
        textarea {
            flex: 1;
            min-height: 400px;
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: Monaco, Menlo, monospace;
            font-size: 0.85rem;
            color: var(--text-primary);
            resize: vertical;
            line-height: 1.5;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        
        .options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--bg-color);
            border-radius: 0.5rem;
        }
        
        .option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }
        
        .option input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }
        
        .option select {
            padding: 0.25rem 0.5rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            color: var(--text-primary);
            font-size: 0.85rem;
        }
        
        .status {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }
        
        .status.success {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }
        
        .status.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }
        
        .examples {
            margin-top: 1rem;
        }
        
        .examples h3 {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .example-btns {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .example-btn {
            padding: 0.4rem 0.8rem;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .example-btn:hover {
            border-color: var(--accent-color);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
    
    <div class="container">
        <header>
            <h1>JSON Schema ç”Ÿæˆå™¨</h1>
            <p class="subtitle">ä» JSON æ•°æ®è‡ªåŠ¨ç”Ÿæˆ JSON Schema å®šä¹‰</p>
        </header>
        
        <div class="options">
            <div class="option">
                <label>Schema ç‰ˆæœ¬:</label>
                <select id="schemaVersion">
                    <option value="http://json-schema.org/draft-07/schema#">Draft-07</option>
                    <option value="http://json-schema.org/draft-06/schema#">Draft-06</option>
                    <option value="http://json-schema.org/draft-04/schema#">Draft-04</option>
                </select>
            </div>
            <div class="option">
                <input type="checkbox" id="requireAll" checked>
                <label for="requireAll">æ‰€æœ‰å­—æ®µå¿…å¡«</label>
            </div>
            <div class="option">
                <input type="checkbox" id="additionalProps">
                <label for="additionalProps">å…è®¸é¢å¤–å±æ€§</label>
            </div>
            <div class="option">
                <input type="checkbox" id="includeExamples" checked>
                <label for="includeExamples">åŒ…å«ç¤ºä¾‹å€¼</label>
            </div>
            <div class="option">
                <input type="checkbox" id="includeDescriptions">
                <label for="includeDescriptions">ç”Ÿæˆæè¿°å­—æ®µ</label>
            </div>
        </div>
        
        <div class="main-grid">
            <div class="panel">
                <div class="panel-header">
                    <h2>è¾“å…¥ JSON</h2>
                    <div class="panel-actions">
                        <button class="btn btn-secondary" onclick="formatInput()">æ ¼å¼åŒ–</button>
                        <button class="btn btn-secondary" onclick="clearInput()">æ¸…ç©º</button>
                    </div>
                </div>
                <textarea id="input" placeholder="åœ¨æ­¤ç²˜è´´ JSON æ•°æ®...">{
  "id": 1,
  "name": "å¼ ä¸‰",
  "email": "zhangsan@example.com",
  "age": 28,
  "isActive": true,
  "tags": ["developer", "designer"],
  "address": {
    "city": "åŒ—äº¬",
    "zipCode": "100000"
  },
  "createdAt": "2024-01-15T10:30:00Z"
}</textarea>
                <div id="inputStatus"></div>
                
                <div class="examples">
                    <h3>ç¤ºä¾‹æ•°æ®</h3>
                    <div class="example-btns">
                        <button class="example-btn" onclick="loadExample('user')">ç”¨æˆ·</button>
                        <button class="example-btn" onclick="loadExample('product')">å•†å“</button>
                        <button class="example-btn" onclick="loadExample('order')">è®¢å•</button>
                        <button class="example-btn" onclick="loadExample('api')">APIå“åº”</button>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <h2>ç”Ÿæˆçš„ JSON Schema</h2>
                    <div class="panel-actions">
                        <button class="btn btn-primary" onclick="generate()">ç”Ÿæˆ Schema</button>
                        <button class="btn btn-secondary" onclick="copyOutput()">å¤åˆ¶</button>
                    </div>
                </div>
                <textarea id="output" readonly placeholder="ç”Ÿæˆçš„ Schema å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                <div id="outputStatus"></div>
            </div>
        </div>
    </div>
    
    <script>
        const examples = {
            user: {
                id: 1,
                name: "å¼ ä¸‰",
                email: "zhangsan@example.com",
                age: 28,
                isActive: true,
                tags: ["developer", "designer"],
                address: {
                    city: "åŒ—äº¬",
                    zipCode: "100000"
                },
                createdAt: "2024-01-15T10:30:00Z"
            },
            product: {
                sku: "PROD-001",
                name: "æ— çº¿è“ç‰™è€³æœº",
                description: "é«˜å“è´¨æ— çº¿è“ç‰™è€³æœºï¼Œæ”¯æŒé™å™ª",
                price: 299.99,
                currency: "CNY",
                inStock: true,
                quantity: 150,
                categories: ["ç”µå­äº§å“", "éŸ³é¢‘è®¾å¤‡"],
                specifications: {
                    brand: "AudioTech",
                    weight: "250g",
                    batteryLife: "30å°æ—¶"
                },
                images: [
                    "https://example.com/img1.jpg",
                    "https://example.com/img2.jpg"
                ]
            },
            order: {
                orderId: "ORD-2024-001",
                customerId: "CUST-123",
                status: "pending",
                items: [
                    {
                        productId: "PROD-001",
                        name: "æ— çº¿è€³æœº",
                        quantity: 2,
                        unitPrice: 299.99
                    }
                ],
                totalAmount: 599.98,
                shippingAddress: {
                    street: "ä¸­å…³æ‘å¤§è¡—1å·",
                    city: "åŒ—äº¬",
                    country: "ä¸­å›½",
                    postalCode: "100080"
                },
                paymentMethod: "alipay",
                createdAt: "2024-01-20T14:30:00Z"
            },
            api: {
                success: true,
                code: 200,
                message: "æ“ä½œæˆåŠŸ",
                data: {
                    items: [
                        { id: 1, title: "æ–‡ç« æ ‡é¢˜1" },
                        { id: 2, title: "æ–‡ç« æ ‡é¢˜2" }
                    ],
                    pagination: {
                        page: 1,
                        pageSize: 10,
                        total: 100,
                        totalPages: 10
                    }
                },
                timestamp: 1705747800000
            }
        };
        
        function loadExample(name) {
            document.getElementById('input').value = JSON.stringify(examples[name], null, 2);
            generate();
        }
        
        function formatInput() {
            const input = document.getElementById('input');
            try {
                const json = JSON.parse(input.value);
                input.value = JSON.stringify(json, null, 2);
                showStatus('inputStatus', 'JSON æ ¼å¼åŒ–æˆåŠŸ', 'success');
            } catch (e) {
                showStatus('inputStatus', 'æ— æ•ˆçš„ JSON: ' + e.message, 'error');
            }
        }
        
        function clearInput() {
            document.getElementById('input').value = '';
            document.getElementById('output').value = '';
            document.getElementById('inputStatus').innerHTML = '';
            document.getElementById('outputStatus').innerHTML = '';
        }
        
        function showStatus(elementId, message, type) {
            const el = document.getElementById(elementId);
            el.innerHTML = `<div class="status ${type}">${message}</div>`;
            setTimeout(() => el.innerHTML = '', 3000);
        }
        
        function generate() {
            const input = document.getElementById('input').value.trim();
            
            if (!input) {
                showStatus('inputStatus', 'è¯·è¾“å…¥ JSON æ•°æ®', 'error');
                return;
            }
            
            try {
                const json = JSON.parse(input);
                const schema = generateSchema(json);
                document.getElementById('output').value = JSON.stringify(schema, null, 2);
                showStatus('outputStatus', 'Schema ç”ŸæˆæˆåŠŸ', 'success');
            } catch (e) {
                showStatus('inputStatus', 'æ— æ•ˆçš„ JSON: ' + e.message, 'error');
            }
        }
        
        function generateSchema(value, key = null) {
            const schemaVersion = document.getElementById('schemaVersion').value;
            const requireAll = document.getElementById('requireAll').checked;
            const additionalProps = document.getElementById('additionalProps').checked;
            const includeExamples = document.getElementById('includeExamples').checked;
            const includeDescriptions = document.getElementById('includeDescriptions').checked;
            
            const type = getType(value);
            let schema = {};
            
            // æ ¹çº§åˆ«æ·»åŠ  $schema
            if (key === null) {
                schema.$schema = schemaVersion;
                schema.title = "Root Schema";
                if (includeDescriptions) {
                    schema.description = "è‡ªåŠ¨ç”Ÿæˆçš„ JSON Schema";
                }
            }
            
            switch (type) {
                case 'object':
                    schema.type = 'object';
                    schema.properties = {};
                    const keys = Object.keys(value);
                    
                    for (const k of keys) {
                        schema.properties[k] = generateSchema(value[k], k);
                        // ç§»é™¤å­å±æ€§çš„ $schema
                        delete schema.properties[k].$schema;
                    }
                    
                    if (requireAll && keys.length > 0) {
                        schema.required = keys;
                    }
                    
                    schema.additionalProperties = additionalProps;
                    break;
                    
                case 'array':
                    schema.type = 'array';
                    if (value.length > 0) {
                        // è·å–æ•°ç»„å…ƒç´ çš„ç±»å‹
                        const itemTypes = [...new Set(value.map(v => getType(v)))];
                        
                        if (itemTypes.length === 1) {
                            schema.items = generateSchema(value[0]);
                            delete schema.items.$schema;
                        } else {
                            // å¤šç§ç±»å‹
                            schema.items = {
                                oneOf: value.slice(0, 3).map(v => {
                                    const s = generateSchema(v);
                                    delete s.$schema;
                                    return s;
                                })
                            };
                        }
                    }
                    if (includeExamples) {
                        schema.examples = [value];
                    }
                    break;
                    
                case 'string':
                    schema.type = 'string';
                    
                    // æ£€æµ‹ç‰¹æ®Šæ ¼å¼
                    if (isDateTimeString(value)) {
                        schema.format = 'date-time';
                    } else if (isDateString(value)) {
                        schema.format = 'date';
                    } else if (isEmailString(value)) {
                        schema.format = 'email';
                    } else if (isUriString(value)) {
                        schema.format = 'uri';
                    } else if (isUuidString(value)) {
                        schema.format = 'uuid';
                    }
                    
                    if (includeExamples) {
                        schema.examples = [value];
                    }
                    break;
                    
                case 'number':
                    schema.type = Number.isInteger(value) ? 'integer' : 'number';
                    if (includeExamples) {
                        schema.examples = [value];
                    }
                    break;
                    
                case 'boolean':
                    schema.type = 'boolean';
                    if (includeExamples) {
                        schema.examples = [value];
                    }
                    break;
                    
                case 'null':
                    schema.type = 'null';
                    break;
            }
            
            if (includeDescriptions && key) {
                schema.description = `${key} å­—æ®µ`;
            }
            
            return schema;
        }
        
        function getType(value) {
            if (value === null) return 'null';
            if (Array.isArray(value)) return 'array';
            return typeof value;
        }
        
        function isDateTimeString(str) {
            return /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(str);
        }
        
        function isDateString(str) {
            return /^\d{4}-\d{2}-\d{2}$/.test(str);
        }
        
        function isEmailString(str) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(str);
        }
        
        function isUriString(str) {
            return /^https?:\/\//.test(str);
        }
        
        function isUuidString(str) {
            return /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(str);
        }
        
        function copyOutput() {
            const output = document.getElementById('output');
            if (!output.value) {
                showStatus('outputStatus', 'æ²¡æœ‰å†…å®¹å¯å¤åˆ¶', 'error');
                return;
            }
            navigator.clipboard.writeText(output.value).then(() => {
                showStatus('outputStatus', 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            });
        }
        
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const next = current === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
        }
        
        // åˆå§‹åŒ–
        (function() {
            const saved = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', saved);
            
            // è‡ªåŠ¨ç”Ÿæˆ
            generate();
            
            // è¾“å…¥æ—¶è‡ªåŠ¨ç”Ÿæˆ
            document.getElementById('input').addEventListener('input', debounce(generate, 500));
        })();
        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>
