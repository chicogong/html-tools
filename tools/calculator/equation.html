<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊñπÁ®ãÊ±ÇËß£Âô®</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }
        .grid-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }
        .result-box {
            background: var(--pico-primary-focus);
            border: 2px solid var(--pico-primary);
            border-radius: var(--pico-border-radius);
            padding: var(--spacing-lg);
            text-align: center;
            margin: var(--spacing-md) 0;
        }
        .result-box h2 {
            margin: 0;
            font-size: 1.5rem;
        }
        .result-box p {
            margin: var(--spacing-sm) 0 0 0;
            color: var(--pico-muted-color);
        }
        .btn-group {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
            margin-top: var(--spacing-md);
        }
        .theme-toggle {
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.5rem;
            padding: 0.5rem;
        }
        .tabs {
            display: flex;
            gap: var(--spacing-sm);
            border-bottom: 2px solid var(--pico-muted-border-color);
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
        }
        .tab {
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            border: none;
            background: none;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }
        .tab.active {
            border-bottom-color: var(--pico-primary);
            color: var(--pico-primary);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .formula-box {
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            font-family: monospace;
            text-align: center;
            font-size: 1.2rem;
        }
        .step-box {
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            padding: var(--spacing-md);
            margin-top: var(--spacing-md);
            font-family: monospace;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        .equation-preview {
            font-size: 1.25rem;
            text-align: center;
            padding: var(--spacing-md);
            background: var(--pico-card-background-color);
            border-radius: var(--pico-border-radius);
            margin-bottom: var(--spacing-md);
            font-family: monospace;
        }
        .coef-label {
            text-align: center;
            font-size: 0.875rem;
            color: var(--pico-muted-color);
        }
        .matrix-grid {
            display: grid;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }
        .matrix-row {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }
        .matrix-row input {
            width: 60px;
            text-align: center;
        }
        .matrix-row span {
            min-width: 30px;
            text-align: center;
        }
    </style>
</head>
<body>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">‚Üê ËøîÂõûÈ¶ñÈ°µ</a>
        <div class="header">
            <h1>ÊñπÁ®ãÊ±ÇËß£Âô®</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="ÂàáÊç¢‰∏ªÈ¢ò">üåì</button>
        </div>

        <article>
            <div class="tabs">
                <button class="tab active" onclick="switchTab('linear')">‰∏ÄÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ã</button>
                <button class="tab" onclick="switchTab('quadratic')">‰∏ÄÂÖÉ‰∫åÊ¨°ÊñπÁ®ã</button>
                <button class="tab" onclick="switchTab('system2')">‰∫åÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÁªÑ</button>
                <button class="tab" onclick="switchTab('system3')">‰∏âÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÁªÑ</button>
                <button class="tab" onclick="switchTab('cubic')">‰∏ÄÂÖÉ‰∏âÊ¨°ÊñπÁ®ã</button>
            </div>

            <!-- Linear Equation Tab -->
            <div id="linear-tab" class="tab-content active">
                <div class="formula-box">ax + b = c</div>
                <div class="equation-preview" id="linearPreview">ax + b = c</div>

                <div class="grid-inputs">
                    <div>
                        <label>a (Á≥ªÊï∞)</label>
                        <input type="number" id="linearA" value="2" step="any" oninput="updateLinearPreview()">
                    </div>
                    <div>
                        <label>b (Â∏∏Êï∞)</label>
                        <input type="number" id="linearB" value="3" step="any" oninput="updateLinearPreview()">
                    </div>
                    <div>
                        <label>c (Á≠âÂè∑Âè≥Ëæπ)</label>
                        <input type="number" id="linearC" value="7" step="any" oninput="updateLinearPreview()">
                    </div>
                </div>

                <div class="btn-group">
                    <button onclick="solveLinear()">Ê±ÇËß£</button>
                    <button class="secondary" onclick="clearLinear()">Ê∏ÖÁ©∫</button>
                </div>
            </div>

            <!-- Quadratic Equation Tab -->
            <div id="quadratic-tab" class="tab-content">
                <div class="formula-box">ax¬≤ + bx + c = 0</div>
                <div class="equation-preview" id="quadraticPreview">ax¬≤ + bx + c = 0</div>

                <div class="grid-inputs">
                    <div>
                        <label>a (x¬≤Á≥ªÊï∞)</label>
                        <input type="number" id="quadA" value="1" step="any" oninput="updateQuadraticPreview()">
                    </div>
                    <div>
                        <label>b (xÁ≥ªÊï∞)</label>
                        <input type="number" id="quadB" value="-5" step="any" oninput="updateQuadraticPreview()">
                    </div>
                    <div>
                        <label>c (Â∏∏Êï∞È°π)</label>
                        <input type="number" id="quadC" value="6" step="any" oninput="updateQuadraticPreview()">
                    </div>
                </div>

                <div class="btn-group">
                    <button onclick="solveQuadratic()">Ê±ÇËß£</button>
                    <button class="secondary" onclick="clearQuadratic()">Ê∏ÖÁ©∫</button>
                </div>
            </div>

            <!-- System of 2 Linear Equations Tab -->
            <div id="system2-tab" class="tab-content">
                <div class="formula-box">
                    a‚ÇÅx + b‚ÇÅy = c‚ÇÅ<br>
                    a‚ÇÇx + b‚ÇÇy = c‚ÇÇ
                </div>

                <div class="matrix-grid">
                    <div class="matrix-row">
                        <input type="number" id="s2a1" value="2" step="any">
                        <span>x +</span>
                        <input type="number" id="s2b1" value="3" step="any">
                        <span>y =</span>
                        <input type="number" id="s2c1" value="8" step="any">
                    </div>
                    <div class="matrix-row">
                        <input type="number" id="s2a2" value="4" step="any">
                        <span>x +</span>
                        <input type="number" id="s2b2" value="-1" step="any">
                        <span>y =</span>
                        <input type="number" id="s2c2" value="2" step="any">
                    </div>
                </div>

                <div class="btn-group">
                    <button onclick="solveSystem2()">Ê±ÇËß£</button>
                    <button class="secondary" onclick="clearSystem2()">Ê∏ÖÁ©∫</button>
                </div>
            </div>

            <!-- System of 3 Linear Equations Tab -->
            <div id="system3-tab" class="tab-content">
                <div class="formula-box">
                    a‚ÇÅx + b‚ÇÅy + c‚ÇÅz = d‚ÇÅ<br>
                    a‚ÇÇx + b‚ÇÇy + c‚ÇÇz = d‚ÇÇ<br>
                    a‚ÇÉx + b‚ÇÉy + c‚ÇÉz = d‚ÇÉ
                </div>

                <div class="matrix-grid">
                    <div class="matrix-row">
                        <input type="number" id="s3a1" value="1" step="any">
                        <span>x +</span>
                        <input type="number" id="s3b1" value="2" step="any">
                        <span>y +</span>
                        <input type="number" id="s3c1" value="3" step="any">
                        <span>z =</span>
                        <input type="number" id="s3d1" value="14" step="any">
                    </div>
                    <div class="matrix-row">
                        <input type="number" id="s3a2" value="2" step="any">
                        <span>x +</span>
                        <input type="number" id="s3b2" value="-1" step="any">
                        <span>y +</span>
                        <input type="number" id="s3c2" value="1" step="any">
                        <span>z =</span>
                        <input type="number" id="s3d2" value="3" step="any">
                    </div>
                    <div class="matrix-row">
                        <input type="number" id="s3a3" value="3" step="any">
                        <span>x +</span>
                        <input type="number" id="s3b3" value="1" step="any">
                        <span>y +</span>
                        <input type="number" id="s3c3" value="-2" step="any">
                        <span>z =</span>
                        <input type="number" id="s3d3" value="1" step="any">
                    </div>
                </div>

                <div class="btn-group">
                    <button onclick="solveSystem3()">Ê±ÇËß£</button>
                    <button class="secondary" onclick="clearSystem3()">Ê∏ÖÁ©∫</button>
                </div>
            </div>

            <!-- Cubic Equation Tab -->
            <div id="cubic-tab" class="tab-content">
                <div class="formula-box">ax¬≥ + bx¬≤ + cx + d = 0</div>
                <div class="equation-preview" id="cubicPreview">ax¬≥ + bx¬≤ + cx + d = 0</div>

                <div class="grid-inputs">
                    <div>
                        <label>a (x¬≥Á≥ªÊï∞)</label>
                        <input type="number" id="cubicA" value="1" step="any" oninput="updateCubicPreview()">
                    </div>
                    <div>
                        <label>b (x¬≤Á≥ªÊï∞)</label>
                        <input type="number" id="cubicB" value="-6" step="any" oninput="updateCubicPreview()">
                    </div>
                    <div>
                        <label>c (xÁ≥ªÊï∞)</label>
                        <input type="number" id="cubicC" value="11" step="any" oninput="updateCubicPreview()">
                    </div>
                    <div>
                        <label>d (Â∏∏Êï∞È°π)</label>
                        <input type="number" id="cubicD" value="-6" step="any" oninput="updateCubicPreview()">
                    </div>
                </div>

                <div class="btn-group">
                    <button onclick="solveCubic()">Ê±ÇËß£</button>
                    <button class="secondary" onclick="clearCubic()">Ê∏ÖÁ©∫</button>
                </div>
            </div>

            <div class="result-box">
                <h2 id="result">--</h2>
                <p id="resultDetail">ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£</p>
            </div>

            <div class="step-box" id="steps" style="display: none;"></div>
        </article>
    </main>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            html.setAttribute('data-theme', current === 'light' ? 'dark' : 'light');
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(function(t) { t.classList.remove('active'); });
            document.querySelectorAll('.tab-content').forEach(function(c) { c.classList.remove('active'); });
            document.querySelector('[onclick="switchTab(\'' + tabName + '\')"]').classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            document.getElementById('steps').style.display = 'none';
            document.getElementById('result').textContent = '--';
            document.getElementById('resultDetail').textContent = 'ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£';
        }

        function formatNumber(num) {
            if (Math.abs(num - Math.round(num)) < 1e-10) {
                return Math.round(num).toString();
            }
            return num.toFixed(6).replace(/\.?0+$/, '');
        }

        function formatCoef(num, isFirst, variable) {
            if (num === 0) return '';
            const abs = Math.abs(num);
            const sign = num > 0 ? (isFirst ? '' : ' + ') : ' - ';
            const coef = abs === 1 ? '' : formatNumber(abs);
            return sign + coef + variable;
        }

        // Linear equation: ax + b = c
        function updateLinearPreview() {
            const a = parseFloat(document.getElementById('linearA').value) || 0;
            const b = parseFloat(document.getElementById('linearB').value) || 0;
            const c = parseFloat(document.getElementById('linearC').value) || 0;
            
            let eq = formatNumber(a) + 'x';
            if (b >= 0) eq += ' + ' + formatNumber(b);
            else eq += ' - ' + formatNumber(Math.abs(b));
            eq += ' = ' + formatNumber(c);
            
            document.getElementById('linearPreview').textContent = eq;
        }

        function solveLinear() {
            const a = parseFloat(document.getElementById('linearA').value) || 0;
            const b = parseFloat(document.getElementById('linearB').value) || 0;
            const c = parseFloat(document.getElementById('linearC').value) || 0;

            if (a === 0) {
                if (b === c) {
                    document.getElementById('result').textContent = 'Êó†Á©∑Â§öËß£';
                    document.getElementById('resultDetail').textContent = 'ÊñπÁ®ãÊÅíÊàêÁ´ã';
                } else {
                    document.getElementById('result').textContent = 'Êó†Ëß£';
                    document.getElementById('resultDetail').textContent = 'ÊñπÁ®ãÁüõÁõæ';
                }
                document.getElementById('steps').style.display = 'none';
                return;
            }

            const x = (c - b) / a;
            
            let steps = 'ÂéüÊñπÁ®ã: ' + formatNumber(a) + 'x + ' + formatNumber(b) + ' = ' + formatNumber(c) + '\n';
            steps += 'ÁßªÈ°π: ' + formatNumber(a) + 'x = ' + formatNumber(c) + ' - ' + formatNumber(b) + '\n';
            steps += '       ' + formatNumber(a) + 'x = ' + formatNumber(c - b) + '\n';
            steps += '‰∏§ËæπÈô§‰ª• ' + formatNumber(a) + ':\n';
            steps += '       x = ' + formatNumber(c - b) + ' / ' + formatNumber(a) + '\n';
            steps += '       x = ' + formatNumber(x);

            document.getElementById('result').textContent = 'x = ' + formatNumber(x);
            document.getElementById('resultDetail').textContent = '‰∏ÄÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÁöÑËß£';
            document.getElementById('steps').textContent = steps;
            document.getElementById('steps').style.display = 'block';
        }

        function clearLinear() {
            document.getElementById('linearA').value = 2;
            document.getElementById('linearB').value = 3;
            document.getElementById('linearC').value = 7;
            updateLinearPreview();
            document.getElementById('result').textContent = '--';
            document.getElementById('resultDetail').textContent = 'ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£';
            document.getElementById('steps').style.display = 'none';
        }

        // Quadratic equation: ax¬≤ + bx + c = 0
        function updateQuadraticPreview() {
            const a = parseFloat(document.getElementById('quadA').value) || 0;
            const b = parseFloat(document.getElementById('quadB').value) || 0;
            const c = parseFloat(document.getElementById('quadC').value) || 0;
            
            let eq = formatNumber(a) + 'x¬≤';
            if (b >= 0) eq += ' + ' + formatNumber(b) + 'x';
            else eq += ' - ' + formatNumber(Math.abs(b)) + 'x';
            if (c >= 0) eq += ' + ' + formatNumber(c);
            else eq += ' - ' + formatNumber(Math.abs(c));
            eq += ' = 0';
            
            document.getElementById('quadraticPreview').textContent = eq;
        }

        function solveQuadratic() {
            const a = parseFloat(document.getElementById('quadA').value) || 0;
            const b = parseFloat(document.getElementById('quadB').value) || 0;
            const c = parseFloat(document.getElementById('quadC').value) || 0;

            if (a === 0) {
                alert('a‰∏çËÉΩ‰∏∫0ÔºåÂê¶Âàô‰∏çÊòØ‰∫åÊ¨°ÊñπÁ®ã');
                return;
            }

            const discriminant = b * b - 4 * a * c;
            
            let steps = 'ÂéüÊñπÁ®ã: ' + formatNumber(a) + 'x¬≤ + ' + formatNumber(b) + 'x + ' + formatNumber(c) + ' = 0\n\n';
            steps += 'Âà§Âà´Âºè Œî = b¬≤ - 4ac\n';
            steps += '       Œî = ' + formatNumber(b) + '¬≤ - 4√ó' + formatNumber(a) + '√ó' + formatNumber(c) + '\n';
            steps += '       Œî = ' + formatNumber(b * b) + ' - ' + formatNumber(4 * a * c) + '\n';
            steps += '       Œî = ' + formatNumber(discriminant) + '\n\n';

            let result;
            if (discriminant > 0) {
                const x1 = (-b + Math.sqrt(discriminant)) / (2 * a);
                const x2 = (-b - Math.sqrt(discriminant)) / (2 * a);
                result = 'x‚ÇÅ = ' + formatNumber(x1) + ', x‚ÇÇ = ' + formatNumber(x2);
                steps += 'Œî > 0, Êúâ‰∏§‰∏™‰∏çÁ≠âÂÆûÊ†π:\n';
                steps += 'x = (-b ¬± ‚àöŒî) / 2a\n';
                steps += 'x‚ÇÅ = (' + formatNumber(-b) + ' + ‚àö' + formatNumber(discriminant) + ') / ' + formatNumber(2 * a) + ' = ' + formatNumber(x1) + '\n';
                steps += 'x‚ÇÇ = (' + formatNumber(-b) + ' - ‚àö' + formatNumber(discriminant) + ') / ' + formatNumber(2 * a) + ' = ' + formatNumber(x2);
            } else if (discriminant === 0) {
                const x = -b / (2 * a);
                result = 'x = ' + formatNumber(x) + ' (ÈáçÊ†π)';
                steps += 'Œî = 0, Êúâ‰∏§‰∏™Áõ∏Á≠âÂÆûÊ†π:\n';
                steps += 'x = -b / 2a = ' + formatNumber(-b) + ' / ' + formatNumber(2 * a) + ' = ' + formatNumber(x);
            } else {
                const realPart = -b / (2 * a);
                const imagPart = Math.sqrt(-discriminant) / (2 * a);
                result = 'x‚ÇÅ = ' + formatNumber(realPart) + ' + ' + formatNumber(imagPart) + 'i\nx‚ÇÇ = ' + formatNumber(realPart) + ' - ' + formatNumber(imagPart) + 'i';
                steps += 'Œî < 0, Êúâ‰∏§‰∏™ÂÖ±ËΩ≠Â§çÊ†π:\n';
                steps += 'x = (-b ¬± ‚àöŒî) / 2a\n';
                steps += 'ÂÆûÈÉ®: ' + formatNumber(-b) + ' / ' + formatNumber(2 * a) + ' = ' + formatNumber(realPart) + '\n';
                steps += 'ËôöÈÉ®: ‚àö' + formatNumber(-discriminant) + ' / ' + formatNumber(2 * a) + ' = ' + formatNumber(imagPart) + '\n';
                steps += 'x‚ÇÅ = ' + formatNumber(realPart) + ' + ' + formatNumber(imagPart) + 'i\n';
                steps += 'x‚ÇÇ = ' + formatNumber(realPart) + ' - ' + formatNumber(imagPart) + 'i';
            }

            document.getElementById('result').textContent = result;
            document.getElementById('resultDetail').textContent = discriminant >= 0 ? 'ÂÆûÊï∞Ëß£' : 'Â§çÊï∞Ëß£';
            document.getElementById('steps').textContent = steps;
            document.getElementById('steps').style.display = 'block';
        }

        function clearQuadratic() {
            document.getElementById('quadA').value = 1;
            document.getElementById('quadB').value = -5;
            document.getElementById('quadC').value = 6;
            updateQuadraticPreview();
            document.getElementById('result').textContent = '--';
            document.getElementById('resultDetail').textContent = 'ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£';
            document.getElementById('steps').style.display = 'none';
        }

        // System of 2 equations using Cramer's rule
        function solveSystem2() {
            const a1 = parseFloat(document.getElementById('s2a1').value) || 0;
            const b1 = parseFloat(document.getElementById('s2b1').value) || 0;
            const c1 = parseFloat(document.getElementById('s2c1').value) || 0;
            const a2 = parseFloat(document.getElementById('s2a2').value) || 0;
            const b2 = parseFloat(document.getElementById('s2b2').value) || 0;
            const c2 = parseFloat(document.getElementById('s2c2').value) || 0;

            const det = a1 * b2 - a2 * b1;
            
            let steps = 'ÊñπÁ®ãÁªÑ:\n';
            steps += formatNumber(a1) + 'x + ' + formatNumber(b1) + 'y = ' + formatNumber(c1) + '\n';
            steps += formatNumber(a2) + 'x + ' + formatNumber(b2) + 'y = ' + formatNumber(c2) + '\n\n';
            steps += '‰ΩøÁî®ÂÖãÊãâÈªòÊ≥ïÂàô:\n';
            steps += 'D = |a1 b1| = ' + formatNumber(a1) + '√ó' + formatNumber(b2) + ' - ' + formatNumber(a2) + '√ó' + formatNumber(b1) + ' = ' + formatNumber(det) + '\n';
            steps += '    |a2 b2|\n\n';

            if (Math.abs(det) < 1e-10) {
                document.getElementById('result').textContent = 'Êó†ÂîØ‰∏ÄËß£';
                document.getElementById('resultDetail').textContent = 'ÊñπÁ®ãÁªÑÊó†Ëß£ÊàñÊúâÊó†Á©∑Â§öËß£';
                document.getElementById('steps').textContent = steps + 'Ë°åÂàóÂºè‰∏∫0ÔºåÊñπÁ®ãÁªÑÊó†ÂîØ‰∏ÄËß£';
                document.getElementById('steps').style.display = 'block';
                return;
            }

            const detX = c1 * b2 - c2 * b1;
            const detY = a1 * c2 - a2 * c1;
            const x = detX / det;
            const y = detY / det;

            steps += 'Dx = |c1 b1| = ' + formatNumber(c1) + '√ó' + formatNumber(b2) + ' - ' + formatNumber(c2) + '√ó' + formatNumber(b1) + ' = ' + formatNumber(detX) + '\n';
            steps += '     |c2 b2|\n\n';
            steps += 'Dy = |a1 c1| = ' + formatNumber(a1) + '√ó' + formatNumber(c2) + ' - ' + formatNumber(a2) + '√ó' + formatNumber(c1) + ' = ' + formatNumber(detY) + '\n';
            steps += '     |a2 c2|\n\n';
            steps += 'x = Dx / D = ' + formatNumber(detX) + ' / ' + formatNumber(det) + ' = ' + formatNumber(x) + '\n';
            steps += 'y = Dy / D = ' + formatNumber(detY) + ' / ' + formatNumber(det) + ' = ' + formatNumber(y);

            document.getElementById('result').textContent = 'x = ' + formatNumber(x) + ', y = ' + formatNumber(y);
            document.getElementById('resultDetail').textContent = '‰∫åÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÁªÑÁöÑËß£';
            document.getElementById('steps').textContent = steps;
            document.getElementById('steps').style.display = 'block';
        }

        function clearSystem2() {
            document.getElementById('s2a1').value = 2;
            document.getElementById('s2b1').value = 3;
            document.getElementById('s2c1').value = 8;
            document.getElementById('s2a2').value = 4;
            document.getElementById('s2b2').value = -1;
            document.getElementById('s2c2').value = 2;
            document.getElementById('result').textContent = '--';
            document.getElementById('resultDetail').textContent = 'ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£';
            document.getElementById('steps').style.display = 'none';
        }

        // System of 3 equations using Cramer's rule
        function det3x3(m) {
            return m[0][0] * (m[1][1] * m[2][2] - m[1][2] * m[2][1])
                 - m[0][1] * (m[1][0] * m[2][2] - m[1][2] * m[2][0])
                 + m[0][2] * (m[1][0] * m[2][1] - m[1][1] * m[2][0]);
        }

        function solveSystem3() {
            const a1 = parseFloat(document.getElementById('s3a1').value) || 0;
            const b1 = parseFloat(document.getElementById('s3b1').value) || 0;
            const c1 = parseFloat(document.getElementById('s3c1').value) || 0;
            const d1 = parseFloat(document.getElementById('s3d1').value) || 0;
            const a2 = parseFloat(document.getElementById('s3a2').value) || 0;
            const b2 = parseFloat(document.getElementById('s3b2').value) || 0;
            const c2 = parseFloat(document.getElementById('s3c2').value) || 0;
            const d2 = parseFloat(document.getElementById('s3d2').value) || 0;
            const a3 = parseFloat(document.getElementById('s3a3').value) || 0;
            const b3 = parseFloat(document.getElementById('s3b3').value) || 0;
            const c3 = parseFloat(document.getElementById('s3c3').value) || 0;
            const d3 = parseFloat(document.getElementById('s3d3').value) || 0;

            const coeffMatrix = [[a1, b1, c1], [a2, b2, c2], [a3, b3, c3]];
            const det = det3x3(coeffMatrix);

            let steps = 'ÊñπÁ®ãÁªÑ:\n';
            steps += formatNumber(a1) + 'x + ' + formatNumber(b1) + 'y + ' + formatNumber(c1) + 'z = ' + formatNumber(d1) + '\n';
            steps += formatNumber(a2) + 'x + ' + formatNumber(b2) + 'y + ' + formatNumber(c2) + 'z = ' + formatNumber(d2) + '\n';
            steps += formatNumber(a3) + 'x + ' + formatNumber(b3) + 'y + ' + formatNumber(c3) + 'z = ' + formatNumber(d3) + '\n\n';
            steps += 'Á≥ªÊï∞Ë°åÂàóÂºè D = ' + formatNumber(det) + '\n\n';

            if (Math.abs(det) < 1e-10) {
                document.getElementById('result').textContent = 'Êó†ÂîØ‰∏ÄËß£';
                document.getElementById('resultDetail').textContent = 'ÊñπÁ®ãÁªÑÊó†Ëß£ÊàñÊúâÊó†Á©∑Â§öËß£';
                document.getElementById('steps').textContent = steps + 'Ë°åÂàóÂºè‰∏∫0ÔºåÊñπÁ®ãÁªÑÊó†ÂîØ‰∏ÄËß£';
                document.getElementById('steps').style.display = 'block';
                return;
            }

            const detX = det3x3([[d1, b1, c1], [d2, b2, c2], [d3, b3, c3]]);
            const detY = det3x3([[a1, d1, c1], [a2, d2, c2], [a3, d3, c3]]);
            const detZ = det3x3([[a1, b1, d1], [a2, b2, d2], [a3, b3, d3]]);

            const x = detX / det;
            const y = detY / det;
            const z = detZ / det;

            steps += 'Dx = ' + formatNumber(detX) + '\n';
            steps += 'Dy = ' + formatNumber(detY) + '\n';
            steps += 'Dz = ' + formatNumber(detZ) + '\n\n';
            steps += 'x = Dx / D = ' + formatNumber(x) + '\n';
            steps += 'y = Dy / D = ' + formatNumber(y) + '\n';
            steps += 'z = Dz / D = ' + formatNumber(z);

            document.getElementById('result').textContent = 'x = ' + formatNumber(x) + ', y = ' + formatNumber(y) + ', z = ' + formatNumber(z);
            document.getElementById('resultDetail').textContent = '‰∏âÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÁªÑÁöÑËß£';
            document.getElementById('steps').textContent = steps;
            document.getElementById('steps').style.display = 'block';
        }

        function clearSystem3() {
            document.getElementById('s3a1').value = 1;
            document.getElementById('s3b1').value = 2;
            document.getElementById('s3c1').value = 3;
            document.getElementById('s3d1').value = 14;
            document.getElementById('s3a2').value = 2;
            document.getElementById('s3b2').value = -1;
            document.getElementById('s3c2').value = 1;
            document.getElementById('s3d2').value = 3;
            document.getElementById('s3a3').value = 3;
            document.getElementById('s3b3').value = 1;
            document.getElementById('s3c3').value = -2;
            document.getElementById('s3d3').value = 1;
            document.getElementById('result').textContent = '--';
            document.getElementById('resultDetail').textContent = 'ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£';
            document.getElementById('steps').style.display = 'none';
        }

        // Cubic equation
        function updateCubicPreview() {
            const a = parseFloat(document.getElementById('cubicA').value) || 0;
            const b = parseFloat(document.getElementById('cubicB').value) || 0;
            const c = parseFloat(document.getElementById('cubicC').value) || 0;
            const d = parseFloat(document.getElementById('cubicD').value) || 0;
            
            let eq = formatNumber(a) + 'x¬≥';
            if (b >= 0) eq += ' + ' + formatNumber(b) + 'x¬≤';
            else eq += ' - ' + formatNumber(Math.abs(b)) + 'x¬≤';
            if (c >= 0) eq += ' + ' + formatNumber(c) + 'x';
            else eq += ' - ' + formatNumber(Math.abs(c)) + 'x';
            if (d >= 0) eq += ' + ' + formatNumber(d);
            else eq += ' - ' + formatNumber(Math.abs(d));
            eq += ' = 0';
            
            document.getElementById('cubicPreview').textContent = eq;
        }

        function solveCubic() {
            const a = parseFloat(document.getElementById('cubicA').value) || 0;
            const b = parseFloat(document.getElementById('cubicB').value) || 0;
            const c = parseFloat(document.getElementById('cubicC').value) || 0;
            const d = parseFloat(document.getElementById('cubicD').value) || 0;

            if (a === 0) {
                alert('a‰∏çËÉΩ‰∏∫0ÔºåÂê¶Âàô‰∏çÊòØ‰∏âÊ¨°ÊñπÁ®ã');
                return;
            }

            // Normalize: x¬≥ + px¬≤ + qx + r = 0
            const p = b / a;
            const q = c / a;
            const r = d / a;

            // Substitution x = t - p/3 to eliminate x¬≤ term
            // t¬≥ + pt' + q' = 0
            const pPrime = q - p * p / 3;
            const qPrime = r - p * q / 3 + 2 * p * p * p / 27;

            // Discriminant
            const discriminant = qPrime * qPrime / 4 + pPrime * pPrime * pPrime / 27;

            let steps = 'ÂéüÊñπÁ®ã: ' + formatNumber(a) + 'x¬≥ + ' + formatNumber(b) + 'x¬≤ + ' + formatNumber(c) + 'x + ' + formatNumber(d) + ' = 0\n\n';
            steps += 'Ê†áÂáÜÂåñ: x¬≥ + ' + formatNumber(p) + 'x¬≤ + ' + formatNumber(q) + 'x + ' + formatNumber(r) + ' = 0\n\n';
            steps += '‰ΩøÁî®Âç°Â∞î‰∏πÂÖ¨ÂºèÊ±ÇËß£...\n';
            steps += 'Âà§Âà´Âºè = ' + formatNumber(discriminant) + '\n\n';

            let roots = [];
            
            if (Math.abs(discriminant) < 1e-10) {
                // Triple root or two roots
                if (Math.abs(pPrime) < 1e-10) {
                    roots.push(-p / 3);
                    steps += '‰∏âÈáçÊ†πÊÉÖÂÜµ\n';
                } else {
                    roots.push(3 * qPrime / pPrime - p / 3);
                    roots.push(-3 * qPrime / (2 * pPrime) - p / 3);
                    steps += 'Êúâ‰∏Ä‰∏™ÈáçÊ†π\n';
                }
            } else if (discriminant > 0) {
                // One real root
                const sqrtD = Math.sqrt(discriminant);
                const u = Math.cbrt(-qPrime / 2 + sqrtD);
                const v = Math.cbrt(-qPrime / 2 - sqrtD);
                roots.push(u + v - p / 3);
                steps += '‰∏Ä‰∏™ÂÆûÊ†πÔºå‰∏§‰∏™ÂÖ±ËΩ≠Â§çÊ†π\n';
            } else {
                // Three real roots (Vieta's trigonometric method)
                const rho = Math.sqrt(-pPrime * pPrime * pPrime / 27);
                const theta = Math.acos(-qPrime / (2 * rho));
                for (let k = 0; k < 3; k++) {
                    roots.push(2 * Math.cbrt(rho) * Math.cos((theta + 2 * Math.PI * k) / 3) - p / 3);
                }
                steps += '‰∏â‰∏™‰∏çÁ≠âÂÆûÊ†π\n';
            }

            roots = roots.map(function(r) { return formatNumber(r); });
            const uniqueRoots = roots.filter(function(r, i, arr) { return arr.indexOf(r) === i; });

            steps += '\nËß£:\n';
            uniqueRoots.forEach(function(r, i) {
                steps += 'x' + (i + 1) + ' = ' + r + '\n';
            });

            document.getElementById('result').textContent = uniqueRoots.map(function(r, i) { return 'x' + (i + 1) + ' = ' + r; }).join(', ');
            document.getElementById('resultDetail').textContent = '‰∏ÄÂÖÉ‰∏âÊ¨°ÊñπÁ®ãÁöÑËß£';
            document.getElementById('steps').textContent = steps;
            document.getElementById('steps').style.display = 'block';
        }

        function clearCubic() {
            document.getElementById('cubicA').value = 1;
            document.getElementById('cubicB').value = -6;
            document.getElementById('cubicC').value = 11;
            document.getElementById('cubicD').value = -6;
            updateCubicPreview();
            document.getElementById('result').textContent = '--';
            document.getElementById('resultDetail').textContent = 'ËæìÂÖ•Á≥ªÊï∞Âπ∂ÁÇπÂáªÊ±ÇËß£';
            document.getElementById('steps').style.display = 'none';
        }

        // Initialize previews
        updateLinearPreview();
        updateQuadraticPreview();
        updateCubicPreview();
    </script>
</body>
</html>
