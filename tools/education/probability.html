<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¦‚ç‡è®¡ç®—å™¨ - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #8b5cf6; --success: #22c55e; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; }
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab { padding: 10px 16px; border: 1px solid var(--border); border-radius: 8px; background: transparent; color: var(--text); cursor: pointer; transition: all 0.2s; font-size: 0.9rem; }
        .tab.active { background: var(--accent); border-color: var(--accent); color: white; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input, select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus, select:focus { outline: none; border-color: var(--accent); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.2s; }
        .btn-primary { background: var(--accent); color: white; }
        .btn:hover { opacity: 0.9; }
        .result-hero { background: linear-gradient(135deg, var(--accent), #a855f7); padding: 24px; border-radius: 12px; text-align: center; color: white; margin-top: 20px; }
        .result-hero .big { font-size: 2.5rem; font-weight: 700; }
        .result-hero .label { opacity: 0.9; margin-bottom: 8px; }
        .result-box { background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 16px; margin-top: 16px; }
        .result-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border); }
        .result-row:last-child { border-bottom: none; }
        .result-row .label { color: var(--text2); }
        .result-row .value { font-weight: 600; font-family: 'Courier New', monospace; }
        .formula { font-family: 'Times New Roman', serif; font-size: 1.1rem; padding: 16px; background: var(--bg); border-radius: 8px; text-align: center; margin-top: 12px; }
        .note { font-size: 0.85rem; color: var(--text2); margin-top: 12px; padding: 12px; background: var(--bg); border-radius: 8px; line-height: 1.6; }
        .hidden { display: none !important; }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">â† è¿”å›</a>
        <h1>ğŸ² æ¦‚ç‡è®¡ç®—å™¨</h1>
        <p class="subtitle">æ’åˆ—ç»„åˆã€äºŒé¡¹åˆ†å¸ƒã€æ¡ä»¶æ¦‚ç‡è®¡ç®—</p>
        
        <div class="tabs">
            <button class="tab active" data-tab="permutation">æ’åˆ—ç»„åˆ</button>
            <button class="tab" data-tab="binomial">äºŒé¡¹åˆ†å¸ƒ</button>
            <button class="tab" data-tab="conditional">æ¡ä»¶æ¦‚ç‡</button>
            <button class="tab" data-tab="bayes">è´å¶æ–¯å®šç†</button>
        </div>
        
        <div id="permutationPanel" class="card">
            <div class="card-title">æ’åˆ—ä¸ç»„åˆ</div>
            <div class="grid">
                <div class="form-group">
                    <label>æ€»æ•° n</label>
                    <input type="number" id="pn" value="10" min="0" oninput="calcPermutation()">
                </div>
                <div class="form-group">
                    <label>é€‰å–æ•° r</label>
                    <input type="number" id="pr" value="3" min="0" oninput="calcPermutation()">
                </div>
            </div>
            
            <div class="result-box">
                <div class="result-row">
                    <span class="label">æ’åˆ— P(n,r) = n!/(n-r)!</span>
                    <span class="value" id="permResult">720</span>
                </div>
                <div class="result-row">
                    <span class="label">ç»„åˆ C(n,r) = n!/[r!(n-r)!]</span>
                    <span class="value" id="combResult">120</span>
                </div>
                <div class="result-row">
                    <span class="label">n! (nçš„é˜¶ä¹˜)</span>
                    <span class="value" id="factResult">3628800</span>
                </div>
            </div>
            
            <div class="note">
                <strong>æ’åˆ—</strong>ï¼šä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡ºrä¸ªå…ƒç´ æ’æˆä¸€åˆ—ï¼ˆæœ‰åºï¼‰<br>
                <strong>ç»„åˆ</strong>ï¼šä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡ºrä¸ªå…ƒç´ æˆä¸ºä¸€ç»„ï¼ˆæ— åºï¼‰
            </div>
        </div>
        
        <div id="binomialPanel" class="card hidden">
            <div class="card-title">äºŒé¡¹åˆ†å¸ƒ B(n, p)</div>
            <div class="grid">
                <div class="form-group">
                    <label>è¯•éªŒæ¬¡æ•° n</label>
                    <input type="number" id="bn" value="10" min="1" oninput="calcBinomial()">
                </div>
                <div class="form-group">
                    <label>æˆåŠŸæ¦‚ç‡ p</label>
                    <input type="number" id="bp" value="0.5" min="0" max="1" step="0.01" oninput="calcBinomial()">
                </div>
            </div>
            <div class="form-group">
                <label>æˆåŠŸæ¬¡æ•° k</label>
                <input type="number" id="bk" value="5" min="0" oninput="calcBinomial()">
            </div>
            
            <div class="result-hero">
                <div class="label">P(X = k) æ°å¥½æˆåŠŸkæ¬¡çš„æ¦‚ç‡</div>
                <div class="big" id="binomialExact">0.2461</div>
            </div>
            
            <div class="result-box">
                <div class="result-row">
                    <span class="label">P(X â‰¤ k) æœ€å¤šæˆåŠŸkæ¬¡</span>
                    <span class="value" id="binomialLte">0.6230</span>
                </div>
                <div class="result-row">
                    <span class="label">P(X â‰¥ k) è‡³å°‘æˆåŠŸkæ¬¡</span>
                    <span class="value" id="binomialGte">0.6230</span>
                </div>
                <div class="result-row">
                    <span class="label">æœŸæœ› E(X) = np</span>
                    <span class="value" id="binomialMean">5</span>
                </div>
                <div class="result-row">
                    <span class="label">æ–¹å·® Var(X) = np(1-p)</span>
                    <span class="value" id="binomialVar">2.5</span>
                </div>
            </div>
            
            <div class="formula">
                P(X = k) = C(n,k) Ã— p<sup>k</sup> Ã— (1-p)<sup>n-k</sup>
            </div>
        </div>
        
        <div id="conditionalPanel" class="card hidden">
            <div class="card-title">æ¡ä»¶æ¦‚ç‡</div>
            <div class="grid">
                <div class="form-group">
                    <label>P(A) äº‹ä»¶Açš„æ¦‚ç‡</label>
                    <input type="number" id="pa" value="0.4" min="0" max="1" step="0.01" oninput="calcConditional()">
                </div>
                <div class="form-group">
                    <label>P(B) äº‹ä»¶Bçš„æ¦‚ç‡</label>
                    <input type="number" id="pb" value="0.5" min="0" max="1" step="0.01" oninput="calcConditional()">
                </div>
            </div>
            <div class="form-group">
                <label>P(Aâˆ©B) äº‹ä»¶Aå’ŒBåŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡</label>
                <input type="number" id="pab" value="0.2" min="0" max="1" step="0.01" oninput="calcConditional()">
            </div>
            
            <div class="result-box">
                <div class="result-row">
                    <span class="label">P(A|B) åœ¨Bå‘ç”Ÿæ¡ä»¶ä¸‹Aå‘ç”Ÿçš„æ¦‚ç‡</span>
                    <span class="value" id="paGivenB">0.4000</span>
                </div>
                <div class="result-row">
                    <span class="label">P(B|A) åœ¨Aå‘ç”Ÿæ¡ä»¶ä¸‹Bå‘ç”Ÿçš„æ¦‚ç‡</span>
                    <span class="value" id="pbGivenA">0.5000</span>
                </div>
                <div class="result-row">
                    <span class="label">P(AâˆªB) äº‹ä»¶Aæˆ–Bå‘ç”Ÿçš„æ¦‚ç‡</span>
                    <span class="value" id="paOrB">0.7000</span>
                </div>
                <div class="result-row">
                    <span class="label">ç‹¬ç«‹æ€§æ£€éªŒ P(A)Ã—P(B)</span>
                    <span class="value" id="independence">0.2000</span>
                </div>
            </div>
            
            <div class="formula">
                P(A|B) = P(Aâˆ©B) / P(B)
            </div>
            
            <div class="note" id="independenceNote"></div>
        </div>
        
        <div id="bayesPanel" class="card hidden">
            <div class="card-title">è´å¶æ–¯å®šç†</div>
            <div class="note" style="margin-top: 0; margin-bottom: 16px;">
                å·²çŸ¥ï¼šP(A)ä¸ºå…ˆéªŒæ¦‚ç‡ï¼ŒP(B|A)ä¸ºä¼¼ç„¶æ¦‚ç‡<br>
                æ±‚ï¼šP(A|B)åéªŒæ¦‚ç‡
            </div>
            
            <div class="grid">
                <div class="form-group">
                    <label>P(A) äº‹ä»¶Açš„å…ˆéªŒæ¦‚ç‡</label>
                    <input type="number" id="bayesPa" value="0.01" min="0" max="1" step="0.001" oninput="calcBayes()">
                </div>
                <div class="form-group">
                    <label>P(Â¬A) = 1 - P(A)</label>
                    <input type="number" id="bayesPna" value="0.99" readonly>
                </div>
            </div>
            <div class="grid">
                <div class="form-group">
                    <label>P(B|A) Aå‘ç”Ÿæ—¶Bå‘ç”Ÿçš„æ¦‚ç‡</label>
                    <input type="number" id="bayesPba" value="0.99" min="0" max="1" step="0.01" oninput="calcBayes()">
                </div>
                <div class="form-group">
                    <label>P(B|Â¬A) Aä¸å‘ç”Ÿæ—¶Bå‘ç”Ÿçš„æ¦‚ç‡</label>
                    <input type="number" id="bayesPbna" value="0.05" min="0" max="1" step="0.01" oninput="calcBayes()">
                </div>
            </div>
            
            <div class="result-hero">
                <div class="label">P(A|B) åéªŒæ¦‚ç‡</div>
                <div class="big" id="bayesResult">0.1667</div>
            </div>
            
            <div class="result-box">
                <div class="result-row">
                    <span class="label">P(B) å…¨æ¦‚ç‡</span>
                    <span class="value" id="bayesPb">0.0594</span>
                </div>
                <div class="result-row">
                    <span class="label">P(Â¬A|B) åéªŒäº’è¡¥æ¦‚ç‡</span>
                    <span class="value" id="bayesPnaGivenB">0.8333</span>
                </div>
            </div>
            
            <div class="formula">
                P(A|B) = P(B|A) Ã— P(A) / P(B)<br>
                P(B) = P(B|A)Ã—P(A) + P(B|Â¬A)Ã—P(Â¬A)
            </div>
            
            <div class="note">
                <strong>ç»å…¸åº”ç”¨ï¼š</strong>åŒ»å­¦æ£€æµ‹<br>
                â€¢ P(A) = æ‚£ç—…ç‡ï¼ˆå¦‚1%ï¼‰<br>
                â€¢ P(B|A) = æ£€æµ‹çµæ•åº¦ï¼ˆå¦‚99%ï¼Œæ‚£ç—…æ—¶æ£€æµ‹é˜³æ€§æ¦‚ç‡ï¼‰<br>
                â€¢ P(B|Â¬A) = å‡é˜³æ€§ç‡ï¼ˆå¦‚5%ï¼Œå¥åº·æ—¶æ£€æµ‹é˜³æ€§æ¦‚ç‡ï¼‰<br>
                â€¢ P(A|B) = æ£€æµ‹é˜³æ€§æ—¶çœŸæ­£æ‚£ç—…çš„æ¦‚ç‡
            </div>
        </div>
    </div>
    
    <script>
        document.querySelectorAll('.tab').forEach(function(tab) {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(function(t) { t.classList.remove('active'); });
                tab.classList.add('active');
                
                var tabName = tab.dataset.tab;
                document.getElementById('permutationPanel').classList.toggle('hidden', tabName !== 'permutation');
                document.getElementById('binomialPanel').classList.toggle('hidden', tabName !== 'binomial');
                document.getElementById('conditionalPanel').classList.toggle('hidden', tabName !== 'conditional');
                document.getElementById('bayesPanel').classList.toggle('hidden', tabName !== 'bayes');
            });
        });
        
        function factorial(n) {
            if (n < 0) return NaN;
            if (n === 0 || n === 1) return 1;
            var result = 1;
            for (var i = 2; i <= n; i++) {
                result *= i;
            }
            return result;
        }
        
        function permutation(n, r) {
            if (r > n || r < 0 || n < 0) return 0;
            return factorial(n) / factorial(n - r);
        }
        
        function combination(n, r) {
            if (r > n || r < 0 || n < 0) return 0;
            return factorial(n) / (factorial(r) * factorial(n - r));
        }
        
        function binomialProb(n, k, p) {
            return combination(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);
        }
        
        function formatNum(n, digits) {
            if (isNaN(n) || !isFinite(n)) return '-';
            if (digits === undefined) digits = 4;
            if (n > 1e10) return n.toExponential(2);
            return n.toFixed(digits);
        }
        
        function calcPermutation() {
            var n = parseInt(document.getElementById('pn').value) || 0;
            var r = parseInt(document.getElementById('pr').value) || 0;
            
            document.getElementById('permResult').textContent = formatNum(permutation(n, r), 0);
            document.getElementById('combResult').textContent = formatNum(combination(n, r), 0);
            document.getElementById('factResult').textContent = formatNum(factorial(n), 0);
        }
        
        function calcBinomial() {
            var n = parseInt(document.getElementById('bn').value) || 0;
            var p = parseFloat(document.getElementById('bp').value) || 0;
            var k = parseInt(document.getElementById('bk').value) || 0;
            
            var exact = binomialProb(n, k, p);
            document.getElementById('binomialExact').textContent = formatNum(exact);
            
            var lte = 0;
            for (var i = 0; i <= k; i++) {
                lte += binomialProb(n, i, p);
            }
            document.getElementById('binomialLte').textContent = formatNum(lte);
            
            var gte = 0;
            for (var i = k; i <= n; i++) {
                gte += binomialProb(n, i, p);
            }
            document.getElementById('binomialGte').textContent = formatNum(gte);
            
            document.getElementById('binomialMean').textContent = formatNum(n * p);
            document.getElementById('binomialVar').textContent = formatNum(n * p * (1 - p));
        }
        
        function calcConditional() {
            var pa = parseFloat(document.getElementById('pa').value) || 0;
            var pb = parseFloat(document.getElementById('pb').value) || 0;
            var pab = parseFloat(document.getElementById('pab').value) || 0;
            
            var paGivenB = pb > 0 ? pab / pb : 0;
            var pbGivenA = pa > 0 ? pab / pa : 0;
            var paOrB = pa + pb - pab;
            var independence = pa * pb;
            
            document.getElementById('paGivenB').textContent = formatNum(paGivenB);
            document.getElementById('pbGivenA').textContent = formatNum(pbGivenA);
            document.getElementById('paOrB').textContent = formatNum(paOrB);
            document.getElementById('independence').textContent = formatNum(independence);
            
            var note = document.getElementById('independenceNote');
            if (Math.abs(pab - independence) < 0.0001) {
                note.textContent = 'äº‹ä»¶Aå’ŒBç›¸äº’ç‹¬ç«‹ï¼ˆP(Aâˆ©B) = P(A)Ã—P(B)ï¼‰';
                note.style.color = 'var(--success)';
            } else {
                note.textContent = 'äº‹ä»¶Aå’ŒBä¸ç‹¬ç«‹ï¼ˆP(Aâˆ©B) â‰  P(A)Ã—P(B)ï¼‰';
                note.style.color = 'var(--text2)';
            }
        }
        
        function calcBayes() {
            var pa = parseFloat(document.getElementById('bayesPa').value) || 0;
            var pna = 1 - pa;
            document.getElementById('bayesPna').value = formatNum(pna);
            
            var pba = parseFloat(document.getElementById('bayesPba').value) || 0;
            var pbna = parseFloat(document.getElementById('bayesPbna').value) || 0;
            
            var pb = pba * pa + pbna * pna;
            var paGivenB = pb > 0 ? (pba * pa) / pb : 0;
            var pnaGivenB = pb > 0 ? (pbna * pna) / pb : 0;
            
            document.getElementById('bayesResult').textContent = formatNum(paGivenB);
            document.getElementById('bayesPb').textContent = formatNum(pb);
            document.getElementById('bayesPnaGivenB').textContent = formatNum(pnaGivenB);
        }
        
        calcPermutation();
        calcBinomial();
        calcConditional();
        calcBayes();
    </script>
</body>
</html>
