<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«æ·ä¾¿ç­¾ - WebUtils</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root { --primary-color: #8b5cf6; --colors: #fef3c7,#dbeafe,#d1fae5,#fce7f3,#e0e7ff,#fecaca; }
        body { padding: 1rem; min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem; }
        header h1 { margin: 0; font-size: 1.75rem; }
        .header-actions { display: flex; gap: 0.5rem; }
        .theme-toggle { cursor: pointer; background: var(--primary-color); border: none; padding: 0.5rem 1rem; border-radius: 8px; color: white; }
        .notes-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; }
        .note-card { border-radius: 12px; padding: 1rem; min-height: 150px; position: relative; display: flex; flex-direction: column; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .note-card textarea { flex: 1; background: transparent; border: none; resize: none; font-size: 0.9rem; line-height: 1.6; outline: none; color: #333; }
        .note-card .meta { display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; font-size: 0.7rem; opacity: 0.6; }
        .note-card .actions { position: absolute; top: 0.5rem; right: 0.5rem; display: flex; gap: 0.25rem; opacity: 0; transition: opacity 0.2s; }
        .note-card:hover .actions { opacity: 1; }
        .note-card .actions button { background: rgba(0,0,0,0.1); border: none; cursor: pointer; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem; }
        .note-card .actions button:hover { background: rgba(0,0,0,0.2); }
        .add-note { border: 2px dashed var(--muted-border-color); background: transparent; display: flex; align-items: center; justify-content: center; cursor: pointer; min-height: 150px; border-radius: 12px; transition: all 0.3s; }
        .add-note:hover { border-color: var(--primary-color); background: rgba(139,92,246,0.05); }
        .color-picker { display: flex; gap: 0.25rem; margin-top: 0.5rem; }
        .color-picker span { width: 20px; height: 20px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; }
        .color-picker span:hover { transform: scale(1.2); }
        .color-picker span.active { border-color: #333; }
        .search-bar { margin-bottom: 1rem; }
        .stats { font-size: 0.85rem; color: var(--muted-color); margin-bottom: 1rem; }
        .toast { position: fixed; bottom: 20px; right: 20px; padding: 1rem 1.5rem; background: var(--primary-color); color: white; border-radius: 8px; z-index: 1000; }
        [data-theme="dark"] .note-card textarea { color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ å¿«æ·ä¾¿ç­¾</h1>
            <div class="header-actions">
                <button class="outline" onclick="exportNotes()">ğŸ“¥ å¯¼å‡º</button>
                <button class="outline" onclick="importNotes()">ğŸ“¤ å¯¼å…¥</button>
                <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </header>
        <div class="search-bar">
            <input type="search" id="searchInput" placeholder="ğŸ” æœç´¢ä¾¿ç­¾..." oninput="renderNotes()">
        </div>
        <div class="stats">ğŸ“Š å…± <strong id="noteCount">0</strong> ä¸ªä¾¿ç­¾</div>
        <div class="notes-grid" id="notesGrid"></div>
    </div>
    <input type="file" id="importInput" accept=".json" style="display:none" onchange="handleImport(event)">
    <script>
        const COLORS = ['#fef3c7','#dbeafe','#d1fae5','#fce7f3','#e0e7ff','#fecaca'];
        let notes = [];
        
        document.addEventListener('DOMContentLoaded', () => { initTheme(); loadNotes(); renderNotes(); });
        
        function initTheme() { const s = localStorage.getItem('theme'); if (s) document.documentElement.setAttribute('data-theme', s); }
        window.toggleTheme = function() { const c = document.documentElement.getAttribute('data-theme'); const n = c === 'dark' ? 'light' : 'dark'; document.documentElement.setAttribute('data-theme', n); localStorage.setItem('theme', n); };
        
        function loadNotes() { const s = localStorage.getItem('quickNotes'); if (s) try { notes = JSON.parse(s); } catch(e) { notes = []; } }
        function saveNotes() { localStorage.setItem('quickNotes', JSON.stringify(notes)); }
        
        window.addNote = function() {
            notes.unshift({ id: Date.now(), content: '', color: COLORS[Math.floor(Math.random() * COLORS.length)], created: Date.now(), updated: Date.now() });
            saveNotes();
            renderNotes();
        };
        
        window.updateNote = function(id, content) {
            const note = notes.find(n => n.id === id);
            if (note) { note.content = content; note.updated = Date.now(); saveNotes(); }
        };
        
        window.changeColor = function(id, color) {
            const note = notes.find(n => n.id === id);
            if (note) { note.color = color; saveNotes(); renderNotes(); }
        };
        
        window.deleteNote = function(id) {
            if (confirm('ç¡®å®šåˆ é™¤æ­¤ä¾¿ç­¾ï¼Ÿ')) { notes = notes.filter(n => n.id !== id); saveNotes(); renderNotes(); }
        };
        
        window.copyNote = function(id) {
            const note = notes.find(n => n.id === id);
            if (note) { navigator.clipboard.writeText(note.content); showToast('å·²å¤åˆ¶'); }
        };
        
        function renderNotes() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const filtered = notes.filter(n => n.content.toLowerCase().includes(search));
            document.getElementById('noteCount').textContent = notes.length;
            
            const grid = document.getElementById('notesGrid');
            grid.innerHTML = '<div class="add-note" onclick="addNote()"><span style="font-size:2rem">â•</span></div>' +
                filtered.map(note => {
                    const time = new Date(note.updated).toLocaleString();
                    const colorPicker = COLORS.map(c => '<span style="background:' + c + '" class="' + (c === note.color ? 'active' : '') + '" onclick="changeColor(' + note.id + ',\'' + c + '\')"></span>').join('');
                    return '<div class="note-card" style="background:' + note.color + '">' +
                        '<div class="actions">' +
                            '<button onclick="copyNote(' + note.id + ')">ğŸ“‹</button>' +
                            '<button onclick="deleteNote(' + note.id + ')">ğŸ—‘ï¸</button>' +
                        '</div>' +
                        '<textarea placeholder="å†™ç‚¹ä»€ä¹ˆ..." oninput="updateNote(' + note.id + ', this.value)">' + escapeHtml(note.content) + '</textarea>' +
                        '<div class="color-picker">' + colorPicker + '</div>' +
                        '<div class="meta"><span>' + time + '</span><span>' + note.content.length + ' å­—</span></div>' +
                    '</div>';
                }).join('');
        }
        
        window.exportNotes = function() { const b = new Blob([JSON.stringify(notes, null, 2)], {type: 'application/json'}); const a = document.createElement('a'); a.href = URL.createObjectURL(b); a.download = 'quick-notes.json'; a.click(); showToast('å·²å¯¼å‡º'); };
        window.importNotes = function() { document.getElementById('importInput').click(); };
        window.handleImport = function(e) {
            const f = e.target.files[0]; if (!f) return;
            const r = new FileReader();
            r.onload = ev => { try { const data = JSON.parse(ev.target.result); notes = [...data, ...notes]; saveNotes(); renderNotes(); showToast('å·²å¯¼å…¥ ' + data.length + ' ä¸ªä¾¿ç­¾'); } catch(err) { showToast('å¯¼å…¥å¤±è´¥'); } };
            r.readAsText(f);
            e.target.value = '';
        };
        
        window.escapeHtml = function(t) { return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); };
        function showToast(m) { const t = document.createElement('div'); t.className = 'toast'; t.textContent = m; document.body.appendChild(t); setTimeout(() => t.remove(), 2000); }
    </script>
</body>
</html>
