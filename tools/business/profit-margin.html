<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ©æ¶¦ç‡è®¡ç®—å™¨ - WebUtils</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #6366f1; --accent2: #8b5cf6; --green: #10b981; --red: #ef4444; --orange: #f59e0b; }
        @media (prefers-color-scheme: light) {
            :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #1a1a1a; --text2: #666; }
        }
        [data-theme="light"] { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #1a1a1a; --text2: #666; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 16px; }
        .card-title { font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus { outline: none; border-color: var(--accent); }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.2s; }
        .btn-primary { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; width: 100%; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4); }
        .result-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; }
        .result-item { background: var(--bg); border-radius: 12px; padding: 20px; text-align: center; }
        .result-icon { font-size: 2rem; margin-bottom: 8px; }
        .result-label { font-size: 0.85rem; color: var(--text2); margin-bottom: 8px; }
        .result-value { font-size: 1.8rem; font-weight: 700; }
        .result-value.green { color: var(--green); }
        .result-value.red { color: var(--red); }
        .result-value.orange { color: var(--orange); }
        .gauge-container { margin: 20px 0; text-align: center; }
        .gauge { width: 200px; height: 100px; margin: 0 auto; position: relative; overflow: hidden; }
        .gauge-bg { width: 200px; height: 100px; border-radius: 100px 100px 0 0; background: var(--border); position: absolute; }
        .gauge-fill { width: 200px; height: 100px; border-radius: 100px 100px 0 0; background: linear-gradient(90deg, var(--red), var(--orange), var(--green)); position: absolute; transform-origin: bottom center; transform: rotate(-90deg); transition: transform 0.5s; }
        .gauge-cover { width: 160px; height: 80px; border-radius: 80px 80px 0 0; background: var(--card); position: absolute; top: 20px; left: 20px; }
        .gauge-value { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); font-size: 1.5rem; font-weight: 700; }
        .formula-box { background: var(--bg); border-radius: 8px; padding: 16px; margin-top: 16px; }
        .formula-title { font-size: 0.9rem; color: var(--accent); margin-bottom: 8px; }
        .formula { font-family: monospace; color: var(--text2); line-height: 1.8; }
        .hidden { display: none; }
        .theme-toggle { position: fixed; top: 16px; right: 16px; background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; cursor: pointer; font-size: 1.2rem; z-index: 100; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">â† è¿”å›</a>
        <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
        <h1>ğŸ“Š åˆ©æ¶¦ç‡è®¡ç®—å™¨</h1>
        <p class="subtitle">è®¡ç®—æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡ç­‰å…³é”®ç›ˆåˆ©æŒ‡æ ‡</p>

        <div class="card">
            <div class="card-title">ğŸ’° æ”¶å…¥ä¿¡æ¯</div>
            <div class="grid">
                <div class="form-group">
                    <label>é”€å”®æ”¶å…¥ (å…ƒ)</label>
                    <input type="number" id="revenue" value="100000" min="0">
                </div>
                <div class="form-group">
                    <label>é”€å”®æˆæœ¬ (å…ƒ)</label>
                    <input type="number" id="cogs" value="60000" min="0">
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">ğŸ“‹ è¿è¥è´¹ç”¨</div>
            <div class="grid">
                <div class="form-group">
                    <label>ç®¡ç†è´¹ç”¨ (å…ƒ)</label>
                    <input type="number" id="adminExpense" value="10000" min="0">
                </div>
                <div class="form-group">
                    <label>é”€å”®è´¹ç”¨ (å…ƒ)</label>
                    <input type="number" id="salesExpense" value="8000" min="0">
                </div>
                <div class="form-group">
                    <label>è´¢åŠ¡è´¹ç”¨ (å…ƒ)</label>
                    <input type="number" id="financeExpense" value="2000" min="0">
                </div>
                <div class="form-group">
                    <label>ç¨è´¹ (å…ƒ)</label>
                    <input type="number" id="tax" value="5000" min="0">
                </div>
            </div>
            <button class="btn btn-primary" onclick="calculate()">è®¡ç®—åˆ©æ¶¦ç‡</button>
        </div>

        <div id="resultSection" class="hidden">
            <div class="card">
                <div class="card-title">ğŸ“ˆ åˆ©æ¶¦åˆ†æ</div>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="result-icon">ğŸ’µ</div>
                        <div class="result-label">æ¯›åˆ©æ¶¦</div>
                        <div class="result-value green" id="grossProfit"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-icon">ğŸ“Š</div>
                        <div class="result-label">æ¯›åˆ©ç‡</div>
                        <div class="result-value" id="grossMargin"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-icon">ğŸ’°</div>
                        <div class="result-label">è¥ä¸šåˆ©æ¶¦</div>
                        <div class="result-value" id="operatingProfit"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-icon">ğŸ“ˆ</div>
                        <div class="result-label">è¥ä¸šåˆ©æ¶¦ç‡</div>
                        <div class="result-value" id="operatingMargin"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-icon">ğŸ†</div>
                        <div class="result-label">å‡€åˆ©æ¶¦</div>
                        <div class="result-value" id="netProfit"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-icon">â­</div>
                        <div class="result-label">å‡€åˆ©ç‡</div>
                        <div class="result-value" id="netMargin"></div>
                    </div>
                </div>

                <div class="gauge-container">
                    <p style="color: var(--text2); margin-bottom: 10px;">å‡€åˆ©ç‡å¥åº·åº¦</p>
                    <div class="gauge">
                        <div class="gauge-bg"></div>
                        <div class="gauge-fill" id="gaugeFill"></div>
                        <div class="gauge-cover"></div>
                        <div class="gauge-value" id="gaugeValue"></div>
                    </div>
                </div>

                <div class="formula-box">
                    <div class="formula-title">è®¡ç®—å…¬å¼</div>
                    <div class="formula">
                        æ¯›åˆ©æ¶¦ = é”€å”®æ”¶å…¥ - é”€å”®æˆæœ¬<br>
                        æ¯›åˆ©ç‡ = æ¯›åˆ©æ¶¦ / é”€å”®æ”¶å…¥ Ã— 100%<br>
                        è¥ä¸šåˆ©æ¶¦ = æ¯›åˆ©æ¶¦ - ç®¡ç†è´¹ç”¨ - é”€å”®è´¹ç”¨ - è´¢åŠ¡è´¹ç”¨<br>
                        å‡€åˆ©æ¶¦ = è¥ä¸šåˆ©æ¶¦ - ç¨è´¹<br>
                        å‡€åˆ©ç‡ = å‡€åˆ©æ¶¦ / é”€å”®æ”¶å…¥ Ã— 100%
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleTheme() {
            var theme = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        }
        (function() {
            var saved = localStorage.getItem('theme');
            if (saved) {
                document.body.setAttribute('data-theme', saved);
            } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
                document.body.setAttribute('data-theme', 'light');
            }
        })();

        function formatMoney(num) {
            if (Math.abs(num) >= 10000) {
                return (num / 10000).toFixed(2) + 'ä¸‡';
            }
            return num.toFixed(2) + 'å…ƒ';
        }

        function getMarginColor(margin) {
            if (margin >= 20) return 'green';
            if (margin >= 10) return 'orange';
            return 'red';
        }

        function calculate() {
            var revenue = parseFloat(document.getElementById('revenue').value) || 0;
            var cogs = parseFloat(document.getElementById('cogs').value) || 0;
            var adminExpense = parseFloat(document.getElementById('adminExpense').value) || 0;
            var salesExpense = parseFloat(document.getElementById('salesExpense').value) || 0;
            var financeExpense = parseFloat(document.getElementById('financeExpense').value) || 0;
            var tax = parseFloat(document.getElementById('tax').value) || 0;

            var grossProfit = revenue - cogs;
            var grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
            var operatingExpenses = adminExpense + salesExpense + financeExpense;
            var operatingProfit = grossProfit - operatingExpenses;
            var operatingMargin = revenue > 0 ? (operatingProfit / revenue) * 100 : 0;
            var netProfit = operatingProfit - tax;
            var netMargin = revenue > 0 ? (netProfit / revenue) * 100 : 0;

            document.getElementById('resultSection').classList.remove('hidden');

            var grossProfitEl = document.getElementById('grossProfit');
            grossProfitEl.textContent = formatMoney(grossProfit);
            grossProfitEl.className = 'result-value ' + (grossProfit >= 0 ? 'green' : 'red');

            var grossMarginEl = document.getElementById('grossMargin');
            grossMarginEl.textContent = grossMargin.toFixed(2) + '%';
            grossMarginEl.className = 'result-value ' + getMarginColor(grossMargin);

            var operatingProfitEl = document.getElementById('operatingProfit');
            operatingProfitEl.textContent = formatMoney(operatingProfit);
            operatingProfitEl.className = 'result-value ' + (operatingProfit >= 0 ? 'green' : 'red');

            var operatingMarginEl = document.getElementById('operatingMargin');
            operatingMarginEl.textContent = operatingMargin.toFixed(2) + '%';
            operatingMarginEl.className = 'result-value ' + getMarginColor(operatingMargin);

            var netProfitEl = document.getElementById('netProfit');
            netProfitEl.textContent = formatMoney(netProfit);
            netProfitEl.className = 'result-value ' + (netProfit >= 0 ? 'green' : 'red');

            var netMarginEl = document.getElementById('netMargin');
            netMarginEl.textContent = netMargin.toFixed(2) + '%';
            netMarginEl.className = 'result-value ' + getMarginColor(netMargin);

            // æ›´æ–°ä»ªè¡¨ç›˜
            var gaugeRotation = Math.min(Math.max(netMargin, -10), 30) / 40 * 180 - 90;
            document.getElementById('gaugeFill').style.transform = 'rotate(' + gaugeRotation + 'deg)';
            document.getElementById('gaugeValue').textContent = netMargin.toFixed(1) + '%';
        }

        calculate();
    </script>
</body>
</html>
