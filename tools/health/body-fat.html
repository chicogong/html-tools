<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>体脂率计算器 - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #f59e0b; --accent2: #10b981; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); cursor: pointer; text-align: center; transition: all 0.2s; }
        .tab.active { background: var(--accent); border-color: var(--accent); color: white; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input, select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus, select:focus { outline: none; border-color: var(--accent); }
        .radio-group { display: flex; gap: 12px; }
        .radio-btn { flex: 1; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); cursor: pointer; text-align: center; transition: all 0.2s; }
        .radio-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
        .result-hero { background: linear-gradient(135deg, var(--accent), #d97706); padding: 32px; border-radius: 12px; text-align: center; color: white; margin-bottom: 20px; }
        .result-hero .label { opacity: 0.9; margin-bottom: 4px; }
        .result-hero .big { font-size: 3rem; font-weight: 700; }
        .result-hero .unit { font-size: 1.2rem; }
        .result-hero .category { margin-top: 12px; padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 20px; display: inline-block; }
        .result-row { display: flex; justify-content: space-between; padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; }
        .result-row .label { color: var(--text2); }
        .result-row .value { font-weight: 600; }
        .bar-chart { margin-top: 16px; }
        .bar-item { margin-bottom: 12px; }
        .bar-label { display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 4px; }
        .bar-track { height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; position: relative; }
        .bar-fill { height: 100%; border-radius: 4px; transition: width 0.3s; }
        .bar-marker { position: absolute; top: -4px; width: 4px; height: 16px; background: white; border-radius: 2px; transform: translateX(-50%); }
        .range-chart { position: relative; height: 40px; margin: 20px 0; border-radius: 8px; overflow: hidden; display: flex; }
        .range-segment { height: 100%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: white; font-weight: 500; }
        .range-marker { position: absolute; top: 0; bottom: 0; width: 3px; background: white; border: 2px solid var(--card); z-index: 10; }
        .range-labels { display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text2); margin-top: 4px; }
        .tips { margin-top: 16px; }
        .tip { padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; font-size: 0.9rem; }
        .tip-title { font-weight: 600; color: var(--accent); margin-bottom: 4px; }
        .note { margin-top: 16px; padding: 12px; background: var(--bg); border-radius: 8px; font-size: 0.85rem; color: var(--text2); }
    </style>
</head>
<body>
    <div class="container">
        <h1>体脂率计算器</h1>
        <p class="subtitle">评估身体脂肪含量，了解健康状况</p>
        
        <div class="tabs">
            <div class="tab active" data-method="navy" onclick="setMethod('navy')">海军公式</div>
            <div class="tab" data-method="bmi" onclick="setMethod('bmi')">BMI估算</div>
            <div class="tab" data-method="skinfold" onclick="setMethod('skinfold')">皮褶厚度</div>
        </div>
        
        <div class="grid">
            <div class="card">
                <div class="card-title">基本信息</div>
                <div class="form-group">
                    <label>性别</label>
                    <div class="radio-group">
                        <div class="radio-btn active" data-value="male" onclick="setGender('male')">男性</div>
                        <div class="radio-btn" data-value="female" onclick="setGender('female')">女性</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>年龄 (岁)</label>
                    <input type="number" id="age" value="25" min="10" max="100" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>身高 (cm)</label>
                    <input type="number" id="height" value="170" min="100" max="250" oninput="calculate()">
                </div>
                <div class="form-group">
                    <label>体重 (kg)</label>
                    <input type="number" id="weight" value="70" min="30" max="200" oninput="calculate()">
                </div>
                
                <div id="navyInputs">
                    <div class="form-group">
                        <label>腰围 (cm) - 肚脐位置</label>
                        <input type="number" id="waist" value="80" min="50" max="150" oninput="calculate()">
                    </div>
                    <div class="form-group">
                        <label>颈围 (cm)</label>
                        <input type="number" id="neck" value="38" min="20" max="60" oninput="calculate()">
                    </div>
                    <div class="form-group" id="hipGroup">
                        <label>臀围 (cm) - 仅女性</label>
                        <input type="number" id="hip" value="95" min="60" max="150" oninput="calculate()">
                    </div>
                </div>
                
                <div id="skinfoldInputs" style="display: none;">
                    <div class="form-group">
                        <label>三头肌皮褶 (mm)</label>
                        <input type="number" id="tricep" value="15" min="1" max="50" oninput="calculate()">
                    </div>
                    <div class="form-group">
                        <label>肩胛下皮褶 (mm)</label>
                        <input type="number" id="subscapular" value="12" min="1" max="50" oninput="calculate()">
                    </div>
                    <div class="form-group">
                        <label>髂骨上皮褶 (mm)</label>
                        <input type="number" id="suprailiac" value="18" min="1" max="50" oninput="calculate()">
                    </div>
                </div>
            </div>
            
            <div>
                <div class="result-hero">
                    <div class="label">体脂率</div>
                    <div class="big"><span id="bodyFat">0</span><span class="unit">%</span></div>
                    <div class="category" id="category">-</div>
                </div>
                
                <div class="card">
                    <div class="card-title">体脂率范围</div>
                    <div class="range-chart" id="rangeChart"></div>
                    <div class="range-labels" id="rangeLabels"></div>
                </div>
                
                <div class="card">
                    <div class="card-title">身体成分分析</div>
                    <div class="result-row">
                        <span class="label">脂肪重量</span>
                        <span class="value" id="fatMass">0 kg</span>
                    </div>
                    <div class="result-row">
                        <span class="label">去脂体重</span>
                        <span class="value" id="leanMass">0 kg</span>
                    </div>
                    <div class="result-row">
                        <span class="label">BMI</span>
                        <span class="value" id="bmi">0</span>
                    </div>
                    <div class="result-row">
                        <span class="label">理想体脂率</span>
                        <span class="value" id="idealFat">-</span>
                    </div>
                    <div class="result-row">
                        <span class="label">目标体重（理想体脂）</span>
                        <span class="value" id="targetWeight">-</span>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">健康建议</div>
                    <div class="tips" id="tips"></div>
                </div>
            </div>
        </div>
        
        <div class="note">
            体脂率计算结果仅供参考，不同计算方法可能有差异。精确测量建议使用专业设备（如DEXA扫描）。
        </div>
    </div>
    
    <script>
        let gender = 'male';
        let method = 'navy';
        
        const maleRanges = [
            { min: 0, max: 6, label: '必需脂肪', color: '#ef4444' },
            { min: 6, max: 14, label: '运动员', color: '#10b981' },
            { min: 14, max: 18, label: '健康', color: '#22c55e' },
            { min: 18, max: 25, label: '一般', color: '#f59e0b' },
            { min: 25, max: 40, label: '肥胖', color: '#ef4444' }
        ];
        
        const femaleRanges = [
            { min: 0, max: 14, label: '必需脂肪', color: '#ef4444' },
            { min: 14, max: 21, label: '运动员', color: '#10b981' },
            { min: 21, max: 25, label: '健康', color: '#22c55e' },
            { min: 25, max: 32, label: '一般', color: '#f59e0b' },
            { min: 32, max: 45, label: '肥胖', color: '#ef4444' }
        ];
        
        function setGender(g) {
            gender = g;
            document.querySelectorAll('.radio-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.value === g);
            });
            document.getElementById('hipGroup').style.display = g === 'female' ? 'block' : 'none';
            calculate();
        }
        
        function setMethod(m) {
            method = m;
            document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.dataset.method === m));
            document.getElementById('navyInputs').style.display = m === 'navy' ? 'block' : 'none';
            document.getElementById('skinfoldInputs').style.display = m === 'skinfold' ? 'block' : 'none';
            calculate();
        }
        
        function calculate() {
            const age = parseFloat(document.getElementById('age').value) || 25;
            const height = parseFloat(document.getElementById('height').value) || 170;
            const weight = parseFloat(document.getElementById('weight').value) || 70;
            const waist = parseFloat(document.getElementById('waist').value) || 80;
            const neck = parseFloat(document.getElementById('neck').value) || 38;
            const hip = parseFloat(document.getElementById('hip').value) || 95;
            
            let bodyFat = 0;
            const bmi = weight / Math.pow(height / 100, 2);
            
            if (method === 'navy') {
                // 美国海军公式
                if (gender === 'male') {
                    bodyFat = 495 / (1.0324 - 0.19077 * Math.log10(waist - neck) + 0.15456 * Math.log10(height)) - 450;
                } else {
                    bodyFat = 495 / (1.29579 - 0.35004 * Math.log10(waist + hip - neck) + 0.22100 * Math.log10(height)) - 450;
                }
            } else if (method === 'bmi') {
                // BMI估算法
                if (gender === 'male') {
                    bodyFat = 1.20 * bmi + 0.23 * age - 16.2;
                } else {
                    bodyFat = 1.20 * bmi + 0.23 * age - 5.4;
                }
            } else if (method === 'skinfold') {
                // 皮褶厚度法 (Jackson-Pollock)
                const tricep = parseFloat(document.getElementById('tricep').value) || 15;
                const subscapular = parseFloat(document.getElementById('subscapular').value) || 12;
                const suprailiac = parseFloat(document.getElementById('suprailiac').value) || 18;
                const sum = tricep + subscapular + suprailiac;
                
                if (gender === 'male') {
                    const density = 1.10938 - 0.0008267 * sum + 0.0000016 * sum * sum - 0.0002574 * age;
                    bodyFat = (495 / density) - 450;
                } else {
                    const density = 1.0994921 - 0.0009929 * sum + 0.0000023 * sum * sum - 0.0001392 * age;
                    bodyFat = (495 / density) - 450;
                }
            }
            
            bodyFat = Math.max(3, Math.min(50, bodyFat));
            
            const fatMass = weight * bodyFat / 100;
            const leanMass = weight - fatMass;
            
            // 理想体脂率
            const idealFatRange = gender === 'male' ? '10-20%' : '18-28%';
            const idealFat = gender === 'male' ? 15 : 23;
            const targetWeight = leanMass / (1 - idealFat / 100);
            
            document.getElementById('bodyFat').textContent = bodyFat.toFixed(1);
            document.getElementById('fatMass').textContent = fatMass.toFixed(1) + ' kg';
            document.getElementById('leanMass').textContent = leanMass.toFixed(1) + ' kg';
            document.getElementById('bmi').textContent = bmi.toFixed(1);
            document.getElementById('idealFat').textContent = idealFatRange;
            document.getElementById('targetWeight').textContent = targetWeight.toFixed(1) + ' kg';
            
            // 分类
            const ranges = gender === 'male' ? maleRanges : femaleRanges;
            let category = '未知';
            for (const range of ranges) {
                if (bodyFat >= range.min && bodyFat < range.max) {
                    category = range.label;
                    break;
                }
            }
            document.getElementById('category').textContent = category;
            
            // 渲染范围图
            renderRangeChart(bodyFat, ranges);
            
            // 健康建议
            renderTips(bodyFat, category);
        }
        
        function renderRangeChart(bodyFat, ranges) {
            const chart = document.getElementById('rangeChart');
            const labels = document.getElementById('rangeLabels');
            chart.textContent = '';
            labels.textContent = '';
            
            const maxVal = ranges[ranges.length - 1].max;
            
            ranges.forEach(range => {
                const width = ((range.max - range.min) / maxVal) * 100;
                const segment = document.createElement('div');
                segment.className = 'range-segment';
                segment.style.width = width + '%';
                segment.style.background = range.color;
                segment.textContent = range.label;
                chart.appendChild(segment);
            });
            
            // 标记当前位置
            const markerPos = Math.min(100, (bodyFat / maxVal) * 100);
            const marker = document.createElement('div');
            marker.className = 'range-marker';
            marker.style.left = markerPos + '%';
            chart.appendChild(marker);
            
            // 标签
            ranges.forEach(range => {
                const label = document.createElement('span');
                label.textContent = range.min + '%';
                labels.appendChild(label);
            });
            const lastLabel = document.createElement('span');
            lastLabel.textContent = ranges[ranges.length - 1].max + '%';
            labels.appendChild(lastLabel);
        }
        
        function renderTips(bodyFat, category) {
            const container = document.getElementById('tips');
            container.textContent = '';
            
            const tips = [];
            
            if (category === '肥胖') {
                tips.push({ title: '饮食调整', text: '控制热量摄入，减少精制碳水和加工食品，增加蛋白质和蔬菜摄入' });
                tips.push({ title: '运动建议', text: '每周进行150分钟以上中等强度有氧运动，配合力量训练' });
                tips.push({ title: '生活习惯', text: '保证充足睡眠，减少压力，避免久坐' });
            } else if (category === '一般') {
                tips.push({ title: '优化饮食', text: '适当减少热量摄入，保持营养均衡，多吃全谷物和蔬菜' });
                tips.push({ title: '增加运动', text: '每周3-5次运动，结合有氧和力量训练' });
            } else if (category === '健康' || category === '运动员') {
                tips.push({ title: '保持现状', text: '您的体脂率处于健康范围，继续保持良好的运动和饮食习惯' });
                tips.push({ title: '定期监测', text: '每月测量一次，关注体脂变化趋势' });
            } else if (category === '必需脂肪') {
                tips.push({ title: '注意健康', text: '体脂率过低可能影响激素水平和免疫功能，建议咨询医生' });
                tips.push({ title: '适当增脂', text: '如非专业运动员，建议适当增加健康脂肪摄入' });
            }
            
            tips.forEach(tip => {
                const div = document.createElement('div');
                div.className = 'tip';
                
                const title = document.createElement('div');
                title.className = 'tip-title';
                title.textContent = tip.title;
                
                const text = document.createElement('div');
                text.textContent = tip.text;
                
                div.appendChild(title);
                div.appendChild(text);
                container.appendChild(div);
            });
        }
        
        calculate();
    </script>
</body>
</html>
