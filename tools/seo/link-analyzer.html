<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é“¾æ¥åˆ†æå™¨ - WebUtils</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --primary-color: #667eea;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        .theme-toggle {
            background: none;
            border: 2px solid var(--pico-primary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        textarea {
            min-height: 200px;
            font-family: monospace;
        }
        .input-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: flex-end;
        }
        .input-row .field {
            flex: 1;
        }
        .input-row label {
            display: block;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .stat-card {
            background: var(--pico-card-background-color);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--pico-muted-border-color);
        }
        .stat-card h3 {
            margin: 0;
            font-size: 1.5rem;
            color: var(--pico-primary);
        }
        .stat-card p {
            margin: 0.5rem 0 0;
            font-size: 0.8rem;
            color: var(--pico-muted-color);
        }
        .stat-card.internal h3 { color: #3b82f6; }
        .stat-card.external h3 { color: #8b5cf6; }
        .stat-card.nofollow h3 { color: #f59e0b; }
        .stat-card.broken h3 { color: #ef4444; }
        
        .link-section {
            margin-bottom: 2rem;
        }
        .link-section h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .link-table {
            width: 100%;
            font-size: 0.9rem;
        }
        .link-table th {
            text-align: left;
            padding: 0.75rem;
            background: var(--pico-muted-border-color);
        }
        .link-table td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--pico-muted-border-color);
            word-break: break-all;
        }
        .link-table tr:hover td {
            background: var(--pico-card-background-color);
        }
        
        .anchor-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--pico-card-background-color);
            border-radius: 8px;
            border: 1px solid var(--pico-muted-border-color);
        }
        .anchor-tag {
            padding: 0.35rem 0.75rem;
            background: var(--pico-muted-border-color);
            border-radius: 20px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }
        .anchor-count {
            background: var(--pico-primary);
            color: white;
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            font-size: 0.75rem;
        }
        
        .badge {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        .badge-internal { background: #dbeafe; color: #1d4ed8; }
        .badge-external { background: #ede9fe; color: #6d28d9; }
        .badge-nofollow { background: #fef3c7; color: #92400e; }
        .badge-blank { background: #f3f4f6; color: #4b5563; }
        [data-theme="dark"] .badge-internal { background: #1e3a5f; color: #93c5fd; }
        [data-theme="dark"] .badge-external { background: #2e1065; color: #c4b5fd; }
        [data-theme="dark"] .badge-nofollow { background: #422006; color: #fcd34d; }
        [data-theme="dark"] .badge-blank { background: #374151; color: #d1d5db; }
        
        .tips {
            background: var(--pico-card-background-color);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            border-left: 4px solid var(--pico-primary);
        }
        .tips h4 {
            margin-top: 0;
        }
        .tips ul {
            margin-bottom: 0;
        }
        
        .ratio-bar {
            display: flex;
            height: 24px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        .ratio-internal {
            background: #3b82f6;
        }
        .ratio-external {
            background: #8b5cf6;
        }
        .ratio-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--pico-muted-color);
        }
        
        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .filter-tabs button {
            padding: 0.5rem 1rem;
            border: 1px solid var(--pico-muted-border-color);
            background: var(--pico-card-background-color);
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        .filter-tabs button.active {
            background: var(--pico-primary);
            color: white;
            border-color: var(--pico-primary);
        }
        
        .empty-message {
            padding: 2rem;
            text-align: center;
            color: var(--pico-muted-color);
        }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#seo">SEO å·¥å…·</a><span>â€º</span>é“¾æ¥åˆ†æå™¨</nav>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ğŸ”— é“¾æ¥åˆ†æå™¨</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
                <span id="theme-icon">ğŸŒ™</span>
            </button>
        </header>

        <article>
            <h3>è¾“å…¥HTMLä»£ç </h3>
            <div class="input-row">
                <div class="field">
                    <label for="baseUrl">å½“å‰é¡µé¢URLï¼ˆç”¨äºåˆ¤æ–­å†…é“¾/å¤–é“¾ï¼‰</label>
                    <input type="text" id="baseUrl" placeholder="https://example.com">
                </div>
            </div>
            <textarea id="htmlInput" placeholder="åœ¨æ­¤ç²˜è´´åŒ…å«é“¾æ¥çš„HTMLä»£ç ...

ç¤ºä¾‹ï¼š
<a href='/about'>å…³äºæˆ‘ä»¬</a>
<a href='https://example.com/product'>äº§å“é¡µé¢</a>
<a href='https://other-site.com' target='_blank' rel='nofollow'>å¤–éƒ¨é“¾æ¥</a>
<a href='#section'>é¡µé¢é”šç‚¹</a>"></textarea>
            <button onclick="analyzeLinks()">åˆ†æé“¾æ¥</button>
        </article>

        <div id="results" style="display: none;">
            <h3>ğŸ“Š ç»Ÿè®¡æ¦‚è§ˆ</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalLinks">0</h3>
                    <p>æ€»é“¾æ¥æ•°</p>
                </div>
                <div class="stat-card internal">
                    <h3 id="internalLinks">0</h3>
                    <p>å†…éƒ¨é“¾æ¥</p>
                </div>
                <div class="stat-card external">
                    <h3 id="externalLinks">0</h3>
                    <p>å¤–éƒ¨é“¾æ¥</p>
                </div>
                <div class="stat-card nofollow">
                    <h3 id="nofollowLinks">0</h3>
                    <p>Nofollow</p>
                </div>
                <div class="stat-card">
                    <h3 id="uniqueDomains">0</h3>
                    <p>ç‹¬ç«‹åŸŸå</p>
                </div>
            </div>

            <h4>ğŸ“ˆ å†…å¤–é“¾æ¯”ä¾‹</h4>
            <article>
                <div class="ratio-bar">
                    <div class="ratio-internal" id="internalBar" style="width: 50%;"></div>
                    <div class="ratio-external" id="externalBar" style="width: 50%;"></div>
                </div>
                <div class="ratio-labels">
                    <span>å†…é“¾: <span id="internalPercent">50%</span></span>
                    <span>å¤–é“¾: <span id="externalPercent">50%</span></span>
                </div>
            </article>

            <div class="link-section">
                <h4>ğŸ·ï¸ é”šæ–‡æœ¬ç»Ÿè®¡</h4>
                <div class="anchor-cloud" id="anchorCloud">
                    <span class="empty-message">æš‚æ— æ•°æ®</span>
                </div>
            </div>

            <div class="link-section">
                <h4>ğŸ“‹ é“¾æ¥è¯¦æƒ…</h4>
                <div class="filter-tabs">
                    <button class="active" onclick="filterLinks('all')">å…¨éƒ¨</button>
                    <button onclick="filterLinks('internal')">å†…é“¾</button>
                    <button onclick="filterLinks('external')">å¤–é“¾</button>
                    <button onclick="filterLinks('nofollow')">Nofollow</button>
                </div>
                <div style="overflow-x: auto;">
                    <table class="link-table">
                        <thead>
                            <tr>
                                <th style="width: 40%;">é“¾æ¥åœ°å€</th>
                                <th style="width: 30%;">é”šæ–‡æœ¬</th>
                                <th style="width: 30%;">å±æ€§</th>
                            </tr>
                        </thead>
                        <tbody id="linkTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tips">
                <h4>ğŸ’¡ SEOå»ºè®®</h4>
                <ul>
                    <li><strong>å†…å¤–é“¾æ¯”ä¾‹ï¼š</strong>å»ºè®®å†…é“¾æ•°é‡å¤šäºå¤–é“¾ï¼Œåˆç†æ¯”ä¾‹ä¸º3:1åˆ°5:1</li>
                    <li><strong>é”šæ–‡æœ¬ï¼š</strong>ä½¿ç”¨æè¿°æ€§çš„é”šæ–‡æœ¬ï¼Œé¿å…"ç‚¹å‡»è¿™é‡Œ"ç­‰æ— æ„ä¹‰æ–‡å­—</li>
                    <li><strong>Nofollowï¼š</strong>å¹¿å‘Šé“¾æ¥ã€ç”¨æˆ·ç”Ÿæˆå†…å®¹ä¸­çš„é“¾æ¥åº”æ·»åŠ nofollow</li>
                    <li><strong>æ–°çª—å£ï¼š</strong>å¤–éƒ¨é“¾æ¥å»ºè®®ä½¿ç”¨target="_blank"å¹¶æ·»åŠ rel="noopener"</li>
                    <li><strong>é“¾æ¥æ·±åº¦ï¼š</strong>é‡è¦é¡µé¢åº”è¯¥åœ¨ç½‘ç«™é¦–é¡µ3æ¬¡ç‚¹å‡»å†…å¯è¾¾</li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        // ä¸»é¢˜åˆ‡æ¢
        window.toggleTheme = function() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', newTheme);
        };

        // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        })();

        let allLinks = [];
        let currentFilter = 'all';

        function getDomain(url) {
            try {
                if (url.startsWith('//')) {
                    url = 'https:' + url;
                }
                const urlObj = new URL(url, 'https://example.com');
                return urlObj.hostname;
            } catch (e) {
                return null;
            }
        }

        function isInternalLink(href, baseUrl) {
            if (!href) return false;
            
            // é”šç‚¹é“¾æ¥
            if (href.startsWith('#')) return true;
            
            // ç›¸å¯¹è·¯å¾„
            if (href.startsWith('/') && !href.startsWith('//')) return true;
            if (!href.includes('://') && !href.startsWith('//')) return true;
            
            // ç»å¯¹è·¯å¾„ï¼Œæ¯”è¾ƒåŸŸå
            if (baseUrl) {
                const baseDomain = getDomain(baseUrl);
                const linkDomain = getDomain(href);
                if (baseDomain && linkDomain) {
                    return baseDomain === linkDomain || linkDomain.endsWith('.' + baseDomain);
                }
            }
            
            return false;
        }

        window.filterLinks = function(filter) {
            currentFilter = filter;
            
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.filter-tabs button').forEach(function(btn) {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderLinkTable();
        };

        function createLinkRow(link) {
            const row = document.createElement('tr');
            row.setAttribute('data-type', link.type);
            
            const hrefCell = document.createElement('td');
            hrefCell.textContent = link.href || '(ç©ºé“¾æ¥)';
            
            const anchorCell = document.createElement('td');
            anchorCell.textContent = link.anchor || '(æ— é”šæ–‡æœ¬)';
            
            const attrCell = document.createElement('td');
            
            // ç±»å‹å¾½ç« 
            const typeBadge = document.createElement('span');
            typeBadge.className = 'badge badge-' + link.type;
            typeBadge.textContent = link.type === 'internal' ? 'å†…é“¾' : 'å¤–é“¾';
            attrCell.appendChild(typeBadge);
            
            // nofollowå¾½ç« 
            if (link.nofollow) {
                const nfBadge = document.createElement('span');
                nfBadge.className = 'badge badge-nofollow';
                nfBadge.textContent = 'nofollow';
                nfBadge.style.marginLeft = '0.25rem';
                attrCell.appendChild(nfBadge);
            }
            
            // target="_blank"å¾½ç« 
            if (link.blank) {
                const blankBadge = document.createElement('span');
                blankBadge.className = 'badge badge-blank';
                blankBadge.textContent = '_blank';
                blankBadge.style.marginLeft = '0.25rem';
                attrCell.appendChild(blankBadge);
            }
            
            row.appendChild(hrefCell);
            row.appendChild(anchorCell);
            row.appendChild(attrCell);
            
            return row;
        }

        function renderLinkTable() {
            const tbody = document.getElementById('linkTableBody');
            tbody.textContent = '';
            
            let filtered = allLinks;
            if (currentFilter === 'internal') {
                filtered = allLinks.filter(function(l) { return l.type === 'internal'; });
            } else if (currentFilter === 'external') {
                filtered = allLinks.filter(function(l) { return l.type === 'external'; });
            } else if (currentFilter === 'nofollow') {
                filtered = allLinks.filter(function(l) { return l.nofollow; });
            }
            
            if (filtered.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.colSpan = 3;
                cell.style.textAlign = 'center';
                cell.style.color = 'var(--pico-muted-color)';
                cell.textContent = 'æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„é“¾æ¥';
                row.appendChild(cell);
                tbody.appendChild(row);
                return;
            }
            
            filtered.forEach(function(link) {
                tbody.appendChild(createLinkRow(link));
            });
        }

        function renderAnchorCloud(anchors) {
            const cloud = document.getElementById('anchorCloud');
            cloud.textContent = '';
            
            // è½¬æ¢ä¸ºæ•°ç»„å¹¶æ’åº
            const sortedAnchors = Object.entries(anchors)
                .filter(function(a) { return a[0].trim(); })
                .sort(function(a, b) { return b[1] - a[1]; })
                .slice(0, 20);
            
            if (sortedAnchors.length === 0) {
                const msg = document.createElement('span');
                msg.className = 'empty-message';
                msg.textContent = 'æ²¡æœ‰å‘ç°æœ‰æ•ˆçš„é”šæ–‡æœ¬';
                cloud.appendChild(msg);
                return;
            }
            
            sortedAnchors.forEach(function(item) {
                var anchor = item[0];
                var count = item[1];
                const tag = document.createElement('span');
                tag.className = 'anchor-tag';
                
                const text = document.createElement('span');
                text.textContent = anchor;
                
                const countBadge = document.createElement('span');
                countBadge.className = 'anchor-count';
                countBadge.textContent = count;
                
                tag.appendChild(text);
                tag.appendChild(countBadge);
                cloud.appendChild(tag);
            });
        }

        window.analyzeLinks = function() {
            const html = document.getElementById('htmlInput').value;
            const baseUrl = document.getElementById('baseUrl').value.trim();
            
            if (!html.trim()) {
                alert('è¯·è¾“å…¥HTMLä»£ç ');
                return;
            }

            // è§£æé“¾æ¥æ ‡ç­¾
            const linkRegex = /<a\s+([^>]*)>([\s\S]*?)<\/a>/gi;
            allLinks = [];
            const anchors = {};
            const domains = new Set();
            let match;
            
            while ((match = linkRegex.exec(html)) !== null) {
                const attrs = match[1];
                const anchorText = match[2].replace(/<[^>]+>/g, '').trim();
                
                // æå–å±æ€§
                const hrefMatch = attrs.match(/href\s*=\s*["']([^"']*)["']/i);
                const relMatch = attrs.match(/rel\s*=\s*["']([^"']*)["']/i);
                const targetMatch = attrs.match(/target\s*=\s*["']([^"']*)["']/i);
                
                const href = hrefMatch ? hrefMatch[1] : '';
                const rel = relMatch ? relMatch[1].toLowerCase() : '';
                const target = targetMatch ? targetMatch[1] : '';
                
                const isInternal = isInternalLink(href, baseUrl);
                
                const link = {
                    href: href,
                    anchor: anchorText,
                    type: isInternal ? 'internal' : 'external',
                    nofollow: rel.includes('nofollow'),
                    blank: target === '_blank'
                };
                
                allLinks.push(link);
                
                // ç»Ÿè®¡é”šæ–‡æœ¬
                if (anchorText) {
                    anchors[anchorText] = (anchors[anchorText] || 0) + 1;
                }
                
                // ç»Ÿè®¡å¤–éƒ¨åŸŸå
                if (!isInternal && href) {
                    const domain = getDomain(href);
                    if (domain) domains.add(domain);
                }
            }

            // ç»Ÿè®¡
            const total = allLinks.length;
            const internal = allLinks.filter(function(l) { return l.type === 'internal'; }).length;
            const external = allLinks.filter(function(l) { return l.type === 'external'; }).length;
            const nofollow = allLinks.filter(function(l) { return l.nofollow; }).length;

            // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
            document.getElementById('totalLinks').textContent = total;
            document.getElementById('internalLinks').textContent = internal;
            document.getElementById('externalLinks').textContent = external;
            document.getElementById('nofollowLinks').textContent = nofollow;
            document.getElementById('uniqueDomains').textContent = domains.size;

            // æ›´æ–°æ¯”ä¾‹æ¡
            if (total > 0) {
                const internalPercent = Math.round((internal / total) * 100);
                const externalPercent = 100 - internalPercent;
                document.getElementById('internalBar').style.width = internalPercent + '%';
                document.getElementById('externalBar').style.width = externalPercent + '%';
                document.getElementById('internalPercent').textContent = internalPercent + '%';
                document.getElementById('externalPercent').textContent = externalPercent + '%';
            } else {
                document.getElementById('internalBar').style.width = '50%';
                document.getElementById('externalBar').style.width = '50%';
                document.getElementById('internalPercent').textContent = '0%';
                document.getElementById('externalPercent').textContent = '0%';
            }

            // æ¸²æŸ“é”šæ–‡æœ¬äº‘
            renderAnchorCloud(anchors);

            // æ¸²æŸ“é“¾æ¥è¡¨æ ¼
            currentFilter = 'all';
            document.querySelectorAll('.filter-tabs button').forEach(function(btn, index) {
                btn.classList.toggle('active', index === 0);
            });
            renderLinkTable();

            document.getElementById('results').style.display = 'block';
        };
    </script>
</body>
</html>
