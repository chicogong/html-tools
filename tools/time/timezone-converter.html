<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Êó∂Âå∫ËΩ¨Êç¢Âô® - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="Âú®‰∏çÂêåÊó∂Âå∫‰πãÈó¥ËΩ¨Êç¢Êó∂Èó¥" />
    <meta name="keywords" content="Êó∂Âå∫ timezone ËΩ¨Êç¢ ‰∏ñÁïåÊó∂Èó¥" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link
      rel="canonical"
      href="https://tools.realtime-ai.chat/tools/time/timezone-converter.html"
    />

    <!-- Open Graph -->
    <meta property="og:title" content="Êó∂Âå∫ËΩ¨Êç¢Âô® - WebUtils" />
    <meta property="og:description" content="Âú®‰∏çÂêåÊó∂Âå∫‰πãÈó¥ËΩ¨Êç¢Êó∂Èó¥" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://tools.realtime-ai.chat/tools/time/timezone-converter.html"
    />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Êó∂Âå∫ËΩ¨Êç¢Âô® - WebUtils" />
    <meta name="twitter:description" content="Âú®‰∏çÂêåÊó∂Âå∫‰πãÈó¥ËΩ¨Êç¢Êó∂Èó¥" />
    <!-- OG Image -->
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme='light'] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      :root {
        --bg-primary: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        --bg-card: rgb(255, 255, 255, 0.05);
        --bg-input: rgb(0, 0, 0, 0.3);
        --bg-current: rgb(52, 152, 219, 0.1);
        --text-primary: #e8e8e8;
        --text-muted: #888;
        --text-muted-secondary: #666;
        --border-color: rgb(255, 255, 255, 0.1);
        --border-current: rgb(52, 152, 219, 0.3);
        --accent-blue: #3498db;
        --accent-purple: #9b59b6;
      }
      [data-theme='light'] {
        --bg-primary: linear-gradient(135deg, #f5f7fa 0%, #e4e9f2 100%);
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-current: rgb(52, 152, 219, 0.1);
        --text-primary: #212529;
        --text-muted: #6c757d;
        --text-muted-secondary: #999;
        --border-color: #dee2e6;
        --border-current: rgb(52, 152, 219, 0.3);
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: var(--bg-primary);
        min-height: 100vh;
        color: var(--text-primary);
        padding: 20px;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
      }

      .theme-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--border-color);
        background: var(--bg-card);
        cursor: pointer;
        font-size: 1.2rem;
        z-index: 100;
        transition: all 0.2s;
      }
      .theme-toggle:hover {
        transform: scale(1.1);
      }

      header {
        text-align: center;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 2rem;
        margin-bottom: 10px;
        background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        color: var(--text-muted);
        font-size: 0.95rem;
      }

      .current-time {
        background: var(--bg-current);
        border: 1px solid var(--border-current);
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
      }

      .current-time-label {
        font-size: 0.9rem;
        color: var(--text-muted);
        margin-bottom: 5px;
      }

      .current-time-value {
        font-size: 2rem;
        font-weight: 300;
        color: var(--accent-blue);
        font-family: Monaco, monospace;
      }

      .input-section {
        background: var(--bg-card);
        border-radius: 12px;
        padding: 20px;
        border: 1px solid var(--border-color);
        margin-bottom: 20px;
      }

      .input-row {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        align-items: flex-end;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        flex: 1;
        min-width: 200px;
      }

      .input-group label {
        font-size: 0.85rem;
        color: var(--text-muted);
      }

      input[type='datetime-local'],
      select {
        background: var(--bg-input);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 12px 15px;
        color: var(--text-primary);
        font-size: 1rem;
        width: 100%;
      }

      input[type='datetime-local']:focus,
      select:focus {
        outline: none;
        border-color: var(--accent-blue);
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s ease;
        white-space: nowrap;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--accent-blue), #2980b9);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgb(52, 152, 219, 0.4);
      }

      .btn-secondary {
        background: var(--bg-card);
        color: var(--text-primary);
        border: 1px solid var(--border-color);
      }

      .timezone-list {
        background: var(--bg-card);
        border-radius: 12px;
        padding: 20px;
        border: 1px solid var(--border-color);
      }

      .timezone-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .timezone-title {
        font-size: 1.1rem;
        color: var(--accent-purple);
      }

      .timezone-grid {
        display: grid;
        gap: 12px;
      }

      .timezone-card {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--bg-input);
        border-radius: 10px;
        padding: 15px 20px;
        transition: all 0.2s ease;
        border: 1px solid transparent;
      }

      .timezone-card:hover {
        border-color: rgb(155, 89, 182, 0.3);
        background: rgb(155, 89, 182, 0.1);
      }

      .timezone-card.highlight {
        border-color: rgb(52, 152, 219, 0.5);
        background: rgb(52, 152, 219, 0.1);
      }

      .tz-info {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .tz-name {
        font-weight: 600;
        font-size: 1rem;
      }

      .tz-offset {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .tz-time {
        text-align: right;
      }

      .tz-time-value {
        font-size: 1.3rem;
        font-weight: 300;
        font-family: Monaco, monospace;
        color: var(--accent-blue);
      }

      .tz-date {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .tz-day-diff {
        font-size: 0.75rem;
        padding: 2px 8px;
        border-radius: 10px;
        margin-left: 8px;
      }

      .tz-day-diff.same {
        background: rgb(46, 204, 113, 0.2);
        color: #2ecc71;
      }

      .tz-day-diff.prev {
        background: rgb(231, 76, 60, 0.2);
        color: #e74c3c;
      }

      .tz-day-diff.next {
        background: rgb(52, 152, 219, 0.2);
        color: var(--accent-blue);
      }

      .remove-btn {
        background: none;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        font-size: 1.2rem;
        padding: 5px;
        opacity: 0;
        transition: opacity 0.2s;
      }

      .timezone-card:hover .remove-btn {
        opacity: 1;
      }

      .remove-btn:hover {
        color: #e74c3c;
      }

      .add-timezone {
        margin-top: 15px;
        display: flex;
        gap: 10px;
      }

      .add-timezone select {
        flex: 1;
      }

      .quick-zones {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 15px;
      }

      .quick-zone {
        padding: 6px 12px;
        background: rgb(155, 89, 182, 0.2);
        border: 1px solid rgb(155, 89, 182, 0.3);
        border-radius: 20px;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .quick-zone:hover {
        background: rgb(155, 89, 182, 0.3);
      }

      footer {
        text-align: center;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid var(--border-color);
        color: var(--text-muted-secondary);
        font-size: 0.85rem;
      }

      footer a {
        color: var(--accent-blue);
        text-decoration: none;
      }

      footer a:hover {
        text-decoration: underline;
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">È¶ñÈ°µ</a>
      <span>‚Ä∫</span>
      Êó∂Âå∫ËΩ¨Êç¢Âô®
    </nav>
    <div class="container">
      <button class="theme-toggle" onclick="toggleTheme()" title="ÂàáÊç¢‰∏ªÈ¢ò">üåô</button>
      <header>
        <h1>Êó∂Âå∫ËΩ¨Êç¢Âô®</h1>
        <p class="subtitle">Âú®‰∏çÂêåÊó∂Âå∫‰πãÈó¥ËΩ¨Êç¢Êó∂Èó¥ÔºåÊñπ‰æøË∑®Êó∂Âå∫Âçè‰Ωú</p>
      </header>

      <div class="current-time">
        <div class="current-time-label">ÂΩìÂâçÊó∂Èó¥ (Êú¨Âú∞)</div>
        <div class="current-time-value" id="currentTime">--:--:--</div>
      </div>

      <div class="input-section">
        <div class="input-row">
          <div class="input-group">
            <label>ÈÄâÊã©Êó∂Èó¥</label>
            <input type="datetime-local" id="inputTime" />
          </div>
          <div class="input-group">
            <label>Ê∫êÊó∂Âå∫</label>
            <select id="sourceTimezone"></select>
          </div>
          <button class="btn btn-primary" onclick="convertTime()">ËΩ¨Êç¢</button>
          <button class="btn btn-secondary" onclick="useNow()">‰ΩøÁî®ÂΩìÂâçÊó∂Èó¥</button>
        </div>
      </div>

      <div class="timezone-list">
        <div class="timezone-header">
          <span class="timezone-title">ÁõÆÊ†áÊó∂Âå∫</span>
        </div>
        <div class="timezone-grid" id="timezoneGrid"></div>

        <div class="add-timezone">
          <select id="addTimezoneSelect"></select>
          <button class="btn btn-secondary" onclick="addTimezone()">Ê∑ªÂä†Êó∂Âå∫</button>
        </div>

        <div class="quick-zones">
          <span class="quick-zone" onclick="addQuickZone('Asia/Shanghai')">Âåó‰∫¨</span>
          <span class="quick-zone" onclick="addQuickZone('America/New_York')">Á∫ΩÁ∫¶</span>
          <span class="quick-zone" onclick="addQuickZone('America/Los_Angeles')">Ê¥õÊùâÁü∂</span>
          <span class="quick-zone" onclick="addQuickZone('Europe/London')">‰º¶Êï¶</span>
          <span class="quick-zone" onclick="addQuickZone('Europe/Paris')">Â∑¥Èªé</span>
          <span class="quick-zone" onclick="addQuickZone('Asia/Tokyo')">‰∏ú‰∫¨</span>
          <span class="quick-zone" onclick="addQuickZone('Asia/Singapore')">Êñ∞Âä†Âù°</span>
          <span class="quick-zone" onclick="addQuickZone('Australia/Sydney')">ÊÇâÂ∞º</span>
        </div>
      </div>

      <footer>
        <a href="../../index.html">ËøîÂõûÂ∑•ÂÖ∑ÂàóË°®</a>
        ¬∑
        <a
          href="https://github.com/chicogong/html-tools/blob/master/tools/timezone-converter.html"
          target="_blank"
        >
          Êü•ÁúãÊ∫ê‰ª£Á†Å
        </a>
      </footer>
    </div>

    <script>
      var inputTime = document.getElementById('inputTime');
      var sourceTimezone = document.getElementById('sourceTimezone');
      var addTimezoneSelect = document.getElementById('addTimezoneSelect');
      var timezoneGrid = document.getElementById('timezoneGrid');

      // Â∏∏Áî®Êó∂Âå∫ÂàóË°®
      var timezones = [
        { id: 'Pacific/Honolulu', name: 'Ê™ÄÈ¶ôÂ±±', offset: -10 },
        { id: 'America/Anchorage', name: 'ÂÆâÂÖãÈõ∑Â•á', offset: -9 },
        { id: 'America/Los_Angeles', name: 'Ê¥õÊùâÁü∂', offset: -8 },
        { id: 'America/Denver', name: '‰∏π‰Ωõ', offset: -7 },
        { id: 'America/Chicago', name: 'ËäùÂä†Âì•', offset: -6 },
        { id: 'America/New_York', name: 'Á∫ΩÁ∫¶', offset: -5 },
        { id: 'America/Sao_Paulo', name: 'Âú£‰øùÁΩó', offset: -3 },
        { id: 'Atlantic/Reykjavik', name: 'Èõ∑ÂÖãÈõÖÊú™ÂÖã', offset: 0 },
        { id: 'Europe/London', name: '‰º¶Êï¶', offset: 0 },
        { id: 'Europe/Paris', name: 'Â∑¥Èªé', offset: 1 },
        { id: 'Europe/Berlin', name: 'ÊüèÊûó', offset: 1 },
        { id: 'Europe/Moscow', name: 'Ëé´ÊñØÁßë', offset: 3 },
        { id: 'Asia/Dubai', name: 'Ëø™Êãú', offset: 4 },
        { id: 'Asia/Kolkata', name: 'Â≠ü‰π∞', offset: 5.5 },
        { id: 'Asia/Bangkok', name: 'ÊõºË∞∑', offset: 7 },
        { id: 'Asia/Singapore', name: 'Êñ∞Âä†Âù°', offset: 8 },
        { id: 'Asia/Shanghai', name: 'Âåó‰∫¨/‰∏äÊµ∑', offset: 8 },
        { id: 'Asia/Hong_Kong', name: 'È¶ôÊ∏Ø', offset: 8 },
        { id: 'Asia/Taipei', name: 'Âè∞Âåó', offset: 8 },
        { id: 'Asia/Tokyo', name: '‰∏ú‰∫¨', offset: 9 },
        { id: 'Asia/Seoul', name: 'È¶ñÂ∞î', offset: 9 },
        { id: 'Australia/Sydney', name: 'ÊÇâÂ∞º', offset: 11 },
        { id: 'Pacific/Auckland', name: 'Â••ÂÖãÂÖ∞', offset: 13 },
        { id: 'UTC', name: 'UTC', offset: 0 }
      ];

      // Áî®Êà∑ÈÄâÊã©ÁöÑÊó∂Âå∫
      var selectedTimezones = ['Asia/Shanghai', 'America/New_York', 'Europe/London', 'Asia/Tokyo'];

      // ÂàùÂßãÂåñÊó∂Âå∫ÈÄâÊã©Âô®
      function initTimezoneSelectors() {
        // Ê∏ÖÁ©∫ÈÄâÊã©Âô®
        sourceTimezone.textContent = '';
        addTimezoneSelect.textContent = '';

        timezones.forEach(function (tz) {
          var sign = tz.offset >= 0 ? '+' : '';
          var text = tz.name + ' (UTC' + sign + tz.offset + ')';

          var option1 = document.createElement('option');
          option1.value = tz.id;
          option1.textContent = text;
          sourceTimezone.appendChild(option1);

          var option2 = document.createElement('option');
          option2.value = tz.id;
          option2.textContent = text;
          addTimezoneSelect.appendChild(option2);
        });

        // ÈªòËÆ§ÈÄâÊã©Êú¨Âú∞Êó∂Âå∫
        var localTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
        var matchingTz = timezones.find(function (tz) {
          return tz.id === localTz;
        });
        if (matchingTz) {
          sourceTimezone.value = matchingTz.id;
        } else {
          sourceTimezone.value = 'Asia/Shanghai';
        }
      }

      // ‰ΩøÁî®ÂΩìÂâçÊó∂Èó¥
      function useNow() {
        var now = new Date();
        var year = now.getFullYear();
        var month = String(now.getMonth() + 1).padStart(2, '0');
        var day = String(now.getDate()).padStart(2, '0');
        var hours = String(now.getHours()).padStart(2, '0');
        var minutes = String(now.getMinutes()).padStart(2, '0');
        inputTime.value = year + '-' + month + '-' + day + 'T' + hours + ':' + minutes;
        convertTime();
      }

      // Ëé∑ÂèñÊó∂Âå∫‰ø°ÊÅØ
      function getTimezoneInfo(tzId) {
        return (
          timezones.find(function (tz) {
            return tz.id === tzId;
          }) || { id: tzId, name: tzId, offset: 0 }
        );
      }

      // Ê†ºÂºèÂåñÊó∂Èó¥
      function formatTime(date, tzId) {
        try {
          return date.toLocaleTimeString('zh-CN', {
            timeZone: tzId,
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false
          });
        } catch (e) {
          return '--:--:--';
        }
      }

      // Ê†ºÂºèÂåñÊó•Êúü
      function formatDate(date, tzId) {
        try {
          return date.toLocaleDateString('zh-CN', {
            timeZone: tzId,
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            weekday: 'short'
          });
        } catch (e) {
          return '----/--/--';
        }
      }

      // Ëé∑ÂèñÊó∂Âå∫ÂÅèÁßªÂ≠óÁ¨¶‰∏≤
      function getOffsetString(tzId) {
        try {
          var now = new Date();
          var formatter = new Intl.DateTimeFormat('en-US', {
            timeZone: tzId,
            timeZoneName: 'shortOffset'
          });
          var parts = formatter.formatToParts(now);
          var tzPart = parts.find(function (p) {
            return p.type === 'timeZoneName';
          });
          return tzPart ? tzPart.value : '';
        } catch (e) {
          return '';
        }
      }

      // ËÆ°ÁÆóÊó•ÊúüÂ∑ÆÂºÇ
      function getDayDiff(date, sourceTz, targetTz) {
        try {
          var sourceDate = new Date(date.toLocaleString('en-US', { timeZone: sourceTz }));
          var targetDate = new Date(date.toLocaleString('en-US', { timeZone: targetTz }));
          var sourceDayStart = new Date(
            sourceDate.getFullYear(),
            sourceDate.getMonth(),
            sourceDate.getDate()
          );
          var targetDayStart = new Date(
            targetDate.getFullYear(),
            targetDate.getMonth(),
            targetDate.getDate()
          );
          var diff = Math.round((targetDayStart - sourceDayStart) / (1000 * 60 * 60 * 24));
          return diff;
        } catch (e) {
          return 0;
        }
      }

      // ËΩ¨Êç¢Êó∂Èó¥
      function convertTime() {
        var timeValue = inputTime.value;
        if (!timeValue) {
          useNow();
          return;
        }

        var sourceTz = sourceTimezone.value;

        // ÂàõÂª∫Êó•ÊúüÂØπË±°
        var localDate = new Date(timeValue);

        // Ê∏≤ÊüìÊó∂Âå∫ÂàóË°®
        renderTimezones(localDate, sourceTz);
        saveState();
      }

      // Ê∏≤ÊüìÊó∂Âå∫ÂàóË°®
      function renderTimezones(date, sourceTz) {
        timezoneGrid.textContent = '';

        selectedTimezones.forEach(function (tzId) {
          var tzInfo = getTimezoneInfo(tzId);
          var dayDiff = getDayDiff(date, sourceTz, tzId);

          var card = document.createElement('div');
          card.className = 'timezone-card' + (tzId === sourceTz ? ' highlight' : '');

          var infoDiv = document.createElement('div');
          infoDiv.className = 'tz-info';

          var nameSpan = document.createElement('span');
          nameSpan.className = 'tz-name';
          nameSpan.textContent = tzInfo.name;

          var offsetSpan = document.createElement('span');
          offsetSpan.className = 'tz-offset';
          offsetSpan.textContent = tzId + ' ' + getOffsetString(tzId);

          infoDiv.appendChild(nameSpan);
          infoDiv.appendChild(offsetSpan);

          var timeDiv = document.createElement('div');
          timeDiv.className = 'tz-time';

          var timeSpan = document.createElement('span');
          timeSpan.className = 'tz-time-value';
          timeSpan.textContent = formatTime(date, tzId);

          if (dayDiff !== 0) {
            var diffSpan = document.createElement('span');
            diffSpan.className = 'tz-day-diff ' + (dayDiff > 0 ? 'next' : 'prev');
            diffSpan.textContent = dayDiff > 0 ? '+' + dayDiff + 'Â§©' : dayDiff + 'Â§©';
            timeSpan.appendChild(diffSpan);
          }

          var dateSpan = document.createElement('div');
          dateSpan.className = 'tz-date';
          dateSpan.textContent = formatDate(date, tzId);

          timeDiv.appendChild(timeSpan);
          timeDiv.appendChild(dateSpan);

          var removeBtn = document.createElement('button');
          removeBtn.className = 'remove-btn';
          removeBtn.textContent = 'x';
          removeBtn.onclick = function () {
            removeTimezone(tzId);
          };

          card.appendChild(infoDiv);
          card.appendChild(timeDiv);
          card.appendChild(removeBtn);

          timezoneGrid.appendChild(card);
        });
      }

      // Ê∑ªÂä†Êó∂Âå∫
      window.addTimezone = function () {
        var tzId = addTimezoneSelect.value;
        if (selectedTimezones.indexOf(tzId) === -1) {
          selectedTimezones.push(tzId);
          convertTime();
        }
      };

      // Âø´ÈÄüÊ∑ªÂä†Êó∂Âå∫
      window.addQuickZone = function (tzId) {
        if (selectedTimezones.indexOf(tzId) === -1) {
          selectedTimezones.push(tzId);
          convertTime();
        }
      };

      // ÁßªÈô§Êó∂Âå∫
      function removeTimezone(tzId) {
        selectedTimezones = selectedTimezones.filter(function (tz) {
          return tz !== tzId;
        });
        convertTime();
      }

      // Êõ¥Êñ∞ÂΩìÂâçÊó∂Èó¥ÊòæÁ§∫
      function updateCurrentTime() {
        var now = new Date();
        document.getElementById('currentTime').textContent = now.toLocaleTimeString('zh-CN', {
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit',
          hour12: false
        });
      }

      // URL Áä∂ÊÄÅÊåÅ‰πÖÂåñ
      function saveState() {
        var state = {
          time: inputTime.value,
          source: sourceTimezone.value,
          zones: selectedTimezones
        };
        try {
          var hash = btoa(encodeURIComponent(JSON.stringify(state)));
          history.replaceState(null, '', '#' + hash);
        } catch (e) {
          console.error('‰øùÂ≠òÁä∂ÊÄÅÂ§±Ë¥•:', e);
        }
      }

      function loadState() {
        var hash = window.location.hash.slice(1);
        if (hash) {
          try {
            var state = JSON.parse(decodeURIComponent(atob(hash)));
            if (state.time) inputTime.value = state.time;
            if (state.source) sourceTimezone.value = state.source;
            if (state.zones && state.zones.length > 0) selectedTimezones = state.zones;
            convertTime();
          } catch (e) {
            console.error('Âä†ËΩΩÁä∂ÊÄÅÂ§±Ë¥•:', e);
            useNow();
          }
        } else {
          useNow();
        }
      }

      // ËæìÂÖ•ÂèòÂåñÊó∂ËΩ¨Êç¢
      inputTime.addEventListener('change', convertTime);
      sourceTimezone.addEventListener('change', convertTime);

      // ÂàùÂßãÂåñ
      initTimezoneSelectors();
      loadState();
      updateCurrentTime();
      setInterval(updateCurrentTime, 1000);

      window.toggleTheme = function () {
        var html = document.documentElement;
        var btn = document.querySelector('.theme-toggle');
        var next = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
        html.setAttribute('data-theme', next);
        btn.textContent = next === 'light' ? '‚òÄÔ∏è' : 'üåô';
        localStorage.setItem('theme', next);
      };
      (function () {
        var saved = localStorage.getItem('theme');
        if (saved) {
          document.documentElement.setAttribute('data-theme', saved);
          var btn = document.querySelector('.theme-toggle');
          if (btn) btn.textContent = saved === 'light' ? '‚òÄÔ∏è' : 'üåô';
        }
      })();
    </script>
  </body>
</html>
