<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­£åˆ™è¡¨è¾¾å¼æµ‹è¯•å™¨ - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg-primary: #0a0a0f; --bg-secondary: #12121a; --bg-tertiary: #1a1a25; --text-primary: #fff; --text-secondary: #88a; --accent: #6366f1; --border: #2a2a3a; --success: #22c55e; --warning: #f59e0b; --danger: #ef4444; }
        [data-theme="light"] { --bg-primary: #f8fafc; --bg-secondary: #fff; --bg-tertiary: #f1f5f9; --text-primary: #1e293b; --text-secondary: #64748b; --border: #e2e8f0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }
        .header { background: linear-gradient(135deg, #f97316, #ef4444); padding: 2rem; text-align: center; }
        .header h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .nav { display: flex; justify-content: space-between; max-width: 1200px; margin: 0 auto 1rem; }
        .back-link { color: rgba(255,255,255,0.9); text-decoration: none; }
        .theme-toggle { background: rgba(255,255,255,0.2); border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; color: white; cursor: pointer; }
        .container { max-width: 1000px; margin: 0 auto; padding: 2rem; }
        .card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; }
        .input-group { margin-bottom: 1rem; }
        .input-group label { display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem; }
        .regex-input { display: flex; align-items: center; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.5rem; overflow: hidden; }
        .regex-input .slash { padding: 0.75rem; color: var(--text-secondary); font-family: monospace; }
        .regex-input input { flex: 1; padding: 0.75rem 0; border: none; background: transparent; color: var(--text-primary); font-size: 1rem; font-family: monospace; outline: none; }
        .regex-input .flags { display: flex; gap: 0.25rem; padding: 0.5rem; }
        .flag-btn { padding: 0.25rem 0.5rem; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 0.25rem; color: var(--text-secondary); cursor: pointer; font-family: monospace; font-size: 0.85rem; }
        .flag-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
        textarea { width: 100%; height: 200px; padding: 1rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); font-size: 1rem; font-family: monospace; resize: vertical; line-height: 1.6; }
        .error { color: var(--danger); font-size: 0.85rem; margin-top: 0.5rem; }
        .stats { display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap; }
        .stat { padding: 0.5rem 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; font-size: 0.85rem; }
        .stat strong { color: var(--accent); }
        .matches { margin-top: 1rem; }
        .match-item { padding: 0.75rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem; font-family: monospace; }
        .match-item .index { color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 0.25rem; }
        .match-item .value { color: var(--success); }
        .match-item .groups { margin-top: 0.5rem; font-size: 0.85rem; }
        .match-item .groups span { display: inline-block; background: var(--bg-primary); padding: 0.125rem 0.5rem; border-radius: 0.25rem; margin-right: 0.5rem; margin-top: 0.25rem; }
        .highlight { background: rgba(34, 197, 94, 0.3); border-radius: 2px; }
        .highlighted-text { padding: 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; font-family: monospace; line-height: 1.8; white-space: pre-wrap; word-break: break-all; }
        .quick-patterns { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem; }
        .pattern-btn { padding: 0.375rem 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.375rem; color: var(--text-primary); cursor: pointer; font-size: 0.8rem; }
        .pattern-btn:hover { border-color: var(--accent); }
    </style>
</head>
<body>
    <div class="header">
        <div class="nav">
            <a href="../../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
        </div>
        <h1>ğŸ” æ­£åˆ™è¡¨è¾¾å¼æµ‹è¯•å™¨</h1>
        <p>å®æ—¶æµ‹è¯•å’Œè°ƒè¯•æ­£åˆ™è¡¨è¾¾å¼</p>
    </div>
    <div class="container">
        <div class="card">
            <div class="input-group">
                <label>æ­£åˆ™è¡¨è¾¾å¼</label>
                <div class="regex-input">
                    <span class="slash">/</span>
                    <input type="text" id="pattern" value="\\w+" oninput="testRegex()">
                    <span class="slash">/</span>
                    <div class="flags">
                        <button class="flag-btn active" data-flag="g" onclick="toggleFlag('g')">g</button>
                        <button class="flag-btn" data-flag="i" onclick="toggleFlag('i')">i</button>
                        <button class="flag-btn" data-flag="m" onclick="toggleFlag('m')">m</button>
                        <button class="flag-btn" data-flag="s" onclick="toggleFlag('s')">s</button>
                    </div>
                </div>
                <div class="error" id="error"></div>
            </div>
            
            <div class="quick-patterns">
                <span style="color: var(--text-secondary); font-size: 0.85rem;">å¸¸ç”¨æ¨¡å¼:</span>
                <button class="pattern-btn" onclick="setPattern('[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}')">Email</button>
                <button class="pattern-btn" onclick="setPattern('https?://[\\w\\-._~:/?#[\\]@!$&\\'()*+,;=%]+')">URL</button>
                <button class="pattern-btn" onclick="setPattern('1[3-9]\\d{9}')">æ‰‹æœºå·</button>
                <button class="pattern-btn" onclick="setPattern('\\d{4}-\\d{2}-\\d{2}')">æ—¥æœŸ</button>
                <button class="pattern-btn" onclick="setPattern('#[0-9A-Fa-f]{6}')">åå…­è¿›åˆ¶é¢œè‰²</button>
                <button class="pattern-btn" onclick="setPattern('\\d+\\.\\d+\\.\\d+\\.\\d+')">IPåœ°å€</button>
            </div>
            
            <div class="input-group" style="margin-top: 1rem;">
                <label>æµ‹è¯•æ–‡æœ¬</label>
                <textarea id="testText" oninput="testRegex()">Hello World! My email is test@example.com and backup is user123@test.org
Visit https://example.com or http://test.com
Call me at 13812345678</textarea>
            </div>
        </div>
        
        <div class="card">
            <div class="stats" id="stats"></div>
            <div class="input-group">
                <label>é«˜äº®æ˜¾ç¤º</label>
                <div class="highlighted-text" id="highlighted"></div>
            </div>
            <div class="matches" id="matches"></div>
        </div>
    </div>
    <script>
        let flags = 'g';
        
        window.toggleFlag = function(flag) {
            const btn = document.querySelector(`[data-flag="${flag}"]`);
            if (flags.includes(flag)) {
                flags = flags.replace(flag, '');
                btn.classList.remove('active');
            } else {
                flags += flag;
                btn.classList.add('active');
            }
            testRegex();
        };
        
        window.setPattern = function(pattern) {
            document.getElementById('pattern').value = pattern;
            testRegex();
        };
        
        function testRegex() {
            const pattern = document.getElementById('pattern').value;
            const text = document.getElementById('testText').value;
            const errorEl = document.getElementById('error');
            const statsEl = document.getElementById('stats');
            const highlightedEl = document.getElementById('highlighted');
            const matchesEl = document.getElementById('matches');
            
            errorEl.textContent = '';
            
            if (!pattern) {
                statsEl.innerHTML = '';
                highlightedEl.textContent = text;
                matchesEl.innerHTML = '';
                return;
            }
            
            try {
                const regex = new RegExp(pattern, flags);
                const matches = [...text.matchAll(new RegExp(pattern, flags.includes('g') ? flags : flags + 'g'))];
                
                // Stats
                statsEl.innerHTML = `
                    <div class="stat">åŒ¹é…æ•°: <strong>${matches.length}</strong></div>
                    <div class="stat">æ­£åˆ™: <strong>/${pattern}/${flags}</strong></div>
                `;
                
                // Highlighted text
                let highlighted = text;
                let offset = 0;
                matches.forEach(match => {
                    const start = match.index + offset;
                    const end = start + match[0].length;
                    const before = highlighted.substring(0, start);
                    const matched = highlighted.substring(start, end);
                    const after = highlighted.substring(end);
                    highlighted = before + `<span class="highlight">${escapeHtml(matched)}</span>` + after;
                    offset += '<span class="highlight"></span>'.length;
                });
                highlightedEl.innerHTML = highlighted || escapeHtml(text);
                
                // Matches list
                matchesEl.innerHTML = matches.slice(0, 20).map((match, i) => {
                    let groupsHtml = '';
                    if (match.length > 1) {
                        groupsHtml = '<div class="groups">Groups: ' + 
                            match.slice(1).map((g, j) => `<span>$${j+1}: ${g || '(empty)'}</span>`).join('') + 
                            '</div>';
                    }
                    return `<div class="match-item">
                        <div class="index">åŒ¹é… ${i + 1} @ ä½ç½® ${match.index}</div>
                        <div class="value">${escapeHtml(match[0])}</div>
                        ${groupsHtml}
                    </div>`;
                }).join('') + (matches.length > 20 ? '<p style="color: var(--text-secondary); text-align: center;">... è¿˜æœ‰ ' + (matches.length - 20) + ' ä¸ªåŒ¹é…</p>' : '');
                
            } catch (e) {
                errorEl.textContent = 'æ— æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼: ' + e.message;
                statsEl.innerHTML = '';
                highlightedEl.textContent = text;
                matchesEl.innerHTML = '';
            }
        }
        
        window.escapeHtml = function(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        };
        
        window.toggleTheme = function() {
            const t = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', t);
            localStorage.setItem('theme', t);
        };

        document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'dark');
        testRegex();
    </script>
</body>
</html>
