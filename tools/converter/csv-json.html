<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV ‚áÑ JSON ËΩ¨Êç¢Âô® - WebUtils</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="CSV ‚áÑ JSON ËΩ¨Êç¢Âô® - WebUtils" />
  <meta name="keywords" content="csv-json,converter,tools,webutils" />
  <meta name="author" content="WebUtils" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tools.realtime-ai.chat/tools/converter/csv-json.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="CSV ‚áÑ JSON ËΩ¨Êç¢Âô® - WebUtils" />
  <meta property="og:description" content="CSV ‚áÑ JSON ËΩ¨Êç¢Âô® - WebUtils" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tools.realtime-ai.chat/tools/converter/csv-json.html" />
  <meta property="og:site_name" content="WebUtils" />
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="640" />
  <meta property="og:image:type" content="image/png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="CSV ‚áÑ JSON ËΩ¨Êç¢Âô® - WebUtils" />
  <meta name="twitter:description" content="CSV ‚áÑ JSON ËΩ¨Êç¢Âô® - WebUtils" />
  <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-input: #0e0e14;
      --text-primary: #e8e8ed;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border-subtle: #2a2a3a;
      --border-strong: #3a3a4a;
      --accent-cyan: #00f5d4;
      --accent-green: #10b981;
      --accent-red: #f43f5e;
      --accent-yellow: #fbbf24;
      --accent-purple: #a855f7;
      --glow-cyan: rgb(0, 245, 212, 0.15);
      --glow-green: rgb(16, 185, 129, 0.15);
      --glow-red: rgb(244, 63, 94, 0.15);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    [data-theme="light"] {
      --bg-deep: #fafafa;
      --bg-surface: #fff;
      --bg-card: #fff;
      --bg-input: #f5f5f5;
      --bg-hover: #f5f5f5;
      --text-primary: #1a1a1a;
      --text-secondary: #666;
      --text-muted: #999;
      --border-subtle: #e5e5e5;
      --border-strong: #d5d5d5;
    }

        :root {
            --primary: #06b6d4;
            --primary-hover: #0891b2;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        [data-theme="dark"] {
            --card-bg: #1e293b;
            --border-color: #334155;
            --editor-bg: #0f172a;
        }

        [data-theme="light"] {
            --card-bg: #fff;
            --border-color: #e2e8f0;
            --editor-bg: #f8fafc;
        }

        body {
            padding: 2rem;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        header h1 {
            margin: 0;
            font-size: 1.75rem;
        }

        .theme-toggle {
            background: none;
            border: 1px solid var(--border-color);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-size: 1.25rem;
            width: 42px;
            height: 42px;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: stretch;
        }

        @media (max-width: 900px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
            .convert-controls {
                flex-direction: row !important;
                justify-content: center;
            }
        }

        .editor-panel {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background: var(--border-color);
        }

        .editor-title {
            font-weight: 600;
        }

        .editor-actions {
            display: flex;
            gap: 0.5rem;
        }

        .editor-actions button {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            color: inherit;
        }

        .editor-actions button:hover {
            background: rgba(255,255,255,0.2);
        }

        .editor-body {
            flex: 1;
        }

        .editor-body textarea {
            width: 100%;
            height: 450px;
            padding: 1rem;
            border: none;
            background: var(--editor-bg);
            color: inherit;
            font-family: Monaco, Menlo, 'Ubuntu Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            resize: none;
        }

        .editor-body textarea:focus {
            outline: none;
        }

        .editor-footer {
            padding: 0.5rem 1rem;
            background: var(--border-color);
            font-size: 0.75rem;
            display: flex;
            justify-content: space-between;
            color: var(--muted-color);
        }

        .convert-controls {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 0.5rem;
        }

        .convert-btn {
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.5rem;
            background: var(--primary);
            color: white;
            transition: all 0.2s;
        }

        .convert-btn:hover {
            background: var(--primary-hover);
            transform: scale(1.05);
        }

        .options-bar {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
        }

        .option-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .option-group label {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .option-group select,
        .option-group input {
            padding: 0.375rem 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            font-size: 0.875rem;
            background: var(--card-bg);
            color: inherit;
        }

        .option-group input[type="text"] {
            width: 60px;
        }

        .option-group input[type="checkbox"] {
            width: auto;
        }

        .status-bar {
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            display: none;
        }

        .status-bar.success {
            display: block;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: var(--success);
        }

        .status-bar.error {
            display: block;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--danger);
        }

        .sample-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .sample-btn {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            background: var(--border-color);
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            color: inherit;
        }

        .sample-btn:hover {
            background: var(--primary);
            color: white;
        }

        .preview-table {
            margin-top: 1rem;
            overflow-x: auto;
        }

        .preview-table table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8125rem;
        }

        .preview-table th,
        .preview-table td {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            text-align: left;
        }

        .preview-table th {
            background: var(--border-color);
            font-weight: 600;
        }

        .preview-table tr:nth-child(even) {
            background: rgba(0,0,0,0.02);
        }

        .file-upload {
            border: 2px dashed var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.5rem;
        }

        .file-upload:hover {
            border-color: var(--primary);
            background: rgba(6, 182, 212, 0.05);
        }

        .file-upload input {
            display: none;
        }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">È¶ñÈ°µ</a><span>‚Ä∫</span><a href="../../index.html#converter">ËΩ¨Êç¢Âô®</a><span>‚Ä∫</span>CSV ‚áÑ JSON ËΩ¨Êç¢</nav>
    <div class="container">
        <header>
            <h1>üìä CSV ‚áÑ JSON ËΩ¨Êç¢Âô®</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="ÂàáÊç¢‰∏ªÈ¢ò">üåô</button>
        </header>

        <div class="options-bar">
            <div class="option-group">
                <label>ÂàÜÈöîÁ¨¶:</label>
                <select id="delimiter">
                    <option value=",">ÈÄóÂè∑ (,)</option>
                    <option value=";">ÂàÜÂè∑ (;)</option>
                    <option value="\t">Âà∂Ë°®Á¨¶ (Tab)</option>
                    <option value="|">Á´ñÁ∫ø (|)</option>
                </select>
            </div>
            <div class="option-group">
                <input type="checkbox" id="hasHeader" checked>
                <label for="hasHeader">È¶ñË°å‰∏∫Ë°®Â§¥</label>
            </div>
            <div class="option-group">
                <input type="checkbox" id="trimValues" checked>
                <label for="trimValues">ÂéªÈô§Á©∫ÁôΩ</label>
            </div>
            <div class="option-group">
                <input type="checkbox" id="skipEmpty">
                <label for="skipEmpty">Ë∑≥ËøáÁ©∫Ë°å</label>
            </div>
            <div class="sample-buttons">
                <span style="font-size: 0.875rem; margin-right: 0.5rem;">Á§∫‰æã:</span>
                <button class="sample-btn" onclick="loadSample('users')">Áî®Êà∑Êï∞ÊçÆ</button>
                <button class="sample-btn" onclick="loadSample('products')">‰∫ßÂìÅÂàóË°®</button>
                <button class="sample-btn" onclick="loadSample('sales')">ÈîÄÂîÆËÆ∞ÂΩï</button>
            </div>
        </div>

        <div class="editor-container">
            <div class="editor-panel">
                <div class="editor-header">
                    <div class="editor-title">üìÑ CSV</div>
                    <div class="editor-actions">
                        <button onclick="copyText('csvInput')">Â§çÂà∂</button>
                        <button onclick="clearText('csvInput')">Ê∏ÖÈô§</button>
                        <button onclick="downloadFile('csv')">‰∏ãËΩΩ</button>
                    </div>
                </div>
                <div class="editor-body">
                    <label class="file-upload">
                        <input type="file" accept=".csv,.tsv,.txt" onchange="handleFileUpload(event, 'csv')">
                        üìÅ ÁÇπÂáªÊàñÊãñÊãΩ‰∏ä‰º† CSV Êñá‰ª∂
                    </label>
                    <textarea id="csvInput" placeholder="Âú®Ê≠§ËæìÂÖ•ÊàñÁ≤òË¥¥ CSV Êï∞ÊçÆ...&#10;&#10;Á§∫‰æã:&#10;name,age,city&#10;Âº†‰∏â,25,Âåó‰∫¨&#10;ÊùéÂõõ,30,‰∏äÊµ∑" oninput="updateStats('csv')"></textarea>
                </div>
                <div class="editor-footer">
                    <span id="csvStats">0 Â≠óÁ¨¶ | 0 Ë°å</span>
                </div>
            </div>

            <div class="convert-controls">
                <button class="convert-btn" onclick="csvToJson()" title="CSV ‚Üí JSON">‚Üí</button>
                <button class="convert-btn" onclick="jsonToCsv()" title="JSON ‚Üí CSV">‚Üê</button>
            </div>

            <div class="editor-panel">
                <div class="editor-header">
                    <div class="editor-title">üìã JSON</div>
                    <div class="editor-actions">
                        <button onclick="formatJSON()">Ê†ºÂºèÂåñ</button>
                        <button onclick="copyText('jsonInput')">Â§çÂà∂</button>
                        <button onclick="clearText('jsonInput')">Ê∏ÖÈô§</button>
                        <button onclick="downloadFile('json')">‰∏ãËΩΩ</button>
                    </div>
                </div>
                <div class="editor-body">
                    <label class="file-upload">
                        <input type="file" accept=".json" onchange="handleFileUpload(event, 'json')">
                        üìÅ ÁÇπÂáªÊàñÊãñÊãΩ‰∏ä‰º† JSON Êñá‰ª∂
                    </label>
                    <textarea id="jsonInput" placeholder="Âú®Ê≠§ËæìÂÖ•ÊàñÁ≤òË¥¥ JSON Êï∞ÁªÑ...&#10;&#10;Á§∫‰æã:&#10;[&#10;  {&quot;name&quot;: &quot;Âº†‰∏â&quot;, &quot;age&quot;: 25}&#10;]" oninput="updateStats('json')"></textarea>
                </div>
                <div class="editor-footer">
                    <span id="jsonStats">0 Â≠óÁ¨¶ | 0 Ë°å</span>
                    <span id="jsonValid"></span>
                </div>
            </div>
        </div>

        <div class="status-bar" id="statusBar"></div>

        <div class="preview-table" id="previewTable"></div>
    </div>

    <script>
        // Á§∫‰æãÊï∞ÊçÆ
        const samples = {
            users: `name,email,age,city,role
Âº†‰∏â,zhangsan@example.com,28,Âåó‰∫¨,ÁÆ°ÁêÜÂëò
ÊùéÂõõ,lisi@example.com,32,‰∏äÊµ∑,Áî®Êà∑
Áéã‰∫î,wangwu@example.com,25,ÂπøÂ∑û,Áî®Êà∑
ËµµÂÖ≠,zhaoliu@example.com,35,Ê∑±Âú≥,ÁºñËæë`,
            products: `id,name,price,stock,category
1,Á¨îËÆ∞Êú¨ÁîµËÑë,5999.00,50,ÁîµÂ≠ê‰∫ßÂìÅ
2,Êó†Á∫øÈº†Ê†á,129.00,200,ÈÖç‰ª∂
3,Êú∫Ê¢∞ÈîÆÁõò,399.00,80,ÈÖç‰ª∂
4,ÊòæÁ§∫Âô®,1599.00,30,ÁîµÂ≠ê‰∫ßÂìÅ
5,USB-C ËΩ¨Êé•Âô®,89.00,150,ÈÖç‰ª∂`,
            sales: `date,product,quantity,amount,region
2024-01-15,Á¨îËÆ∞Êú¨ÁîµËÑë,5,29995.00,ÂçéÂåó
2024-01-15,Êó†Á∫øÈº†Ê†á,20,2580.00,Âçé‰∏ú
2024-01-16,Êú∫Ê¢∞ÈîÆÁõò,10,3990.00,ÂçéÂçó
2024-01-16,ÊòæÁ§∫Âô®,3,4797.00,ÂçéÂåó
2024-01-17,USB-C ËΩ¨Êé•Âô®,50,4450.00,Âçé‰∏ú`
        };

        // ‰∏ªÈ¢òÂàáÊç¢
        window.toggleTheme = function() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.querySelector('.theme-toggle').textContent = newTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        };

        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.querySelector('.theme-toggle').textContent = savedTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        // Âä†ËΩΩÁ§∫‰æã
        window.loadSample = function(type) {
            document.getElementById('csvInput').value = samples[type];
            updateStats('csv');
            csvToJson();
        };

        // Ëß£Êûê CSV
        function parseCSV(csv) {
            const delimiter = document.getElementById('delimiter').value === '\\t' ? '\t' : document.getElementById('delimiter').value;
            const hasHeader = document.getElementById('hasHeader').checked;
            const trimValues = document.getElementById('trimValues').checked;
            const skipEmpty = document.getElementById('skipEmpty').checked;

            let lines = csv.split(/\r?\n/);
            if (skipEmpty) {
                lines = lines.filter(line => line.trim() !== '');
            }

            if (lines.length === 0) return [];

            const result = [];
            let headers = [];

            // Ëß£ÊûêÂçïË°åÔºåÂ§ÑÁêÜÂºïÂè∑
            function parseLine(line) {
                const values = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];

                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            current += '"';
                            i++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === delimiter && !inQuotes) {
                        values.push(trimValues ? current.trim() : current);
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(trimValues ? current.trim() : current);
                return values;
            }

            if (hasHeader && lines.length > 0) {
                headers = parseLine(lines[0]);
                lines = lines.slice(1);
            }

            lines.forEach((line, index) => {
                if (line.trim() === '' && skipEmpty) return;

                const values = parseLine(line);

                if (hasHeader) {
                    const obj = {};
                    headers.forEach((header, i) => {
                        let value = values[i] || '';
                        // Â∞ùËØïËΩ¨Êç¢Êï∞Â≠ó
                        if (value !== '' && !isNaN(value) && !isNaN(parseFloat(value))) {
                            value = parseFloat(value);
                        }
                        obj[header] = value;
                    });
                    result.push(obj);
                } else {
                    result.push(values);
                }
            });

            return result;
        }

        // CSV ËΩ¨ JSON
        function csvToJson() {
            const csv = document.getElementById('csvInput').value.trim();
            if (!csv) {
                showStatus('ËØ∑ËæìÂÖ• CSV ÂÜÖÂÆπ', 'error');
                return;
            }

            try {
                const data = parseCSV(csv);
                const json = JSON.stringify(data, null, 2);
                document.getElementById('jsonInput').value = json;
                updateStats('json');
                renderPreviewTable(data);
                showStatus('CSV ‚Üí JSON ËΩ¨Êç¢ÊàêÂäüÔºåÂÖ± ' + data.length + ' Êù°ËÆ∞ÂΩï', 'success');
            } catch (e) {
                showStatus('CSV Ëß£ÊûêÈîôËØØ: ' + e.message, 'error');
            }
        }

        // JSON ËΩ¨ CSV
        function jsonToCsv() {
            const jsonStr = document.getElementById('jsonInput').value.trim();
            if (!jsonStr) {
                showStatus('ËØ∑ËæìÂÖ• JSON ÂÜÖÂÆπ', 'error');
                return;
            }

            try {
                const data = JSON.parse(jsonStr);
                if (!Array.isArray(data)) {
                    showStatus('JSON ÂøÖÈ°ªÊòØÊï∞ÁªÑÊ†ºÂºè', 'error');
                    return;
                }

                if (data.length === 0) {
                    showStatus('JSON Êï∞ÁªÑ‰∏∫Á©∫', 'error');
                    return;
                }

                const delimiter = document.getElementById('delimiter').value === '\\t' ? '\t' : document.getElementById('delimiter').value;
                const hasHeader = document.getElementById('hasHeader').checked;

                let csv = '';

                // Ëé∑ÂèñÊâÄÊúâÈîÆ
                const allKeys = new Set();
                data.forEach(item => {
                    if (typeof item === 'object' && item !== null) {
                        Object.keys(item).forEach(key => allKeys.add(key));
                    }
                });
                const headers = Array.from(allKeys);

                // ËΩ¨‰πâÂáΩÊï∞
                function escapeValue(val) {
                    if (val === null || val === undefined) return '';
                    const str = String(val);
                    if (str.includes(delimiter) || str.includes('"') || str.includes('\n')) {
                        return '"' + str.replace(/"/g, '""') + '"';
                    }
                    return str;
                }

                // Â¶ÇÊûúÊòØÂØπË±°Êï∞ÁªÑ
                if (typeof data[0] === 'object' && !Array.isArray(data[0])) {
                    if (hasHeader) {
                        csv += headers.map(escapeValue).join(delimiter) + '\n';
                    }
                    data.forEach(item => {
                        const row = headers.map(key => escapeValue(item[key]));
                        csv += row.join(delimiter) + '\n';
                    });
                } else {
                    // Â¶ÇÊûúÊòØÁÆÄÂçïÊï∞ÁªÑ
                    data.forEach(item => {
                        if (Array.isArray(item)) {
                            csv += item.map(escapeValue).join(delimiter) + '\n';
                        } else {
                            csv += escapeValue(item) + '\n';
                        }
                    });
                }

                document.getElementById('csvInput').value = csv.trim();
                updateStats('csv');
                renderPreviewTable(data);
                showStatus('JSON ‚Üí CSV ËΩ¨Êç¢ÊàêÂäüÔºåÂÖ± ' + data.length + ' Êù°ËÆ∞ÂΩï', 'success');
            } catch (e) {
                showStatus('JSON Ëß£ÊûêÈîôËØØ: ' + e.message, 'error');
            }
        }

        // Ê∏≤ÊüìÈ¢ÑËßàË°®Ê†º
        function renderPreviewTable(data) {
            const container = document.getElementById('previewTable');
            if (!data || data.length === 0) {
                container.textContent = '';
                return;
            }

            const maxRows = 10;
            const displayData = data.slice(0, maxRows);

            const table = document.createElement('table');
            
            // Ë°®Â§¥
            if (typeof data[0] === 'object' && !Array.isArray(data[0])) {
                const headers = Object.keys(data[0]);
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                headers.forEach(h => {
                    const th = document.createElement('th');
                    th.textContent = h;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Êï∞ÊçÆË°å
                const tbody = document.createElement('tbody');
                displayData.forEach(row => {
                    const tr = document.createElement('tr');
                    headers.forEach(h => {
                        const td = document.createElement('td');
                        td.textContent = row[h] !== undefined ? String(row[h]) : '';
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
                table.appendChild(tbody);
            }

            container.textContent = '';
            if (data.length > maxRows) {
                const info = document.createElement('p');
                info.style.fontSize = '0.75rem';
                info.style.color = 'var(--muted-color)';
                info.textContent = 'ÊòæÁ§∫Ââç ' + maxRows + ' Êù°ÔºåÂÖ± ' + data.length + ' Êù°ËÆ∞ÂΩï';
                container.appendChild(info);
            }
            container.appendChild(table);
        }

        // Ê†ºÂºèÂåñ JSON
        window.formatJSON = function() {
            const jsonInput = document.getElementById('jsonInput');
            try {
                const obj = JSON.parse(jsonInput.value);
                jsonInput.value = JSON.stringify(obj, null, 2);
                updateStats('json');
            } catch (e) {
                showStatus('JSON Ê†ºÂºèÈîôËØØ', 'error');
            }
        };

        // Êõ¥Êñ∞ÁªüËÆ°
        function updateStats(type) {
            const textarea = document.getElementById(type + 'Input');
            const stats = document.getElementById(type + 'Stats');
            const content = textarea.value;

            const chars = content.length;
            const lines = content ? content.split('\n').length : 0;
            stats.textContent = chars + ' Â≠óÁ¨¶ | ' + lines + ' Ë°å';

            if (type === 'json') {
                const valid = document.getElementById('jsonValid');
                if (content.trim()) {
                    try {
                        JSON.parse(content);
                        valid.textContent = '‚úì ÊúâÊïà';
                        valid.style.color = 'var(--success)';
                    } catch {
                        valid.textContent = '‚úó Êó†Êïà';
                        valid.style.color = 'var(--danger)';
                    }
                } else {
                    valid.textContent = '';
                }
            }
        }

        // Êñá‰ª∂‰∏ä‰º†
        window.handleFileUpload = function(event, type) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                document.getElementById(type + 'Input').value = content;
                updateStats(type);
                
                if (type === 'csv') {
                    csvToJson();
                } else {
                    jsonToCsv();
                }
            };
            reader.readAsText(file);
        };

        // ÊòæÁ§∫Áä∂ÊÄÅ
        function showStatus(message, type) {
            const bar = document.getElementById('statusBar');
            bar.textContent = message;
            bar.className = 'status-bar ' + type;
            setTimeout(() => { bar.className = 'status-bar'; }, 3000);
        }

        // Â§çÂà∂ÊñáÊú¨
        window.copyText = function(id) {
            navigator.clipboard.writeText(document.getElementById(id).value).then(() => {
                showStatus('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø', 'success');
            });
        };

        // Ê∏ÖÈô§ÊñáÊú¨
        window.clearText = function(id) {
            document.getElementById(id).value = '';
            updateStats(id.replace('Input', ''));
            document.getElementById('previewTable').textContent = '';
        };

        // ‰∏ãËΩΩÊñá‰ª∂
        window.downloadFile = function(type) {
            const content = document.getElementById(type + 'Input').value;
            if (!content) {
                showStatus('Ê≤°ÊúâÂÜÖÂÆπÂèØ‰∏ãËΩΩ', 'error');
                return;
            }

            const ext = type === 'csv' ? '.csv' : '.json';
            const mime = type === 'csv' ? 'text/csv;charset=utf-8' : 'application/json';
            const blob = new Blob(['\ufeff' + content], { type: mime });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'data' + ext;
            a.click();
            URL.revokeObjectURL(url);
        };

        // ÂàùÂßãÂåñ
        initTheme();
        loadSample('users');
    </script>
</body>
</html>
