<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LaTeXå…¬å¼ç¼–è¾‘å™¨</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <style>
        :root {
            --primary-color: #27ae60;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            margin-bottom: 0;
            color: var(--primary-color);
        }
        
        .theme-toggle {
            cursor: pointer;
            background: none;
            border: 2px solid var(--pico-muted-border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 768px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
        }
        
        .editor-panel, .preview-panel {
            display: flex;
            flex-direction: column;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .panel-header label {
            font-weight: 600;
        }
        
        textarea {
            min-height: 200px;
            resize: vertical;
            font-family: Consolas, Monaco, monospace;
            font-size: 0.95rem;
        }
        
        .preview-box {
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            padding: 1.5rem;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: auto;
        }
        
        .preview-box .katex-display {
            margin: 0;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 0.9rem;
            padding: 0.5rem;
        }
        
        .symbol-panel {
            margin-bottom: 1rem;
        }
        
        .symbol-tabs {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 0.5rem;
        }
        
        .symbol-tabs button {
            padding: 0.25rem 0.75rem;
            font-size: 0.85rem;
        }
        
        .symbol-tabs button.active {
            background: var(--primary-color);
        }
        
        .symbol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 0.25rem;
            padding: 0.5rem;
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            max-height: 150px;
            overflow-y: auto;
        }
        
        .symbol-btn {
            padding: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
            border: 1px solid var(--pico-muted-border-color);
            border-radius: 4px;
            background: var(--pico-background-color);
            transition: all 0.2s;
        }
        
        .symbol-btn:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }
        
        .examples {
            margin-top: 1rem;
        }
        
        .examples h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .example-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.5rem;
        }
        
        .example-item {
            padding: 0.5rem;
            background: var(--pico-card-background-color);
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .example-item:hover {
            border-color: var(--primary-color);
        }
        
        .example-item code {
            display: block;
            margin-top: 0.25rem;
            font-size: 0.75rem;
            color: var(--pico-muted-color);
        }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 1rem;
            border-top: 1px solid var(--pico-muted-border-color);
            color: var(--pico-muted-color);
        }
        
        .history-panel {
            margin-top: 1rem;
        }
        
        .history-list {
            max-height: 100px;
            overflow-y: auto;
            font-size: 0.85rem;
        }
        
        .history-item {
            padding: 0.25rem 0.5rem;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .history-item:hover {
            background: var(--pico-muted-border-color);
        }
    </style>
</head>
<body>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>LaTeXå…¬å¼ç¼–è¾‘å™¨</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
                <span id="theme-icon">ğŸŒ™</span>
            </button>
        </header>
        
        <article>
            <!-- ç¬¦å·é¢æ¿ -->
            <div class="symbol-panel">
                <div class="symbol-tabs">
                    <button class="active" onclick="showSymbols('greek')">å¸Œè…Šå­—æ¯</button>
                    <button onclick="showSymbols('operators')">è¿ç®—ç¬¦</button>
                    <button onclick="showSymbols('relations')">å…³ç³»ç¬¦</button>
                    <button onclick="showSymbols('arrows')">ç®­å¤´</button>
                    <button onclick="showSymbols('misc')">å…¶ä»–</button>
                    <button onclick="showSymbols('structures')">ç»“æ„</button>
                </div>
                <div class="symbol-grid" id="symbol-grid"></div>
            </div>
            
            <!-- ç¼–è¾‘å™¨ -->
            <div class="editor-container">
                <div class="editor-panel">
                    <div class="panel-header">
                        <label for="latex-input">LaTeXä»£ç </label>
                        <button class="outline secondary" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" onclick="clearEditor()">æ¸…ç©º</button>
                    </div>
                    <textarea id="latex-input" placeholder="è¾“å…¥LaTeXå…¬å¼ä»£ç ï¼Œä¾‹å¦‚: \frac{a}{b}, \sqrt{x}, \int_0^1 f(x)dx"></textarea>
                </div>
                
                <div class="preview-panel">
                    <div class="panel-header">
                        <label>å®æ—¶é¢„è§ˆ</label>
                        <button class="outline secondary" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" onclick="copyLatex()">å¤åˆ¶ä»£ç </button>
                    </div>
                    <div class="preview-box" id="preview-box">
                        <span style="color: var(--pico-muted-color)">é¢„è§ˆå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</span>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button onclick="renderLatex()">æ¸²æŸ“å…¬å¼</button>
                <button onclick="exportAsSVG()" class="secondary">å¯¼å‡ºSVG</button>
                <button onclick="saveToHistory()" class="outline">ä¿å­˜åˆ°å†å²</button>
            </div>
            
            <!-- ç¤ºä¾‹å…¬å¼ -->
            <div class="examples">
                <h3>å¸¸ç”¨å…¬å¼ç¤ºä¾‹ï¼ˆç‚¹å‡»ä½¿ç”¨ï¼‰</h3>
                <div class="example-list" id="example-list"></div>
            </div>
            
            <!-- å†å²è®°å½• -->
            <details class="history-panel">
                <summary>å†å²è®°å½•</summary>
                <div class="history-list" id="history-list">
                    <p style="color: var(--pico-muted-color); font-size: 0.85rem;">æš‚æ— å†å²è®°å½•</p>
                </div>
            </details>
        </article>
        
        <footer>
            <p>LaTeXå…¬å¼ç¼–è¾‘å™¨ - ä½¿ç”¨KaTeXæ¸²æŸ“ï¼Œçº¯å®¢æˆ·ç«¯è¿è¡Œ</p>
        </footer>
    </main>
    
    <script>
        // ç¬¦å·æ•°æ®
        const symbols = {
            greek: [
                ['Î±', '\\alpha'], ['Î²', '\\beta'], ['Î³', '\\gamma'], ['Î´', '\\delta'],
                ['Îµ', '\\epsilon'], ['Î¶', '\\zeta'], ['Î·', '\\eta'], ['Î¸', '\\theta'],
                ['Î¹', '\\iota'], ['Îº', '\\kappa'], ['Î»', '\\lambda'], ['Î¼', '\\mu'],
                ['Î½', '\\nu'], ['Î¾', '\\xi'], ['Ï€', '\\pi'], ['Ï', '\\rho'],
                ['Ïƒ', '\\sigma'], ['Ï„', '\\tau'], ['Ï…', '\\upsilon'], ['Ï†', '\\phi'],
                ['Ï‡', '\\chi'], ['Ïˆ', '\\psi'], ['Ï‰', '\\omega'], ['Î“', '\\Gamma'],
                ['Î”', '\\Delta'], ['Î˜', '\\Theta'], ['Î›', '\\Lambda'], ['Î ', '\\Pi'],
                ['Î£', '\\Sigma'], ['Î¦', '\\Phi'], ['Î¨', '\\Psi'], ['Î©', '\\Omega']
            ],
            operators: [
                ['+', '+'], ['-', '-'], ['Ã—', '\\times'], ['Ã·', '\\div'],
                ['Â±', '\\pm'], ['âˆ“', '\\mp'], ['Â·', '\\cdot'], ['âˆ—', '\\ast'],
                ['âˆ‘', '\\sum'], ['âˆ', '\\prod'], ['âˆ«', '\\int'], ['âˆ®', '\\oint'],
                ['âˆ‚', '\\partial'], ['âˆ‡', '\\nabla'], ['âˆš', '\\sqrt{}'], ['âˆ›', '\\sqrt[3]{}'],
                ['lim', '\\lim'], ['log', '\\log'], ['ln', '\\ln'], ['sin', '\\sin'],
                ['cos', '\\cos'], ['tan', '\\tan'], ['âˆ', '\\infty'], ['âˆ…', '\\emptyset']
            ],
            relations: [
                ['=', '='], ['â‰ ', '\\neq'], ['<', '<'], ['>', '>'],
                ['â‰¤', '\\leq'], ['â‰¥', '\\geq'], ['â‰ª', '\\ll'], ['â‰«', '\\gg'],
                ['â‰ˆ', '\\approx'], ['â‰¡', '\\equiv'], ['âˆ¼', '\\sim'], ['â‰ƒ', '\\simeq'],
                ['âˆˆ', '\\in'], ['âˆ‰', '\\notin'], ['âŠ‚', '\\subset'], ['âŠƒ', '\\supset'],
                ['âŠ†', '\\subseteq'], ['âŠ‡', '\\supseteq'], ['âˆª', '\\cup'], ['âˆ©', '\\cap'],
                ['âˆ§', '\\land'], ['âˆ¨', '\\lor'], ['Â¬', '\\neg'], ['âŠ¥', '\\perp']
            ],
            arrows: [
                ['â†', '\\leftarrow'], ['â†’', '\\rightarrow'], ['â†‘', '\\uparrow'], ['â†“', '\\downarrow'],
                ['â†”', '\\leftrightarrow'], ['â‡', '\\Leftarrow'], ['â‡’', '\\Rightarrow'], ['â‡”', '\\Leftrightarrow'],
                ['â†¦', '\\mapsto'], ['â†©', '\\hookleftarrow'], ['â†ª', '\\hookrightarrow'], ['âŸ¶', '\\longrightarrow'],
                ['âŸµ', '\\longleftarrow'], ['âŸ¹', '\\Longrightarrow'], ['âŸ¸', '\\Longleftarrow'], ['âŸº', '\\Longleftrightarrow']
            ],
            misc: [
                ['âˆ€', '\\forall'], ['âˆƒ', '\\exists'], ['âˆ„', '\\nexists'], ['â„•', '\\mathbb{N}'],
                ['â„¤', '\\mathbb{Z}'], ['â„š', '\\mathbb{Q}'], ['â„', '\\mathbb{R}'], ['â„‚', '\\mathbb{C}'],
                ['Â°', '^\\circ'], ['â€²', "'"], ['â€³', "''"], ['â€¦', '\\ldots'],
                ['â‹¯', '\\cdots'], ['â‹®', '\\vdots'], ['â‹±', '\\ddots'], ['â„', '\\hbar']
            ],
            structures: [
                ['åˆ†æ•°', '\\frac{a}{b}'], ['ä¸Šæ ‡', 'x^{n}'], ['ä¸‹æ ‡', 'x_{i}'],
                ['æ ¹å·', '\\sqrt{x}'], ['næ¬¡æ ¹', '\\sqrt[n]{x}'], ['æ±‚å’Œ', '\\sum_{i=1}^{n}'],
                ['ç§¯åˆ†', '\\int_{a}^{b}'], ['æé™', '\\lim_{x \\to \\infty}'], ['çŸ©é˜µ', '\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}'],
                ['å‘é‡', '\\vec{v}'], ['å¸½å­', '\\hat{x}'], ['æ¨ªçº¿', '\\overline{x}'],
                ['ä¸‹åˆ’çº¿', '\\underline{x}'], ['å¤§æ‹¬å·', '\\left\\{ x \\right\\}'], ['ä¸­æ‹¬å·', '\\left[ x \\right]'],
                ['ç»å¯¹å€¼', '\\left| x \\right|']
            ]
        };
        
        // ç¤ºä¾‹å…¬å¼
        const examples = [
            { name: 'äºŒæ¬¡å…¬å¼', latex: 'x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}' },
            { name: 'æ¬§æ‹‰å…¬å¼', latex: 'e^{i\\pi} + 1 = 0' },
            { name: 'æ³°å‹’å±•å¼€', latex: 'e^x = \\sum_{n=0}^{\\infty} \\frac{x^n}{n!}' },
            { name: 'å®šç§¯åˆ†', latex: '\\int_0^1 x^2 dx = \\frac{1}{3}' },
            { name: 'æé™', latex: '\\lim_{x \\to 0} \\frac{\\sin x}{x} = 1' },
            { name: 'çŸ©é˜µ', latex: '\\begin{pmatrix} 1 & 2 \\\\ 3 & 4 \\end{pmatrix}' },
            { name: 'æ±‚å’Œ', latex: '\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}' },
            { name: 'åå¯¼æ•°', latex: '\\frac{\\partial f}{\\partial x}' }
        ];
        
        // å†å²è®°å½•
        let history = JSON.parse(localStorage.getItem('latexHistory') || '[]');
        
        // æ˜¾ç¤ºç¬¦å·
        function showSymbols(category) {
            const grid = document.getElementById('symbol-grid');
            grid.textContent = '';
            
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.symbol-tabs button').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(getCategoryName(category))) {
                    btn.classList.add('active');
                }
            });
            
            symbols[category].forEach(([display, latex]) => {
                const btn = document.createElement('button');
                btn.className = 'symbol-btn';
                btn.textContent = display;
                btn.title = latex;
                btn.onclick = () => insertSymbol(latex);
                grid.appendChild(btn);
            });
        }
        
        function getCategoryName(category) {
            const names = {
                greek: 'å¸Œè…Šå­—æ¯',
                operators: 'è¿ç®—ç¬¦',
                relations: 'å…³ç³»ç¬¦',
                arrows: 'ç®­å¤´',
                misc: 'å…¶ä»–',
                structures: 'ç»“æ„'
            };
            return names[category];
        }
        
        // æ’å…¥ç¬¦å·
        function insertSymbol(latex) {
            const input = document.getElementById('latex-input');
            const start = input.selectionStart;
            const end = input.selectionEnd;
            const text = input.value;
            
            input.value = text.substring(0, start) + latex + text.substring(end);
            input.focus();
            input.selectionStart = input.selectionEnd = start + latex.length;
            
            renderLatex();
        }
        
        // æ¸²æŸ“LaTeX
        function renderLatex() {
            const input = document.getElementById('latex-input').value;
            const preview = document.getElementById('preview-box');
            
            if (!input.trim()) {
                preview.textContent = '';
                const placeholder = document.createElement('span');
                placeholder.style.color = 'var(--pico-muted-color)';
                placeholder.textContent = 'é¢„è§ˆå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...';
                preview.appendChild(placeholder);
                return;
            }
            
            try {
                preview.textContent = '';
                katex.render(input, preview, {
                    displayMode: true,
                    throwOnError: true,
                    errorColor: '#e74c3c'
                });
            } catch (e) {
                preview.textContent = '';
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = 'é”™è¯¯: ' + e.message;
                preview.appendChild(errorDiv);
            }
        }
        
        // æ¸…ç©ºç¼–è¾‘å™¨
        function clearEditor() {
            document.getElementById('latex-input').value = '';
            renderLatex();
        }
        
        // å¤åˆ¶LaTeXä»£ç 
        function copyLatex() {
            const input = document.getElementById('latex-input');
            navigator.clipboard.writeText(input.value).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'å·²å¤åˆ¶';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 1500);
            });
        }
        
        // å¯¼å‡ºSVG
        function exportAsSVG() {
            const preview = document.getElementById('preview-box');
            const svg = preview.querySelector('svg');
            
            if (!svg) {
                alert('è¯·å…ˆè¾“å…¥å¹¶æ¸²æŸ“å…¬å¼');
                return;
            }
            
            const svgData = new XMLSerializer().serializeToString(svg);
            const blob = new Blob([svgData], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'formula.svg';
            a.click();
            
            URL.revokeObjectURL(url);
        }
        
        // ä¿å­˜åˆ°å†å²
        function saveToHistory() {
            const input = document.getElementById('latex-input').value;
            if (!input.trim()) return;
            
            // é¿å…é‡å¤
            if (!history.includes(input)) {
                history.unshift(input);
                if (history.length > 20) history.pop();
                localStorage.setItem('latexHistory', JSON.stringify(history));
                updateHistoryList();
            }
        }
        
        // æ›´æ–°å†å²åˆ—è¡¨
        function updateHistoryList() {
            const list = document.getElementById('history-list');
            list.textContent = '';
            
            if (history.length === 0) {
                const p = document.createElement('p');
                p.style.color = 'var(--pico-muted-color)';
                p.style.fontSize = '0.85rem';
                p.textContent = 'æš‚æ— å†å²è®°å½•';
                list.appendChild(p);
                return;
            }
            
            history.forEach((latex, index) => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.textContent = latex.length > 50 ? latex.substring(0, 50) + '...' : latex;
                item.onclick = () => {
                    document.getElementById('latex-input').value = latex;
                    renderLatex();
                };
                list.appendChild(item);
            });
        }
        
        // åˆå§‹åŒ–ç¤ºä¾‹
        function initExamples() {
            const list = document.getElementById('example-list');
            
            examples.forEach(ex => {
                const item = document.createElement('div');
                item.className = 'example-item';
                
                const name = document.createElement('span');
                name.textContent = ex.name;
                
                const code = document.createElement('code');
                code.textContent = ex.latex;
                
                item.appendChild(name);
                item.appendChild(code);
                
                item.onclick = () => {
                    document.getElementById('latex-input').value = ex.latex;
                    renderLatex();
                };
                list.appendChild(item);
            });
        }
        
        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', newTheme);
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ä¸»é¢˜
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            
            // æ˜¾ç¤ºé»˜è®¤ç¬¦å·
            showSymbols('greek');
            
            // åˆå§‹åŒ–ç¤ºä¾‹
            initExamples();
            
            // æ›´æ–°å†å²
            updateHistoryList();
            
            // å®æ—¶é¢„è§ˆ
            document.getElementById('latex-input').addEventListener('input', renderLatex);
        });
    </script>
</body>
</html>
