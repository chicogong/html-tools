<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ©æ¶¦ç‡è®¡ç®—å™¨ - WebUtils</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #10b981; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); cursor: pointer; text-align: center; }
        .tab.active { background: var(--accent); border-color: var(--accent); color: white; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text2); }
        input { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        input:focus { outline: none; border-color: var(--accent); }
        .result-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .result-item { background: var(--bg); padding: 16px; border-radius: 8px; text-align: center; }
        .result-item .value { font-size: 1.5rem; font-weight: 700; color: var(--accent); }
        .result-item .label { font-size: 0.8rem; color: var(--text2); margin-top: 4px; }
        .result-row { display: flex; justify-content: space-between; padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 8px; }
        .formula { background: var(--bg); padding: 16px; border-radius: 8px; font-family: monospace; font-size: 0.9rem; margin-top: 16px; }
        .formula-title { font-size: 0.85rem; color: var(--text2); margin-bottom: 8px; }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">â† è¿”å›</a>
        <h1>ğŸ’µ åˆ©æ¶¦ç‡è®¡ç®—å™¨</h1>
        <p class="subtitle">è®¡ç®—æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡ã€æˆæœ¬åŠ æˆç‡ç­‰</p>
        
        <div class="tabs">
            <div class="tab active" data-mode="margin" onclick="setMode('margin')">åˆ©æ¶¦ç‡è®¡ç®—</div>
            <div class="tab" data-mode="pricing" onclick="setMode('pricing')">å®šä»·è®¡ç®—</div>
            <div class="tab" data-mode="breakeven" onclick="setMode('breakeven')">ç›ˆäºå¹³è¡¡</div>
        </div>
        
        <div id="marginSection">
            <div class="grid">
                <div class="card">
                    <div class="card-title">è¾“å…¥æ•°æ®</div>
                    <div class="form-group">
                        <label>é”€å”®æ”¶å…¥ (å…ƒ)</label>
                        <input type="number" id="revenue" value="100000" oninput="calculateMargin()">
                    </div>
                    <div class="form-group">
                        <label>æˆæœ¬ (å…ƒ)</label>
                        <input type="number" id="cost" value="60000" oninput="calculateMargin()">
                    </div>
                    <div class="form-group">
                        <label>è¿è¥è´¹ç”¨ (å…ƒï¼Œå¯é€‰)</label>
                        <input type="number" id="expenses" value="20000" oninput="calculateMargin()">
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">è®¡ç®—ç»“æœ</div>
                    <div class="result-grid">
                        <div class="result-item">
                            <div class="value" id="grossMargin">0%</div>
                            <div class="label">æ¯›åˆ©ç‡</div>
                        </div>
                        <div class="result-item">
                            <div class="value" id="netMargin">0%</div>
                            <div class="label">å‡€åˆ©ç‡</div>
                        </div>
                        <div class="result-item">
                            <div class="value" id="markup">0%</div>
                            <div class="label">æˆæœ¬åŠ æˆç‡</div>
                        </div>
                        <div class="result-item">
                            <div class="value" id="grossProfit">Â¥0</div>
                            <div class="label">æ¯›åˆ©æ¶¦</div>
                        </div>
                    </div>
                    
                    <div class="result-row" style="margin-top: 16px;">
                        <span>å‡€åˆ©æ¶¦</span>
                        <span id="netProfit">Â¥0</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="formula-title">å…¬å¼è¯´æ˜</div>
                <div class="formula">
                    æ¯›åˆ©ç‡ = (æ”¶å…¥ - æˆæœ¬) / æ”¶å…¥ Ã— 100%<br>
                    å‡€åˆ©ç‡ = (æ”¶å…¥ - æˆæœ¬ - è´¹ç”¨) / æ”¶å…¥ Ã— 100%<br>
                    æˆæœ¬åŠ æˆç‡ = (æ”¶å…¥ - æˆæœ¬) / æˆæœ¬ Ã— 100%
                </div>
            </div>
        </div>
        
        <div id="pricingSection" style="display: none;">
            <div class="grid">
                <div class="card">
                    <div class="card-title">å®šä»·å‚æ•°</div>
                    <div class="form-group">
                        <label>æˆæœ¬ä»· (å…ƒ)</label>
                        <input type="number" id="unitCost" value="100" oninput="calculatePricing()">
                    </div>
                    <div class="form-group">
                        <label>ç›®æ ‡åˆ©æ¶¦ç‡ (%)</label>
                        <input type="number" id="targetMargin" value="30" oninput="calculatePricing()">
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">å»ºè®®å”®ä»·</div>
                    <div class="result-item" style="padding: 24px;">
                        <div class="value" id="suggestedPrice" style="font-size: 2rem;">Â¥0</div>
                        <div class="label">åŸºäºç›®æ ‡åˆ©æ¶¦ç‡çš„å”®ä»·</div>
                    </div>
                    
                    <div class="result-row" style="margin-top: 16px;">
                        <span>å•ä»¶åˆ©æ¶¦</span>
                        <span id="unitProfit">Â¥0</span>
                    </div>
                    <div class="result-row">
                        <span>å®é™…åŠ æˆç‡</span>
                        <span id="actualMarkup">0%</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="breakevenSection" style="display: none;">
            <div class="grid">
                <div class="card">
                    <div class="card-title">æˆæœ¬ç»“æ„</div>
                    <div class="form-group">
                        <label>å›ºå®šæˆæœ¬ (å…ƒ/æœˆ)</label>
                        <input type="number" id="fixedCost" value="50000" oninput="calculateBreakeven()">
                    </div>
                    <div class="form-group">
                        <label>å•ä½å¯å˜æˆæœ¬ (å…ƒ)</label>
                        <input type="number" id="variableCost" value="60" oninput="calculateBreakeven()">
                    </div>
                    <div class="form-group">
                        <label>å•ä½å”®ä»· (å…ƒ)</label>
                        <input type="number" id="sellingPrice" value="100" oninput="calculateBreakeven()">
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">ç›ˆäºå¹³è¡¡åˆ†æ</div>
                    <div class="result-grid">
                        <div class="result-item">
                            <div class="value" id="breakevenUnits">0</div>
                            <div class="label">ç›ˆäºå¹³è¡¡é”€é‡</div>
                        </div>
                        <div class="result-item">
                            <div class="value" id="breakevenRevenue">Â¥0</div>
                            <div class="label">ç›ˆäºå¹³è¡¡æ”¶å…¥</div>
                        </div>
                        <div class="result-item">
                            <div class="value" id="contributionMargin">Â¥0</div>
                            <div class="label">å•ä½è¾¹é™…è´¡çŒ®</div>
                        </div>
                        <div class="result-item">
                            <div class="value" id="contributionRatio">0%</div>
                            <div class="label">è¾¹é™…è´¡çŒ®ç‡</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="formula-title">å…¬å¼è¯´æ˜</div>
                <div class="formula">
                    ç›ˆäºå¹³è¡¡ç‚¹(é”€é‡) = å›ºå®šæˆæœ¬ / (å”®ä»· - å¯å˜æˆæœ¬)<br>
                    è¾¹é™…è´¡çŒ® = å”®ä»· - å¯å˜æˆæœ¬<br>
                    è¾¹é™…è´¡çŒ®ç‡ = è¾¹é™…è´¡çŒ® / å”®ä»· Ã— 100%
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let currentMode = 'margin';
        
        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-mode="' + mode + '"]').classList.add('active');
            
            document.getElementById('marginSection').style.display = mode === 'margin' ? 'block' : 'none';
            document.getElementById('pricingSection').style.display = mode === 'pricing' ? 'block' : 'none';
            document.getElementById('breakevenSection').style.display = mode === 'breakeven' ? 'block' : 'none';
        }
        
        function calculateMargin() {
            const revenue = parseFloat(document.getElementById('revenue').value) || 0;
            const cost = parseFloat(document.getElementById('cost').value) || 0;
            const expenses = parseFloat(document.getElementById('expenses').value) || 0;
            
            const grossProfit = revenue - cost;
            const netProfit = revenue - cost - expenses;
            
            const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
            const netMargin = revenue > 0 ? (netProfit / revenue) * 100 : 0;
            const markup = cost > 0 ? (grossProfit / cost) * 100 : 0;
            
            const fmt = (n) => 'Â¥' + n.toLocaleString('zh-CN', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            
            document.getElementById('grossMargin').textContent = grossMargin.toFixed(1) + '%';
            document.getElementById('netMargin').textContent = netMargin.toFixed(1) + '%';
            document.getElementById('markup').textContent = markup.toFixed(1) + '%';
            document.getElementById('grossProfit').textContent = fmt(grossProfit);
            document.getElementById('netProfit').textContent = fmt(netProfit);
        }
        
        function calculatePricing() {
            const unitCost = parseFloat(document.getElementById('unitCost').value) || 0;
            const targetMargin = parseFloat(document.getElementById('targetMargin').value) / 100 || 0;
            
            // å”®ä»· = æˆæœ¬ / (1 - ç›®æ ‡åˆ©æ¶¦ç‡)
            const suggestedPrice = targetMargin < 1 ? unitCost / (1 - targetMargin) : 0;
            const unitProfit = suggestedPrice - unitCost;
            const actualMarkup = unitCost > 0 ? (unitProfit / unitCost) * 100 : 0;
            
            const fmt = (n) => 'Â¥' + n.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            
            document.getElementById('suggestedPrice').textContent = fmt(suggestedPrice);
            document.getElementById('unitProfit').textContent = fmt(unitProfit);
            document.getElementById('actualMarkup').textContent = actualMarkup.toFixed(1) + '%';
        }
        
        function calculateBreakeven() {
            const fixedCost = parseFloat(document.getElementById('fixedCost').value) || 0;
            const variableCost = parseFloat(document.getElementById('variableCost').value) || 0;
            const sellingPrice = parseFloat(document.getElementById('sellingPrice').value) || 0;
            
            const contributionMargin = sellingPrice - variableCost;
            const contributionRatio = sellingPrice > 0 ? (contributionMargin / sellingPrice) * 100 : 0;
            
            const breakevenUnits = contributionMargin > 0 ? Math.ceil(fixedCost / contributionMargin) : 0;
            const breakevenRevenue = breakevenUnits * sellingPrice;
            
            const fmt = (n) => 'Â¥' + n.toLocaleString('zh-CN', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            
            document.getElementById('breakevenUnits').textContent = breakevenUnits.toLocaleString() + ' ä»¶';
            document.getElementById('breakevenRevenue').textContent = fmt(breakevenRevenue);
            document.getElementById('contributionMargin').textContent = fmt(contributionMargin);
            document.getElementById('contributionRatio').textContent = contributionRatio.toFixed(1) + '%';
        }
        
        calculateMargin();
        calculatePricing();
        calculateBreakeven();
    </script>
</body>
</html>
