<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ˜æ‰£è®¡ç®—å™¨ - WebUtils</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --spacing-card: 1.5rem;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        .theme-toggle {
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.5rem;
            padding: 0.5rem;
        }
        .calc-mode {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .calc-mode button {
            flex: 1;
            margin: 0;
        }
        .calc-mode button.active {
            background: var(--pico-primary);
            color: var(--pico-primary-inverse);
        }
        .result-card {
            background: var(--pico-card-background-color);
            border-radius: var(--pico-border-radius);
            padding: var(--spacing-card);
            margin-top: 1.5rem;
        }
        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--pico-muted-border-color);
        }
        .result-row:last-child {
            border-bottom: none;
        }
        .result-label {
            color: var(--pico-muted-color);
        }
        .result-value {
            font-weight: bold;
            font-size: 1.1rem;
        }
        .highlight {
            color: var(--pico-primary);
            font-size: 1.3rem;
        }
        .savings {
            color: #22c55e;
        }
        .input-section {
            display: none;
        }
        .input-section.active {
            display: block;
        }
        .discount-presets {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        .discount-presets button {
            flex: 1;
            min-width: 50px;
            padding: 0.5rem;
            margin: 0;
            font-size: 0.85rem;
        }
        .discount-presets button.active {
            background: var(--pico-primary);
            color: var(--pico-primary-inverse);
        }
    
        .breadcrumb { position: fixed; top: 10px; left: 10px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-size: 0.85rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 5px; }
    </style>
</head>
<body>
    <nav class="breadcrumb"><a href="../../index.html">é¦–é¡µ</a><span>â€º</span><a href="../../index.html#calculator">è®¡ç®—å™¨</a><span>â€º</span>æŠ˜æ‰£è®¡ç®—å™¨</nav>
    <main class="container">
        <a href="../../index.html" style="display:inline-block;margin-bottom:1rem;color:var(--pico-primary);text-decoration:none;">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ğŸ·ï¸ æŠ˜æ‰£è®¡ç®—å™¨</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
        </header>

        <article>
            <label>è®¡ç®—æ¨¡å¼</label>
            <div class="calc-mode">
                <button class="active" onclick="setMode('calcFinal')">ç®—åˆ°æ‰‹ä»·</button>
                <button onclick="setMode('calcDiscount')">ç®—æŠ˜æ‰£</button>
                <button onclick="setMode('calcOriginal')">ç®—åŸä»·</button>
            </div>

            <!-- æ¨¡å¼1: å·²çŸ¥åŸä»·å’ŒæŠ˜æ‰£ï¼Œç®—åˆ°æ‰‹ä»· -->
            <div id="mode-calcFinal" class="input-section active">
                <label for="original1">
                    åŸä»·
                    <input type="number" id="original1" placeholder="è¯·è¾“å…¥åŸä»·" min="0" step="0.01" oninput="calculate()">
                </label>
                
                <label>å¿«é€Ÿé€‰æ‹©æŠ˜æ‰£</label>
                <div class="discount-presets">
                    <button onclick="setDiscount(50)">5æŠ˜</button>
                    <button onclick="setDiscount(60)">6æŠ˜</button>
                    <button onclick="setDiscount(70)">7æŠ˜</button>
                    <button onclick="setDiscount(80)">8æŠ˜</button>
                    <button onclick="setDiscount(85)">8.5æŠ˜</button>
                    <button onclick="setDiscount(90)">9æŠ˜</button>
                    <button onclick="setDiscount(95)">9.5æŠ˜</button>
                </div>
                
                <label for="discount1">
                    æŠ˜æ‰£ (å¦‚ï¼š8æŠ˜è¾“å…¥80ï¼Œæ‰“7æŠ˜è¾“å…¥70)
                    <input type="number" id="discount1" placeholder="è¾“å…¥æŠ˜æ‰£ï¼Œå¦‚80è¡¨ç¤º8æŠ˜" min="0" max="100" step="1" oninput="calculate()">
                </label>
            </div>

            <!-- æ¨¡å¼2: å·²çŸ¥åŸä»·å’Œåˆ°æ‰‹ä»·ï¼Œç®—æŠ˜æ‰£ -->
            <div id="mode-calcDiscount" class="input-section">
                <label for="original2">
                    åŸä»·
                    <input type="number" id="original2" placeholder="è¯·è¾“å…¥åŸä»·" min="0" step="0.01" oninput="calculate()">
                </label>
                <label for="final2">
                    åˆ°æ‰‹ä»·
                    <input type="number" id="final2" placeholder="è¯·è¾“å…¥åˆ°æ‰‹ä»·" min="0" step="0.01" oninput="calculate()">
                </label>
            </div>

            <!-- æ¨¡å¼3: å·²çŸ¥åˆ°æ‰‹ä»·å’ŒæŠ˜æ‰£ï¼Œç®—åŸä»· -->
            <div id="mode-calcOriginal" class="input-section">
                <label for="final3">
                    åˆ°æ‰‹ä»·
                    <input type="number" id="final3" placeholder="è¯·è¾“å…¥åˆ°æ‰‹ä»·" min="0" step="0.01" oninput="calculate()">
                </label>
                <label for="discount3">
                    æŠ˜æ‰£ (å¦‚ï¼š8æŠ˜è¾“å…¥80)
                    <input type="number" id="discount3" placeholder="è¾“å…¥æŠ˜æ‰£ï¼Œå¦‚80è¡¨ç¤º8æŠ˜" min="1" max="100" step="1" oninput="calculate()">
                </label>
            </div>
        </article>

        <div class="result-card">
            <h3>è®¡ç®—ç»“æœ</h3>
            <div class="result-row">
                <span class="result-label">åŸä»·</span>
                <span class="result-value" id="resultOriginal">Â¥0.00</span>
            </div>
            <div class="result-row">
                <span class="result-label">æŠ˜æ‰£</span>
                <span class="result-value" id="resultDiscount">0æŠ˜</span>
            </div>
            <div class="result-row">
                <span class="result-label">åˆ°æ‰‹ä»·</span>
                <span class="result-value highlight" id="resultFinal">Â¥0.00</span>
            </div>
            <div class="result-row">
                <span class="result-label">èŠ‚çœé‡‘é¢</span>
                <span class="result-value savings" id="resultSavings">Â¥0.00</span>
            </div>
            <div class="result-row">
                <span class="result-label">èŠ‚çœæ¯”ä¾‹</span>
                <span class="result-value savings" id="resultSavingsPercent">0%</span>
            </div>
        </div>
    </main>

    <script>
        let currentMode = 'calcFinal';

        // ä¸»é¢˜åˆ‡æ¢
        window.toggleTheme = function() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        };

        // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();

        // è®¾ç½®è®¡ç®—æ¨¡å¼
        window.setMode = function(mode) {
            currentMode = mode;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.calc-mode button').forEach((btn, index) => {
                btn.classList.remove('active');
                if ((mode === 'calcFinal' && index === 0) ||
                    (mode === 'calcDiscount' && index === 1) ||
                    (mode === 'calcOriginal' && index === 2)) {
                    btn.classList.add('active');
                }
            });
            
            // æ˜¾ç¤ºå¯¹åº”è¾“å…¥åŒºåŸŸ
            document.querySelectorAll('.input-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById('mode-' + mode).classList.add('active');
            
            calculate();
        };

        // è®¾ç½®é¢„è®¾æŠ˜æ‰£
        window.setDiscount = function(discount) {
            document.getElementById('discount1').value = discount;
            
            document.querySelectorAll('.discount-presets button').forEach(btn => {
                btn.classList.remove('active');
                const btnDiscount = parseInt(btn.textContent) * 10;
                if (btnDiscount === discount) {
                    btn.classList.add('active');
                }
            });
            
            calculate();
        };

        // è®¡ç®—
        window.calculate = function() {
            let original = 0, discount = 0, final = 0, savings = 0, savingsPercent = 0;

            if (currentMode === 'calcFinal') {
                original = parseFloat(document.getElementById('original1').value) || 0;
                discount = parseFloat(document.getElementById('discount1').value) || 0;
                final = original * (discount / 100);
                
                // æ›´æ–°é¢„è®¾æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.discount-presets button').forEach(btn => {
                    btn.classList.remove('active');
                    const btnDiscount = parseFloat(btn.textContent) * 10;
                    if (btnDiscount === discount) {
                        btn.classList.add('active');
                    }
                });
            } else if (currentMode === 'calcDiscount') {
                original = parseFloat(document.getElementById('original2').value) || 0;
                final = parseFloat(document.getElementById('final2').value) || 0;
                discount = original > 0 ? (final / original) * 100 : 0;
            } else if (currentMode === 'calcOriginal') {
                final = parseFloat(document.getElementById('final3').value) || 0;
                discount = parseFloat(document.getElementById('discount3').value) || 0;
                original = discount > 0 ? final / (discount / 100) : 0;
            }

            savings = original - final;
            savingsPercent = original > 0 ? (savings / original) * 100 : 0;

            document.getElementById('resultOriginal').textContent = 'Â¥' + original.toFixed(2);
            document.getElementById('resultDiscount').textContent = (discount / 10).toFixed(1) + 'æŠ˜';
            document.getElementById('resultFinal').textContent = 'Â¥' + final.toFixed(2);
            document.getElementById('resultSavings').textContent = 'Â¥' + savings.toFixed(2);
            document.getElementById('resultSavingsPercent').textContent = savingsPercent.toFixed(1) + '%';
        };

        // åˆå§‹è®¡ç®—
        calculate();
    </script>
</body>
</html>
