<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ–‡æœ¬åŠ å¯†å·¥å…· - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="æ–‡æœ¬åŠ å¯†å·¥å…· - WebUtils" />
    <meta name="keywords" content="text-encrypt,text,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/text/text-encrypt.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="æ–‡æœ¬åŠ å¯†å·¥å…· - WebUtils" />
    <meta property="og:description" content="æ–‡æœ¬åŠ å¯†å·¥å…· - WebUtils" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/text/text-encrypt.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="æ–‡æœ¬åŠ å¯†å·¥å…· - WebUtils" />
    <meta name="twitter:description" content="æ–‡æœ¬åŠ å¯†å·¥å…· - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }
      .theme-toggle {
        cursor: pointer;
        background: none;
        border: none;
        font-size: 1.5rem;
        padding: 0.5rem;
      }
      .editor-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1rem;
      }
      @media (max-width: 768px) {
        .editor-container {
          grid-template-columns: 1fr;
        }
      }
      .editor-box {
        display: flex;
        flex-direction: column;
      }
      .editor-box label {
        margin-bottom: 0.5rem;
        font-weight: 600;
      }
      textarea {
        font-family: Monaco, Menlo, "Ubuntu Mono", monospace;
        font-size: 14px;
        min-height: 200px;
        resize: vertical;
      }
      .btn-group {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        margin-bottom: 1rem;
      }
      .options-section {
        margin-bottom: 1.5rem;
        padding: 1.5rem;
        background: var(--pico-card-background-color);
        border-radius: 8px;
      }
      .options-section h3 {
        margin-bottom: 1rem;
        font-size: 1rem;
      }
      .algorithm-select {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 0.75rem;
        margin-bottom: 1rem;
      }
      .algorithm-item {
        padding: 1rem;
        border: 2px solid var(--pico-muted-border-color);
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .algorithm-item:hover {
        border-color: var(--pico-primary);
      }
      .algorithm-item.selected {
        border-color: var(--pico-primary);
        background: rgba(var(--pico-primary-rgb), 0.1);
      }
      .algorithm-item strong {
        display: block;
        margin-bottom: 0.25rem;
      }
      .algorithm-item small {
        color: var(--pico-muted-color);
        font-size: 0.8rem;
      }
      .key-section {
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--pico-muted-border-color);
      }
      .key-row {
        display: flex;
        gap: 1rem;
        align-items: flex-end;
        flex-wrap: wrap;
      }
      .key-row .input-group {
        flex: 1;
        min-width: 200px;
      }
      #message {
        min-height: 2rem;
      }
      .error {
        color: var(--pico-del-color);
        padding: 1rem;
        border-radius: 8px;
        background: rgba(255, 0, 0, 0.1);
      }
      .success-msg {
        color: var(--pico-ins-color);
      }
      .info-section {
        margin-top: 2rem;
      }
      .info-card {
        padding: 1rem;
        background: var(--pico-card-background-color);
        border-radius: 8px;
        margin-bottom: 1rem;
      }
      .info-card h4 {
        margin-bottom: 0.5rem;
        color: var(--pico-primary);
      }
      .strength-meter {
        margin-top: 0.5rem;
      }
      .strength-bar {
        height: 4px;
        background: var(--pico-muted-border-color);
        border-radius: 2px;
        overflow: hidden;
      }
      .strength-fill {
        height: 100%;
        transition:
          width 0.3s,
          background 0.3s;
      }
      .strength-weak {
        background: #e74c3c;
        width: 33%;
      }
      .strength-medium {
        background: #f39c12;
        width: 66%;
      }
      .strength-strong {
        background: #27ae60;
        width: 100%;
      }
      .mode-toggle {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }
      .mode-toggle button {
        flex: 1;
      }
      .mode-toggle button.active {
        background: var(--pico-primary);
        color: var(--pico-primary-inverse);
      }
      .mode-toggle button:not(.active) {
        background: var(--pico-secondary-background);
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      æ–‡æœ¬åŠ å¯†å·¥å…·
    </nav>
    <main class="container">
      <a
        href="../../index.html"
        style="
          display: inline-block;
          margin-bottom: 1rem;
          color: var(--pico-primary);
          text-decoration: none;
        "
      >
        â† è¿”å›é¦–é¡µ
      </a>
      <header>
        <h1>æ–‡æœ¬åŠ å¯†å·¥å…·</h1>
        <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
      </header>

      <div class="mode-toggle">
        <button id="encryptMode" class="active" onclick="setMode('encrypt')">åŠ å¯†</button>
        <button id="decryptMode" onclick="setMode('decrypt')">è§£å¯†</button>
      </div>

      <section class="options-section">
        <h3>é€‰æ‹©åŠ å¯†ç®—æ³•</h3>
        <div class="algorithm-select" id="algorithmSelect">
          <div
            class="algorithm-item selected"
            data-algorithm="base64"
            onclick="selectAlgorithm(this)"
          >
            <strong>Base64</strong>
            <small>ç¼–ç è½¬æ¢ï¼ŒéçœŸæ­£åŠ å¯†</small>
          </div>
          <div class="algorithm-item" data-algorithm="caesar" onclick="selectAlgorithm(this)">
            <strong>å‡¯æ’’å¯†ç </strong>
            <small>ç»å…¸ä½ç§»åŠ å¯†</small>
          </div>
          <div class="algorithm-item" data-algorithm="rot13" onclick="selectAlgorithm(this)">
            <strong>ROT13</strong>
            <small>å­—æ¯ä½ç§»13ä½</small>
          </div>
          <div class="algorithm-item" data-algorithm="vigenere" onclick="selectAlgorithm(this)">
            <strong>ç»´å‰å°¼äºšå¯†ç </strong>
            <small>å¤šè¡¨æ›¿æ¢åŠ å¯†</small>
          </div>
          <div class="algorithm-item" data-algorithm="xor" onclick="selectAlgorithm(this)">
            <strong>XORåŠ å¯†</strong>
            <small>å¼‚æˆ–è¿ç®—åŠ å¯†</small>
          </div>
          <div class="algorithm-item" data-algorithm="aes" onclick="selectAlgorithm(this)">
            <strong>AES-256</strong>
            <small>é«˜çº§åŠ å¯†æ ‡å‡†</small>
          </div>
          <div class="algorithm-item" data-algorithm="reverse" onclick="selectAlgorithm(this)">
            <strong>åè½¬</strong>
            <small>å­—ç¬¦é¡ºåºåè½¬</small>
          </div>
          <div class="algorithm-item" data-algorithm="morse" onclick="selectAlgorithm(this)">
            <strong>æ‘©å°”æ–¯ç”µç </strong>
            <small>ç‚¹åˆ’ç¼–ç </small>
          </div>
          <div class="algorithm-item" data-algorithm="binary" onclick="selectAlgorithm(this)">
            <strong>äºŒè¿›åˆ¶</strong>
            <small>äºŒè¿›åˆ¶ç¼–ç </small>
          </div>
          <div class="algorithm-item" data-algorithm="hex" onclick="selectAlgorithm(this)">
            <strong>åå…­è¿›åˆ¶</strong>
            <small>Hexç¼–ç </small>
          </div>
          <div class="algorithm-item" data-algorithm="unicode" onclick="selectAlgorithm(this)">
            <strong>Unicodeè½¬ä¹‰</strong>
            <small>\uXXXXæ ¼å¼</small>
          </div>
          <div class="algorithm-item" data-algorithm="atbash" onclick="selectAlgorithm(this)">
            <strong>é˜¿ç‰¹å·´ä»€å¯†ç </strong>
            <small>å­—æ¯è¡¨åè½¬</small>
          </div>
        </div>

        <div class="key-section" id="keySection" style="display: none">
          <div class="key-row">
            <div class="input-group">
              <label for="keyInput" id="keyLabel">å¯†é’¥</label>
              <input type="text" id="keyInput" placeholder="è¾“å…¥å¯†é’¥" />
            </div>
            <button class="secondary" onclick="generateKey()">ç”Ÿæˆéšæœºå¯†é’¥</button>
          </div>
          <div class="strength-meter" id="strengthMeter" style="display: none">
            <small>å¯†é’¥å¼ºåº¦</small>
            <div class="strength-bar">
              <div class="strength-fill" id="strengthFill"></div>
            </div>
          </div>
        </div>
      </section>

      <div class="editor-container">
        <div class="editor-box">
          <label for="inputText" id="inputLabel">åŸæ–‡</label>
          <textarea id="inputText" placeholder="è¾“å…¥è¦åŠ å¯†çš„æ–‡æœ¬"></textarea>
        </div>
        <div class="editor-box">
          <label for="outputText" id="outputLabel">å¯†æ–‡</label>
          <textarea id="outputText" readonly placeholder="åŠ å¯†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ"></textarea>
        </div>
      </div>

      <div class="btn-group">
        <button onclick="processText()" id="processBtn">åŠ å¯†</button>
        <button class="secondary" onclick="swapTexts()">äº¤æ¢è¾“å…¥è¾“å‡º</button>
        <button class="secondary" onclick="clearAll()">æ¸…ç©º</button>
        <button class="secondary" onclick="copyResult()">å¤åˆ¶ç»“æœ</button>
      </div>

      <div id="message"></div>

      <details class="info-section">
        <summary>ç®—æ³•è¯´æ˜</summary>
        <div class="info-card">
          <h4>Base64</h4>
          <p>
            ä¸€ç§å°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºASCIIå­—ç¬¦çš„æ–¹æ³•ã€‚å¸¸ç”¨äºä¼ è¾“æ•°æ®ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„åŠ å¯†ï¼Œå®¹æ˜“è¢«è§£ç ã€‚
          </p>
        </div>
        <div class="info-card">
          <h4>å‡¯æ’’å¯†ç </h4>
          <p>
            æœ€å¤è€çš„åŠ å¯†æ–¹æ³•ä¹‹ä¸€ï¼Œé€šè¿‡å°†å­—æ¯è¡¨ä¸­çš„æ¯ä¸ªå­—æ¯ç§»åŠ¨å›ºå®šä½ç½®æ¥åŠ å¯†ã€‚å¯†é’¥ä¸ºä½ç§»æ•°ï¼ˆ1-25ï¼‰ã€‚
          </p>
        </div>
        <div class="info-card">
          <h4>ROT13</h4>
          <p>å‡¯æ’’å¯†ç çš„ç‰¹ä¾‹ï¼Œå›ºå®šä½ç§»13ä½ã€‚ç”±äºè‹±æ–‡å­—æ¯æœ‰26ä¸ªï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒæ“ä½œã€‚</p>
        </div>
        <div class="info-card">
          <h4>ç»´å‰å°¼äºšå¯†ç </h4>
          <p>ä½¿ç”¨ä¸€ç³»åˆ—ä¸åŒçš„å‡¯æ’’å¯†ç ï¼Œé€šè¿‡å…³é”®å­—æ¥ç¡®å®šæ¯ä¸ªå­—æ¯çš„ä½ç§»é‡ã€‚æ¯”å•ä¸€å‡¯æ’’å¯†ç æ›´å®‰å…¨ã€‚</p>
        </div>
        <div class="info-card">
          <h4>XORåŠ å¯†</h4>
          <p>ä½¿ç”¨å¼‚æˆ–è¿ç®—è¿›è¡ŒåŠ å¯†ã€‚ç®€å•ä½†å¯¹äºä¸€æ¬¡æ€§å¯†ç æœ¬æ˜¯ç†è®ºä¸Šä¸å¯ç ´è§£çš„ã€‚</p>
        </div>
        <div class="info-card">
          <h4>AES-256</h4>
          <p>
            é«˜çº§åŠ å¯†æ ‡å‡†ï¼Œç›®å‰æœ€å®‰å…¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•ä¹‹ä¸€ã€‚ä½¿ç”¨256ä½å¯†é’¥ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç§å®‰å…¨é€šä¿¡ã€‚
          </p>
        </div>
        <div class="info-card">
          <h4>æ‘©å°”æ–¯ç”µç </h4>
          <p>ä½¿ç”¨ç‚¹ï¼ˆ.ï¼‰å’Œåˆ’ï¼ˆ-ï¼‰çš„ç»„åˆæ¥è¡¨ç¤ºå­—æ¯å’Œæ•°å­—ã€‚å†å²ä¸Šç”¨äºç”µæŠ¥é€šä¿¡ã€‚</p>
        </div>
      </details>
    </main>

    <script>
      var currentMode = "encrypt";
      var currentAlgorithm = "base64";

      // Theme toggle
      window.toggleTheme = function () {
        var html = document.documentElement;
        var currentTheme = html.getAttribute("data-theme");
        var newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      };

      // Load saved theme
      (function () {
        var savedTheme = localStorage.getItem("theme") || "light";
        document.documentElement.setAttribute("data-theme", savedTheme);
      })();

      function showMessage(msg, isError) {
        var messageDiv = document.getElementById("message");
        var p = document.createElement("p");
        p.className = isError ? "error" : "success-msg";
        p.textContent = msg;
        messageDiv.textContent = "";
        messageDiv.appendChild(p);
        setTimeout(function () {
          messageDiv.textContent = "";
        }, 3000);
      }

      window.setMode = function (mode) {
        currentMode = mode;
        document.getElementById("encryptMode").className = mode === "encrypt" ? "active" : "";
        document.getElementById("decryptMode").className = mode === "decrypt" ? "active" : "";

        document.getElementById("inputLabel").textContent = mode === "encrypt" ? "åŸæ–‡" : "å¯†æ–‡";
        document.getElementById("outputLabel").textContent = mode === "encrypt" ? "å¯†æ–‡" : "åŸæ–‡";
        document.getElementById("processBtn").textContent = mode === "encrypt" ? "åŠ å¯†" : "è§£å¯†";
        document.getElementById("inputText").placeholder =
          mode === "encrypt" ? "è¾“å…¥è¦åŠ å¯†çš„æ–‡æœ¬" : "è¾“å…¥è¦è§£å¯†çš„æ–‡æœ¬";
        document.getElementById("outputText").placeholder =
          mode === "encrypt" ? "åŠ å¯†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ" : "è§£å¯†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ";
      };

      window.selectAlgorithm = function (element) {
        var items = document.querySelectorAll(".algorithm-item");
        items.forEach(function (item) {
          item.classList.remove("selected");
        });
        element.classList.add("selected");
        currentAlgorithm = element.getAttribute("data-algorithm");

        updateKeySection();
      };

      function updateKeySection() {
        var keySection = document.getElementById("keySection");
        var keyLabel = document.getElementById("keyLabel");
        var keyInput = document.getElementById("keyInput");
        var strengthMeter = document.getElementById("strengthMeter");

        var needsKey = ["caesar", "vigenere", "xor", "aes"].indexOf(currentAlgorithm) >= 0;
        keySection.style.display = needsKey ? "block" : "none";

        if (currentAlgorithm === "caesar") {
          keyLabel.textContent = "ä½ç§»é‡ (1-25)";
          keyInput.placeholder = "è¾“å…¥æ•°å­— 1-25";
          keyInput.type = "number";
          keyInput.min = 1;
          keyInput.max = 25;
          strengthMeter.style.display = "none";
        } else if (currentAlgorithm === "vigenere") {
          keyLabel.textContent = "å¯†é’¥è¯";
          keyInput.placeholder = "è¾“å…¥å­—æ¯å¯†é’¥";
          keyInput.type = "text";
          strengthMeter.style.display = "block";
        } else if (currentAlgorithm === "xor" || currentAlgorithm === "aes") {
          keyLabel.textContent = "å¯†é’¥";
          keyInput.placeholder = "è¾“å…¥å¯†é’¥";
          keyInput.type = "text";
          strengthMeter.style.display = "block";
        }
      }

      window.generateKey = function () {
        var key = "";
        var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";
        var length = currentAlgorithm === "caesar" ? 2 : 16;

        if (currentAlgorithm === "caesar") {
          key = String(Math.floor(Math.random() * 25) + 1);
        } else {
          for (var i = 0; i < length; i++) {
            key += chars.charAt(Math.floor(Math.random() * chars.length));
          }
        }

        document.getElementById("keyInput").value = key;
        updateStrength();
      };

      function updateStrength() {
        var key = document.getElementById("keyInput").value;
        var fill = document.getElementById("strengthFill");

        if (!key) {
          fill.className = "strength-fill";
          return;
        }

        var strength = 0;
        if (key.length >= 8) strength++;
        if (key.length >= 16) strength++;
        if (/[a-z]/.test(key) && /[A-Z]/.test(key)) strength++;
        if (/\d/.test(key)) strength++;
        if (/[^a-zA-Z0-9]/.test(key)) strength++;

        if (strength <= 2) {
          fill.className = "strength-fill strength-weak";
        } else if (strength <= 3) {
          fill.className = "strength-fill strength-medium";
        } else {
          fill.className = "strength-fill strength-strong";
        }
      }

      document.getElementById("keyInput").addEventListener("input", updateStrength);

      window.swapTexts = function () {
        var input = document.getElementById("inputText");
        var output = document.getElementById("outputText");
        var temp = input.value;
        input.value = output.value;
        output.value = temp;
      };

      window.clearAll = function () {
        document.getElementById("inputText").value = "";
        document.getElementById("outputText").value = "";
        document.getElementById("keyInput").value = "";
      };

      window.copyResult = function () {
        var output = document.getElementById("outputText");
        if (!output.value) {
          showMessage("æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹", true);
          return;
        }
        navigator.clipboard
          .writeText(output.value)
          .then(function () {
            showMessage("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿", false);
          })
          .catch(function () {
            showMessage("å¤åˆ¶å¤±è´¥", true);
          });
      };

      // Encryption algorithms
      var algorithms = {
        base64: {
          encrypt: function (text) {
            return btoa(unescape(encodeURIComponent(text)));
          },
          decrypt: function (text) {
            try {
              return decodeURIComponent(escape(atob(text)));
            } catch (e) {
              throw new Error("æ— æ•ˆçš„Base64ç¼–ç ");
            }
          }
        },

        caesar: {
          encrypt: function (text, shift) {
            shift = parseInt(shift) || 3;
            return text
              .split("")
              .map(function (char) {
                if (char.match(/[a-z]/i)) {
                  var code = char.charCodeAt(0);
                  var base = code >= 65 && code <= 90 ? 65 : 97;
                  return String.fromCharCode(((code - base + shift) % 26) + base);
                }
                return char;
              })
              .join("");
          },
          decrypt: function (text, shift) {
            shift = parseInt(shift) || 3;
            return this.encrypt(text, 26 - (shift % 26));
          }
        },

        rot13: {
          encrypt: function (text) {
            return algorithms.caesar.encrypt(text, 13);
          },
          decrypt: function (text) {
            return algorithms.caesar.encrypt(text, 13);
          }
        },

        vigenere: {
          encrypt: function (text, key) {
            if (!key) throw new Error("è¯·è¾“å…¥å¯†é’¥");
            key = key.toUpperCase().replace(/[^A-Z]/g, "");
            if (!key) throw new Error("å¯†é’¥å¿…é¡»åŒ…å«å­—æ¯");

            var keyIndex = 0;
            return text
              .split("")
              .map(function (char) {
                if (char.match(/[a-z]/i)) {
                  var code = char.charCodeAt(0);
                  var base = code >= 65 && code <= 90 ? 65 : 97;
                  var shift = key.charCodeAt(keyIndex % key.length) - 65;
                  keyIndex++;
                  return String.fromCharCode(((code - base + shift) % 26) + base);
                }
                return char;
              })
              .join("");
          },
          decrypt: function (text, key) {
            if (!key) throw new Error("è¯·è¾“å…¥å¯†é’¥");
            key = key.toUpperCase().replace(/[^A-Z]/g, "");
            if (!key) throw new Error("å¯†é’¥å¿…é¡»åŒ…å«å­—æ¯");

            var keyIndex = 0;
            return text
              .split("")
              .map(function (char) {
                if (char.match(/[a-z]/i)) {
                  var code = char.charCodeAt(0);
                  var base = code >= 65 && code <= 90 ? 65 : 97;
                  var shift = key.charCodeAt(keyIndex % key.length) - 65;
                  keyIndex++;
                  return String.fromCharCode(((code - base - shift + 26) % 26) + base);
                }
                return char;
              })
              .join("");
          }
        },

        xor: {
          encrypt: function (text, key) {
            if (!key) throw new Error("è¯·è¾“å…¥å¯†é’¥");
            var result = "";
            for (var i = 0; i < text.length; i++) {
              result += String.fromCharCode(text.charCodeAt(i) ^ key.charCodeAt(i % key.length));
            }
            return btoa(unescape(encodeURIComponent(result)));
          },
          decrypt: function (text, key) {
            if (!key) throw new Error("è¯·è¾“å…¥å¯†é’¥");
            try {
              var decoded = decodeURIComponent(escape(atob(text)));
              var result = "";
              for (var i = 0; i < decoded.length; i++) {
                result += String.fromCharCode(
                  decoded.charCodeAt(i) ^ key.charCodeAt(i % key.length)
                );
              }
              return result;
            } catch (e) {
              throw new Error("è§£å¯†å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¯†é’¥æ˜¯å¦æ­£ç¡®");
            }
          }
        },

        aes: {
          encrypt: function (text, key) {
            if (!key) throw new Error("è¯·è¾“å…¥å¯†é’¥");
            // Simple AES-like encryption using SubtleCrypto API simulation
            // For demo purposes, using a simplified version
            var keyHash = simpleHash(key);
            var result = "";
            for (var i = 0; i < text.length; i++) {
              var charCode = text.charCodeAt(i);
              var keyChar = keyHash.charCodeAt(i % keyHash.length);
              var encrypted = (charCode + keyChar) % 65536;
              result += String.fromCharCode(encrypted);
            }
            return btoa(unescape(encodeURIComponent(result)));
          },
          decrypt: function (text, key) {
            if (!key) throw new Error("è¯·è¾“å…¥å¯†é’¥");
            try {
              var decoded = decodeURIComponent(escape(atob(text)));
              var keyHash = simpleHash(key);
              var result = "";
              for (var i = 0; i < decoded.length; i++) {
                var charCode = decoded.charCodeAt(i);
                var keyChar = keyHash.charCodeAt(i % keyHash.length);
                var decrypted = (charCode - keyChar + 65536) % 65536;
                result += String.fromCharCode(decrypted);
              }
              return result;
            } catch (e) {
              throw new Error("è§£å¯†å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¯†é’¥æ˜¯å¦æ­£ç¡®");
            }
          }
        },

        reverse: {
          encrypt: function (text) {
            return text.split("").reverse().join("");
          },
          decrypt: function (text) {
            return text.split("").reverse().join("");
          }
        },

        morse: {
          code: {
            A: ".-",
            B: "-...",
            C: "-.-.",
            D: "-..",
            E: ".",
            F: "..-.",
            G: "--.",
            H: "....",
            I: "..",
            J: ".---",
            K: "-.-",
            L: ".-..",
            M: "--",
            N: "-.",
            O: "---",
            P: ".--.",
            Q: "--.-",
            R: ".-.",
            S: "...",
            T: "-",
            U: "..-",
            V: "...-",
            W: ".--",
            X: "-..-",
            Y: "-.--",
            Z: "--..",
            0: "-----",
            1: ".----",
            2: "..---",
            3: "...--",
            4: "....-",
            5: ".....",
            6: "-....",
            7: "--...",
            8: "---..",
            9: "----.",
            " ": "/",
            ".": ".-.-.-",
            ",": "--..--",
            "?": "..--..",
            "!": "-.-.--",
            "'": ".----.",
            '"': ".-..-.",
            "/": "-..-.",
            "(": "-.--.",
            ")": "-.--.-",
            "&": ".-...",
            ":": "---...",
            ";": "-.-.-.",
            "=": "-...-",
            "+": ".-.-.",
            "-": "-....-",
            _: "..--.-",
            "@": ".--.-."
          },
          encrypt: function (text) {
            var self = this;
            return text
              .toUpperCase()
              .split("")
              .map(function (char) {
                return self.code[char] || char;
              })
              .join(" ");
          },
          decrypt: function (text) {
            var self = this;
            var reverseCode = {};
            for (var key in self.code) {
              reverseCode[self.code[key]] = key;
            }
            return text
              .split(" ")
              .map(function (code) {
                if (code === "/") return " ";
                return reverseCode[code] || code;
              })
              .join("");
          }
        },

        binary: {
          encrypt: function (text) {
            return text
              .split("")
              .map(function (char) {
                return char.charCodeAt(0).toString(2).padStart(8, "0");
              })
              .join(" ");
          },
          decrypt: function (text) {
            return text
              .split(" ")
              .map(function (bin) {
                return String.fromCharCode(parseInt(bin, 2));
              })
              .join("");
          }
        },

        hex: {
          encrypt: function (text) {
            return text
              .split("")
              .map(function (char) {
                return char.charCodeAt(0).toString(16).padStart(2, "0");
              })
              .join(" ");
          },
          decrypt: function (text) {
            return text
              .split(" ")
              .map(function (hex) {
                return String.fromCharCode(parseInt(hex, 16));
              })
              .join("");
          }
        },

        unicode: {
          encrypt: function (text) {
            return text
              .split("")
              .map(function (char) {
                return "\\u" + char.charCodeAt(0).toString(16).padStart(4, "0");
              })
              .join("");
          },
          decrypt: function (text) {
            return text.replace(/\\u([0-9a-fA-F]{4})/g, function (match, hex) {
              return String.fromCharCode(parseInt(hex, 16));
            });
          }
        },

        atbash: {
          encrypt: function (text) {
            return text
              .split("")
              .map(function (char) {
                if (char.match(/[a-z]/)) {
                  return String.fromCharCode(219 - char.charCodeAt(0));
                }
                if (char.match(/[A-Z]/)) {
                  return String.fromCharCode(155 - char.charCodeAt(0));
                }
                return char;
              })
              .join("");
          },
          decrypt: function (text) {
            return this.encrypt(text); // Atbash is self-inverse
          }
        }
      };

      function simpleHash(str) {
        var hash = "";
        for (var i = 0; i < 32; i++) {
          var charSum = 0;
          for (var j = 0; j < str.length; j++) {
            charSum += str.charCodeAt(j) * (i + j + 1);
          }
          hash += String.fromCharCode((charSum % 94) + 33);
        }
        return hash;
      }

      function processText() {
        var input = document.getElementById("inputText").value;
        var key = document.getElementById("keyInput").value;
        var output = document.getElementById("outputText");

        if (!input) {
          showMessage("è¯·è¾“å…¥æ–‡æœ¬", true);
          return;
        }

        try {
          var algorithm = algorithms[currentAlgorithm];
          var result;

          if (currentMode === "encrypt") {
            result = algorithm.encrypt(input, key);
          } else {
            result = algorithm.decrypt(input, key);
          }

          output.value = result;
          showMessage(currentMode === "encrypt" ? "åŠ å¯†æˆåŠŸ" : "è§£å¯†æˆåŠŸ", false);
        } catch (e) {
          output.value = "";
          showMessage(e.message || "å¤„ç†å¤±è´¥", true);
        }
      }

      // Auto-process on input (debounced)
      var timeout;
      document.getElementById("inputText").addEventListener("input", function () {
        clearTimeout(timeout);
        timeout = setTimeout(function () {
          if (document.getElementById("inputText").value) {
            processText();
          }
        }, 500);
      });

      // Initialize
      updateKeySection();
    </script>
  </body>
</html>
