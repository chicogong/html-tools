<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>打字速度测试 - HTML Tools</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg: #0a0a0f; --card: #12121a; --border: #2a2a3a; --text: #fff; --text2: #888; --accent: #8b5cf6; --success: #22c55e; --danger: #ef4444; --warning: #f59e0b; }
        @media (prefers-color-scheme: light) { :root { --bg: #f5f5f5; --card: #fff; --border: #e0e0e0; --text: #333; --text2: #666; } }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: var(--text2); margin-bottom: 24px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .card-title { font-size: 1rem; color: var(--text2); margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.2s; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text); }
        .btn:hover { opacity: 0.9; }
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .stats-bar { display: flex; justify-content: center; gap: 30px; margin-bottom: 20px; flex-wrap: wrap; }
        .stat { text-align: center; }
        .stat .value { font-size: 2rem; font-weight: 700; color: var(--accent); }
        .stat .label { font-size: 0.85rem; color: var(--text2); }
        .timer { font-size: 3rem; font-weight: 700; text-align: center; color: var(--accent); margin: 20px 0; }
        .typing-area { position: relative; }
        .sample-text { font-size: 1.2rem; line-height: 2; padding: 20px; background: var(--bg); border-radius: 8px; margin-bottom: 20px; font-family: 'Courier New', monospace; white-space: pre-wrap; word-break: break-all; }
        .sample-text .correct { color: var(--success); }
        .sample-text .wrong { color: var(--danger); background: rgba(239, 68, 68, 0.2); }
        .sample-text .current { background: var(--accent); color: white; padding: 2px 0; }
        .sample-text .pending { color: var(--text2); }
        .input-area { width: 100%; padding: 16px; border: 2px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1.2rem; font-family: 'Courier New', monospace; resize: none; }
        .input-area:focus { outline: none; border-color: var(--accent); }
        .progress-bar { height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; margin-bottom: 16px; }
        .progress-fill { height: 100%; background: var(--accent); transition: width 0.1s; }
        .result-hero { background: linear-gradient(135deg, var(--accent), #a855f7); padding: 32px; border-radius: 12px; text-align: center; color: white; margin-bottom: 20px; }
        .result-hero .big { font-size: 4rem; font-weight: 700; }
        .result-hero .unit { font-size: 1.2rem; opacity: 0.9; }
        .result-hero .label { opacity: 0.8; margin-bottom: 8px; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        @media (max-width: 600px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
        .stat-item { text-align: center; padding: 16px; background: var(--bg); border-radius: 8px; }
        .stat-item .value { font-size: 1.5rem; font-weight: 700; }
        .stat-item .label { font-size: 0.8rem; color: var(--text2); margin-top: 4px; }
        .stat-item.success .value { color: var(--success); }
        .stat-item.danger .value { color: var(--danger); }
        .hidden { display: none !important; }
        select { padding: 10px 16px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 1rem; }
        .mode-tabs { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .mode-tab { padding: 10px 20px; border: 1px solid var(--border); border-radius: 8px; background: transparent; color: var(--text); cursor: pointer; }
        .mode-tab.active { background: var(--accent); border-color: var(--accent); color: white; }
        .keyboard-hint { margin-top: 20px; padding: 16px; background: var(--bg); border-radius: 8px; }
        .keyboard-row { display: flex; justify-content: center; gap: 4px; margin-bottom: 4px; }
        .key { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; background: var(--card); border: 1px solid var(--border); border-radius: 6px; font-size: 0.85rem; font-family: monospace; }
        .key.highlight { background: var(--accent); color: white; border-color: var(--accent); }
        @media (max-width: 600px) { .key { width: 28px; height: 28px; font-size: 0.7rem; } }
            .back-link { display: inline-block; margin-bottom: 16px; color: var(--accent); text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">← 返回</a>
        <h1>⌨️ 打字速度测试</h1>
        <p class="subtitle">测试你的打字速度和准确率</p>
        
        <div id="setupPanel" class="card">
            <div class="card-title">测试设置</div>
            <div class="mode-tabs">
                <button class="mode-tab active" data-mode="cn">中文</button>
                <button class="mode-tab" data-mode="en">英文</button>
            </div>
            <div class="btn-group" style="margin-bottom: 20px;">
                <select id="duration">
                    <option value="30">30 秒</option>
                    <option value="60" selected>60 秒</option>
                    <option value="120">120 秒</option>
                </select>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="startTest()">开始测试</button>
            </div>
        </div>
        
        <div id="testPanel" class="hidden">
            <div class="card">
                <div class="stats-bar">
                    <div class="stat">
                        <div class="value" id="wpmLive">0</div>
                        <div class="label">WPM</div>
                    </div>
                    <div class="stat">
                        <div class="value" id="cpmLive">0</div>
                        <div class="label">CPM</div>
                    </div>
                    <div class="stat">
                        <div class="value" id="accuracyLive">100%</div>
                        <div class="label">准确率</div>
                    </div>
                </div>
                
                <div class="timer" id="timer">60</div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progress" style="width: 0%"></div>
                </div>
                
                <div class="typing-area">
                    <div class="sample-text" id="sampleText"></div>
                    <textarea class="input-area" id="inputArea" placeholder="点击此处开始打字..." rows="3" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                </div>
                
                <div class="keyboard-hint" id="keyboardHint">
                    <div class="keyboard-row" id="row1"></div>
                    <div class="keyboard-row" id="row2"></div>
                    <div class="keyboard-row" id="row3"></div>
                </div>
                
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn btn-outline" onclick="resetTest()">重新开始</button>
                </div>
            </div>
        </div>
        
        <div id="resultPanel" class="hidden">
            <div class="result-hero">
                <div class="label">打字速度</div>
                <div class="big" id="finalWpm">0</div>
                <div class="unit">WPM (字/分钟)</div>
            </div>
            
            <div class="card">
                <div class="card-title">详细数据</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="value" id="finalCpm">0</div>
                        <div class="label">CPM (字符/分钟)</div>
                    </div>
                    <div class="stat-item success">
                        <div class="value" id="finalAccuracy">0%</div>
                        <div class="label">准确率</div>
                    </div>
                    <div class="stat-item">
                        <div class="value" id="totalChars">0</div>
                        <div class="label">总字符数</div>
                    </div>
                    <div class="stat-item danger">
                        <div class="value" id="totalErrors">0</div>
                        <div class="label">错误数</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">速度参考</div>
                <div style="font-size: 0.9rem; color: var(--text2); line-height: 1.8;">
                    <p>• 0-20 WPM：初学者</p>
                    <p>• 20-40 WPM：普通水平</p>
                    <p>• 40-60 WPM：熟练水平</p>
                    <p>• 60-80 WPM：专业水平</p>
                    <p>• 80+ WPM：打字高手</p>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" onclick="startTest()">再测一次</button>
                <button class="btn btn-outline" onclick="backToSetup()">返回设置</button>
            </div>
        </div>
    </div>
    
    <script>
        const chineseTexts = [
            "春眠不觉晓，处处闻啼鸟。夜来风雨声，花落知多少。这是一首描写春天早晨的诗，诗人在睡梦中被鸟鸣声唤醒，想起昨夜的风雨，不禁担忧花儿凋落了多少。",
            "人工智能正在改变我们的生活方式。从智能手机助手到自动驾驶汽车，从医疗诊断到金融分析，人工智能技术已经渗透到各行各业。未来，它将继续推动社会进步。",
            "学习是一个终身的过程。在这个快速变化的时代，我们需要不断更新自己的知识和技能。只有保持学习的热情，才能在竞争中立于不败之地。让我们一起努力，成为更好的自己。",
            "健康是人生最宝贵的财富。合理的饮食、适当的运动、充足的睡眠，这些都是保持健康的基本要素。我们应该珍惜身体，养成良好的生活习惯，这样才能享受美好的人生。",
            "科技的发展日新月异。互联网让世界变得更小，人们可以随时随地获取信息。移动支付改变了我们的消费方式，网上购物成为日常。我们正生活在一个充满机遇的数字时代。"
        ];
        
        const englishTexts = [
            "The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet and is commonly used for typing practice. It helps improve your typing speed and accuracy.",
            "Programming is the art of telling a computer what to do. It requires logical thinking and attention to detail. With practice, anyone can learn to write code and create amazing software applications.",
            "Technology has transformed the way we live and work. From smartphones to artificial intelligence, innovation continues to shape our future. Embracing change is essential for success in the modern world.",
            "Reading books is a wonderful way to expand your knowledge and imagination. Whether fiction or non-fiction, each book offers a unique journey. Make reading a daily habit and discover new worlds.",
            "The internet has connected billions of people around the world. Social media platforms allow us to share ideas and stay in touch with friends. Digital communication has become an integral part of modern life."
        ];
        
        const keyboardRows = {
            en: {
                row1: ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                row2: ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                row3: ['Z', 'X', 'C', 'V', 'B', 'N', 'M']
            }
        };
        
        let mode = 'cn';
        let duration = 60;
        let sampleText = '';
        let startTime = 0;
        let timerInterval = null;
        let timeLeft = 60;
        let isStarted = false;
        let totalTyped = 0;
        let totalErrors = 0;
        
        document.querySelectorAll('.mode-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.mode-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                mode = tab.dataset.mode;
            });
        });
        
        function startTest() {
            duration = parseInt(document.getElementById('duration').value);
            timeLeft = duration;
            isStarted = false;
            totalTyped = 0;
            totalErrors = 0;
            
            const texts = mode === 'cn' ? chineseTexts : englishTexts;
            sampleText = texts[Math.floor(Math.random() * texts.length)];
            
            document.getElementById('setupPanel').classList.add('hidden');
            document.getElementById('testPanel').classList.remove('hidden');
            document.getElementById('resultPanel').classList.add('hidden');
            
            renderSampleText();
            renderKeyboard();
            
            document.getElementById('timer').textContent = timeLeft;
            document.getElementById('progress').style.width = '0%';
            document.getElementById('inputArea').value = '';
            document.getElementById('inputArea').focus();
            
            updateLiveStats();
        }
        
        function renderSampleText() {
            const container = document.getElementById('sampleText');
            container.textContent = '';
            
            for (let i = 0; i < sampleText.length; i++) {
                const span = document.createElement('span');
                span.textContent = sampleText[i];
                span.className = i === 0 ? 'current' : 'pending';
                span.dataset.index = i;
                container.appendChild(span);
            }
        }
        
        function renderKeyboard() {
            if (mode === 'cn') {
                document.getElementById('keyboardHint').style.display = 'none';
                return;
            }
            
            document.getElementById('keyboardHint').style.display = 'block';
            
            ['row1', 'row2', 'row3'].forEach(rowId => {
                const row = document.getElementById(rowId);
                row.textContent = '';
                keyboardRows.en[rowId].forEach(key => {
                    const keyDiv = document.createElement('div');
                    keyDiv.className = 'key';
                    keyDiv.textContent = key;
                    keyDiv.dataset.key = key.toLowerCase();
                    row.appendChild(keyDiv);
                });
            });
        }
        
        function highlightKey(char) {
            if (mode === 'cn') return;
            
            document.querySelectorAll('.key').forEach(k => k.classList.remove('highlight'));
            
            const key = document.querySelector('[data-key="' + char.toLowerCase() + '"]');
            if (key) {
                key.classList.add('highlight');
            }
        }
        
        document.getElementById('inputArea').addEventListener('input', function(e) {
            if (!isStarted) {
                isStarted = true;
                startTime = Date.now();
                timerInterval = setInterval(updateTimer, 1000);
            }
            
            const typed = this.value;
            totalTyped = typed.length;
            
            const chars = document.querySelectorAll('#sampleText span');
            let errors = 0;
            
            for (let i = 0; i < sampleText.length; i++) {
                const span = chars[i];
                if (i < typed.length) {
                    if (typed[i] === sampleText[i]) {
                        span.className = 'correct';
                    } else {
                        span.className = 'wrong';
                        errors++;
                    }
                } else if (i === typed.length) {
                    span.className = 'current';
                    highlightKey(sampleText[i]);
                } else {
                    span.className = 'pending';
                }
            }
            
            totalErrors = errors;
            
            const progress = (typed.length / sampleText.length) * 100;
            document.getElementById('progress').style.width = Math.min(progress, 100) + '%';
            
            updateLiveStats();
            
            if (typed.length >= sampleText.length) {
                endTest();
            }
        });
        
        function updateTimer() {
            timeLeft--;
            document.getElementById('timer').textContent = timeLeft;
            
            if (timeLeft <= 0) {
                endTest();
            }
        }
        
        function updateLiveStats() {
            const elapsed = isStarted ? (Date.now() - startTime) / 1000 / 60 : 0;
            const correctChars = totalTyped - totalErrors;
            
            const cpm = elapsed > 0 ? Math.round(correctChars / elapsed) : 0;
            const wpm = Math.round(cpm / 5);
            const accuracy = totalTyped > 0 ? Math.round((correctChars / totalTyped) * 100) : 100;
            
            document.getElementById('wpmLive').textContent = wpm;
            document.getElementById('cpmLive').textContent = cpm;
            document.getElementById('accuracyLive').textContent = accuracy + '%';
        }
        
        function endTest() {
            clearInterval(timerInterval);
            
            const elapsed = (Date.now() - startTime) / 1000 / 60;
            const correctChars = totalTyped - totalErrors;
            
            const cpm = Math.round(correctChars / elapsed);
            const wpm = Math.round(cpm / 5);
            const accuracy = totalTyped > 0 ? Math.round((correctChars / totalTyped) * 100) : 0;
            
            document.getElementById('testPanel').classList.add('hidden');
            document.getElementById('resultPanel').classList.remove('hidden');
            
            document.getElementById('finalWpm').textContent = wpm;
            document.getElementById('finalCpm').textContent = cpm;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
            document.getElementById('totalChars').textContent = totalTyped;
            document.getElementById('totalErrors').textContent = totalErrors;
        }
        
        function resetTest() {
            clearInterval(timerInterval);
            startTest();
        }
        
        function backToSetup() {
            clearInterval(timerInterval);
            document.getElementById('setupPanel').classList.remove('hidden');
            document.getElementById('testPanel').classList.add('hidden');
            document.getElementById('resultPanel').classList.add('hidden');
        }
    </script>
</body>
</html>
