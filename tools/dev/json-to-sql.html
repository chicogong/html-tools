<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSON è½¬ SQL INSERT è¯­å¥ - WebUtils</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="JSON è½¬ SQL INSERT è¯­å¥ - WebUtils" />
    <meta name="keywords" content="json-to-sql,dev,tools,webutils" />
    <meta name="author" content="WebUtils" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://tools.realtime-ai.chat/tools/dev/json-to-sql.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="JSON è½¬ SQL INSERT è¯­å¥ - WebUtils" />
    <meta property="og:description" content="JSON è½¬ SQL INSERT è¯­å¥ - WebUtils" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tools.realtime-ai.chat/tools/dev/json-to-sql.html" />
    <meta property="og:site_name" content="WebUtils" />
    <meta property="og:locale" content="zh_CN" />
    <meta property="og:image" content="https://tools.realtime-ai.chat/social-preview.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:image:type" content="image/png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="JSON è½¬ SQL INSERT è¯­å¥ - WebUtils" />
    <meta name="twitter:description" content="JSON è½¬ SQL INSERT è¯­å¥ - WebUtils" />
    <meta name="twitter:image" content="https://tools.realtime-ai.chat/social-preview.png" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      :root {
        --bg-deep: #0a0a0f;
        --bg-surface: #12121a;
        --bg-card: #1a1a24;
        --bg-input: #0e0e14;
        --text-primary: #e8e8ed;
        --text-secondary: #8888a0;
        --text-muted: #55556a;
        --border-subtle: #2a2a3a;
        --border-strong: #3a3a4a;
        --accent-cyan: #00f5d4;
        --accent-green: #10b981;
        --accent-red: #f43f5e;
        --accent-yellow: #fbbf24;
        --accent-purple: #a855f7;
        --glow-cyan: rgb(0, 245, 212, 0.15);
        --glow-green: rgb(16, 185, 129, 0.15);
        --glow-red: rgb(244, 63, 94, 0.15);
        --radius-sm: 4px;
        --radius-md: 8px;
        --radius-lg: 12px;
      }

      [data-theme="light"] {
        --bg-deep: #fafafa;
        --bg-surface: #fff;
        --bg-card: #fff;
        --bg-input: #f5f5f5;
        --bg-hover: #f5f5f5;
        --text-primary: #1a1a1a;
        --text-secondary: #666;
        --text-muted: #999;
        --border-subtle: #e5e5e5;
        --border-strong: #d5d5d5;
      }

      body {
        min-height: 100vh;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }
      header h1 {
        margin: 0;
      }
      .theme-toggle {
        cursor: pointer;
        background: none;
        border: none;
        font-size: 1.5rem;
        padding: 0.5rem;
      }
      .editor-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1rem;
      }
      @media (max-width: 900px) {
        .editor-container {
          grid-template-columns: 1fr;
        }
      }
      .editor-panel {
        display: flex;
        flex-direction: column;
      }
      .editor-panel label {
        margin-bottom: 0.5rem;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .editor-panel textarea {
        min-height: 400px;
        font-family: Consolas, Monaco, "Courier New", monospace;
        font-size: 0.9rem;
        resize: vertical;
      }
      .options-panel {
        background: var(--pico-card-background-color);
        border: 1px solid var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        padding: 1rem;
        margin-bottom: 1rem;
      }
      .options-row {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        align-items: center;
        margin-bottom: 0.5rem;
      }
      .options-row:last-child {
        margin-bottom: 0;
      }
      .options-row label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin: 0;
      }
      .options-row input[type="text"] {
        width: 200px;
        margin: 0;
        padding: 0.25rem 0.5rem;
      }
      .options-row select {
        width: auto;
        margin: 0;
        padding: 0.25rem 0.5rem;
      }
      .controls {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 1rem;
      }
      .btn-group {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }
      .status-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 1rem;
        background: var(--pico-secondary-background);
        border-radius: var(--pico-border-radius);
        font-size: 0.85rem;
        margin-top: 1rem;
      }
      .status-bar .error {
        color: #ef4444;
      }
      .status-bar .success {
        color: #22c55e;
      }
      .copy-btn {
        padding: 0.25rem 0.75rem;
        font-size: 0.85rem;
      }
      .preview-table {
        margin-top: 1rem;
        overflow-x: auto;
      }
      .preview-table table {
        font-size: 0.85rem;
      }
      .preview-table th {
        background: var(--pico-secondary-background);
        white-space: nowrap;
      }
      .preview-table td {
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .field-mapping {
        margin-top: 1rem;
      }
      .field-item {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        margin-bottom: 0.5rem;
        padding: 0.5rem;
        background: var(--pico-secondary-background);
        border-radius: var(--pico-border-radius);
      }
      .field-item input[type="checkbox"] {
        margin: 0;
      }
      .field-item .field-name {
        min-width: 120px;
        font-weight: bold;
      }
      .field-item .field-type {
        color: var(--pico-muted-color);
        font-size: 0.85rem;
      }
      .field-item input[type="text"] {
        flex: 1;
        margin: 0;
        padding: 0.25rem 0.5rem;
      }

      .breadcrumb {
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.85rem;
      }
      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      .breadcrumb span {
        color: #999;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <nav class="breadcrumb">
      <a href="../../index.html">é¦–é¡µ</a>
      <span>â€º</span>
      JSON è½¬ SQL
    </nav>
    <main class="container">
      <a
        href="../../index.html"
        style="
          display: inline-block;
          margin-bottom: 1rem;
          color: var(--pico-primary);
          text-decoration: none;
        "
      >
        â† è¿”å›é¦–é¡µ
      </a>
      <header>
        <h1>ğŸ”„ JSON è½¬ SQL INSERT</h1>
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
      </header>

      <section class="options-panel">
        <div class="options-row">
          <label>
            è¡¨åï¼š
            <input type="text" id="tableName" value="table_name" placeholder="è¾“å…¥è¡¨å" />
          </label>
          <label>
            æ•°æ®åº“ç±»å‹ï¼š
            <select id="dbType">
              <option value="mysql">MySQL</option>
              <option value="postgresql">PostgreSQL</option>
              <option value="sqlite">SQLite</option>
              <option value="sqlserver">SQL Server</option>
              <option value="oracle">Oracle</option>
            </select>
          </label>
          <label>
            <input type="checkbox" id="optBatch" />
            æ‰¹é‡æ’å…¥æ¨¡å¼
          </label>
        </div>
        <div class="options-row">
          <label>
            <input type="checkbox" id="optIgnore" />
            INSERT IGNORE
          </label>
          <label>
            <input type="checkbox" id="optReplace" />
            REPLACE INTO
          </label>
          <label>
            <input type="checkbox" id="optPretty" checked />
            æ ¼å¼åŒ–è¾“å‡º
          </label>
          <label>
            <input type="checkbox" id="optNullString" />
            ç©ºå­—ç¬¦ä¸²è½¬ NULL
          </label>
        </div>
      </section>

      <section class="controls">
        <div class="btn-group">
          <button onclick="convertToSql()">ğŸ”„ ç”Ÿæˆ SQL</button>
          <button class="secondary" onclick="formatJson()">ğŸ“ æ ¼å¼åŒ– JSON</button>
          <button class="secondary" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
          <button class="outline" onclick="loadExample()">ğŸ“‹ åŠ è½½ç¤ºä¾‹</button>
        </div>
      </section>

      <section class="editor-container">
        <div class="editor-panel">
          <label for="jsonInput">è¾“å…¥ JSON æ•°æ®ï¼ˆå¯¹è±¡æˆ–æ•°ç»„ï¼‰</label>
          <textarea
            id="jsonInput"
            placeholder='[{"name": "å¼ ä¸‰", "age": 25}, {"name": "æå››", "age": 30}]'
          ></textarea>
        </div>
        <div class="editor-panel">
          <label for="sqlOutput">
            ç”Ÿæˆçš„ SQL è¯­å¥
            <button class="copy-btn outline secondary" onclick="copySql()">å¤åˆ¶</button>
          </label>
          <textarea id="sqlOutput" readonly placeholder="ç‚¹å‡»ç”ŸæˆæŒ‰é’®æŸ¥çœ‹ç»“æœ"></textarea>
        </div>
      </section>

      <div class="status-bar">
        <span id="statusText">å°±ç»ª</span>
        <span id="statsText"></span>
      </div>

      <section>
        <details>
          <summary>å­—æ®µæ˜ å°„ï¼ˆå¯é€‰ï¼‰</summary>
          <div class="field-mapping" id="fieldMapping">
            <p style="color: var(--pico-muted-color)">è§£æ JSON åæ˜¾ç¤ºå­—æ®µåˆ—è¡¨</p>
          </div>
        </details>
      </section>

      <section>
        <details>
          <summary>æ•°æ®é¢„è§ˆ</summary>
          <div class="preview-table" id="previewTable">
            <p style="color: var(--pico-muted-color)">è§£æ JSON åæ˜¾ç¤ºæ•°æ®é¢„è§ˆ</p>
          </div>
        </details>
      </section>

      <section style="margin-top: 2rem">
        <details>
          <summary>ä½¿ç”¨è¯´æ˜</summary>
          <article>
            <h4>æ”¯æŒçš„è¾“å…¥æ ¼å¼</h4>
            <ul>
              <li>
                å•ä¸ªå¯¹è±¡ï¼š
                <code>{"name": "å¼ ä¸‰", "age": 25}</code>
              </li>
              <li>
                å¯¹è±¡æ•°ç»„ï¼š
                <code>[{"name": "å¼ ä¸‰"}, {"name": "æå››"}]</code>
              </li>
            </ul>

            <h4>æ•°æ®åº“å·®å¼‚</h4>
            <ul>
              <li>
                <strong>MySQL</strong>
                ï¼šæ”¯æŒ INSERT IGNORE, REPLACE INTO, æ‰¹é‡æ’å…¥
              </li>
              <li>
                <strong>PostgreSQL</strong>
                ï¼šä½¿ç”¨ ON CONFLICT DO NOTHING
              </li>
              <li>
                <strong>SQLite</strong>
                ï¼šæ”¯æŒ INSERT OR IGNORE, INSERT OR REPLACE
              </li>
              <li>
                <strong>SQL Server</strong>
                ï¼šä½¿ç”¨æ–¹æ‹¬å·åŒ…è£¹æ ‡è¯†ç¬¦
              </li>
              <li>
                <strong>Oracle</strong>
                ï¼šä½¿ç”¨ INSERT ALL è¯­æ³•
              </li>
            </ul>

            <h4>æ³¨æ„äº‹é¡¹</h4>
            <ul>
              <li>å­—ç¬¦ä¸²å€¼ä¼šè‡ªåŠ¨è½¬ä¹‰å•å¼•å·</li>
              <li>null å€¼ä¼šç”Ÿæˆ NULL</li>
              <li>å¸ƒå°”å€¼æ ¹æ®æ•°æ®åº“ç±»å‹è½¬æ¢</li>
              <li>åµŒå¥—å¯¹è±¡ä¼šè½¬ä¸º JSON å­—ç¬¦ä¸²</li>
            </ul>
          </article>
        </details>
      </section>
    </main>

    <script>
      // ä¸»é¢˜åˆ‡æ¢
      window.toggleTheme = function () {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "light" ? "dark" : "light";
        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
        document.querySelector(".theme-toggle").textContent = newTheme === "light" ? "ğŸŒ™" : "â˜€ï¸";
      };

      function initTheme() {
        const savedTheme =
          localStorage.getItem("theme") ||
          (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", savedTheme);
        document.querySelector(".theme-toggle").textContent = savedTheme === "light" ? "ğŸŒ™" : "â˜€ï¸";
      }

      // å­—æ®µé…ç½®
      let fieldConfig = {};

      // è½¬ä¹‰å­—ç¬¦ä¸²
      function escapeString(str, dbType) {
        if (str === null || str === undefined) return null;
        str = String(str);

        // åŸºæœ¬è½¬ä¹‰
        str = str.replace(/'/g, "''");

        if (dbType === "mysql") {
          str = str.replace(/\\/g, "\\\\");
        }

        return str;
      }

      // æ ¼å¼åŒ–å€¼
      function formatValue(value, dbType, nullString) {
        if (value === null || value === undefined) {
          return "NULL";
        }

        if (nullString && value === "") {
          return "NULL";
        }

        if (typeof value === "boolean") {
          if (dbType === "postgresql") {
            return value ? "TRUE" : "FALSE";
          }
          return value ? "1" : "0";
        }

        if (typeof value === "number") {
          return String(value);
        }

        if (typeof value === "object") {
          // åµŒå¥—å¯¹è±¡è½¬ JSON å­—ç¬¦ä¸²
          return "'" + escapeString(JSON.stringify(value), dbType) + "'";
        }

        return "'" + escapeString(value, dbType) + "'";
      }

      // åŒ…è£¹æ ‡è¯†ç¬¦
      function wrapIdentifier(name, dbType) {
        switch (dbType) {
          case "mysql":
            return "`" + name + "`";
          case "postgresql":
            return '"' + name + '"';
          case "sqlserver":
            return "[" + name + "]";
          case "oracle":
            return '"' + name.toUpperCase() + '"';
          default:
            return name;
        }
      }

      // ç”Ÿæˆå•æ¡ INSERT
      function generateSingleInsert(data, columns, tableName, dbType, options) {
        const values = columns
          .map((col) => {
            const mappedCol = fieldConfig[col];
            if (mappedCol && mappedCol.exclude) return null;
            return formatValue(data[col], dbType, options.nullString);
          })
          .filter((v) => v !== null);

        const cols = columns
          .filter((col) => !fieldConfig[col] || !fieldConfig[col].exclude)
          .map((col) => {
            const mapped = fieldConfig[col];
            return wrapIdentifier(mapped && mapped.rename ? mapped.rename : col, dbType);
          });

        let sql = "";

        if (options.replace && (dbType === "mysql" || dbType === "sqlite")) {
          sql = "REPLACE INTO";
        } else if (options.ignore) {
          if (dbType === "mysql") {
            sql = "INSERT IGNORE INTO";
          } else if (dbType === "sqlite") {
            sql = "INSERT OR IGNORE INTO";
          } else {
            sql = "INSERT INTO";
          }
        } else {
          sql = "INSERT INTO";
        }

        sql += " " + wrapIdentifier(tableName, dbType);

        if (options.pretty) {
          sql += "\n  (" + cols.join(", ") + ")\nVALUES\n  (" + values.join(", ") + ")";
        } else {
          sql += " (" + cols.join(", ") + ") VALUES (" + values.join(", ") + ")";
        }

        // PostgreSQL ON CONFLICT
        if (options.ignore && dbType === "postgresql") {
          sql += "\nON CONFLICT DO NOTHING";
        }

        return sql + ";";
      }

      // ç”Ÿæˆæ‰¹é‡ INSERT (MySQL)
      function generateBatchInsertMySQL(dataArray, columns, tableName, dbType, options) {
        const cols = columns
          .filter((col) => !fieldConfig[col] || !fieldConfig[col].exclude)
          .map((col) => {
            const mapped = fieldConfig[col];
            return wrapIdentifier(mapped && mapped.rename ? mapped.rename : col, dbType);
          });

        let sql = options.ignore ? "INSERT IGNORE INTO" : "INSERT INTO";
        sql += " " + wrapIdentifier(tableName, dbType);

        if (options.pretty) {
          sql += "\n  (" + cols.join(", ") + ")\nVALUES";
        } else {
          sql += " (" + cols.join(", ") + ") VALUES ";
        }

        const valueRows = dataArray.map((data) => {
          const values = columns
            .map((col) => {
              if (fieldConfig[col] && fieldConfig[col].exclude) return null;
              return formatValue(data[col], dbType, options.nullString);
            })
            .filter((v) => v !== null);
          return "(" + values.join(", ") + ")";
        });

        if (options.pretty) {
          sql += "\n  " + valueRows.join(",\n  ");
        } else {
          sql += valueRows.join(", ");
        }

        return sql + ";";
      }

      // ç”Ÿæˆ Oracle INSERT ALL
      function generateOracleInsertAll(dataArray, columns, tableName, dbType, options) {
        const cols = columns
          .filter((col) => !fieldConfig[col] || !fieldConfig[col].exclude)
          .map((col) => {
            const mapped = fieldConfig[col];
            return wrapIdentifier(mapped && mapped.rename ? mapped.rename : col, dbType);
          });

        let sql = "INSERT ALL";

        dataArray.forEach((data) => {
          const values = columns
            .map((col) => {
              if (fieldConfig[col] && fieldConfig[col].exclude) return null;
              return formatValue(data[col], dbType, options.nullString);
            })
            .filter((v) => v !== null);

          if (options.pretty) {
            sql += "\n  INTO " + wrapIdentifier(tableName, dbType);
            sql += " (" + cols.join(", ") + ")";
            sql += " VALUES (" + values.join(", ") + ")";
          } else {
            sql += " INTO " + wrapIdentifier(tableName, dbType);
            sql += " (" + cols.join(", ") + ") VALUES (" + values.join(", ") + ")";
          }
        });

        sql += "\nSELECT 1 FROM DUAL;";
        return sql;
      }

      // ä¸»è½¬æ¢å‡½æ•°
      window.convertToSql = function () {
        const input = document.getElementById("jsonInput").value.trim();
        const tableName = document.getElementById("tableName").value.trim() || "table_name";
        const dbType = document.getElementById("dbType").value;
        const statusText = document.getElementById("statusText");
        const statsText = document.getElementById("statsText");

        if (!input) {
          setStatus("è¯·è¾“å…¥ JSON æ•°æ®", "error");
          return;
        }

        try {
          let json = JSON.parse(input);

          // ç¡®ä¿æ˜¯æ•°ç»„
          const dataArray = Array.isArray(json) ? json : [json];

          if (dataArray.length === 0) {
            setStatus("JSON æ•°ç»„ä¸ºç©º", "error");
            return;
          }

          // è·å–æ‰€æœ‰åˆ—
          const allColumns = new Set();
          dataArray.forEach((item) => {
            if (typeof item === "object" && item !== null) {
              Object.keys(item).forEach((key) => allColumns.add(key));
            }
          });
          const columns = Array.from(allColumns);

          if (columns.length === 0) {
            setStatus("æ— æ³•ä» JSON ä¸­æå–å­—æ®µ", "error");
            return;
          }

          // æ›´æ–°å­—æ®µæ˜ å°„ UI
          updateFieldMapping(columns, dataArray[0]);

          // ç”Ÿæˆ SQL
          const options = {
            batch: document.getElementById("optBatch").checked,
            ignore: document.getElementById("optIgnore").checked,
            replace: document.getElementById("optReplace").checked,
            pretty: document.getElementById("optPretty").checked,
            nullString: document.getElementById("optNullString").checked
          };

          let sql = "";

          if (options.batch && dataArray.length > 1) {
            if (dbType === "oracle") {
              sql = generateOracleInsertAll(dataArray, columns, tableName, dbType, options);
            } else {
              sql = generateBatchInsertMySQL(dataArray, columns, tableName, dbType, options);
            }
          } else {
            const statements = dataArray.map((data) =>
              generateSingleInsert(data, columns, tableName, dbType, options)
            );
            sql = statements.join(options.pretty ? "\n\n" : "\n");
          }

          document.getElementById("sqlOutput").value = sql;

          // æ›´æ–°é¢„è§ˆè¡¨æ ¼
          updatePreviewTable(dataArray, columns);

          statsText.textContent = "è®°å½•æ•°: " + dataArray.length + " | å­—æ®µæ•°: " + columns.length;
          setStatus("ç”ŸæˆæˆåŠŸ", "success");
        } catch (e) {
          setStatus("JSON è§£æé”™è¯¯: " + e.message, "error");
          document.getElementById("sqlOutput").value = "";
          statsText.textContent = "";
        }
      };

      // æ›´æ–°å­—æ®µæ˜ å°„
      function updateFieldMapping(columns, sampleData) {
        const container = document.getElementById("fieldMapping");
        container.textContent = "";

        columns.forEach((col) => {
          const value = sampleData[col];
          const type = value === null ? "null" : typeof value;

          if (!fieldConfig[col]) {
            fieldConfig[col] = { exclude: false, rename: "" };
          }

          const div = document.createElement("div");
          div.className = "field-item";

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = !fieldConfig[col].exclude;
          checkbox.onchange = function () {
            fieldConfig[col].exclude = !this.checked;
          };

          const nameSpan = document.createElement("span");
          nameSpan.className = "field-name";
          nameSpan.textContent = col;

          const typeSpan = document.createElement("span");
          typeSpan.className = "field-type";
          typeSpan.textContent = "(" + type + ")";

          const renameInput = document.createElement("input");
          renameInput.type = "text";
          renameInput.placeholder = "é‡å‘½åä¸º...";
          renameInput.value = fieldConfig[col].rename || "";
          renameInput.oninput = function () {
            fieldConfig[col].rename = this.value;
          };

          div.appendChild(checkbox);
          div.appendChild(nameSpan);
          div.appendChild(typeSpan);
          div.appendChild(renameInput);
          container.appendChild(div);
        });
      }

      // æ›´æ–°é¢„è§ˆè¡¨æ ¼
      function updatePreviewTable(dataArray, columns) {
        const container = document.getElementById("previewTable");
        container.textContent = "";

        const table = document.createElement("table");

        // è¡¨å¤´
        const thead = document.createElement("thead");
        const headerRow = document.createElement("tr");
        columns.forEach((col) => {
          const th = document.createElement("th");
          th.textContent = col;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        table.appendChild(thead);

        // è¡¨ä½“ï¼ˆæœ€å¤šæ˜¾ç¤º10è¡Œï¼‰
        const tbody = document.createElement("tbody");
        const displayData = dataArray.slice(0, 10);
        displayData.forEach((data) => {
          const tr = document.createElement("tr");
          columns.forEach((col) => {
            const td = document.createElement("td");
            const value = data[col];
            if (value === null || value === undefined) {
              td.textContent = "NULL";
              td.style.color = "var(--pico-muted-color)";
            } else if (typeof value === "object") {
              td.textContent = JSON.stringify(value);
            } else {
              td.textContent = String(value);
            }
            td.title = td.textContent;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
        table.appendChild(tbody);

        container.appendChild(table);

        if (dataArray.length > 10) {
          const note = document.createElement("p");
          note.style.color = "var(--pico-muted-color)";
          note.style.fontSize = "0.85rem";
          note.textContent = "ä»…æ˜¾ç¤ºå‰ 10 æ¡ï¼Œå…± " + dataArray.length + " æ¡è®°å½•";
          container.appendChild(note);
        }
      }

      // è®¾ç½®çŠ¶æ€
      function setStatus(text, type) {
        const statusText = document.getElementById("statusText");
        statusText.textContent = text;
        statusText.className = type || "";
      }

      // æ ¼å¼åŒ– JSON
      window.formatJson = function () {
        const input = document.getElementById("jsonInput");
        try {
          const json = JSON.parse(input.value);
          input.value = JSON.stringify(json, null, 2);
          setStatus("æ ¼å¼åŒ–æˆåŠŸ", "success");
        } catch (e) {
          setStatus("JSON æ ¼å¼é”™è¯¯: " + e.message, "error");
        }
      };

      // å¤åˆ¶ SQL
      window.copySql = function () {
        const output = document.getElementById("sqlOutput");
        if (!output.value) {
          setStatus("æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹", "error");
          return;
        }
        navigator.clipboard
          .writeText(output.value)
          .then(() => {
            setStatus("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿", "success");
          })
          .catch(() => {
            output.select();
            document.execCommand("copy");
            setStatus("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿", "success");
          });
      };

      // æ¸…ç©º
      window.clearAll = function () {
        document.getElementById("jsonInput").value = "";
        document.getElementById("sqlOutput").value = "";
        document.getElementById("statsText").textContent = "";
        document.getElementById("fieldMapping").textContent = "";
        document.getElementById("previewTable").textContent = "";
        fieldConfig = {};
        setStatus("å·²æ¸…ç©º", "success");
      };

      // åŠ è½½ç¤ºä¾‹
      window.loadExample = function () {
        const example = [
          {
            id: 1,
            name: "å¼ ä¸‰",
            email: "zhangsan@example.com",
            age: 28,
            is_active: true,
            balance: 1234.56,
            created_at: "2024-01-15 10:30:00"
          },
          {
            id: 2,
            name: "æå››",
            email: "lisi@example.com",
            age: 32,
            is_active: false,
            balance: 5678.9,
            created_at: "2024-01-16 14:20:00"
          },
          {
            id: 3,
            name: "ç‹äº”",
            email: null,
            age: 25,
            is_active: true,
            balance: 0,
            created_at: "2024-01-17 09:15:00"
          }
        ];
        document.getElementById("jsonInput").value = JSON.stringify(example, null, 2);
        document.getElementById("tableName").value = "users";
        setStatus("å·²åŠ è½½ç¤ºä¾‹æ•°æ®", "success");
      };

      // åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", () => {
        initTheme();

        // äº’æ–¥é€‰é¡¹
        document.getElementById("optIgnore").addEventListener("change", function () {
          if (this.checked) {
            document.getElementById("optReplace").checked = false;
          }
        });

        document.getElementById("optReplace").addEventListener("change", function () {
          if (this.checked) {
            document.getElementById("optIgnore").checked = false;
          }
        });
      });
    </script>
  </body>
</html>
